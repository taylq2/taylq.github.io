define("mediaServices/services/wixMediaManager/constants",["util"],function(e){"use strict";return{BASE_HOST:e.serviceTopology.baseDomain,MMGR_BASE_URL:e.serviceTopology.mediaManagerUrl,MMGR_UOU_UPLOAD_NAMESPACE:"_WixCodeAnonymUpload",MMGR_LANGUAGE_CODE:e.editorModel.languageCode,MMGR_WINDOW_STYLE:"fullscreen",MMGR_MAX_PARALLEL_UPLOADS:6,MMGR_SELECTION_TYPE:["single","multiple"],MMGR_TRANSLATION_KEYS_MAP:{description:{private:"private_media.upload_restrictions_header_message",external:"social_images.upload_restrictions_header_message",public:"free_from_wix.upload_restrictions_header_message",photoStock:"bigstock_images.upload_restrictions_header_message",shutterStock:"shutterstock_images.upload_restrictions_header_message"},tab:{private:"private_media_tab",external:"external_media_tab",public:"public_media_tab",photoStock:"photo_stock_tab",shutterStock:"shutterstock_tab"},noItems:{allMediaFolder:{header:"no_items.header_allMedia",text:"no_items.text_allMedia"},siteMediaFolder:{header:"no_items.header_siteMedia",text:"no_items.text_siteMedia"},userMediaFolder:{header:"no_items.header_user_folder",text:"no_items.text_user_folder"}},title:"header",submitButton:"footer.submit",uploadButton:"uploader.upload"},MMGR_SERVICES_LIST_MAP:{FACEBOOK:"facebook",FLICKR:"flickr",INSTAGRAM:"instagram",PICASA:"picasa",GOOGLE_DRIVE:"drive",DROPBOX:"dropbox"},SINGLE:0,MULTIPLE:1,PRIVATE_MEDIA:"private",MMGR_TABS_MAP:{MY_SHAPE:"private",MY_SHAPE_UOU:"private",MY_IMAGE:"private",MY_IMAGE_PRO:"private",MY_IMAGE_UOU:"private",MY_VIDEO:"private",MY_VIDEO_PRO:"private",MY_VIDEO_UOU:"private",MY_MUSIC:"private",MY_MUSIC_PRO:"private",MY_MUSIC_UOU:"private",MY_DOCUMENT:"private",MY_DOCUMENT_PRO:"private",MY_DOCUMENT_UOU:"private",MY_FLASH:"private",MY_FLASH_UOU:"private",MY_FAVICON:"private",MY_NETWORK:"external",FREE_FROM_WIX:"public",BIG_STOCK:"photoStock",SHUTTER_STOCK:"shutterStock"},MMGR_IMAGE_ANALYSIS_OPTIONS:{faces:["face"],labels:["label","explicit_content"],dominantColors:["color"],cropHints:["crop_hints"],landmarks:["landmark"],logos:["logo"]}}}),define("mediaServices/services/wixMediaManager/presets",["mediaServices/services/wixMediaManager/constants"],function(e){"use strict";return{SHAPE:{canAddMedia:!0,canAddMultipleMedia:!0,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!1,canUseImageAnalysis:!1,helpId:"",tabsList:{open:["FREE_FROM_WIX"],manage:[],default:"FREE_FROM_WIX"},socialNetworksList:[],mmgrParams:{i18nPrefix:["shape","multiple_shapes"],mediaType:"shape",publicMediaRoot:"shapes",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},VECTOR_SHAPE:{canAddMedia:!0,canAddMultipleMedia:!0,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!1,canUseImageAnalysis:!1,helpId:"",tabsList:{open:["FREE_FROM_WIX"],manage:[],default:"FREE_FROM_WIX"},socialNetworksList:[],mmgrParams:{i18nPrefix:["shape","multiple_shapes"],mediaType:"shape",publicMediaRoot:"vector_shapes",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},VECTOR_ART:{canAddMedia:!0,canAddMultipleMedia:!0,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!1,canUseImageAnalysis:!1,helpId:"f0a9768b-ca4a-48db-96ef-26522d2e3863",tabsList:{open:["FREE_FROM_WIX"],manage:[],default:"FREE_FROM_WIX"},socialNetworksList:[],mmgrParams:{i18nPrefix:["shape","multiple_shapes"],mediaType:"shape",publicMediaRoot:"vector_art",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},IMAGE:{canAddMedia:!0,canAddMultipleMedia:!0,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!0,helpId:"",tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","SHUTTER_STOCK"],manage:["MY_IMAGE"],default:"MY_IMAGE"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["single_image","multiple_images"],mediaType:"picture",publicMediaRoot:"photos",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},IMAGE_PRO:{canAddMedia:!0,canAddMultipleMedia:!0,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!0,helpId:"",tabsList:{open:["MY_IMAGE_PRO"],manage:["MY_IMAGE_PRO"],default:"MY_IMAGE_PRO"},socialNetworksList:[],mmgrParams:{i18nPrefix:["single_secure_image","addmultiple_secure_images"],mediaType:"secure_picture",publicMediaRoot:"",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},IMAGE_UOU:{canAddMedia:!1,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!1,canUseImageAnalysis:!0,helpId:"",tabsList:{open:["MY_IMAGE_UOU"],manage:["MY_IMAGE_UOU"],default:"MY_IMAGE_UOU"},socialNetworksList:[],mmgrParams:{i18nPrefix:["single_image","multiple_images"],mediaType:"picture",publicMediaRoot:"",videoEncodingProfile:"",namespace:e.MMGR_UOU_UPLOAD_NAMESPACE},translationMap:{title:!0,tabCaption:!0,description:!0,uploadCaption:!1,noItems:!0,submitCaption:!1}},DOCUMENT_UOU:{canAddMedia:!1,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!1,canUseImageAnalysis:!1,helpId:"",tabsList:{open:["MY_DOCUMENT_UOU"],manage:["MY_DOCUMENT_UOU"],default:"MY_DOCUMENT_UOU"},socialNetworksList:[],mmgrParams:{i18nPrefix:["document","addmultiple_document"],mediaType:"document",publicMediaRoot:"",videoEncodingProfile:"",namespace:e.MMGR_UOU_UPLOAD_NAMESPACE},translationMap:{title:!0,tabCaption:!0,description:!0,uploadCaption:!1,noItems:!0,submitCaption:!1}},VIDEO:{canAddMedia:!0,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!0,canUploadMedia:!0,canUseImageAnalysis:!1,helpId:"",tabsList:{open:["MY_VIDEO"],manage:["MY_VIDEO"],default:"MY_VIDEO"},socialNetworksList:[],mmgrParams:{i18nPrefix:["video","addmultiple_video"],mediaType:"video",publicMediaRoot:"",videoEncodingProfile:"mp4-storyboard",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},MUSIC:{canAddMedia:!0,canAddMultipleMedia:!0,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!1,helpId:"",tabsList:{open:["MY_MUSIC"],manage:["MY_MUSIC"],default:"MY_MUSIC"},socialNetworksList:[],mmgrParams:{i18nPrefix:["music","addmultiple_music"],mediaType:"music",publicMediaRoot:"",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},MUSIC_PRO:{canAddMedia:!0,canAddMultipleMedia:!0,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!1,helpId:"",tabsList:{open:["MY_MUSIC_PRO"],manage:["MY_MUSIC_PRO"],default:"MY_MUSIC_PRO"},socialNetworksList:[],mmgrParams:{i18nPrefix:["secure_music","addmultiple_secure_music"],mediaType:"secure_music",publicMediaRoot:"",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},DOCUMENT:{canAddMedia:!0,canAddMultipleMedia:!0,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!1,helpId:"",tabsList:{open:["MY_DOCUMENT"],manage:["MY_DOCUMENT"],default:"MY_DOCUMENT"},socialNetworksList:[],mmgrParams:{i18nPrefix:["document","addmultiple_document"],mediaType:"document",publicMediaRoot:"",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},FLASH:{canAddMedia:!0,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!1,helpId:"",tabsList:{open:["MY_FLASH"],manage:[],default:"MY_FLASH"},socialNetworksList:[],mmgrParams:{i18nPrefix:["flash","multiple_flash"],mediaType:"swf",publicMediaRoot:"",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},CLIPART:{canAddMedia:!0,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!0,helpId:"",tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","SHUTTER_STOCK"],manage:[],default:"MY_IMAGE"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["clipart","addmultiple_clipart"],mediaType:"picture",publicMediaRoot:"clipart",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},ILLUSTRATION:{canAddMedia:!0,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!1,canUseImageAnalysis:!1,helpId:"49601b49-c395-44ff-84bf-2934e789b6a4",tabsList:{open:["FREE_FROM_WIX"],manage:[],default:"FREE_FROM_WIX"},socialNetworksList:[],mmgrParams:{i18nPrefix:["clipart","addmultiple_clipart"],mediaType:"picture",publicMediaRoot:"illustrations",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!1,noItems:!1,submitCaption:!0}},BG_IMAGE:{canAddMedia:!0,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!0,helpId:"",tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","SHUTTER_STOCK"],manage:[],default:"MY_IMAGE"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["background","multiple_background"],mediaType:"picture",publicMediaRoot:"backgrounds",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},BG_VIDEO:{canAddMedia:!0,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!0,canUploadMedia:!0,canUseImageAnalysis:!1,helpId:"",tabsList:{open:["MY_VIDEO","FREE_FROM_WIX"],manage:[],default:"MY_VIDEO"},socialNetworksList:[],mmgrParams:{i18nPrefix:["video","addmultiple_video"],mediaType:"video",publicMediaRoot:"videos",videoEncodingProfile:"mp4-storyboard",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},ICON_DOCUMENT:{canAddMedia:!0,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!1,helpId:"",tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","SHUTTER_STOCK"],manage:[],default:"FREE_FROM_WIX"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["single_icon","multiple_icons"],mediaType:"picture",publicMediaRoot:"file_icons",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},ICON_SOCIAL:{canAddMedia:!0,canAddMultipleMedia:!0,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!1,helpId:"",tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","SHUTTER_STOCK"],manage:[],default:"FREE_FROM_WIX"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["single_icon","multiple_icons"],mediaType:"picture",publicMediaRoot:"social_icons",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},ICON_FAVICON:{canAddMedia:!0,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!1,helpId:"",tabsList:{open:["MY_FAVICON","SHUTTER_STOCK"],manage:[],default:"MY_FAVICON"},socialNetworksList:[],mmgrParams:{i18nPrefix:["favicon","multiple_favicons"],mediaType:"site_icon",publicMediaRoot:"",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}}}}),define("mediaServices/services/wixMediaManager/mmgrUtils",["lodash","mediaServices/services/wixMediaManager/constants","util"],function(e,a,i){"use strict";function t(e){return a.MMGR_TABS_MAP[e]}return{getMMGRMediaType:function(e){return e.mmgrParams.mediaType},getMMGRSelectionType:function(e){return a.MMGR_SELECTION_TYPE[e.canAddMultipleMedia?a.MULTIPLE:a.SINGLE]},getMMGRI18nPrefix:function(e){return e.mmgrParams.i18nPrefix[e.canAddMultipleMedia?a.MULTIPLE:a.SINGLE]},getMMGRTabsList:function(e){for(var a=[],i=0;i<e.tabsList.length;i++)a[i]=t(e.tabsList[i]);return a},getMMGRServicesList:function(e){for(var i=[],t=0;t<e.socialNetworksList.length;t++)i[t]=a.MMGR_SERVICES_LIST_MAP[e.socialNetworksList[t]];return i},getMMGRTranslations:function(n){var o={},s=void 0,d=void 0,l=n.canAddMultipleMedia?"_MULTISELECT":"";return n.translationMap.title&&(s=("MMGR_API_"+n.categoryName+(n.manageMode?"_MANAGE":"_OPEN")+"_TITLE"+l).toUpperCase(),d=a.MMGR_TRANSLATION_KEYS_MAP.title,o[d]=n.translation.title||i.translate(s)),e.forEach(n.tabsList,function(e){n.translationMap.tabCaption&&(s=("MMGR_API_"+e+"_TAB").toUpperCase(),d=a.MMGR_TRANSLATION_KEYS_MAP.tab[t(e)],o[d]=i.translate(s)),n.translationMap.description&&(s=("MMGR_API_"+e+"_DESCRIPTION").toUpperCase(),d=a.MMGR_TRANSLATION_KEYS_MAP.description[t(e)],o[d]=i.translate(s)),t(e)===a.PRIVATE_MEDIA&&n.translationMap.noItems&&(s=("MMGR_API_"+e+"_NO_ITEMS_HEADER_ALL_MEDIA").toUpperCase(),d=a.MMGR_TRANSLATION_KEYS_MAP.noItems.allMediaFolder.header,o[d]=i.translate(s),s=("MMGR_API_"+e+"_NO_ITEMS_TEXT_ALL_MEDIA").toUpperCase(),d=a.MMGR_TRANSLATION_KEYS_MAP.noItems.allMediaFolder.text,o[d]=i.translate(s),s=("MMGR_API_"+e+"_NO_ITEMS_HEADER_SITE_MEDIA").toUpperCase(),d=a.MMGR_TRANSLATION_KEYS_MAP.noItems.siteMediaFolder.header,o[d]=i.translate(s),s=("MMGR_API_"+e+"_NO_ITEMS_TEXT_SITE_MEDIA").toUpperCase(),d=a.MMGR_TRANSLATION_KEYS_MAP.noItems.siteMediaFolder.text,o[d]=i.translate(s),s=("MMGR_API_"+e+"_NO_ITEMS_HEADER_USER_FOLDER").toUpperCase(),d=a.MMGR_TRANSLATION_KEYS_MAP.noItems.userMediaFolder.header,o[d]=i.translate(s),s=("MMGR_API_"+e+"_NO_ITEMS_TEXT_USER_FOLDER").toUpperCase(),d=a.MMGR_TRANSLATION_KEYS_MAP.noItems.userMediaFolder.text,o[d]=i.translate(s))}),n.translationMap.uploadCaption&&(s=("MMGR_API_"+n.categoryName+"_UPLOAD_BUTTON").toUpperCase(),d=a.MMGR_TRANSLATION_KEYS_MAP.uploadButton,o[d]=i.translate(s)),n.translationMap.submitCaption&&(s=("MMGR_API_"+n.categoryName+"_SUBMIT_BUTTON"+l).toUpperCase(),d=a.MMGR_TRANSLATION_KEYS_MAP.submitButton,o[d]=n.translation.submitButton||i.translate(s)),o},getImageAnalysisOptions:function(i){return[].concat.apply([],e(a.MMGR_IMAGE_ANALYSIS_OPTIONS).keys().filter(function(e){return i[e]}).map(function(e){return a.MMGR_IMAGE_ANALYSIS_OPTIONS[e]}).value()).filter(function(e,a,i){return i.indexOf(e)===a})}}}),define("mediaServices/services/wixMediaManager/adapter",["lodash","jquery","mediaServices/services/wixMediaManager/presets","mediaServices/services/wixMediaManager/constants","mediaServices/services/wixMediaManager/mmgrUtils","coreUtilsLib"],function(e,a,i,t,n,o){"use strict";function s(i){function o(e){if(i.callback){var t=e&&e.items||null,n=t&&{path:e.path}||null;i.callback(t,n)}s.off("close",o),s.off("items",o),function(){var e=a("#editor");if(e){var i=a(window),t=i.scrollTop();e.trigger("focus"),i.scrollTop(t)}}()}var s=window.MediaFrame,d={mediaGalleryBaseHost:t.MMGR_BASE_URL,baseHost:t.BASE_HOST,i18nCode:t.MMGR_LANGUAGE_CODE,windowStyle:t.MMGR_WINDOW_STYLE,i18nPrefix:n.getMMGRI18nPrefix(i),mediaType:n.getMMGRMediaType(i),selectionType:n.getMMGRSelectionType(i),canShowSelectButton:i.canAddMedia,canSubmitUntranscoded:i.canAddMediaBeforeEncodingComplete,disableUpload:!i.canUploadMedia,tabsList:n.getMMGRTabsList(i),path:i.path,siteMediaToken:i.siteMediaToken,isEmailWithWixDomain:i.isEmailWithWixDomain,maxParallelUploads:t.MMGR_MAX_PARALLEL_UPLOADS};if(i.imageAnalysis){var l=n.getImageAnalysisOptions(i.imageAnalysis);l.length&&(d.vision=l)}d.translations=n.getMMGRTranslations(i),i.mmgrParams.publicMediaRoot&&(d.publicMediaRoot=i.mmgrParams.publicMediaRoot),e.isEmpty(i.socialNetworksList)||(d.servicesList=n.getMMGRServicesList(i)),e.isEmpty(i.mmgrParams.videoEncodingProfile)||(d.videoEncodingProfile=i.mmgrParams.videoEncodingProfile),e.isEmpty(i.mmgrParams.namespace)||(d.namespace=i.mmgrParams.namespace),e.isEmpty(i.helpId)||(d.helpId=i.helpId),s.on("items",o).on("close",o),s.open(d),window.document.getElementById("mediaGalleryFrame").contentWindow.focus()}return{open:function(e,a,n){n=n||{};var o=i[a],d={categoryName:a,tabsList:o.tabsList.open,socialNetworksList:o.socialNetworksList,mmgrParams:o.mmgrParams,helpId:o.helpId,canAddMedia:o.canAddMedia,canAddMultipleMedia:void 0===n.multiSelect?o.canAddMultipleMedia:n.multiSelect,canAddMediaBeforeEncodingComplete:o.canAddMediaBeforeEncodingComplete,canUploadMedia:o.canUploadMedia,manageMode:!1,path:n.path||t.MMGR_TABS_MAP[o.tabsList.default],translation:{},translationMap:o.translationMap,siteMediaToken:e.siteMediaToken,isEmailWithWixDomain:e.isEmailWithWixDomain,imageAnalysis:o.canUseImageAnalysis?n.imageAnalysis||null:null};n.translation&&(n.translation.title&&(d.translation.title=n.translation.title),n.translation.submitButton&&(d.translation.submitButton=n.translation.submitButton)),n.callback&&(d.callback=function(){n.callback.apply(null,arguments),window.focus()}),s(d)},presets:i,manage:function(a,n,d){d=d||{};var l=i[n],r={categoryName:n,tabsList:l.tabsList.manage,socialNetworksList:l.socialNetworksList,mmgrParams:l.mmgrParams,helpId:l.helpId,canAddMedia:!1,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:l.canUploadMedia,manageMode:!0,path:d.path||t.MMGR_TABS_MAP[l.tabsList.default],translation:{},translationMap:l.translationMap,siteMediaToken:a.siteMediaToken,isEmailWithWixDomain:a.isEmailWithWixDomain,imageAnalysis:l.canUseImageAnalysis?d.imageAnalysis||null:null};d.translation&&d.translation.title&&(r.translation.title=d.translation.title),d.callback&&(r.callback=d.callback),e.isEmpty(r.tabsList)?o.log.error(n+" is an un-managed category"):s(r)},categories:function(){var a={};return e.forEach(e.keys(i),function(e){e=e.toUpperCase(),a[e]=e}),a}()}}),define("mediaServices/services/fontsManager/fontsUploader",["lodash","wixmp","util"],function(e,a,i){"use strict";return{upload:function(t,n){if(t){var o=e.map(n,function(e){return{uploadFn:t.item.upload,source:{file:e,name:e.name,size:e.size,folderId:null,folderName:"All Media",mediaType:i.fontsManagerUtils.constants.FONTS_MEDIA_TYPE}}});a.Uploader.upload(o)}},clearUploadQueue:function(){a.Uploader.uploadIsInProgress||a.Uploader.clearQueue()},getUploadQueue:function(){return a.Uploader.uploadQueue},cancelUpload:function(e){var a=!1;if(e.canAbort())try{e.abort(),a=!0}catch(e){a=!1}return a},retryUpload:function(){!e.isEmpty(a.Uploader.uploadQueue)&a.Uploader.uploadIsInProgress&&a.Uploader.upload()},registerToFileStatusChanged:function(e){a.Uploader.on("fileStatusChanged",function(a){e(a)})},registerToQueueChange:function(e){a.Uploader.on("queueChanged",function(a){e(a)})}}}),define("mediaServices/services/fontsManager/fontsManager",["lodash","wixmp","util","mediaServices/services/fontsManager/fontsUploader"],function(e,a,i,t){"use strict";function n(){o(),t.registerToFileStatusChanged(d),t.registerToQueueChange(l),a.events.on(a.events.ITEMS.REMOVE,function(a){e.forEach(a,function(e){e.then(o).catch()})})}function o(){var a={mediaType:c.FONTS_MEDIA_TYPE};return a.paging={cursor:null,size:500},r.items.list(null,a).then(function(a){p=function(a){return a=e.reject(a,function(e){return!e.fileInput}),e.map(a,function(e){return i.fontsManagerUtils.getUploadedFontData(e)})}(a.data),s(c.FONT_EVENTS_NAMES.LIST_CHANGED,p)})}function s(a,i){e.forEach(M[a],function(e){e(i)})}function d(e){e.currentFileProgress.status===c.FONT_STATUS.SUCCEEDED&&o(),s(c.FONT_EVENTS_NAMES.FILE_CHANGED,e)}function l(e){s(c.FONT_EVENTS_NAMES.QUEUE_CHANGED,e)}var r=new a.Source(a.sources.PRIVATE,{asyncFontUpload:!0}),M={},p={},c=i.fontsManagerUtils.constants;return{registerObserver:function(e,a){M[e]?M[e].push(a):M[e]=[a]},unregisterObserver:function(a,i){M[a]=e.reject(M[a],function(e){return e===i})},getList:function(){return p},remove:function(e){r.items.remove(e)},init:n,uploader:{upload:function(e){t.upload(r,e)},clearUploadQueue:t.clearUploadQueue,getUploadQueue:t.getUploadQueue,cancelUpload:t.cancelUpload,retryUpload:t.retryUpload}}}),define("mediaServices",["lodash","mediaServices/services/wixMediaManager/adapter","mediaServices/services/fontsManager/fontsManager"],function(e,a,i){"use strict";function t(){this.mediaData={siteMediaToken:"",isEmailWithWixDomain:!1},this.fontsManager=i,this.mediaManager={manage:a.manage.bind(null,this.mediaData),open:a.open.bind(null,this.mediaData),presets:a.presets,categories:a.categories}}return t.prototype=e.create(Object.prototype,{constructor:t,setSiteMediaToken:function(e){this.mediaData.siteMediaToken=e||""},setIsEmailWithWixDomain:function(e){this.mediaData.isEmailWithWixDomain=e},getSiteMediaToken:function(){return this.mediaData.siteMediaToken}}),t});
//# sourceMappingURL=mediaServices.min.js.map