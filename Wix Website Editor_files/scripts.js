function find(element,selector){return angular.element(element[0].querySelector(selector))}function UUID(){}!function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("fedops-logger",[],factory):"object"==typeof exports?exports["fedops-logger"]=factory():root["fedops-logger"]=factory()}("undefined"!=typeof self?self:this,function(){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};if(__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__.p="undefined"!=typeof window&&window.__STATICS_BASE_URL__||__webpack_require__.p,"undefined"!=typeof document){var style=document.getElementById("fedops-logger.stylable.bundle.css");style||(style=document.createElement("style"),style.id="fedops-logger.stylable.bundle.css",document.head.appendChild(style)),style.textContent=""}return __webpack_require__(__webpack_require__.s=28)}([function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _dataItem=__webpack_require__(2),_dataItem2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_dataItem),BiBaseDataItem=function(_DataItem){function BiBaseDataItem(evid,sessionId){return _classCallCheck(this,BiBaseDataItem),_possibleConstructorReturn(this,(BiBaseDataItem.__proto__||Object.getPrototypeOf(BiBaseDataItem)).call(this,{src:72,evid:evid,session_id:sessionId,_:(new Date).getTime()}))}return _inherits(BiBaseDataItem,_DataItem),BiBaseDataItem}(_dataItem2.default);exports.default=BiBaseDataItem},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _location=__webpack_require__(8),_location2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_location);exports.default={getNavigation:function(){return window&&window.performance?window.performance.navigation:{}},getResources:function(){var emptyVal=[];try{return window&&window.performance&&window.performance.getEntriesByType&&window.performance.getEntriesByType("resource")||emptyVal}catch(e){return emptyVal}},getTiming:function(){return window&&window.performance?window.performance.timing:{}},now:function(){return window&&window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},mark:function(name){_location2.default.isFedopsDev()&&window&&window.performance&&window.performance.mark&&window.performance.mark(name)},measure:function(name,startMark,endMark){_location2.default.isFedopsDev()&&window&&window.performance&&window.performance.measure&&window.performance.measure(name,startMark,endMark)}}},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),DataItem=function(){function DataItem(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;_classCallCheck(this,DataItem),this.data=data}return _createClass(DataItem,[{key:"isActive",value:function(){return!0}},{key:"export",value:function(){return this.data}}]),DataItem}();exports.default=DataItem},function(module,exports,__webpack_require__){"use strict";function mapToQuery(data){var res=[];for(var key in data)data.hasOwnProperty(key)&&res.push(key+"="+encodeURIComponent(data[key]));return res.join("&")}function generateGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=16*Math.random()|0;return("x"===c?r:3&r|8).toString(16)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={mapToQuery:mapToQuery,generateGuid:generateGuid}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_dataSource=__webpack_require__(16),_dataSource2=_interopRequireDefault(_dataSource),_biLoadPhaseItem=__webpack_require__(17),_biLoadPhaseItem2=_interopRequireDefault(_biLoadPhaseItem),_durationItem=__webpack_require__(5),_durationItem2=_interopRequireDefault(_durationItem),_biErrorItem=__webpack_require__(9),_biErrorItem2=_interopRequireDefault(_biErrorItem),_performance=__webpack_require__(1),_performance2=_interopRequireDefault(_performance),_resourceItem=__webpack_require__(18),_resourceItem2=_interopRequireDefault(_resourceItem),BaseLogger=function(){function BaseLogger(appName,appVersion,reporter,_ref){var sessionId=_ref.sessionId,errorHandlerToggle=_ref.errorHandlerToggle,disableAutoLoadFinish=_ref.disableAutoLoadFinish;_classCallCheck(this,BaseLogger),this.appName=appName,this.appVersion=appVersion,this.reporter=reporter,this.params={sessionId:sessionId},this.errorHandlerToggle=errorHandlerToggle,this.disableAutoLoadFinish=disableAutoLoadFinish,this.dataSource=new _dataSource2.default({appName:appName}),errorHandlerToggle&&window.fedopsLoggerErrorHandler.subscribeListener(appName,this.reportError.bind(this))}return _createClass(BaseLogger,[{key:"reportNetworkAnalysis",value:function(){var _this=this,resources=_performance2.default.getResources();setTimeout(function(){try{var resourceDataItem=new _resourceItem2.default(_this.sessionId),analysis=resourceDataItem.performNetworkAnalysis(resources);if(!analysis)return;var dataSource=_this.dataSource.clone().addItem(resourceDataItem).addItem(analysis);_this._report(dataSource)}catch(e){console.error("[fedops] Failed to report resource metrics",e)}},1e3)}},{key:"reportError",value:function(error,errorType,errorInfo){var interactionName=void 0;interactionName=this._appLoadedCalled?Object.keys(this._outgoingInteractions)[0]:"[APP LOAD]";var dataSource=this.dataSource.clone().addItem({interactionName:interactionName}).addItem({errorType:errorType}).addItem({errorInfo:errorInfo}).addItem(new _biErrorItem2.default(this.sessionId));interactionName&&this._report(dataSource)}},{key:"_report",value:function(dataSource){return this.reporter.report(dataSource.mergeItems())}},{key:"getAppName",value:function(){return this.appName}},{key:"getAppVersion",value:function(){return this.appVersion}},{key:"getReporter",value:function(){return this.reporter}},{key:"getParam",value:function(paramName){return this.params[paramName]}},{key:"_isDisableAutoLoadFinish",value:function(){return this.disableAutoLoadFinish}},{key:"appLoadingPhase",value:function(phaseName){var dataSource=this.dataSource.clone().addItem({name:phaseName}).addItem(new _biLoadPhaseItem2.default(this.sessionId)).addItem(new _durationItem2.default);return this._report(dataSource)}},{key:"sessionId",get:function(){return this.getParam("sessionId")}}]),BaseLogger}();exports.default=BaseLogger},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_time=__webpack_require__(6),_time2=_interopRequireDefault(_time),_dataItem=__webpack_require__(2),_dataItem2=_interopRequireDefault(_dataItem),DurationDataItem=function(_DataItem){function DurationDataItem(appName){_classCallCheck(this,DurationDataItem);var _this=_possibleConstructorReturn(this,(DurationDataItem.__proto__||Object.getPrototypeOf(DurationDataItem)).call(this,{duration:Math.floor(_time2.default.appLoadTime(appName))}));return _this.appName=appName,_this}return _inherits(DurationDataItem,_DataItem),_createClass(DurationDataItem,[{key:"setFirstRequestDuration",value:function(){return this.data.frd=Math.floor(_time2.default.firstRequestDuration(this.appName)),this}}]),DurationDataItem}(_dataItem2.default);exports.default=DurationDataItem},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function startLoadTime(appName){return _appData2.default.getStartLoadTime(appName)||0}function endLoadTime(){return _performance2.default.now()}Object.defineProperty(exports,"__esModule",{value:!0});var _appData=__webpack_require__(7),_appData2=_interopRequireDefault(_appData),_performance=__webpack_require__(1),_performance2=_interopRequireDefault(_performance);exports.default={appLoadTime:function(appName){return endLoadTime()-startLoadTime(appName)},loadStarted:function(appName){_appData2.default.setStartLoadTime(appName,_performance2.default.now())},firstRequestDuration:function(appName){return startLoadTime(appName)}}},function(module,exports,__webpack_require__){"use strict";function getAppData(appName){return window.fedops.apps[appName]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={init:function(appName){window.fedops.apps[appName]=window.fedops.apps[appName]||{}},getStartLoadTime:function(appName){var appData=getAppData(appName);return appData?appData.startLoadTime:null},setStartLoadTime:function(appName,startLoadTime){return getAppData(appName).startLoadTime=startLoadTime}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var location=function(){return"undefined"!=typeof window&&window.location};exports.default={getHost:function(){return location()&&window.location.host},isFedopsDev:function(){return((location()||{}).search||"").indexOf("fedops=dev")>-1}}},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.EVID=void 0;var _biBaseItem=__webpack_require__(0),_biBaseItem2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_biBaseItem),EVID=exports.EVID=17,BiErrorItem=function(_BiBaseDataItem){function BiErrorItem(sessionId){return _classCallCheck(this,BiErrorItem),_possibleConstructorReturn(this,(BiErrorItem.__proto__||Object.getPrototypeOf(BiErrorItem)).call(this,EVID,sessionId))}return _inherits(BiErrorItem,_BiBaseDataItem),BiErrorItem}(_biBaseItem2.default);exports.default=BiErrorItem},function(module,exports,__webpack_require__){"use strict";function create(appName){var _ref=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_ref$baseUrl=_ref.baseUrl,baseUrl=void 0===_ref$baseUrl?null:_ref$baseUrl,_ref$appId=_ref.appId,appId=void 0===_ref$appId?null:_ref$appId,_ref$isWidgetLogger=_ref.isWidgetLogger,isWidgetLogger=void 0!==_ref$isWidgetLogger&&_ref$isWidgetLogger,_ref$errorHandlerTogg=_ref.errorHandlerToggle,errorHandlerToggle=void 0!==_ref$errorHandlerTogg&&_ref$errorHandlerTogg,_ref$disableAutoLoadF=_ref.disableAutoLoadFinish,disableAutoLoadFinish=void 0!==_ref$disableAutoLoadF&&_ref$disableAutoLoadF,_ref$swallowException=_ref.swallowExceptions,swallowExceptions=void 0!==_ref$swallowException&&_ref$swallowException,_ref$interactionTimeo=_ref.interactionTimeout,interactionTimeout=void 0===_ref$interactionTimeo?null:_ref$interactionTimeo,_ref$timeoutHook=_ref.timeoutHook,timeoutHook=void 0===_ref$timeoutHook?null:_ref$timeoutHook,_ref$startHook=_ref.startHook,startHook=void 0===_ref$startHook?null:_ref$startHook,_ref$endHook=_ref.endHook,endHook=void 0===_ref$endHook?null:_ref$endHook,_ref$networkAnalysis=_ref.networkAnalysis,networkAnalysis=void 0!==_ref$networkAnalysis&&_ref$networkAnalysis,appVersion="undefined"!=typeof window?"1.0.0-SNAPSHOT":null;return(new _loggerBuilder2.default).setAppName(appName).setAppVersion(appVersion).setBaseUrl(baseUrl).setAppId(appId).setErrorHandlerToggle(errorHandlerToggle).setSwallowExceptions(swallowExceptions).setWidgetLogger(isWidgetLogger).setInteractionTimeout(interactionTimeout).setTimeoutHook(timeoutHook).setStartHook(startHook).setEndHook(endHook).setDisableAutoLoadFinish(disableAutoLoadFinish).setNetworkAnalysis(networkAnalysis).build()}Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=create;var _loggerBuilder=__webpack_require__(11),_loggerBuilder2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_loggerBuilder)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function getSessionId(){var res="undefined"!=typeof window&&window.fedops&&window.fedops.sessionId;return res=res||_storage2.default.getItem(_conf.SESSION_ID_STORAGE_KEY),res=res||_tools2.default.generateGuid(),_storage2.default.setItem(_conf.SESSION_ID_STORAGE_KEY,res),res}function setFactory(factory){ReporterFactory=factory}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();exports.setFactory=setFactory;var _tools=__webpack_require__(3),_tools2=_interopRequireDefault(_tools),_storage=__webpack_require__(12),_storage2=_interopRequireDefault(_storage),_reporter=__webpack_require__(13),_reporter2=_interopRequireDefault(_reporter),_loggerInstance=__webpack_require__(15),_loggerInstance2=_interopRequireDefault(_loggerInstance),_widgetLoggerInstance=__webpack_require__(22),_widgetLoggerInstance2=_interopRequireDefault(_widgetLoggerInstance),_errorHandler=__webpack_require__(24),_errorHandler2=_interopRequireDefault(_errorHandler),_conf=__webpack_require__(26),ReporterFactory=_reporter2.default,LoggerBuilder=function(){function LoggerBuilder(){_classCallCheck(this,LoggerBuilder)}return _createClass(LoggerBuilder,[{key:"setAppName",value:function(name){return this.appName=name,this}},{key:"setAppVersion",value:function(version){return this.appVersion=version,this}},{key:"setErrorHandlerToggle",value:function(toggle){return this.errorHandlerToggle=toggle,this}},{key:"setSwallowExceptions",value:function(swallow){return this.swallowExceptions=swallow,this}},{key:"setAppId",value:function(appId){return this.appId=appId,this}},{key:"setBaseUrl",value:function(url){return this.baseUrl=url,this}},{key:"setWidgetLogger",value:function(isWidgetLogger){return this.isWidgetLogger=isWidgetLogger,this}},{key:"setInteractionTimeout",value:function(interactionTimeout){return this.interactionTimeout=interactionTimeout,this}},{key:"setTimeoutHook",value:function(timeoutHook){return this.timeoutHook=timeoutHook,this}},{key:"setStartHook",value:function(startHook){return this.startHook=startHook,this}},{key:"setEndHook",value:function(endHook){return this.endHook=endHook,this}},{key:"setDisableAutoLoadFinish",value:function(disableAutoLoadFinish){return this.disableAutoLoadFinish=disableAutoLoadFinish,this}},{key:"setNetworkAnalysis",value:function(){return this}},{key:"build",value:function(){if(!this.appName)return null;this.appVersion||(this.appVersion=_conf.DEFAULT_APP_VERSION);var reporter=new ReporterFactory(this.baseUrl||_conf.BI_BASE_URL),errorHandlerToggle=this.errorHandlerToggle,swallowExceptions=this.swallowExceptions,interactionTimeout=this.interactionTimeout,timeoutHook=this.timeoutHook,startHook=this.startHook,endHook=this.endHook,disableAutoLoadFinish=this.disableAutoLoadFinish;errorHandlerToggle&&(window.fedopsLoggerErrorHandler=window.fedopsLoggerErrorHandler||new _errorHandler2.default({swallowExceptions:swallowExceptions}));return this.isWidgetLogger?new _widgetLoggerInstance2.default(this.appName,this.appVersion,reporter,{sessionId:getSessionId(),errorHandlerToggle:errorHandlerToggle,swallowExceptions:swallowExceptions,disableAutoLoadFinish:disableAutoLoadFinish}):new _loggerInstance2.default(this.appName,this.appVersion,reporter,{sessionId:getSessionId(),errorHandlerToggle:errorHandlerToggle,swallowExceptions:swallowExceptions,disableAutoLoadFinish:disableAutoLoadFinish,interactionTimeout:interactionTimeout,timeoutHook:timeoutHook,startHook:startHook,endHook:endHook})}}]),LoggerBuilder}();exports.default=LoggerBuilder},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={getItem:function(key){try{return window.localStorage.getItem(key)}catch(e){}},setItem:function(key,value){try{return window.localStorage.setItem(key,value)}catch(e){}}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_pixel=__webpack_require__(14),_pixel2=_interopRequireDefault(_pixel),_tools=__webpack_require__(3),_tools2=_interopRequireDefault(_tools),Reporter=function(){function Reporter(baseUrl){_classCallCheck(this,Reporter),this.baseUrl=baseUrl}return _createClass(Reporter,[{key:"getBaseUrl",value:function(){return this.baseUrl}},{key:"report",value:function(data){return data?_pixel2.default.fetch(this.baseUrl+"?"+_tools2.default.mapToQuery(data)):null}}]),Reporter}();exports.default=Reporter},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={fetch:function(url){return(new window.Image).src=url}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_baseLogger=__webpack_require__(4),_baseLogger2=_interopRequireDefault(_baseLogger),_biLoadFinishItem=__webpack_require__(19),_biLoadFinishItem2=_interopRequireDefault(_biLoadFinishItem),_durationItem=__webpack_require__(5),_durationItem2=_interopRequireDefault(_durationItem),_biInteractionStartItem=__webpack_require__(20),_biInteractionStartItem2=_interopRequireDefault(_biInteractionStartItem),_biInteractionEndItem=__webpack_require__(21),_biInteractionEndItem2=_interopRequireDefault(_biInteractionEndItem),_biErrorItem=__webpack_require__(9),_biErrorItem2=_interopRequireDefault(_biErrorItem),_performance=__webpack_require__(1),_performance2=_interopRequireDefault(_performance),callHook=function(hook,hookArgs){if(hook)return hook(hookArgs)},LoggerInstance=function(_BaseLogger){function LoggerInstance(appName,appVersion,reporter,_ref){var sessionId=_ref.sessionId,errorHandlerToggle=_ref.errorHandlerToggle,disableAutoLoadFinish=_ref.disableAutoLoadFinish,interactionTimeout=_ref.interactionTimeout,timeoutHook=_ref.timeoutHook,startHook=_ref.startHook,endHook=_ref.endHook;_classCallCheck(this,LoggerInstance);var _this=_possibleConstructorReturn(this,(LoggerInstance.__proto__||Object.getPrototypeOf(LoggerInstance)).call(this,appName,appVersion,reporter,{sessionId:sessionId,errorHandlerToggle:errorHandlerToggle,disableAutoLoadFinish:disableAutoLoadFinish}));return _this._outgoingInteractions={},_this.interactionTimeout=interactionTimeout,_this.timeoutHook=timeoutHook,_this.startHook=startHook,_this.endHook=endHook,_this}return _inherits(LoggerInstance,_BaseLogger),_createClass(LoggerInstance,[{key:"appLoaded",value:function(){if(!this._appLoadedCalled){window&&window.fedops&&"function"==typeof window.fedops.clearLoadTimeout&&window.fedops.clearLoadTimeout();var dataSource=this.dataSource.clone().addItem(new _biLoadFinishItem2.default(this.sessionId)).addItem(new _durationItem2.default(this.appName).setFirstRequestDuration());return this._appLoadedCalled=!0,_performance2.default.mark("[fedops] app-loaded"),_performance2.default.measure("[fedops] app-loaded","navigationStart","[fedops] app-loaded"),this.reportNetworkAnalysis(),this._report(dataSource)}}},{key:"interactionStarted",value:function(interactionName){var _this2=this,_ref2=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},interactionTimeout=_ref2.interactionTimeout,startHook=_ref2.startHook,timeoutHook=_ref2.timeoutHook;_performance2.default.mark(interactionName+" started");var dataSource=this.dataSource.clone().addItem({name:interactionName}).addItem(new _biInteractionStartItem2.default(this.sessionId));return this._outgoingInteractions[interactionName]={timestamp:_performance2.default.now(),timeout:interactionTimeout||this.interactionTimeout},this._report(dataSource),callHook(startHook||this.startHook,{name:interactionName}),{timeoutId:function(){if(interactionTimeout||_this2.interactionTimeout)return setTimeout(function(){var dataSource=_this2.dataSource.clone().addItem({interactionName:interactionName}).addItem({errorType:"timeout"}).addItem(new _biErrorItem2.default(_this2.sessionId));_this2._report(dataSource),callHook(timeoutHook||_this2.timeoutHook,{name:interactionName,timeout:interactionTimeout||_this2.interactionTimeout})},interactionTimeout||_this2.interactionTimeout)}()}}},{key:"interactionEnded",value:function(interactionName){var _ref3=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},timeoutId=_ref3.timeoutId,endHook=_ref3.endHook;_performance2.default.mark(interactionName+" ended"),_performance2.default.measure(interactionName+" duration",interactionName+" started",interactionName+" ended"),timeoutId&&clearTimeout(timeoutId);var duration=this._outgoingInteractions[interactionName]?Math.floor(_performance2.default.now()-this._outgoingInteractions[interactionName].timestamp):"";callHook(endHook||this.endHook,{name:interactionName,duration:duration,timeout:this._outgoingInteractions[interactionName]&&this._outgoingInteractions[interactionName].timeout});var dataSource=this.dataSource.clone().addItem({name:interactionName}).addItem({duration:duration}).addItem(new _biInteractionEndItem2.default(this.sessionId));delete this._outgoingInteractions[interactionName],this._report(dataSource)}},{key:"isDisableAutoLoadFinish",value:function(){return this._isDisableAutoLoadFinish()}}]),LoggerInstance}(_baseLogger2.default);exports.default=LoggerInstance},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_dataItem=__webpack_require__(2),_dataItem2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_dataItem),DataSource=function(){function DataSource(){var _this=this,item=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;_classCallCheck(this,DataSource),this.items=[],item&&(void 0===item.length?[item]:item).forEach(function(item){return _this.addItem(item)})}return _createClass(DataSource,[{key:"clone",value:function(){return new DataSource(this.items.slice())}},{key:"addItem",value:function(item){return this.items.push(item instanceof _dataItem2.default?item:new _dataItem2.default(item)),this}},{key:"mergeItems",value:function(){for(var res={},i=0;i<this.items.length;i++){var item=this.items[i];if(!item.isActive()){res=null;break}var data=item.export();for(var key in data)data.hasOwnProperty(key)&&(res[key]=data[key])}return res}}]),DataSource}();exports.default=DataSource},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _biBaseItem=__webpack_require__(0),_biBaseItem2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_biBaseItem),BiLoadPhaseDataItem=function(_BiBaseDataItem){function BiLoadPhaseDataItem(sessionId){return _classCallCheck(this,BiLoadPhaseDataItem),_possibleConstructorReturn(this,(BiLoadPhaseDataItem.__proto__||Object.getPrototypeOf(BiLoadPhaseDataItem)).call(this,13,sessionId))}return _inherits(BiLoadPhaseDataItem,_BiBaseDataItem),BiLoadPhaseDataItem}(_biBaseItem2.default);exports.default=BiLoadPhaseDataItem},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){
if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function filterResourcesByType(resources,type){var validator=CUSTOM_VALIDATORS[type];return resources.filter(function(r){return type===r.initiatorType&&(!validator||validator(r))})}function calculateTotalSizeOfResource(resources){return resources.reduce(function(totalSize,resource){return totalSize+resource.transferSize},0)}function calculateResourceLoadLongestDuration(resources){if(0===resources.length)return 0;var longest=resources.reduce(function(acc,cur){return durationOf(cur)>=durationOf(acc)?cur:acc});return durationOf(longest)}function calculateResourceLoadDuration(resources){if(0===resources.length)return 0;var loadStartStop={startTime:1/0,responseEnd:0};return resources.forEach(function(r){loadStartStop.startTime>r.startTime&&(loadStartStop.startTime=r.startTime),loadStartStop.responseEnd<r.responseEnd&&(loadStartStop.responseEnd=r.responseEnd)}),loadStartStop.responseEnd-loadStartStop.startTime}function calculatePercentageOfUnsupportedResources(resources){var totalCount=resources.length;if(0===totalCount)return 0;var unsupportedCount=resources.filter(isResourceUnsupported).length;return Math.round(unsupportedCount/totalCount*100)}function calculateCachedResourcesPercentage(resources){if(0===resources.length)return 0;var cached=resources.filter(function(r){return 0===r.transferSize});return Math.round(cached.length/resources.length*100)}function calculatePercentageOfHttp2(resources){if(0===resources.length)return 0;var supported=!1,res=Math.round(resources.filter(function(r){return supported=supported||"nextHopProtocol"in r,"h2"===r.nextHopProtocol}).length/resources.length*100);return supported?res:NaN}function isResourceRelevant(resource){return!resource.name.match(/http(s)?:\/\/frog.wix.com\//)}function isResourceUnsupported(resource){return isCORS(resource.name)&&0===resource.transferSize&&0===resource.requestStart}function isCORS(resourceName){var host=_location2.default.getHost();return host&&-1===resourceName.indexOf(host)}function normalizeValues(analysis){return Object.keys(analysis).reduce(function(result,key){var n=parseInt(analysis[key]);return isNaN(n)||"number"!=typeof n||(result[key]=n),result},{})}function countAllResourcesByType(resources){var supportedResources=resources.filter(function(r){return!isResourceUnsupported(r)});return Object.keys(RESOURCES_TYPES).reduce(function(result,currentType){var allSameTypeResources=filterResourcesByType(resources,currentType),supportedSameTypeResources=filterResourcesByType(supportedResources,currentType),type=RESOURCES_TYPES[currentType];return result[type.count]=supportedSameTypeResources.length,result[type.duration]=calculateResourceLoadDuration(supportedSameTypeResources),result[type.total]=calculateTotalSizeOfResource(supportedSameTypeResources),result[type.unsupported]=calculatePercentageOfUnsupportedResources(allSameTypeResources),result[type.http2]=calculatePercentageOfHttp2(allSameTypeResources),type.longest&&(result[type.longest]=calculateResourceLoadLongestDuration(supportedSameTypeResources)),type.cached&&(result[type.cached]=calculateCachedResourcesPercentage(supportedSameTypeResources)),result},{})}function extractResourceMetrics(resource){return{url:resource.name,downloadDuration:resource.responseEnd-resource.startTime,bytesTransferred:resource.transferSize,isHTTP2:"h2"===resource.nextHopProtocol}}function getResourcesBreakdown(resources){var resourcesPartition=resources.reduce(function(result,r){return isResourceUnsupported(r)?result.unsupported.push(r):result.supported.push(r),result},{supported:[],unsupported:[]});return Object.keys(RESOURCES_TYPES).reduce(function(result,currentType){return result[currentType]={},result[currentType].supported=filterResourcesByType(resourcesPartition.supported,currentType).map(function(r){return extractResourceMetrics(r)}),result[currentType].unsupported=filterResourcesByType(resourcesPartition.unsupported,currentType).map(function(r){return extractResourceMetrics(r)}),result},{})}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_biBaseItem=__webpack_require__(0),_biBaseItem2=_interopRequireDefault(_biBaseItem),_location=__webpack_require__(8),_location2=_interopRequireDefault(_location),_performance=__webpack_require__(1),_performance2=_interopRequireDefault(_performance),RESOURCES_TYPES={xmlhttprequest:{count:"countXhr",unsupported:"unsprtXhr",duration:"timeXhr",total:"sizeXhr",longest:"longXhr",http2:"h2Xhr"},script:{count:"countJs",unsupported:"unsprtJs",duration:"timeJs",total:"sizeJs",cached:"cachedJs",http2:"h2Js"},link:{count:"countCss",unsupported:"unsprtCss",duration:"timeCss",total:"sizeCss",cached:"cachedCss",http2:"h2Css"},img:{count:"countImg",unsupported:"unsprtImg",duration:"timeImg",total:"sizeImg",cached:"cachedImages",http2:"h2Images"}},CUSTOM_VALIDATORS={link:function(resource){return/(.\.css$|.\.css?.)/g.test(resource.name)}},durationOf=function(item){return item.responseEnd-item.startTime},ResourceDataItem=function(_BiBaseDataItem){function ResourceDataItem(sessionId){return _classCallCheck(this,ResourceDataItem),_possibleConstructorReturn(this,(ResourceDataItem.__proto__||Object.getPrototypeOf(ResourceDataItem)).call(this,18,sessionId))}return _inherits(ResourceDataItem,_BiBaseDataItem),_createClass(ResourceDataItem,[{key:"performNetworkAnalysis",value:function(resources){if(0===resources.length)return null;var t0=_performance2.default.now(),resourcesToHandle=resources.filter(isResourceRelevant),analysis=countAllResourcesByType(resourcesToHandle);analysis.overhead=_performance2.default.now()-t0;var result=normalizeValues(analysis);if(console.debug&&_location2.default.isFedopsDev()){var resourcesBreakdown=getResourcesBreakdown(resourcesToHandle);console.debug("[fedops network analysis] [bytes analysis]\n"+JSON.stringify(result,null,4)),console.debug("[fedops network analysis] [resources breakdown]\n",resourcesBreakdown)}return result}}]),ResourceDataItem}(_biBaseItem2.default);exports.default=ResourceDataItem},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _biBaseItem=__webpack_require__(0),_biBaseItem2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_biBaseItem),BiLoadFinishDataItem=function(_BiBaseDataItem){function BiLoadFinishDataItem(sessionId){return _classCallCheck(this,BiLoadFinishDataItem),_possibleConstructorReturn(this,(BiLoadFinishDataItem.__proto__||Object.getPrototypeOf(BiLoadFinishDataItem)).call(this,11,sessionId))}return _inherits(BiLoadFinishDataItem,_BiBaseDataItem),BiLoadFinishDataItem}(_biBaseItem2.default);exports.default=BiLoadFinishDataItem},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.INTERACTION_START_EVID=void 0;var _biBaseItem=__webpack_require__(0),_biBaseItem2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_biBaseItem),INTERACTION_START_EVID=exports.INTERACTION_START_EVID=15,BiInteractionStartDataItem=function(_BiBaseDataItem){function BiInteractionStartDataItem(sessionId){return _classCallCheck(this,BiInteractionStartDataItem),_possibleConstructorReturn(this,(BiInteractionStartDataItem.__proto__||Object.getPrototypeOf(BiInteractionStartDataItem)).call(this,INTERACTION_START_EVID,sessionId))}return _inherits(BiInteractionStartDataItem,_BiBaseDataItem),BiInteractionStartDataItem}(_biBaseItem2.default);exports.default=BiInteractionStartDataItem},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.INTERACTION_END_EVID=void 0;var _biBaseItem=__webpack_require__(0),_biBaseItem2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_biBaseItem),INTERACTION_END_EVID=exports.INTERACTION_END_EVID=16,BiInteractionEndDataItem=function(_BiBaseDataItem){function BiInteractionEndDataItem(sessionId){return _classCallCheck(this,BiInteractionEndDataItem),_possibleConstructorReturn(this,(BiInteractionEndDataItem.__proto__||Object.getPrototypeOf(BiInteractionEndDataItem)).call(this,INTERACTION_END_EVID,sessionId))}return _inherits(BiInteractionEndDataItem,_BiBaseDataItem),BiInteractionEndDataItem}(_biBaseItem2.default);exports.default=BiInteractionEndDataItem},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_baseLogger=__webpack_require__(4),_baseLogger2=_interopRequireDefault(_baseLogger),_biLoadStartItem=__webpack_require__(23),_biLoadStartItem2=_interopRequireDefault(_biLoadStartItem),_time=__webpack_require__(6),_time2=_interopRequireDefault(_time),_appData=__webpack_require__(7),_appData2=_interopRequireDefault(_appData),WidgetLoggerInstance=function(_BaseLogger){function WidgetLoggerInstance(appName,appVersion,reporter,_ref){var sessionId=_ref.sessionId,disableAutoLoadFinish=_ref.disableAutoLoadFinish;_classCallCheck(this,WidgetLoggerInstance);var _this=_possibleConstructorReturn(this,(WidgetLoggerInstance.__proto__||Object.getPrototypeOf(WidgetLoggerInstance)).call(this,appName,appVersion,reporter,{sessionId:sessionId,disableAutoLoadFinish:disableAutoLoadFinish}));return _appData2.default.init(_this.appName),_this}return _inherits(WidgetLoggerInstance,_BaseLogger),_createClass(WidgetLoggerInstance,[{key:"appLoadStarted",value:function(){_time2.default.loadStarted(this.appName);var dataSource=this.dataSource.clone().addItem(new _biLoadStartItem2.default(this.sessionId));return this._report(dataSource)}},{key:"isDisableAutoLoadFinish",value:function(){return this._isDisableAutoLoadFinish()}}]),WidgetLoggerInstance}(_baseLogger2.default);exports.default=WidgetLoggerInstance},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _biBaseItem=__webpack_require__(0),_biBaseItem2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_biBaseItem),BiLoadStartDataItem=function(_BiBaseDataItem){function BiLoadStartDataItem(sessionId){return _classCallCheck(this,BiLoadStartDataItem),_possibleConstructorReturn(this,(BiLoadStartDataItem.__proto__||Object.getPrototypeOf(BiLoadStartDataItem)).call(this,14,sessionId))}return _inherits(BiLoadStartDataItem,_BiBaseDataItem),BiLoadStartDataItem}(_biBaseItem2.default);exports.default=BiLoadStartDataItem},function(module,exports,__webpack_require__){"use strict";(function(global){function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_window="undefined"!=typeof window?window:void 0!==global?global:"undefined"!=typeof self?self:{},ErrorHandler=function(){function ErrorHandler(_ref){var swallowExceptions=_ref.swallowExceptions;_classCallCheck(this,ErrorHandler),this.swallowExceptions=swallowExceptions,this.listeners={},this.instrumentAjax(),this.instrumentSetTimeout(),this.instrumentSetInterval(),this.instrumentAddEventListener(),this.instrumentFetch(),this.instrumentPromise(),this.instrumentGloballyUnhandledError()}return _createClass(ErrorHandler,[{key:"subscribeListener",value:function(appName,cb){this.listeners[appName]=cb}},{key:"removeListener",value:function(appName){delete this.listeners[appName]}},{key:"instrumentAjax",value:function(){var self=this;if("XMLHttpRequest"in _window){var xhrproto=XMLHttpRequest.prototype;this._wrap(xhrproto,"open",function(orig){return function(method,url){return this.__fedops_xhr={method:method,url:url,status_code:null},orig.apply(this,arguments)}},"xhr"),this._wrap(xhrproto,"send",function(orig){return function(){function saveStatusCode(){if(1===xhr.readyState||4===xhr.readyState){try{xhr.__fedops_xhr.status_code=xhr.status}catch(e){}self._isErrorStatusCode(xhr.__fedops_xhr.status_code)&&self._reportError(xhr.__fedops_xhr,"xhr",xhr.__fedops_xhr.status_code)}}var xhr=this;return self._wrap(this,"onload",function(orig){return function(){orig&&orig.apply(this,arguments)}},"xhr"),self._wrap(this,"onerror",function(orig){return function(){orig&&orig.apply(this,arguments)}},"xhr"),self._wrap(this,"onprogress",function(orig){return function(){orig&&orig.apply(this,arguments)}},"xhr"),"onreadystatechange"in xhr&&"function"==typeof xhr.onreadystatechange?self._wrap(xhr,"onreadystatechange",function(orig){return function(){return saveStatusCode(),orig.apply(this,arguments)}}):xhr.onreadystatechange=saveStatusCode,orig.apply(this,arguments)}},"xhr")}}},{key:"instrumentSetTimeout",value:function(){var self=this;this._wrap(_window,"setTimeout",function(globalSetTimeout){return function(fn){for(var _len=arguments.length,rest=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)rest[_key-1]=arguments[_key];return globalSetTimeout.call.apply(globalSetTimeout,[this,self._wrapCallback(fn,"setTimeout")].concat(rest))}})}},{key:"instrumentSetInterval",value:function(){var self=this;this._wrap(_window,"setInterval",function(globalSetInterval){return function(fn){for(var _len2=arguments.length,rest=Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)rest[_key2-1]=arguments[_key2];return globalSetInterval.call.apply(globalSetInterval,[this,self._wrapCallback(fn,"setInterval")].concat(rest))}})}},{key:"instrumentAddEventListener",value:function(){function instrumentEventTarget(name){var origTarget=_window[name]&&_window[name].prototype;origTarget&&Object.prototype.hasOwnProperty.call(origTarget,"addEventListener")&&(self._wrap(origTarget,"addEventListener",function(orig){return function(eventName,fn,capture,secure){var wrapped=self._wrapCallback(fn,"addEventListener");return fn&&(fn.__fedopsWrapper__=wrapped),orig.call(this,eventName,wrapped,capture,secure)}}),self._wrap(origTarget,"removeEventListener",function(orig){return function(eventName,fn,capture,secure){return fn=fn&&(fn.__fedopsWrapper__||fn),orig.call(this,eventName,fn,capture,secure)}}))}var self=this;["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"].forEach(function(name){return instrumentEventTarget(name)})}},{key:"instrumentRequestAnimationFrame",value:function(){}},{key:"instrumentFetch",value:function(){var self=this;this._wrap(_window,"fetch",function(globalFetch){return function(url,fetchOptions){return globalFetch.apply(this,arguments).then(function(response){var statusCode=response.status;if(self._isErrorStatusCode(statusCode)){var requestInfo={url:url,method:fetchOptions?fetchOptions.method:"GET",status_code:statusCode};self._reportError(requestInfo,"fetch",statusCode)}return response})}})}},{key:"instrumentPromise",value:function(){var self=this;_window.addEventListener("unhandledrejection",function(err){self._reportError(err,"promise")})}},{key:"instrumentGloballyUnhandledError",value:function(){var _this=this;_window.addEventListener("error",function(err){_this._reportError(err,"windowOnError")})}},{key:"instrumentHistory",value:function(){}},{key:"_wrap",value:function(obj,fnName,replaced,errorType){var self=this,orig=obj[fnName],r=replaced(orig),wrapped=function(){try{return r.apply(this,arguments)}catch(err){if(self._reportError(err,errorType),!self.swallowExceptions)throw err}};obj[fnName]=wrapped}},{key:"_wrapCallback",value:function(fn,errorType){var self=this;return function(){try{return fn.apply(this,arguments)}catch(err){if(self._reportError(err,errorType),!self.swallowExceptions)throw err}}}},{key:"_reportError",value:function(err,errorType,errorInfo){var self=this,actualError=err&&(err.error||err);if(!actualError.__fedopsHandledError__){Object.keys(this.listeners).forEach(function(appName){self.listeners[appName](actualError,errorType,errorInfo)}),actualError.__fedopsHandledError__=!0}}},{key:"_isErrorStatusCode",value:function(statusCode){return statusCode>=400||0===statusCode}}]),ErrorHandler}();exports.default=ErrorHandler}).call(exports,__webpack_require__(25))},function(module,exports){var g;g=function(){return this}();try{g=g||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(g=window)}module.exports=g},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.BI_BASE_URL="https://frog.wix.com/fed",exports.SESSION_ID_STORAGE_KEY="fedops.logger.sessionId",exports.DEFAULT_APP_VERSION="0.0.0"},function(module,exports,__webpack_require__){"use strict";function initiateApp(){window.fedops=window.fedops||{},window.fedops.apps=window.fedops.apps||{}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.initiateApp=initiateApp},function(module,exports,__webpack_require__){"use strict";var _appInitializer=__webpack_require__(27),_loggerFactory=__webpack_require__(10);(0,_appInitializer.initiateApp)(),window.fedops.logger={create:_loggerFactory.create},window.fedops.widgetLogger={create:function(appName){var _ref=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_ref$baseUrl=_ref.baseUrl,baseUrl=void 0===_ref$baseUrl?null:_ref$baseUrl,_ref$appId=_ref.appId,appId=void 0===_ref$appId?null:_ref$appId;return(0,_loggerFactory.create)(appName,{baseUrl:baseUrl,appId:appId,isWidgetLogger:!0})}}}])}),function(root,factory){"undefined"!=typeof module&&module.exports?(factory("undefined"==typeof angular?require("angular"):angular),module.exports="ngDialog"):"function"==typeof define&&define.amd?define(["angular"],factory):factory(root.angular)}(this,function(angular){"use strict";var m=angular.module("ngDialog",[]),$el=angular.element,isDef=angular.isDefined,style=(document.body||document.documentElement).style,animationEndSupport=isDef(style.animation)||isDef(style.WebkitAnimation)||isDef(style.MozAnimation)||isDef(style.MsAnimation)||isDef(style.OAnimation),animationEndEvent="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",forceElementsReload={html:!1,body:!1},scopes={},openIdStack=[],keydownIsBound=!1,openOnePerName=!1;return m.provider("ngDialog",function(){var defaults=this.defaults={className:"ngdialog-theme-default",appendClassName:"",disableAnimation:!1,plain:!1,showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,overlay:!0,cache:!0,trapFocus:!0,preserveFocus:!0,ariaAuto:!0,ariaRole:null,ariaLabelledById:null,ariaLabelledBySelector:null,ariaDescribedById:null,ariaDescribedBySelector:null,bodyClassName:"ngdialog-open",width:null,height:null};this.setForceHtmlReload=function(_useIt){forceElementsReload.html=_useIt||!1},this.setForceBodyReload=function(_useIt){forceElementsReload.body=_useIt||!1},this.setDefaults=function(newDefaults){angular.extend(defaults,newDefaults)},this.setOpenOnePerName=function(isOpenOne){openOnePerName=isOpenOne||!1};var closeByDocumentHandler,globalID=0,dialogsCount=0,defers={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$injector",function($document,$templateCache,$compile,$q,$http,$rootScope,$timeout,$window,$controller,$injector){var $elements=[],privateMethods={onDocumentKeydown:function(event){27===event.keyCode&&publicMethods.close("$escape")},activate:function($dialog){$dialog.data("$ngDialogOptions").trapFocus&&($dialog.on("keydown",privateMethods.onTrapFocusKeydown),$elements.body.on("keydown",privateMethods.onTrapFocusKeydown))},deactivate:function($dialog){$dialog.off("keydown",privateMethods.onTrapFocusKeydown),$elements.body.off("keydown",privateMethods.onTrapFocusKeydown)},deactivateAll:function(els){angular.forEach(els,function(el){var $dialog=angular.element(el);privateMethods.deactivate($dialog)})},setBodyPadding:function(width){var originalBodyPadding=parseInt($elements.body.css("padding-right")||0,10);$elements.body.css("padding-right",originalBodyPadding+width+"px"),$elements.body.data("ng-dialog-original-padding",originalBodyPadding),$rootScope.$broadcast("ngDialog.setPadding",width)},resetBodyPadding:function(){var originalBodyPadding=$elements.body.data("ng-dialog-original-padding");originalBodyPadding?$elements.body.css("padding-right",originalBodyPadding+"px"):$elements.body.css("padding-right",""),$rootScope.$broadcast("ngDialog.setPadding",0)},performCloseDialog:function($dialog,value){var options=$dialog.data("$ngDialogOptions"),id=$dialog.attr("id"),scope=scopes[id];if(scope){if(void 0!==$window.Hammer){var hammerTime=scope.hammerTime;hammerTime.off("tap",closeByDocumentHandler),hammerTime.destroy&&hammerTime.destroy(),delete scope.hammerTime}else $dialog.unbind("click");1===dialogsCount&&$elements.body.unbind("keydown",privateMethods.onDocumentKeydown),$dialog.hasClass("ngdialog-closing")||(dialogsCount-=1);var previousFocus=$dialog.data("$ngDialogPreviousFocus");previousFocus&&previousFocus.focus&&previousFocus.focus(),$rootScope.$broadcast("ngDialog.closing",$dialog,value),dialogsCount=dialogsCount<0?0:dialogsCount,animationEndSupport&&!options.disableAnimation?(scope.$destroy(),$dialog.unbind(animationEndEvent).bind(animationEndEvent,function(){privateMethods.closeDialogElement($dialog,value)}).addClass("ngdialog-closing")):(scope.$destroy(),privateMethods.closeDialogElement($dialog,value)),defers[id]&&(defers[id].resolve({id:id,value:value,$dialog:$dialog,remainingDialogs:dialogsCount}),delete defers[id]),scopes[id]&&delete scopes[id],openIdStack.splice(openIdStack.indexOf(id),1),openIdStack.length||($elements.body.unbind("keydown",privateMethods.onDocumentKeydown),keydownIsBound=!1)}},closeDialogElement:function($dialog,value){var options=$dialog.data("$ngDialogOptions");$dialog.remove(),0===dialogsCount&&($elements.html.removeClass(options.bodyClassName),$elements.body.removeClass(options.bodyClassName),privateMethods.resetBodyPadding()),$rootScope.$broadcast("ngDialog.closed",$dialog,value)},closeDialog:function($dialog,value){var preCloseCallback=$dialog.data("$ngDialogPreCloseCallback");if(preCloseCallback&&angular.isFunction(preCloseCallback)){var preCloseCallbackResult=preCloseCallback.call($dialog,value);if(angular.isObject(preCloseCallbackResult))preCloseCallbackResult.closePromise?preCloseCallbackResult.closePromise.then(function(){privateMethods.performCloseDialog($dialog,value)},function(){return!1}):preCloseCallbackResult.then(function(){privateMethods.performCloseDialog($dialog,value)},function(){return!1});else{if(!1===preCloseCallbackResult)return!1;privateMethods.performCloseDialog($dialog,value)}}else privateMethods.performCloseDialog($dialog,value)},onTrapFocusKeydown:function(ev){var $dialog,el=angular.element(ev.currentTarget);if(el.hasClass("ngdialog"))$dialog=el;else if(null===($dialog=privateMethods.getActiveDialog()))return;var isTab=9===ev.keyCode,backward=!0===ev.shiftKey;isTab&&privateMethods.handleTab($dialog,ev,backward)},handleTab:function($dialog,ev,backward){var focusableElements=privateMethods.getFocusableElements($dialog);if(0===focusableElements.length)return void(document.activeElement&&document.activeElement.blur&&document.activeElement.blur());var currentFocus=document.activeElement,focusIndex=Array.prototype.indexOf.call(focusableElements,currentFocus),isFocusIndexUnknown=-1===focusIndex,isFirstElementFocused=0===focusIndex,isLastElementFocused=focusIndex===focusableElements.length-1,cancelEvent=!1;backward?(isFocusIndexUnknown||isFirstElementFocused)&&(focusableElements[focusableElements.length-1].focus(),cancelEvent=!0):(isFocusIndexUnknown||isLastElementFocused)&&(focusableElements[0].focus(),cancelEvent=!0),cancelEvent&&(ev.preventDefault(),ev.stopPropagation())},autoFocus:function($dialog){var dialogEl=$dialog[0],autoFocusEl=dialogEl.querySelector("*[autofocus]");if(null===autoFocusEl||(autoFocusEl.focus(),document.activeElement!==autoFocusEl)){var focusableElements=privateMethods.getFocusableElements($dialog);if(focusableElements.length>0)return void focusableElements[0].focus();var contentElements=privateMethods.filterVisibleElements(dialogEl.querySelectorAll("h1,h2,h3,h4,h5,h6,p,span"));if(contentElements.length>0){var contentElement=contentElements[0];$el(contentElement).attr("tabindex","-1").css("outline","0"),contentElement.focus()}}},getFocusableElements:function($dialog){var dialogEl=$dialog[0],rawElements=dialogEl.querySelectorAll("a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]"),tabbableElements=privateMethods.filterTabbableElements(rawElements);return privateMethods.filterVisibleElements(tabbableElements)},filterTabbableElements:function(els){for(var tabbableFocusableElements=[],i=0;i<els.length;i++){var el=els[i];"-1"!==$el(el).attr("tabindex")&&tabbableFocusableElements.push(el)}return tabbableFocusableElements},filterVisibleElements:function(els){for(var visibleFocusableElements=[],i=0;i<els.length;i++){var el=els[i];(el.offsetWidth>0||el.offsetHeight>0)&&visibleFocusableElements.push(el)}return visibleFocusableElements},getActiveDialog:function(){var dialogs=document.querySelectorAll(".ngdialog");return 0===dialogs.length?null:$el(dialogs[dialogs.length-1])},applyAriaAttributes:function($dialog,options){if(options.ariaAuto){if(!options.ariaRole){var detectedRole=privateMethods.getFocusableElements($dialog).length>0?"dialog":"alertdialog";options.ariaRole=detectedRole}options.ariaLabelledBySelector||(options.ariaLabelledBySelector="h1,h2,h3,h4,h5,h6"),options.ariaDescribedBySelector||(options.ariaDescribedBySelector="article,section,p")}
options.ariaRole&&$dialog.attr("role",options.ariaRole),privateMethods.applyAriaAttribute($dialog,"aria-labelledby",options.ariaLabelledById,options.ariaLabelledBySelector),privateMethods.applyAriaAttribute($dialog,"aria-describedby",options.ariaDescribedById,options.ariaDescribedBySelector)},applyAriaAttribute:function($dialog,attr,id,selector){if(id&&$dialog.attr(attr,id),selector){var dialogId=$dialog.attr("id"),firstMatch=$dialog[0].querySelector(selector);if(!firstMatch)return;var generatedId=dialogId+"-"+attr;return $el(firstMatch).attr("id",generatedId),$dialog.attr(attr,generatedId),generatedId}},detectUIRouter:function(){try{return angular.module("ui.router"),!0}catch(err){return!1}},getRouterLocationEventName:function(){return privateMethods.detectUIRouter()?"$stateChangeStart":"$locationChangeStart"}},publicMethods={__PRIVATE__:privateMethods,open:function(opts){function loadTemplateUrl(tmpl,config){var config=config||{};return config.headers=config.headers||{},angular.extend(config.headers,{Accept:"text/html"}),$rootScope.$broadcast("ngDialog.templateLoading",tmpl),$http.get(tmpl,config).then(function(res){return $rootScope.$broadcast("ngDialog.templateLoaded",tmpl),res.data||""})}var dialogID=null;if(opts=opts||{},!(openOnePerName&&opts.name&&(dialogID=opts.name.toLowerCase().replace(/\s/g,"-")+"-dialog",this.isOpen(dialogID)))){var options=angular.copy(defaults),localID=++globalID;dialogID=dialogID||"ngdialog"+localID,openIdStack.push(dialogID),void 0!==options.data&&(void 0===opts.data&&(opts.data={}),opts.data=angular.merge(angular.copy(options.data),opts.data)),angular.extend(options,opts);var defer;defers[dialogID]=defer=$q.defer();var scope;scopes[dialogID]=scope=angular.isObject(options.scope)?options.scope.$new():$rootScope.$new();var $dialog,$dialogParent,$dialogContent,resolve=angular.extend({},options.resolve);return angular.forEach(resolve,function(value,key){resolve[key]=angular.isString(value)?$injector.get(value):$injector.invoke(value,null,null,key)}),$q.all({template:function(tmpl){return tmpl?angular.isString(tmpl)&&options.plain?tmpl:"boolean"!=typeof options.cache||options.cache?loadTemplateUrl(tmpl,{cache:$templateCache}):loadTemplateUrl(tmpl,{cache:!1}):"Empty template"}(options.template||options.templateUrl),locals:$q.all(resolve)}).then(function(setup){var template=setup.template,locals=setup.locals;options.showClose&&(template+='<div class="ngdialog-close"></div>');var hasOverlayClass=options.overlay?"":" ngdialog-no-overlay";if($dialog=$el('<div id="'+dialogID+'" class="ngdialog'+hasOverlayClass+'"></div>'),$dialog.html(options.overlay?'<div class="ngdialog-overlay"></div><div class="ngdialog-content" role="document">'+template+"</div>":'<div class="ngdialog-content" role="document">'+template+"</div>"),$dialog.data("$ngDialogOptions",options),scope.ngDialogId=dialogID,options.data&&angular.isString(options.data)){var firstLetter=options.data.replace(/^\s*/,"")[0];scope.ngDialogData="{"===firstLetter||"["===firstLetter?angular.fromJson(options.data):new String(options.data),scope.ngDialogData.ngDialogId=dialogID}else options.data&&angular.isObject(options.data)&&(scope.ngDialogData=options.data,scope.ngDialogData.ngDialogId=dialogID);if(options.className&&$dialog.addClass(options.className),options.appendClassName&&$dialog.addClass(options.appendClassName),options.width&&($dialogContent=$dialog[0].querySelector(".ngdialog-content"),angular.isString(options.width)?$dialogContent.style.width=options.width:$dialogContent.style.width=options.width+"px"),options.height&&($dialogContent=$dialog[0].querySelector(".ngdialog-content"),angular.isString(options.height)?$dialogContent.style.height=options.height:$dialogContent.style.height=options.height+"px"),options.disableAnimation&&$dialog.addClass("ngdialog-disabled-animation"),$dialogParent=options.appendTo&&angular.isString(options.appendTo)?angular.element(document.querySelector(options.appendTo)):$elements.body,privateMethods.applyAriaAttributes($dialog,options),options.preCloseCallback){var preCloseCallback;angular.isFunction(options.preCloseCallback)?preCloseCallback=options.preCloseCallback:angular.isString(options.preCloseCallback)&&scope&&(angular.isFunction(scope[options.preCloseCallback])?preCloseCallback=scope[options.preCloseCallback]:scope.$parent&&angular.isFunction(scope.$parent[options.preCloseCallback])?preCloseCallback=scope.$parent[options.preCloseCallback]:$rootScope&&angular.isFunction($rootScope[options.preCloseCallback])&&(preCloseCallback=$rootScope[options.preCloseCallback])),preCloseCallback&&$dialog.data("$ngDialogPreCloseCallback",preCloseCallback)}if(scope.closeThisDialog=function(value){privateMethods.closeDialog($dialog,value)},options.controller&&(angular.isString(options.controller)||angular.isArray(options.controller)||angular.isFunction(options.controller))){var label;options.controllerAs&&angular.isString(options.controllerAs)&&(label=options.controllerAs);var controllerInstance=$controller(options.controller,angular.extend(locals,{$scope:scope,$element:$dialog}),!0,label);options.bindToController&&angular.extend(controllerInstance.instance,{ngDialogId:scope.ngDialogId,ngDialogData:scope.ngDialogData,closeThisDialog:scope.closeThisDialog,confirm:scope.confirm}),"function"==typeof controllerInstance?$dialog.data("$ngDialogControllerController",controllerInstance()):$dialog.data("$ngDialogControllerController",controllerInstance)}if($timeout(function(){var $activeDialogs=document.querySelectorAll(".ngdialog");privateMethods.deactivateAll($activeDialogs),$compile($dialog)(scope);var widthDiffs=$window.innerWidth-$elements.body.prop("clientWidth");$elements.html.addClass(options.bodyClassName),$elements.body.addClass(options.bodyClassName);var scrollBarWidth=widthDiffs-($window.innerWidth-$elements.body.prop("clientWidth"));scrollBarWidth>0&&privateMethods.setBodyPadding(scrollBarWidth),$dialogParent.append($dialog),privateMethods.activate($dialog),options.trapFocus&&privateMethods.autoFocus($dialog),options.name?$rootScope.$broadcast("ngDialog.opened",{dialog:$dialog,name:options.name}):$rootScope.$broadcast("ngDialog.opened",$dialog)}),keydownIsBound||($elements.body.bind("keydown",privateMethods.onDocumentKeydown),keydownIsBound=!0),options.closeByNavigation){var eventName=privateMethods.getRouterLocationEventName();$rootScope.$on(eventName,function($event){!1===privateMethods.closeDialog($dialog)&&$event.preventDefault()})}if(options.preserveFocus&&$dialog.data("$ngDialogPreviousFocus",document.activeElement),closeByDocumentHandler=function(event){var isOverlay=!!options.closeByDocument&&$el(event.target).hasClass("ngdialog-overlay"),isCloseBtn=$el(event.target).hasClass("ngdialog-close");(isOverlay||isCloseBtn)&&publicMethods.close($dialog.attr("id"),isCloseBtn?"$closeButton":"$document")},void 0!==$window.Hammer){(scope.hammerTime=$window.Hammer($dialog[0])).on("tap",closeByDocumentHandler)}else $dialog.bind("click",closeByDocumentHandler);return dialogsCount+=1,publicMethods}),{id:dialogID,closePromise:defer.promise,close:function(value){privateMethods.closeDialog($dialog,value)}}}},openConfirm:function(opts){var defer=$q.defer(),options=angular.copy(defaults);opts=opts||{},void 0!==options.data&&(void 0===opts.data&&(opts.data={}),opts.data=angular.merge(angular.copy(options.data),opts.data)),angular.extend(options,opts),options.scope=angular.isObject(options.scope)?options.scope.$new():$rootScope.$new(),options.scope.confirm=function(value){defer.resolve(value);var $dialog=$el(document.getElementById(openResult.id));privateMethods.performCloseDialog($dialog,value)};var openResult=publicMethods.open(options);if(openResult)return openResult.closePromise.then(function(data){return data?defer.reject(data.value):defer.reject()}),defer.promise},isOpen:function(id){return $el(document.getElementById(id)).length>0},close:function(id,value){var $dialog=$el(document.getElementById(id));if($dialog.length)privateMethods.closeDialog($dialog,value);else if("$escape"===id){var topDialogId=openIdStack[openIdStack.length-1];$dialog=$el(document.getElementById(topDialogId)),$dialog.data("$ngDialogOptions").closeByEscape&&privateMethods.closeDialog($dialog,"$escape")}else publicMethods.closeAll(value);return publicMethods},closeAll:function(value){for(var $all=document.querySelectorAll(".ngdialog"),i=$all.length-1;i>=0;i--){var dialog=$all[i];privateMethods.closeDialog($el(dialog),value)}},getOpenDialogs:function(){return openIdStack},getDefaults:function(){return defaults}};return angular.forEach(["html","body"],function(elementName){if($elements[elementName]=$document.find(elementName),forceElementsReload[elementName]){var eventName=privateMethods.getRouterLocationEventName();$rootScope.$on(eventName,function(){$elements[elementName]=$document.find(elementName)})}}),publicMethods}]}),m.directive("ngDialog",["ngDialog",function(ngDialog){return{restrict:"A",scope:{ngDialogScope:"="},link:function(scope,elem,attrs){elem.on("click",function(e){e.preventDefault();var ngDialogScope=angular.isDefined(scope.ngDialogScope)?scope.ngDialogScope:"noScope";angular.isDefined(attrs.ngDialogClosePrevious)&&ngDialog.close(attrs.ngDialogClosePrevious);var defaults=ngDialog.getDefaults();ngDialog.open({template:attrs.ngDialog,className:attrs.ngDialogClass||defaults.className,appendClassName:attrs.ngDialogAppendClass,controller:attrs.ngDialogController,controllerAs:attrs.ngDialogControllerAs,bindToController:attrs.ngDialogBindToController,disableAnimation:attrs.ngDialogDisableAnimation,scope:ngDialogScope,data:attrs.ngDialogData,showClose:"false"!==attrs.ngDialogShowClose&&("true"===attrs.ngDialogShowClose||defaults.showClose),closeByDocument:"false"!==attrs.ngDialogCloseByDocument&&("true"===attrs.ngDialogCloseByDocument||defaults.closeByDocument),closeByEscape:"false"!==attrs.ngDialogCloseByEscape&&("true"===attrs.ngDialogCloseByEscape||defaults.closeByEscape),overlay:"false"!==attrs.ngDialogOverlay&&("true"===attrs.ngDialogOverlay||defaults.overlay),preCloseCallback:attrs.ngDialogPreCloseCallback||defaults.preCloseCallback,bodyClassName:attrs.ngDialogBodyClass||defaults.bodyClassName})})}}}]),m}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.Promise=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof _dereq_&&_dereq_;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof _dereq_&&_dereq_,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise){function any(promises){var ret=new SomePromiseArray(promises),promise=ret.promise();return ret.setHowMany(1),ret.setUnwrap(),ret.init(),promise}var SomePromiseArray=Promise._SomePromiseArray;Promise.any=function(promises){return any(promises)},Promise.prototype.any=function(){return any(this)}}},{}],2:[function(_dereq_,module,exports){"use strict";function Async(){this._isTickUsed=!1,this._lateQueue=new Queue(16),this._normalQueue=new Queue(16),this._trampolineEnabled=!0;var self=this;this.drainQueues=function(){self._drainQueues()},this._schedule=schedule.isStatic?schedule(this.drainQueues):schedule}function AsyncInvokeLater(fn,receiver,arg){this._lateQueue.push(fn,receiver,arg),this._queueTick()}function AsyncInvoke(fn,receiver,arg){this._normalQueue.push(fn,receiver,arg),this._queueTick()}function AsyncSettlePromises(promise){this._normalQueue._pushOne(promise),this._queueTick()}var firstLineError;try{throw new Error}catch(e){firstLineError=e}var schedule=_dereq_("./schedule.js"),Queue=_dereq_("./queue.js"),util=_dereq_("./util.js");Async.prototype.disableTrampolineIfNecessary=function(){util.hasDevTools&&(this._trampolineEnabled=!1)},Async.prototype.enableTrampoline=function(){this._trampolineEnabled||(this._trampolineEnabled=!0,this._schedule=function(fn){setTimeout(fn,0)})},Async.prototype.haveItemsQueued=function(){return this._normalQueue.length()>0},Async.prototype.throwLater=function(fn,arg){if(1===arguments.length&&(arg=fn,fn=function(){throw arg}),"undefined"!=typeof setTimeout)setTimeout(function(){fn(arg)},0);else try{this._schedule(function(){fn(arg)})}catch(e){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")}},util.hasDevTools?(schedule.isStatic&&(schedule=function(fn){setTimeout(fn,0)}),Async.prototype.invokeLater=function(fn,receiver,arg){this._trampolineEnabled?AsyncInvokeLater.call(this,fn,receiver,arg):this._schedule(function(){setTimeout(function(){fn.call(receiver,arg)},100)})},Async.prototype.invoke=function(fn,receiver,arg){this._trampolineEnabled?AsyncInvoke.call(this,fn,receiver,arg):this._schedule(function(){fn.call(receiver,arg)})},Async.prototype.settlePromises=function(promise){this._trampolineEnabled?AsyncSettlePromises.call(this,promise):this._schedule(function(){promise._settlePromises()})}):(Async.prototype.invokeLater=AsyncInvokeLater,Async.prototype.invoke=AsyncInvoke,Async.prototype.settlePromises=AsyncSettlePromises),Async.prototype.invokeFirst=function(fn,receiver,arg){this._normalQueue.unshift(fn,receiver,arg),this._queueTick()},Async.prototype._drainQueue=function(queue){for(;queue.length()>0;){var fn=queue.shift();if("function"==typeof fn){var receiver=queue.shift(),arg=queue.shift();fn.call(receiver,arg)}else fn._settlePromises()}},Async.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._drainQueue(this._lateQueue)},Async.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},Async.prototype._reset=function(){this._isTickUsed=!1},module.exports=new Async,module.exports.firstLineError=firstLineError},{"./queue.js":28,"./schedule.js":31,"./util.js":38}],3:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL,tryConvertToPromise){var rejectThis=function(_,e){this._reject(e)},targetRejected=function(e,context){context.promiseRejectionQueued=!0,context.bindingPromise._then(rejectThis,rejectThis,null,this,e)},bindingResolved=function(thisArg,context){this._isPending()&&this._resolveCallback(context.target)},bindingRejected=function(e,context){context.promiseRejectionQueued||this._reject(e)};Promise.prototype.bind=function(thisArg){var maybePromise=tryConvertToPromise(thisArg),ret=new Promise(INTERNAL);ret._propagateFrom(this,1);var target=this._target();if(ret._setBoundTo(maybePromise),maybePromise instanceof Promise){var context={promiseRejectionQueued:!1,promise:ret,target:target,bindingPromise:maybePromise};target._then(INTERNAL,targetRejected,ret._progress,ret,context),maybePromise._then(bindingResolved,bindingRejected,ret._progress,ret,context)}else ret._resolveCallback(target);return ret},Promise.prototype._setBoundTo=function(obj){void 0!==obj?(this._bitField=131072|this._bitField,this._boundTo=obj):this._bitField=-131073&this._bitField},Promise.prototype._isBound=function(){return 131072==(131072&this._bitField)},Promise.bind=function(thisArg,value){var maybePromise=tryConvertToPromise(thisArg),ret=new Promise(INTERNAL);return ret._setBoundTo(maybePromise),maybePromise instanceof Promise?maybePromise._then(function(){ret._resolveCallback(value)},ret._reject,ret._progress,ret,null):ret._resolveCallback(value),ret}}},{}],4:[function(_dereq_,module,exports){"use strict";function noConflict(){try{Promise===bluebird&&(Promise=old)}catch(e){}return bluebird}var old;"undefined"!=typeof Promise&&(old=Promise);var bluebird=_dereq_("./promise.js")();bluebird.noConflict=noConflict,module.exports=bluebird},{"./promise.js":23}],5:[function(_dereq_,module,exports){"use strict";var cr=Object.create;if(cr){var callerCache=cr(null),getterCache=cr(null);callerCache[" size"]=getterCache[" size"]=0}module.exports=function(Promise){function ensureMethod(obj,methodName){var fn;if(null!=obj&&(fn=obj[methodName]),"function"!=typeof fn){var message="Object "+util.classString(obj)+" has no method '"+util.toString(methodName)+"'";throw new Promise.TypeError(message)}return fn}function caller(obj){return ensureMethod(obj,this.pop()).apply(obj,this)}function namedGetter(obj){return obj[this]}function indexedGetter(obj){var index=+this;return index<0&&(index=Math.max(0,index+obj.length)),obj[index]}var getGetter,util=_dereq_("./util.js"),canEvaluate=util.canEvaluate;util.isIdentifier;Promise.prototype.call=function(methodName){for(var $_len=arguments.length,args=new Array($_len-1),$_i=1;$_i<$_len;++$_i)args[$_i-1]=arguments[$_i];return args.push(methodName),this._then(caller,void 0,void 0,args,void 0)},Promise.prototype.get=function(propertyName){var getter,isIndex="number"==typeof propertyName;if(isIndex)getter=indexedGetter;else if(canEvaluate){var maybeGetter=getGetter(propertyName);getter=null!==maybeGetter?maybeGetter:namedGetter}else getter=namedGetter;return this._then(getter,void 0,void 0,propertyName,void 0)}}},{"./util.js":38}],6:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise){var errors=_dereq_("./errors.js"),async=_dereq_("./async.js"),CancellationError=errors.CancellationError;Promise.prototype._cancel=function(reason){if(!this.isCancellable())return this;for(var parent,promiseToReject=this;void 0!==(parent=promiseToReject._cancellationParent)&&parent.isCancellable();)promiseToReject=parent;this._unsetCancellable(),promiseToReject._target()._rejectCallback(reason,!1,!0)},Promise.prototype.cancel=function(reason){return this.isCancellable()?(void 0===reason&&(reason=new CancellationError),async.invokeLater(this._cancel,this,reason),this):this},Promise.prototype.cancellable=function(){return this._cancellable()?this:(async.enableTrampoline(),this._setCancellable(),this._cancellationParent=void 0,this)},Promise.prototype.uncancellable=function(){var ret=this.then();return ret._unsetCancellable(),ret},Promise.prototype.fork=function(didFulfill,didReject,didProgress){var ret=this._then(didFulfill,didReject,didProgress,void 0,void 0);return ret._setCancellable(),ret._cancellationParent=void 0,ret}}},{"./async.js":2,"./errors.js":13}],7:[function(_dereq_,module,exports){"use strict";module.exports=function(){function CapturedTrace(parent){this._parent=parent;var length=this._length=1+(void 0===parent?0:parent._length);captureStackTrace(this,CapturedTrace),length>32&&this.uncycle()}function reconstructStack(message,stacks){for(var i=0;i<stacks.length-1;++i)stacks[i].push("From previous event:"),stacks[i]=stacks[i].join("\n");return i<stacks.length&&(stacks[i]=stacks[i].join("\n")),message+"\n"+stacks.join("\n")}function removeDuplicateOrEmptyJumps(stacks){for(var i=0;i<stacks.length;++i)(0===stacks[i].length||i+1<stacks.length&&stacks[i][0]===stacks[i+1][0])&&(stacks.splice(i,1),i--)}function removeCommonRoots(stacks){for(var current=stacks[0],i=1;i<stacks.length;++i){for(var prev=stacks[i],currentLastIndex=current.length-1,currentLastLine=current[currentLastIndex],commonRootMeetPoint=-1,j=prev.length-1;j>=0;--j)if(prev[j]===currentLastLine){commonRootMeetPoint=j;break}for(var j=commonRootMeetPoint;j>=0;--j){var line=prev[j];if(current[currentLastIndex]!==line)break;current.pop(),currentLastIndex--}current=prev}}function cleanStack(stack){for(var ret=[],i=0;i<stack.length;++i){var line=stack[i],isTraceLine=stackFramePattern.test(line)||"    (No stack trace)"===line,isInternalFrame=isTraceLine&&shouldIgnore(line);isTraceLine&&!isInternalFrame&&(indentStackFrames&&" "!==line.charAt(0)&&(line="    "+line),ret.push(line))}return ret}function stackFramesAsArray(error){for(var stack=error.stack.replace(/\s+$/g,"").split("\n"),i=0;i<stack.length;++i){var line=stack[i];if("    (No stack trace)"===line||stackFramePattern.test(line))break}return i>0&&(stack=stack.slice(i)),stack}function formatNonError(obj){var str;if("function"==typeof obj)str="[function "+(obj.name||"anonymous")+"]";else{str=obj.toString();if(/\[object [a-zA-Z0-9$_]+\]/.test(str))try{str=JSON.stringify(obj)}catch(e){}0===str.length&&(str="(empty array)")}return"(<"+snip(str)+">, no stack trace)"}function snip(str){return str.length<41?str:str.substr(0,38)+"..."}function parseLineInfo(line){var matches=line.match(parseLineInfoRegex);if(matches)return{fileName:matches[1],line:parseInt(matches[2],10)}}var warn,async=_dereq_("./async.js"),util=_dereq_("./util.js"),bluebirdFramePattern=/[\\\/]bluebird[\\\/]js[\\\/](main|debug|zalgo|instrumented)/,stackFramePattern=null,formatStack=null,indentStackFrames=!1;util.inherits(CapturedTrace,Error),CapturedTrace.prototype.uncycle=function(){var length=this._length;if(!(length<2)){for(var nodes=[],stackToIndex={},i=0,node=this;void 0!==node;++i)nodes.push(node),node=node._parent;length=this._length=i;for(var i=length-1;i>=0;--i){var stack=nodes[i].stack;void 0===stackToIndex[stack]&&(stackToIndex[stack]=i)}for(var i=0;i<length;++i){var currentStack=nodes[i].stack,index=stackToIndex[currentStack];if(void 0!==index&&index!==i){index>0&&(nodes[index-1]._parent=void 0,nodes[index-1]._length=1),nodes[i]._parent=void 0,nodes[i]._length=1;var cycleEdgeNode=i>0?nodes[i-1]:this;index<length-1?(cycleEdgeNode._parent=nodes[index+1],cycleEdgeNode._parent.uncycle(),cycleEdgeNode._length=cycleEdgeNode._parent._length+1):(cycleEdgeNode._parent=void 0,cycleEdgeNode._length=1);for(var currentChildLength=cycleEdgeNode._length+1,j=i-2;j>=0;--j)nodes[j]._length=currentChildLength,currentChildLength++;return}}}},CapturedTrace.prototype.parent=function(){return this._parent},CapturedTrace.prototype.hasParent=function(){return void 0!==this._parent},CapturedTrace.prototype.attachExtraTrace=function(error){if(!error.__stackCleaned__){this.uncycle();for(var parsed=CapturedTrace.parseStackAndMessage(error),message=parsed.message,stacks=[parsed.stack],trace=this;void 0!==trace;)stacks.push(cleanStack(trace.stack.split("\n"))),trace=trace._parent;removeCommonRoots(stacks),removeDuplicateOrEmptyJumps(stacks),util.notEnumerableProp(error,"stack",reconstructStack(message,stacks)),util.notEnumerableProp(error,"__stackCleaned__",!0)}},CapturedTrace.parseStackAndMessage=function(error){var stack=error.stack,message=error.toString();return stack="string"==typeof stack&&stack.length>0?stackFramesAsArray(error):["    (No stack trace)"],{message:message,stack:cleanStack(stack)}},CapturedTrace.formatAndLogError=function(error,title){if("undefined"!=typeof console){var message;if("object"==typeof error||"function"==typeof error){var stack=error.stack;message=title+formatStack(stack,error)}else message=title+String(error);"function"==typeof warn?warn(message):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(message)}},CapturedTrace.unhandledRejection=function(reason){CapturedTrace.formatAndLogError(reason,"^--- With additional stack trace: ")},CapturedTrace.isSupported=function(){return"function"==typeof captureStackTrace},CapturedTrace.fireRejectionEvent=function(name,localHandler,reason,promise){var localEventFired=!1;try{"function"==typeof localHandler&&(localEventFired=!0,"rejectionHandled"===name?localHandler(promise):localHandler(reason,promise))}catch(e){async.throwLater(e)}var globalEventFired=!1;try{globalEventFired=fireGlobalEvent(name,reason,promise)}catch(e){globalEventFired=!0,async.throwLater(e)}var domEventFired=!1;if(fireDomEvent)try{domEventFired=fireDomEvent(name.toLowerCase(),{reason:reason,promise:promise})}catch(e){domEventFired=!0,async.throwLater(e)}globalEventFired||localEventFired||domEventFired||"unhandledRejection"!==name||CapturedTrace.formatAndLogError(reason,"Unhandled rejection ")};var shouldIgnore=function(){return!1},parseLineInfoRegex=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;CapturedTrace.setBounds=function(firstLineError,lastLineError){if(CapturedTrace.isSupported()){for(var firstFileName,lastFileName,firstStackLines=firstLineError.stack.split("\n"),lastStackLines=lastLineError.stack.split("\n"),firstIndex=-1,lastIndex=-1,i=0;i<firstStackLines.length;++i){var result=parseLineInfo(firstStackLines[i]);if(result){firstFileName=result.fileName,firstIndex=result.line;break}}for(var i=0;i<lastStackLines.length;++i){var result=parseLineInfo(lastStackLines[i]);if(result){lastFileName=result.fileName,lastIndex=result.line;break}}firstIndex<0||lastIndex<0||!firstFileName||!lastFileName||firstFileName!==lastFileName||firstIndex>=lastIndex||(shouldIgnore=function(line){if(bluebirdFramePattern.test(line))return!0;var info=parseLineInfo(line);return!!(info&&info.fileName===firstFileName&&firstIndex<=info.line&&info.line<=lastIndex)})}};var fireDomEvent,captureStackTrace=function(){var v8stackFramePattern=/^\s*at\s*/,v8stackFormatter=function(stack,error){return"string"==typeof stack?stack:void 0!==error.name&&void 0!==error.message?error.toString():formatNonError(error)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit=Error.stackTraceLimit+6,stackFramePattern=v8stackFramePattern,formatStack=v8stackFormatter;var captureStackTrace=Error.captureStackTrace;return shouldIgnore=function(line){return bluebirdFramePattern.test(line)},function(receiver,ignoreUntil){Error.stackTraceLimit=Error.stackTraceLimit+6,captureStackTrace(receiver,ignoreUntil),Error.stackTraceLimit=Error.stackTraceLimit-6}}var err=new Error;if("string"==typeof err.stack&&err.stack.split("\n")[0].indexOf("stackDetection@")>=0)return stackFramePattern=/@/,formatStack=v8stackFormatter,indentStackFrames=!0,function(o){o.stack=(new Error).stack};var hasStackAfterThrow;try{throw new Error}catch(e){hasStackAfterThrow="stack"in e}return"stack"in err||!hasStackAfterThrow||"number"!=typeof Error.stackTraceLimit?(formatStack=function(stack,error){return"string"==typeof stack?stack:"object"!=typeof error&&"function"!=typeof error||void 0===error.name||void 0===error.message?formatNonError(error):error.toString()},null):(stackFramePattern=v8stackFramePattern,formatStack=v8stackFormatter,function(o){Error.stackTraceLimit=Error.stackTraceLimit+6;try{throw new Error}catch(e){o.stack=e.stack}Error.stackTraceLimit=Error.stackTraceLimit-6})}(),fireGlobalEvent=function(){if(util.isNode)return function(name,reason,promise){return"rejectionHandled"===name?process.emit(name,promise):process.emit(name,reason,promise)};var customEventWorks=!1,anyEventWorks=!0;try{var ev=new self.CustomEvent("test");customEventWorks=ev instanceof CustomEvent}catch(e){}if(!customEventWorks)try{var event=document.createEvent("CustomEvent");event.initCustomEvent("testingtheevent",!1,!0,{}),self.dispatchEvent(event)}catch(e){anyEventWorks=!1}anyEventWorks&&(fireDomEvent=function(type,detail){var event;return customEventWorks?event=new self.CustomEvent(type,{detail:detail,bubbles:!1,cancelable:!0}):self.dispatchEvent&&(event=document.createEvent("CustomEvent"),event.initCustomEvent(type,!1,!0,detail)),!!event&&!self.dispatchEvent(event)});var toWindowMethodNameMap={};return toWindowMethodNameMap.unhandledRejection="onunhandledRejection".toLowerCase(),toWindowMethodNameMap.rejectionHandled="onrejectionHandled".toLowerCase(),function(name,reason,promise){var methodName=toWindowMethodNameMap[name],method=self[methodName];return!!method&&("rejectionHandled"===name?method.call(self,promise):method.call(self,reason,promise),!0)}}();return"undefined"!=typeof console&&void 0!==console.warn&&(warn=function(message){console.warn(message)},util.isNode&&process.stderr.isTTY?warn=function(message){process.stderr.write("[31m"+message+"[39m\n")}:util.isNode||"string"!=typeof(new Error).stack||(warn=function(message){console.warn("%c"+message,"color: red")})),CapturedTrace}},{"./async.js":2,"./util.js":38}],8:[function(_dereq_,module,exports){"use strict";module.exports=function(NEXT_FILTER){function CatchFilter(instances,callback,promise){this._instances=instances,this._callback=callback,this._promise=promise}function safePredicate(predicate,e){var safeObject={},retfilter=tryCatch(predicate).call(safeObject,e);return retfilter===errorObj?retfilter:keys(safeObject).length?(errorObj.e=new TypeError("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"),errorObj):retfilter}var util=_dereq_("./util.js"),errors=_dereq_("./errors.js"),tryCatch=util.tryCatch,errorObj=util.errorObj,keys=_dereq_("./es5.js").keys,TypeError=errors.TypeError;return CatchFilter.prototype.doFilter=function(e){for(var cb=this._callback,promise=this._promise,boundTo=promise._boundValue(),i=0,len=this._instances.length;i<len;++i){var item=this._instances[i],itemIsErrorType=item===Error||null!=item&&item.prototype instanceof Error;if(itemIsErrorType&&e instanceof item){var ret=tryCatch(cb).call(boundTo,e);return ret===errorObj?(NEXT_FILTER.e=ret.e,NEXT_FILTER):ret}if("function"==typeof item&&!itemIsErrorType){var shouldHandle=safePredicate(item,e);if(shouldHandle===errorObj){e=errorObj.e;break}if(shouldHandle){var ret=tryCatch(cb).call(boundTo,e);return ret===errorObj?(NEXT_FILTER.e=ret.e,NEXT_FILTER):ret}}}return NEXT_FILTER.e=e,NEXT_FILTER},CatchFilter}},{"./errors.js":13,"./es5.js":14,"./util.js":38}],9:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,CapturedTrace,isDebugging){function Context(){this._trace=new CapturedTrace(peekContext())}function createContext(){if(isDebugging())return new Context}function peekContext(){var lastIndex=contextStack.length-1;if(lastIndex>=0)return contextStack[lastIndex]}var contextStack=[];return Context.prototype._pushContext=function(){isDebugging()&&void 0!==this._trace&&contextStack.push(this._trace)},Context.prototype._popContext=function(){isDebugging()&&void 0!==this._trace&&contextStack.pop()},Promise.prototype._peekContext=peekContext,Promise.prototype._pushContext=Context.prototype._pushContext,Promise.prototype._popContext=Context.prototype._popContext,createContext}},{}],10:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,CapturedTrace){var unhandledRejectionHandled,possiblyUnhandledRejection,getDomain=Promise._getDomain,async=_dereq_("./async.js"),Warning=_dereq_("./errors.js").Warning,util=_dereq_("./util.js"),canAttachTrace=util.canAttachTrace,debugging=util.isNode&&(!!process.env.BLUEBIRD_DEBUG||"development"===process.env.NODE_ENV);return util.isNode&&0==process.env.BLUEBIRD_DEBUG&&(debugging=!1),debugging&&async.disableTrampolineIfNecessary(),Promise.prototype._ignoreRejections=function(){this._unsetRejectionIsUnhandled(),this._bitField=16777216|this._bitField},Promise.prototype._ensurePossibleRejectionHandled=function(){0==(16777216&this._bitField)&&(this._setRejectionIsUnhandled(),async.invokeLater(this._notifyUnhandledRejection,this,void 0))},Promise.prototype._notifyUnhandledRejectionIsHandled=function(){CapturedTrace.fireRejectionEvent("rejectionHandled",unhandledRejectionHandled,void 0,this)},Promise.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var reason=this._getCarriedStackTrace()||this._settledValue;this._setUnhandledRejectionIsNotified(),CapturedTrace.fireRejectionEvent("unhandledRejection",possiblyUnhandledRejection,reason,this)}},Promise.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=524288|this._bitField},Promise.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-524289&this._bitField},Promise.prototype._isUnhandledRejectionNotified=function(){return(524288&this._bitField)>0},Promise.prototype._setRejectionIsUnhandled=function(){this._bitField=2097152|this._bitField},Promise.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-2097153&this._bitField,
this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},Promise.prototype._isRejectionUnhandled=function(){return(2097152&this._bitField)>0},Promise.prototype._setCarriedStackTrace=function(capturedTrace){this._bitField=1048576|this._bitField,this._fulfillmentHandler0=capturedTrace},Promise.prototype._isCarryingStackTrace=function(){return(1048576&this._bitField)>0},Promise.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0},Promise.prototype._captureStackTrace=function(){return debugging&&(this._trace=new CapturedTrace(this._peekContext())),this},Promise.prototype._attachExtraTrace=function(error,ignoreSelf){if(debugging&&canAttachTrace(error)){var trace=this._trace;if(void 0!==trace&&ignoreSelf&&(trace=trace._parent),void 0!==trace)trace.attachExtraTrace(error);else if(!error.__stackCleaned__){var parsed=CapturedTrace.parseStackAndMessage(error);util.notEnumerableProp(error,"stack",parsed.message+"\n"+parsed.stack.join("\n")),util.notEnumerableProp(error,"__stackCleaned__",!0)}}},Promise.prototype._warn=function(message){var warning=new Warning(message),ctx=this._peekContext();if(ctx)ctx.attachExtraTrace(warning);else{var parsed=CapturedTrace.parseStackAndMessage(warning);warning.stack=parsed.message+"\n"+parsed.stack.join("\n")}CapturedTrace.formatAndLogError(warning,"")},Promise.onPossiblyUnhandledRejection=function(fn){var domain=getDomain();possiblyUnhandledRejection="function"==typeof fn?null===domain?fn:domain.bind(fn):void 0},Promise.onUnhandledRejectionHandled=function(fn){var domain=getDomain();unhandledRejectionHandled="function"==typeof fn?null===domain?fn:domain.bind(fn):void 0},Promise.longStackTraces=function(){if(async.haveItemsQueued()&&!1===debugging)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/DT1qyG\n");(debugging=CapturedTrace.isSupported())&&async.disableTrampolineIfNecessary()},Promise.hasLongStackTraces=function(){return debugging&&CapturedTrace.isSupported()},CapturedTrace.isSupported()||(Promise.longStackTraces=function(){},debugging=!1),function(){return debugging}}},{"./async.js":2,"./errors.js":13,"./util.js":38}],11:[function(_dereq_,module,exports){"use strict";var util=_dereq_("./util.js"),isPrimitive=util.isPrimitive;module.exports=function(Promise){var returner=function(){return this},thrower=function(){throw this},returnUndefined=function(){},throwUndefined=function(){throw void 0},wrapper=function(value,action){return 1===action?function(){throw value}:2===action?function(){return value}:void 0};Promise.prototype.return=Promise.prototype.thenReturn=function(value){return void 0===value?this.then(returnUndefined):isPrimitive(value)?this._then(wrapper(value,2),void 0,void 0,void 0,void 0):(value instanceof Promise&&value._ignoreRejections(),this._then(returner,void 0,void 0,value,void 0))},Promise.prototype.throw=Promise.prototype.thenThrow=function(reason){return void 0===reason?this.then(throwUndefined):isPrimitive(reason)?this._then(wrapper(reason,1),void 0,void 0,void 0,void 0):this._then(thrower,void 0,void 0,reason,void 0)}}},{"./util.js":38}],12:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){var PromiseReduce=Promise.reduce;Promise.prototype.each=function(fn){return PromiseReduce(this,fn,null,INTERNAL)},Promise.each=function(promises,fn){return PromiseReduce(promises,fn,null,INTERNAL)}}},{}],13:[function(_dereq_,module,exports){"use strict";function subError(nameProperty,defaultMessage){function SubError(message){if(!(this instanceof SubError))return new SubError(message);notEnumerableProp(this,"message","string"==typeof message?message:defaultMessage),notEnumerableProp(this,"name",nameProperty),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return inherits(SubError,Error),SubError}function OperationalError(message){if(!(this instanceof OperationalError))return new OperationalError(message);notEnumerableProp(this,"name","OperationalError"),notEnumerableProp(this,"message",message),this.cause=message,this.isOperational=!0,message instanceof Error?(notEnumerableProp(this,"message",message.message),notEnumerableProp(this,"stack",message.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}var _TypeError,_RangeError,es5=_dereq_("./es5.js"),Objectfreeze=es5.freeze,util=_dereq_("./util.js"),inherits=util.inherits,notEnumerableProp=util.notEnumerableProp,Warning=subError("Warning","warning"),CancellationError=subError("CancellationError","cancellation error"),TimeoutError=subError("TimeoutError","timeout error"),AggregateError=subError("AggregateError","aggregate error");try{_TypeError=TypeError,_RangeError=RangeError}catch(e){_TypeError=subError("TypeError","type error"),_RangeError=subError("RangeError","range error")}for(var methods="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),i=0;i<methods.length;++i)"function"==typeof Array.prototype[methods[i]]&&(AggregateError.prototype[methods[i]]=Array.prototype[methods[i]]);es5.defineProperty(AggregateError.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),AggregateError.prototype.isOperational=!0;var level=0;AggregateError.prototype.toString=function(){var indent=Array(4*level+1).join(" "),ret="\n"+indent+"AggregateError of:\n";level++,indent=Array(4*level+1).join(" ");for(var i=0;i<this.length;++i){for(var str=this[i]===this?"[Circular AggregateError]":this[i]+"",lines=str.split("\n"),j=0;j<lines.length;++j)lines[j]=indent+lines[j];str=lines.join("\n"),ret+=str+"\n"}return level--,ret},inherits(OperationalError,Error);var errorTypes=Error.__BluebirdErrorTypes__;errorTypes||(errorTypes=Objectfreeze({CancellationError:CancellationError,TimeoutError:TimeoutError,OperationalError:OperationalError,RejectionError:OperationalError,AggregateError:AggregateError}),notEnumerableProp(Error,"__BluebirdErrorTypes__",errorTypes)),module.exports={Error:Error,TypeError:_TypeError,RangeError:_RangeError,CancellationError:errorTypes.CancellationError,OperationalError:errorTypes.OperationalError,TimeoutError:errorTypes.TimeoutError,AggregateError:errorTypes.AggregateError,Warning:Warning}},{"./es5.js":14,"./util.js":38}],14:[function(_dereq_,module,exports){var isES5=function(){"use strict";return void 0===this}();if(isES5)module.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:isES5,propertyIsWritable:function(obj,prop){var descriptor=Object.getOwnPropertyDescriptor(obj,prop);return!(descriptor&&!descriptor.writable&&!descriptor.set)}};else{var has={}.hasOwnProperty,str={}.toString,proto={}.constructor.prototype,ObjectKeys=function(o){var ret=[];for(var key in o)has.call(o,key)&&ret.push(key);return ret},ObjectGetDescriptor=function(o,key){return{value:o[key]}},ObjectDefineProperty=function(o,key,desc){return o[key]=desc.value,o},ObjectFreeze=function(obj){return obj},ObjectGetPrototypeOf=function(obj){try{return Object(obj).constructor.prototype}catch(e){return proto}},ArrayIsArray=function(obj){try{return"[object Array]"===str.call(obj)}catch(e){return!1}};module.exports={isArray:ArrayIsArray,keys:ObjectKeys,names:ObjectKeys,defineProperty:ObjectDefineProperty,getDescriptor:ObjectGetDescriptor,freeze:ObjectFreeze,getPrototypeOf:ObjectGetPrototypeOf,isES5:isES5,propertyIsWritable:function(){return!0}}}},{}],15:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){var PromiseMap=Promise.map;Promise.prototype.filter=function(fn,options){return PromiseMap(this,fn,options,INTERNAL)},Promise.filter=function(promises,fn,options){return PromiseMap(promises,fn,options,INTERNAL)}}},{}],16:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,NEXT_FILTER,tryConvertToPromise){function returnThis(){return this}function throwThis(){throw this}function return$(r){return function(){return r}}function throw$(r){return function(){throw r}}function promisedFinally(ret,reasonOrValue,isFulfilled){var then;return then=isPrimitive(reasonOrValue)?isFulfilled?return$(reasonOrValue):throw$(reasonOrValue):isFulfilled?returnThis:throwThis,ret._then(then,thrower,void 0,reasonOrValue,void 0)}function finallyHandler(reasonOrValue){var promise=this.promise,handler=this.handler,ret=promise._isBound()?handler.call(promise._boundValue()):handler();if(void 0!==ret){var maybePromise=tryConvertToPromise(ret,promise);if(maybePromise instanceof Promise)return maybePromise=maybePromise._target(),promisedFinally(maybePromise,reasonOrValue,promise.isFulfilled())}return promise.isRejected()?(NEXT_FILTER.e=reasonOrValue,NEXT_FILTER):reasonOrValue}function tapHandler(value){var promise=this.promise,handler=this.handler,ret=promise._isBound()?handler.call(promise._boundValue(),value):handler(value);if(void 0!==ret){var maybePromise=tryConvertToPromise(ret,promise);if(maybePromise instanceof Promise)return maybePromise=maybePromise._target(),promisedFinally(maybePromise,value,!0)}return value}var util=_dereq_("./util.js"),isPrimitive=util.isPrimitive,thrower=util.thrower;Promise.prototype._passThroughHandler=function(handler,isFinally){if("function"!=typeof handler)return this.then();var promiseAndHandler={promise:this,handler:handler};return this._then(isFinally?finallyHandler:tapHandler,isFinally?finallyHandler:void 0,void 0,promiseAndHandler,void 0)},Promise.prototype.lastly=Promise.prototype.finally=function(handler){return this._passThroughHandler(handler,!0)},Promise.prototype.tap=function(handler){return this._passThroughHandler(handler,!1)}}},{"./util.js":38}],17:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,apiRejection,INTERNAL,tryConvertToPromise){function promiseFromYieldHandler(value,yieldHandlers,traceParent){for(var i=0;i<yieldHandlers.length;++i){traceParent._pushContext();var result=tryCatch(yieldHandlers[i])(value);if(traceParent._popContext(),result===errorObj){traceParent._pushContext();var ret=Promise.reject(errorObj.e);return traceParent._popContext(),ret}var maybePromise=tryConvertToPromise(result,traceParent);if(maybePromise instanceof Promise)return maybePromise}return null}function PromiseSpawn(generatorFunction,receiver,yieldHandler,stack){(this._promise=new Promise(INTERNAL))._captureStackTrace(),this._stack=stack,this._generatorFunction=generatorFunction,this._receiver=receiver,this._generator=void 0,this._yieldHandlers="function"==typeof yieldHandler?[yieldHandler].concat(yieldHandlers):yieldHandlers}var errors=_dereq_("./errors.js"),TypeError=errors.TypeError,util=_dereq_("./util.js"),errorObj=util.errorObj,tryCatch=util.tryCatch,yieldHandlers=[];PromiseSpawn.prototype.promise=function(){return this._promise},PromiseSpawn.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._next(void 0)},PromiseSpawn.prototype._continue=function(result){if(result===errorObj)return this._promise._rejectCallback(result.e,!1,!0);var value=result.value;if(!0===result.done)this._promise._resolveCallback(value);else{var maybePromise=tryConvertToPromise(value,this._promise);if(!(maybePromise instanceof Promise)&&null===(maybePromise=promiseFromYieldHandler(maybePromise,this._yieldHandlers,this._promise)))return void this._throw(new TypeError("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/4Y4pDk\n\n".replace("%s",value)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));maybePromise._then(this._next,this._throw,void 0,this,null)}},PromiseSpawn.prototype._throw=function(reason){this._promise._attachExtraTrace(reason),this._promise._pushContext();var result=tryCatch(this._generator.throw).call(this._generator,reason);this._promise._popContext(),this._continue(result)},PromiseSpawn.prototype._next=function(value){this._promise._pushContext();var result=tryCatch(this._generator.next).call(this._generator,value);this._promise._popContext(),this._continue(result)},Promise.coroutine=function(generatorFunction,options){if("function"!=typeof generatorFunction)throw new TypeError("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var yieldHandler=Object(options).yieldHandler,PromiseSpawn$=PromiseSpawn,stack=(new Error).stack;return function(){var generator=generatorFunction.apply(this,arguments),spawn=new PromiseSpawn$(void 0,void 0,yieldHandler,stack);return spawn._generator=generator,spawn._next(void 0),spawn.promise()}},Promise.coroutine.addYieldHandler=function(fn){if("function"!=typeof fn)throw new TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");yieldHandlers.push(fn)},Promise.spawn=function(generatorFunction){if("function"!=typeof generatorFunction)return apiRejection("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var spawn=new PromiseSpawn(generatorFunction,this),ret=spawn.promise();return spawn._run(Promise.spawn),ret}}},{"./errors.js":13,"./util.js":38}],18:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,tryConvertToPromise,INTERNAL){var util=_dereq_("./util.js");util.canEvaluate,util.tryCatch,util.errorObj;Promise.join=function(){var fn,last=arguments.length-1;if(last>0&&"function"==typeof arguments[last]){fn=arguments[last];var ret}for(var $_len=arguments.length,args=new Array($_len),$_i=0;$_i<$_len;++$_i)args[$_i]=arguments[$_i];fn&&args.pop();var ret=new PromiseArray(args).promise();return void 0!==fn?ret.spread(fn):ret}}},{"./util.js":38}],19:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,apiRejection,tryConvertToPromise,INTERNAL){function MappingPromiseArray(promises,fn,limit,_filter){this.constructor$(promises),this._promise._captureStackTrace();var domain=getDomain();this._callback=null===domain?fn:domain.bind(fn),this._preservedValues=_filter===INTERNAL?new Array(this.length()):null,this._limit=limit,this._inFlight=0,this._queue=limit>=1?[]:EMPTY_ARRAY,async.invoke(init,this,void 0)}function init(){this._init$(void 0,-2)}function map(promises,fn,options,_filter){var limit="object"==typeof options&&null!==options?options.concurrency:0;return limit="number"==typeof limit&&isFinite(limit)&&limit>=1?limit:0,new MappingPromiseArray(promises,fn,limit,_filter)}var getDomain=Promise._getDomain,async=_dereq_("./async.js"),util=_dereq_("./util.js"),tryCatch=util.tryCatch,errorObj=util.errorObj,PENDING={},EMPTY_ARRAY=[];util.inherits(MappingPromiseArray,PromiseArray),MappingPromiseArray.prototype._init=function(){},MappingPromiseArray.prototype._promiseFulfilled=function(value,index){var values=this._values,length=this.length(),preservedValues=this._preservedValues,limit=this._limit;if(values[index]===PENDING){if(values[index]=value,limit>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return}else{if(limit>=1&&this._inFlight>=limit)return values[index]=value,void this._queue.push(index);null!==preservedValues&&(preservedValues[index]=value);var callback=this._callback,receiver=this._promise._boundValue();this._promise._pushContext();var ret=tryCatch(callback).call(receiver,value,index,length);if(this._promise._popContext(),ret===errorObj)return this._reject(ret.e);var maybePromise=tryConvertToPromise(ret,this._promise);if(maybePromise instanceof Promise){if(maybePromise=maybePromise._target(),maybePromise._isPending())return limit>=1&&this._inFlight++,values[index]=PENDING,maybePromise._proxyPromiseArray(this,index);if(!maybePromise._isFulfilled())return this._reject(maybePromise._reason());ret=maybePromise._value()}values[index]=ret}++this._totalResolved>=length&&(null!==preservedValues?this._filter(values,preservedValues):this._resolve(values))},MappingPromiseArray.prototype._drainQueue=function(){for(var queue=this._queue,limit=this._limit,values=this._values;queue.length>0&&this._inFlight<limit;){if(this._isResolved())return;var index=queue.pop();this._promiseFulfilled(values[index],index)}},MappingPromiseArray.prototype._filter=function(booleans,values){for(var len=values.length,ret=new Array(len),j=0,i=0;i<len;++i)booleans[i]&&(ret[j++]=values[i]);ret.length=j,this._resolve(ret)},MappingPromiseArray.prototype.preservedValues=function(){return this._preservedValues},Promise.prototype.map=function(fn,options){return"function"!=typeof fn?apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):map(this,fn,options,null).promise()},Promise.map=function(promises,fn,options,_filter){return"function"!=typeof fn?apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):map(promises,fn,options,_filter).promise()}}},{"./async.js":2,"./util.js":38}],20:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL,tryConvertToPromise,apiRejection){var util=_dereq_("./util.js"),tryCatch=util.tryCatch;Promise.method=function(fn){if("function"!=typeof fn)throw new Promise.TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");return function(){var ret=new Promise(INTERNAL);ret._captureStackTrace(),ret._pushContext();var value=tryCatch(fn).apply(this,arguments);return ret._popContext(),ret._resolveFromSyncValue(value),ret}},Promise.attempt=Promise.try=function(fn,args,ctx){if("function"!=typeof fn)return apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var ret=new Promise(INTERNAL);ret._captureStackTrace(),ret._pushContext();var value=util.isArray(args)?tryCatch(fn).apply(ctx,args):tryCatch(fn).call(ctx,args);return ret._popContext(),ret._resolveFromSyncValue(value),ret},Promise.prototype._resolveFromSyncValue=function(value){value===util.errorObj?this._rejectCallback(value.e,!1,!0):this._resolveCallback(value,!0)}}},{"./util.js":38}],21:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise){function spreadAdapter(val,nodeback){var promise=this;if(!util.isArray(val))return successAdapter.call(promise,val,nodeback);var ret=tryCatch(nodeback).apply(promise._boundValue(),[null].concat(val));ret===errorObj&&async.throwLater(ret.e)}function successAdapter(val,nodeback){var promise=this,receiver=promise._boundValue(),ret=void 0===val?tryCatch(nodeback).call(receiver,null):tryCatch(nodeback).call(receiver,null,val);ret===errorObj&&async.throwLater(ret.e)}function errorAdapter(reason,nodeback){var promise=this;if(!reason){var target=promise._target(),newReason=target._getCarriedStackTrace();newReason.cause=reason,reason=newReason}var ret=tryCatch(nodeback).call(promise._boundValue(),reason);ret===errorObj&&async.throwLater(ret.e)}var util=_dereq_("./util.js"),async=_dereq_("./async.js"),tryCatch=util.tryCatch,errorObj=util.errorObj;Promise.prototype.asCallback=Promise.prototype.nodeify=function(nodeback,options){if("function"==typeof nodeback){var adapter=successAdapter;void 0!==options&&Object(options).spread&&(adapter=spreadAdapter),this._then(adapter,errorAdapter,void 0,this,nodeback)}return this}}},{"./async.js":2,"./util.js":38}],22:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray){var util=_dereq_("./util.js"),async=_dereq_("./async.js"),tryCatch=util.tryCatch,errorObj=util.errorObj;Promise.prototype.progressed=function(handler){return this._then(void 0,void 0,handler,void 0,void 0)},Promise.prototype._progress=function(progressValue){this._isFollowingOrFulfilledOrRejected()||this._target()._progressUnchecked(progressValue)},Promise.prototype._progressHandlerAt=function(index){return 0===index?this._progressHandler0:this[(index<<2)+index-5+2]},Promise.prototype._doProgressWith=function(progression){var progressValue=progression.value,handler=progression.handler,promise=progression.promise,receiver=progression.receiver,ret=tryCatch(handler).call(receiver,progressValue);if(ret===errorObj){if(null!=ret.e&&"StopProgressPropagation"!==ret.e.name){var trace=util.canAttachTrace(ret.e)?ret.e:new Error(util.toString(ret.e));promise._attachExtraTrace(trace),promise._progress(ret.e)}}else ret instanceof Promise?ret._then(promise._progress,null,null,promise,void 0):promise._progress(ret)},Promise.prototype._progressUnchecked=function(progressValue){for(var len=this._length(),progress=this._progress,i=0;i<len;i++){var handler=this._progressHandlerAt(i),promise=this._promiseAt(i);if(promise instanceof Promise)"function"==typeof handler?async.invoke(this._doProgressWith,this,{handler:handler,promise:promise,receiver:this._receiverAt(i),value:progressValue}):async.invoke(progress,promise,progressValue);else{var receiver=this._receiverAt(i);"function"==typeof handler?handler.call(receiver,progressValue,promise):receiver instanceof PromiseArray&&!receiver._isResolved()&&receiver._promiseProgressed(progressValue,promise)}}}}},{"./async.js":2,"./util.js":38}],23:[function(_dereq_,module,exports){"use strict";module.exports=function(){function Promise(resolver){if("function"!=typeof resolver)throw new TypeError("the promise constructor requires a resolver function\n\n    See http://goo.gl/EC22Yn\n");if(this.constructor!==Promise)throw new TypeError("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/KsIlge\n");this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._progressHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._settledValue=void 0,resolver!==INTERNAL&&this._resolveFromResolver(resolver)}function fillTypes(value){var p=new Promise(INTERNAL);p._fulfillmentHandler0=value,p._rejectionHandler0=value,p._progressHandler0=value,p._promise0=value,p._receiver0=value,p._settledValue=value}var getDomain,makeSelfResolutionError=function(){return new TypeError("circular promise resolution chain\n\n    See http://goo.gl/LhFpo0\n")},reflect=function(){return new Promise.PromiseInspection(this._target())},apiRejection=function(msg){return Promise.reject(new TypeError(msg))},util=_dereq_("./util.js");getDomain=util.isNode?function(){var ret=process.domain;return void 0===ret&&(ret=null),ret}:function(){return null},util.notEnumerableProp(Promise,"_getDomain",getDomain);var UNDEFINED_BINDING={},async=_dereq_("./async.js"),errors=_dereq_("./errors.js"),TypeError=Promise.TypeError=errors.TypeError;Promise.RangeError=errors.RangeError,Promise.CancellationError=errors.CancellationError,Promise.TimeoutError=errors.TimeoutError,Promise.OperationalError=errors.OperationalError,Promise.RejectionError=errors.OperationalError,Promise.AggregateError=errors.AggregateError;var INTERNAL=function(){},APPLY={},NEXT_FILTER={e:null},tryConvertToPromise=_dereq_("./thenables.js")(Promise,INTERNAL),PromiseArray=_dereq_("./promise_array.js")(Promise,INTERNAL,tryConvertToPromise,apiRejection),CapturedTrace=_dereq_("./captured_trace.js")(),isDebugging=_dereq_("./debuggability.js")(Promise,CapturedTrace),createContext=_dereq_("./context.js")(Promise,CapturedTrace,isDebugging),CatchFilter=_dereq_("./catch_filter.js")(NEXT_FILTER),PromiseResolver=_dereq_("./promise_resolver.js"),nodebackForPromise=PromiseResolver._nodebackForPromise,errorObj=util.errorObj,tryCatch=util.tryCatch;return Promise.prototype.toString=function(){return"[object Promise]"},Promise.prototype.caught=Promise.prototype.catch=function(fn){var len=arguments.length;if(len>1){var i,catchInstances=new Array(len-1),j=0;for(i=0;i<len-1;++i){var item=arguments[i];if("function"!=typeof item)return Promise.reject(new TypeError("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"));catchInstances[j++]=item}catchInstances.length=j,fn=arguments[i];var catchFilter=new CatchFilter(catchInstances,fn,this);return this._then(void 0,catchFilter.doFilter,void 0,catchFilter,void 0)}return this._then(void 0,fn,void 0,void 0,void 0)},Promise.prototype.reflect=function(){return this._then(reflect,reflect,void 0,this,void 0)},Promise.prototype.then=function(didFulfill,didReject,didProgress){if(isDebugging()&&arguments.length>0&&"function"!=typeof didFulfill&&"function"!=typeof didReject){var msg=".then() only accepts functions but was passed: "+util.classString(didFulfill);arguments.length>1&&(msg+=", "+util.classString(didReject)),this._warn(msg)}return this._then(didFulfill,didReject,didProgress,void 0,void 0)},Promise.prototype.done=function(didFulfill,didReject,didProgress){this._then(didFulfill,didReject,didProgress,void 0,void 0)._setIsFinal()},Promise.prototype.spread=function(didFulfill,didReject){return this.all()._then(didFulfill,didReject,void 0,APPLY,void 0)},Promise.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},Promise.prototype.toJSON=function(){var ret={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(ret.fulfillmentValue=this.value(),ret.isFulfilled=!0):this.isRejected()&&(ret.rejectionReason=this.reason(),ret.isRejected=!0),ret},Promise.prototype.all=function(){return new PromiseArray(this).promise()},Promise.prototype.error=function(fn){return this.caught(util.originatesFromRejection,fn)},Promise.getNewLibraryCopy=module.exports,Promise.is=function(val){return val instanceof Promise},Promise.fromNode=function(fn){var ret=new Promise(INTERNAL),result=tryCatch(fn)(nodebackForPromise(ret));return result===errorObj&&ret._rejectCallback(result.e,!0,!0),ret},Promise.all=function(promises){return new PromiseArray(promises).promise()},Promise.defer=Promise.pending=function(){var promise=new Promise(INTERNAL);return new PromiseResolver(promise)},Promise.cast=function(obj){var ret=tryConvertToPromise(obj);if(!(ret instanceof Promise)){var val=ret;ret=new Promise(INTERNAL),ret._fulfillUnchecked(val)}return ret},Promise.resolve=Promise.fulfilled=Promise.cast,Promise.reject=Promise.rejected=function(reason){var ret=new Promise(INTERNAL);return ret._captureStackTrace(),ret._rejectCallback(reason,!0),ret},Promise.setScheduler=function(fn){if("function"!=typeof fn)throw new TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var prev=async._schedule;return async._schedule=fn,prev},Promise.prototype._then=function(didFulfill,didReject,didProgress,receiver,internalData){var haveInternalData=void 0!==internalData,ret=haveInternalData?internalData:new Promise(INTERNAL);haveInternalData||(ret._propagateFrom(this,5),ret._captureStackTrace());var target=this._target();target!==this&&(void 0===receiver&&(receiver=this._boundTo),haveInternalData||ret._setIsMigrated());var callbackIndex=target._addCallbacks(didFulfill,didReject,didProgress,ret,receiver,getDomain());return target._isResolved()&&!target._isSettlePromisesQueued()&&async.invoke(target._settlePromiseAtPostResolution,target,callbackIndex),ret},Promise.prototype._settlePromiseAtPostResolution=function(index){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),this._settlePromiseAt(index)},Promise.prototype._length=function(){return 131071&this._bitField},Promise.prototype._isFollowingOrFulfilledOrRejected=function(){return(939524096&this._bitField)>0},Promise.prototype._isFollowing=function(){return 536870912==(536870912&this._bitField)},Promise.prototype._setLength=function(len){this._bitField=-131072&this._bitField|131071&len},Promise.prototype._setFulfilled=function(){this._bitField=268435456|this._bitField},Promise.prototype._setRejected=function(){this._bitField=134217728|this._bitField},Promise.prototype._setFollowing=function(){this._bitField=536870912|this._bitField},Promise.prototype._setIsFinal=function(){this._bitField=33554432|this._bitField},Promise.prototype._isFinal=function(){return(33554432&this._bitField)>0},Promise.prototype._cancellable=function(){return(67108864&this._bitField)>0},Promise.prototype._setCancellable=function(){this._bitField=67108864|this._bitField},Promise.prototype._unsetCancellable=function(){this._bitField=-67108865&this._bitField},Promise.prototype._setIsMigrated=function(){this._bitField=4194304|this._bitField},Promise.prototype._unsetIsMigrated=function(){this._bitField=-4194305&this._bitField},Promise.prototype._isMigrated=function(){return(4194304&this._bitField)>0},Promise.prototype._receiverAt=function(index){var ret=0===index?this._receiver0:this[5*index-5+4];if(ret!==UNDEFINED_BINDING)return void 0===ret&&this._isBound()?this._boundValue():ret},Promise.prototype._promiseAt=function(index){return 0===index?this._promise0:this[5*index-5+3]},Promise.prototype._fulfillmentHandlerAt=function(index){return 0===index?this._fulfillmentHandler0:this[5*index-5+0]},Promise.prototype._rejectionHandlerAt=function(index){return 0===index?this._rejectionHandler0:this[5*index-5+1]},Promise.prototype._boundValue=function(){var ret=this._boundTo;return void 0!==ret&&ret instanceof Promise?ret.isFulfilled()?ret.value():void 0:ret},Promise.prototype._migrateCallbacks=function(follower,index){var fulfill=follower._fulfillmentHandlerAt(index),reject=follower._rejectionHandlerAt(index),progress=follower._progressHandlerAt(index),promise=follower._promiseAt(index),receiver=follower._receiverAt(index);promise instanceof Promise&&promise._setIsMigrated(),void 0===receiver&&(receiver=UNDEFINED_BINDING),this._addCallbacks(fulfill,reject,progress,promise,receiver,null)},Promise.prototype._addCallbacks=function(fulfill,reject,progress,promise,receiver,domain){var index=this._length();if(index>=131066&&(index=0,this._setLength(0)),0===index)this._promise0=promise,void 0!==receiver&&(this._receiver0=receiver),"function"!=typeof fulfill||this._isCarryingStackTrace()||(this._fulfillmentHandler0=null===domain?fulfill:domain.bind(fulfill)),"function"==typeof reject&&(this._rejectionHandler0=null===domain?reject:domain.bind(reject)),"function"==typeof progress&&(this._progressHandler0=null===domain?progress:domain.bind(progress));else{var base=5*index-5;this[base+3]=promise,this[base+4]=receiver,"function"==typeof fulfill&&(this[base+0]=null===domain?fulfill:domain.bind(fulfill)),"function"==typeof reject&&(this[base+1]=null===domain?reject:domain.bind(reject)),"function"==typeof progress&&(this[base+2]=null===domain?progress:domain.bind(progress))}return this._setLength(index+1),index},Promise.prototype._setProxyHandlers=function(receiver,promiseSlotValue){var index=this._length();if(index>=131066&&(index=0,this._setLength(0)),0===index)this._promise0=promiseSlotValue,this._receiver0=receiver;else{var base=5*index-5;this[base+3]=promiseSlotValue,this[base+4]=receiver}this._setLength(index+1)},Promise.prototype._proxyPromiseArray=function(promiseArray,index){this._setProxyHandlers(promiseArray,index)},Promise.prototype._resolveCallback=function(value,shouldBind){if(!this._isFollowingOrFulfilledOrRejected()){if(value===this)return this._rejectCallback(makeSelfResolutionError(),!1,!0);var maybePromise=tryConvertToPromise(value,this);if(!(maybePromise instanceof Promise))return this._fulfill(value);var propagationFlags=1|(shouldBind?4:0);this._propagateFrom(maybePromise,propagationFlags);var promise=maybePromise._target();if(promise._isPending()){for(var len=this._length(),i=0;i<len;++i)promise._migrateCallbacks(this,i);this._setFollowing(),this._setLength(0),this._setFollowee(promise)}else promise._isFulfilled()?this._fulfillUnchecked(promise._value()):this._rejectUnchecked(promise._reason(),promise._getCarriedStackTrace())}},Promise.prototype._rejectCallback=function(reason,synchronous,shouldNotMarkOriginatingFromRejection){shouldNotMarkOriginatingFromRejection||util.markAsOriginatingFromRejection(reason);var trace=util.ensureErrorObject(reason),hasStack=trace===reason;this._attachExtraTrace(trace,!!synchronous&&hasStack),this._reject(reason,hasStack?void 0:trace)},Promise.prototype._resolveFromResolver=function(resolver){var promise=this
;this._captureStackTrace(),this._pushContext();var synchronous=!0,r=tryCatch(resolver)(function(value){null!==promise&&(promise._resolveCallback(value),promise=null)},function(reason){null!==promise&&(promise._rejectCallback(reason,synchronous),promise=null)});synchronous=!1,this._popContext(),void 0!==r&&r===errorObj&&null!==promise&&(promise._rejectCallback(r.e,!0,!0),promise=null)},Promise.prototype._settlePromiseFromHandler=function(handler,receiver,value,promise){if(!promise._isRejected()){promise._pushContext();var x;if(x=receiver!==APPLY||this._isRejected()?tryCatch(handler).call(receiver,value):tryCatch(handler).apply(this._boundValue(),value),promise._popContext(),x===errorObj||x===promise||x===NEXT_FILTER){var err=x===promise?makeSelfResolutionError():x.e;promise._rejectCallback(err,!1,!0)}else promise._resolveCallback(x)}},Promise.prototype._target=function(){for(var ret=this;ret._isFollowing();)ret=ret._followee();return ret},Promise.prototype._followee=function(){return this._rejectionHandler0},Promise.prototype._setFollowee=function(promise){this._rejectionHandler0=promise},Promise.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)},Promise.prototype._propagateFrom=function(parent,flags){(1&flags)>0&&parent._cancellable()&&(this._setCancellable(),this._cancellationParent=parent),(4&flags)>0&&parent._isBound()&&this._setBoundTo(parent._boundTo)},Promise.prototype._fulfill=function(value){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(value)},Promise.prototype._reject=function(reason,carriedStackTrace){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(reason,carriedStackTrace)},Promise.prototype._settlePromiseAt=function(index){var promise=this._promiseAt(index),isPromise=promise instanceof Promise;if(isPromise&&promise._isMigrated())return promise._unsetIsMigrated(),async.invoke(this._settlePromiseAt,this,index);var handler=this._isFulfilled()?this._fulfillmentHandlerAt(index):this._rejectionHandlerAt(index),carriedStackTrace=this._isCarryingStackTrace()?this._getCarriedStackTrace():void 0,value=this._settledValue,receiver=this._receiverAt(index);this._clearCallbackDataAtIndex(index),"function"==typeof handler?isPromise?this._settlePromiseFromHandler(handler,receiver,value,promise):handler.call(receiver,value,promise):receiver instanceof PromiseArray?receiver._isResolved()||(this._isFulfilled()?receiver._promiseFulfilled(value,promise):receiver._promiseRejected(value,promise)):isPromise&&(this._isFulfilled()?promise._fulfill(value):promise._reject(value,carriedStackTrace)),index>=4&&4==(31&index)&&async.invokeLater(this._setLength,this,0)},Promise.prototype._clearCallbackDataAtIndex=function(index){if(0===index)this._isCarryingStackTrace()||(this._fulfillmentHandler0=void 0),this._rejectionHandler0=this._progressHandler0=this._receiver0=this._promise0=void 0;else{var base=5*index-5;this[base+3]=this[base+4]=this[base+0]=this[base+1]=this[base+2]=void 0}},Promise.prototype._isSettlePromisesQueued=function(){return-1073741824==(-1073741824&this._bitField)},Promise.prototype._setSettlePromisesQueued=function(){this._bitField=-1073741824|this._bitField},Promise.prototype._unsetSettlePromisesQueued=function(){this._bitField=1073741823&this._bitField},Promise.prototype._queueSettlePromises=function(){async.settlePromises(this),this._setSettlePromisesQueued()},Promise.prototype._fulfillUnchecked=function(value){if(value===this){var err=makeSelfResolutionError();return this._attachExtraTrace(err),this._rejectUnchecked(err,void 0)}this._setFulfilled(),this._settledValue=value,this._cleanValues(),this._length()>0&&this._queueSettlePromises()},Promise.prototype._rejectUncheckedCheckError=function(reason){var trace=util.ensureErrorObject(reason);this._rejectUnchecked(reason,trace===reason?void 0:trace)},Promise.prototype._rejectUnchecked=function(reason,trace){if(reason===this){var err=makeSelfResolutionError();return this._attachExtraTrace(err),this._rejectUnchecked(err)}if(this._setRejected(),this._settledValue=reason,this._cleanValues(),this._isFinal())return void async.throwLater(function(e){throw"stack"in e&&async.invokeFirst(CapturedTrace.unhandledRejection,void 0,e),e},void 0===trace?reason:trace);void 0!==trace&&trace!==reason&&this._setCarriedStackTrace(trace),this._length()>0?this._queueSettlePromises():this._ensurePossibleRejectionHandled()},Promise.prototype._settlePromises=function(){this._unsetSettlePromisesQueued();for(var len=this._length(),i=0;i<len;i++)this._settlePromiseAt(i)},util.notEnumerableProp(Promise,"_makeSelfResolutionError",makeSelfResolutionError),_dereq_("./progress.js")(Promise,PromiseArray),_dereq_("./method.js")(Promise,INTERNAL,tryConvertToPromise,apiRejection),_dereq_("./bind.js")(Promise,INTERNAL,tryConvertToPromise),_dereq_("./finally.js")(Promise,NEXT_FILTER,tryConvertToPromise),_dereq_("./direct_resolve.js")(Promise),_dereq_("./synchronous_inspection.js")(Promise),_dereq_("./join.js")(Promise,PromiseArray,tryConvertToPromise,INTERNAL),Promise.version="2.11.0",Promise.Promise=Promise,_dereq_("./map.js")(Promise,PromiseArray,apiRejection,tryConvertToPromise,INTERNAL),_dereq_("./cancel.js")(Promise),_dereq_("./using.js")(Promise,apiRejection,tryConvertToPromise,createContext),_dereq_("./generators.js")(Promise,apiRejection,INTERNAL,tryConvertToPromise),_dereq_("./nodeify.js")(Promise),_dereq_("./call_get.js")(Promise),_dereq_("./props.js")(Promise,PromiseArray,tryConvertToPromise,apiRejection),_dereq_("./race.js")(Promise,INTERNAL,tryConvertToPromise,apiRejection),_dereq_("./reduce.js")(Promise,PromiseArray,apiRejection,tryConvertToPromise,INTERNAL),_dereq_("./settle.js")(Promise,PromiseArray),_dereq_("./some.js")(Promise,PromiseArray,apiRejection),_dereq_("./promisify.js")(Promise,INTERNAL),_dereq_("./any.js")(Promise),_dereq_("./each.js")(Promise,INTERNAL),_dereq_("./timers.js")(Promise,INTERNAL),_dereq_("./filter.js")(Promise,INTERNAL),util.toFastProperties(Promise),util.toFastProperties(Promise.prototype),fillTypes({a:1}),fillTypes({b:2}),fillTypes({c:3}),fillTypes(1),fillTypes(function(){}),fillTypes(void 0),fillTypes(!1),fillTypes(new Promise(INTERNAL)),CapturedTrace.setBounds(async.firstLineError,util.lastLineError),Promise}},{"./any.js":1,"./async.js":2,"./bind.js":3,"./call_get.js":5,"./cancel.js":6,"./captured_trace.js":7,"./catch_filter.js":8,"./context.js":9,"./debuggability.js":10,"./direct_resolve.js":11,"./each.js":12,"./errors.js":13,"./filter.js":15,"./finally.js":16,"./generators.js":17,"./join.js":18,"./map.js":19,"./method.js":20,"./nodeify.js":21,"./progress.js":22,"./promise_array.js":24,"./promise_resolver.js":25,"./promisify.js":26,"./props.js":27,"./race.js":29,"./reduce.js":30,"./settle.js":32,"./some.js":33,"./synchronous_inspection.js":34,"./thenables.js":35,"./timers.js":36,"./using.js":37,"./util.js":38}],24:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL,tryConvertToPromise,apiRejection){function toResolutionValue(val){switch(val){case-2:return[];case-3:return{}}}function PromiseArray(values){var parent,promise=this._promise=new Promise(INTERNAL);values instanceof Promise&&(parent=values,promise._propagateFrom(parent,5)),this._values=values,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var util=_dereq_("./util.js"),isArray=util.isArray;return PromiseArray.prototype.length=function(){return this._length},PromiseArray.prototype.promise=function(){return this._promise},PromiseArray.prototype._init=function init(_,resolveValueIfEmpty){var values=tryConvertToPromise(this._values,this._promise);if(values instanceof Promise){if(values=values._target(),this._values=values,!values._isFulfilled())return values._isPending()?void values._then(init,this._reject,void 0,this,resolveValueIfEmpty):void this._reject(values._reason());if(values=values._value(),!isArray(values)){var err=new Promise.TypeError("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");return void this.__hardReject__(err)}}else if(!isArray(values))return void this._promise._reject(apiRejection("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n")._reason());if(0===values.length)return void(-5===resolveValueIfEmpty?this._resolveEmptyArray():this._resolve(toResolutionValue(resolveValueIfEmpty)));var len=this.getActualLength(values.length);this._length=len,this._values=this.shouldCopyValues()?new Array(len):this._values;for(var promise=this._promise,i=0;i<len;++i){var isResolved=this._isResolved(),maybePromise=tryConvertToPromise(values[i],promise);maybePromise instanceof Promise?(maybePromise=maybePromise._target(),isResolved?maybePromise._ignoreRejections():maybePromise._isPending()?maybePromise._proxyPromiseArray(this,i):maybePromise._isFulfilled()?this._promiseFulfilled(maybePromise._value(),i):this._promiseRejected(maybePromise._reason(),i)):isResolved||this._promiseFulfilled(maybePromise,i)}},PromiseArray.prototype._isResolved=function(){return null===this._values},PromiseArray.prototype._resolve=function(value){this._values=null,this._promise._fulfill(value)},PromiseArray.prototype.__hardReject__=PromiseArray.prototype._reject=function(reason){this._values=null,this._promise._rejectCallback(reason,!1,!0)},PromiseArray.prototype._promiseProgressed=function(progressValue,index){this._promise._progress({index:index,value:progressValue})},PromiseArray.prototype._promiseFulfilled=function(value,index){this._values[index]=value,++this._totalResolved>=this._length&&this._resolve(this._values)},PromiseArray.prototype._promiseRejected=function(reason,index){this._totalResolved++,this._reject(reason)},PromiseArray.prototype.shouldCopyValues=function(){return!0},PromiseArray.prototype.getActualLength=function(len){return len},PromiseArray}},{"./util.js":38}],25:[function(_dereq_,module,exports){"use strict";function isUntypedError(obj){return obj instanceof Error&&es5.getPrototypeOf(obj)===Error.prototype}function wrapAsOperationalError(obj){var ret;if(isUntypedError(obj)){ret=new OperationalError(obj),ret.name=obj.name,ret.message=obj.message,ret.stack=obj.stack;for(var keys=es5.keys(obj),i=0;i<keys.length;++i){var key=keys[i];rErrorKey.test(key)||(ret[key]=obj[key])}return ret}return util.markAsOriginatingFromRejection(obj),obj}function nodebackForPromise(promise){return function(err,value){if(null!==promise){if(err){var wrapped=wrapAsOperationalError(maybeWrapAsError(err));promise._attachExtraTrace(wrapped),promise._reject(wrapped)}else if(arguments.length>2){for(var $_len=arguments.length,args=new Array($_len-1),$_i=1;$_i<$_len;++$_i)args[$_i-1]=arguments[$_i];promise._fulfill(args)}else promise._fulfill(value);promise=null}}}var PromiseResolver,util=_dereq_("./util.js"),maybeWrapAsError=util.maybeWrapAsError,errors=_dereq_("./errors.js"),TimeoutError=errors.TimeoutError,OperationalError=errors.OperationalError,haveGetters=util.haveGetters,es5=_dereq_("./es5.js"),rErrorKey=/^(?:name|message|stack|cause)$/;if(PromiseResolver=haveGetters?function(promise){this.promise=promise}:function(promise){this.promise=promise,this.asCallback=nodebackForPromise(promise),this.callback=this.asCallback},haveGetters){var prop={get:function(){return nodebackForPromise(this.promise)}};es5.defineProperty(PromiseResolver.prototype,"asCallback",prop),es5.defineProperty(PromiseResolver.prototype,"callback",prop)}PromiseResolver._nodebackForPromise=nodebackForPromise,PromiseResolver.prototype.toString=function(){return"[object PromiseResolver]"},PromiseResolver.prototype.resolve=PromiseResolver.prototype.fulfill=function(value){if(!(this instanceof PromiseResolver))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._resolveCallback(value)},PromiseResolver.prototype.reject=function(reason){if(!(this instanceof PromiseResolver))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._rejectCallback(reason)},PromiseResolver.prototype.progress=function(value){if(!(this instanceof PromiseResolver))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._progress(value)},PromiseResolver.prototype.cancel=function(err){this.promise.cancel(err)},PromiseResolver.prototype.timeout=function(){this.reject(new TimeoutError("timeout"))},PromiseResolver.prototype.isResolved=function(){return this.promise.isResolved()},PromiseResolver.prototype.toJSON=function(){return this.promise.toJSON()},module.exports=PromiseResolver},{"./errors.js":13,"./es5.js":14,"./util.js":38}],26:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){function propsFilter(key){return!noCopyPropsPattern.test(key)}function isPromisified(fn){try{return!0===fn.__isPromisified__}catch(e){return!1}}function hasPromisified(obj,key,suffix){var val=util.getDataPropertyOrDefault(obj,key+suffix,defaultPromisified);return!!val&&isPromisified(val)}function checkValid(ret,suffix,suffixRegexp){for(var i=0;i<ret.length;i+=2){var key=ret[i];if(suffixRegexp.test(key))for(var keyWithoutAsyncSuffix=key.replace(suffixRegexp,""),j=0;j<ret.length;j+=2)if(ret[j]===keyWithoutAsyncSuffix)throw new TypeError("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/iWrZbw\n".replace("%s",suffix))}}function promisifiableMethods(obj,suffix,suffixRegexp,filter){for(var keys=util.inheritedDataKeys(obj),ret=[],i=0;i<keys.length;++i){var key=keys[i],value=obj[key],passesDefaultFilter=filter===defaultFilter||defaultFilter(key,value,obj);"function"!=typeof value||isPromisified(value)||hasPromisified(obj,key,suffix)||!filter(key,value,obj,passesDefaultFilter)||ret.push(key,value)}return checkValid(ret,suffix,suffixRegexp),ret}function makeNodePromisifiedClosure(callback,receiver,_,fn){function promisified(){var _receiver=receiver;receiver===THIS&&(_receiver=this);var promise=new Promise(INTERNAL);promise._captureStackTrace();var cb="string"==typeof method&&this!==defaultThis?this[method]:callback,fn=nodebackForPromise(promise);try{cb.apply(_receiver,withAppended(arguments,fn))}catch(e){promise._rejectCallback(maybeWrapAsError(e),!0,!0)}return promise}var defaultThis=function(){return this}(),method=callback;return"string"==typeof method&&(callback=fn),util.notEnumerableProp(promisified,"__isPromisified__",!0),promisified}function promisifyAll(obj,suffix,filter,promisifier){for(var suffixRegexp=new RegExp(escapeIdentRegex(suffix)+"$"),methods=promisifiableMethods(obj,suffix,suffixRegexp,filter),i=0,len=methods.length;i<len;i+=2){var key=methods[i],fn=methods[i+1],promisifiedKey=key+suffix;if(promisifier===makeNodePromisified)obj[promisifiedKey]=makeNodePromisified(key,THIS,key,fn,suffix);else{var promisified=promisifier(fn,function(){return makeNodePromisified(key,THIS,key,fn,suffix)});util.notEnumerableProp(promisified,"__isPromisified__",!0),obj[promisifiedKey]=promisified}}return util.toFastProperties(obj),obj}function promisify(callback,receiver){return makeNodePromisified(callback,receiver,void 0,callback)}var makeNodePromisifiedEval,THIS={},util=_dereq_("./util.js"),nodebackForPromise=_dereq_("./promise_resolver.js")._nodebackForPromise,withAppended=util.withAppended,maybeWrapAsError=util.maybeWrapAsError,canEvaluate=util.canEvaluate,TypeError=_dereq_("./errors").TypeError,defaultPromisified={__isPromisified__:!0},noCopyProps=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],noCopyPropsPattern=new RegExp("^(?:"+noCopyProps.join("|")+")$"),defaultFilter=function(name){return util.isIdentifier(name)&&"_"!==name.charAt(0)&&"constructor"!==name},escapeIdentRegex=function(str){return str.replace(/([$])/,"\\$")},makeNodePromisified=canEvaluate?makeNodePromisifiedEval:makeNodePromisifiedClosure;Promise.promisify=function(fn,receiver){if("function"!=typeof fn)throw new TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");if(isPromisified(fn))return fn;var ret=promisify(fn,arguments.length<2?THIS:receiver);return util.copyDescriptors(fn,ret,propsFilter),ret},Promise.promisifyAll=function(target,options){if("function"!=typeof target&&"object"!=typeof target)throw new TypeError("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/9ITlV0\n");options=Object(options);var suffix=options.suffix;"string"!=typeof suffix&&(suffix="Async");var filter=options.filter;"function"!=typeof filter&&(filter=defaultFilter);var promisifier=options.promisifier;if("function"!=typeof promisifier&&(promisifier=makeNodePromisified),!util.isIdentifier(suffix))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/8FZo5V\n");for(var keys=util.inheritedDataKeys(target),i=0;i<keys.length;++i){var value=target[keys[i]];"constructor"!==keys[i]&&util.isClass(value)&&(promisifyAll(value.prototype,suffix,filter,promisifier),promisifyAll(value,suffix,filter,promisifier))}return promisifyAll(target,suffix,filter,promisifier)}}},{"./errors":13,"./promise_resolver.js":25,"./util.js":38}],27:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,tryConvertToPromise,apiRejection){function PropertiesPromiseArray(obj){for(var keys=es5.keys(obj),len=keys.length,values=new Array(2*len),i=0;i<len;++i){var key=keys[i];values[i]=obj[key],values[i+len]=key}this.constructor$(values)}function props(promises){var ret,castValue=tryConvertToPromise(promises);return isObject(castValue)?(ret=castValue instanceof Promise?castValue._then(Promise.props,void 0,void 0,void 0,void 0):new PropertiesPromiseArray(castValue).promise(),castValue instanceof Promise&&ret._propagateFrom(castValue,4),ret):apiRejection("cannot await properties of a non-object\n\n    See http://goo.gl/OsFKC8\n")}var util=_dereq_("./util.js"),isObject=util.isObject,es5=_dereq_("./es5.js");util.inherits(PropertiesPromiseArray,PromiseArray),PropertiesPromiseArray.prototype._init=function(){this._init$(void 0,-3)},PropertiesPromiseArray.prototype._promiseFulfilled=function(value,index){if(this._values[index]=value,++this._totalResolved>=this._length){for(var val={},keyOffset=this.length(),i=0,len=this.length();i<len;++i)val[this._values[i+keyOffset]]=this._values[i];this._resolve(val)}},PropertiesPromiseArray.prototype._promiseProgressed=function(value,index){this._promise._progress({key:this._values[index+this.length()],value:value})},PropertiesPromiseArray.prototype.shouldCopyValues=function(){return!1},PropertiesPromiseArray.prototype.getActualLength=function(len){return len>>1},Promise.prototype.props=function(){return props(this)},Promise.props=function(promises){return props(promises)}}},{"./es5.js":14,"./util.js":38}],28:[function(_dereq_,module,exports){"use strict";function arrayMove(src,srcIndex,dst,dstIndex,len){for(var j=0;j<len;++j)dst[j+dstIndex]=src[j+srcIndex],src[j+srcIndex]=void 0}function Queue(capacity){this._capacity=capacity,this._length=0,this._front=0}Queue.prototype._willBeOverCapacity=function(size){return this._capacity<size},Queue.prototype._pushOne=function(arg){var length=this.length();this._checkCapacity(length+1),this[this._front+length&this._capacity-1]=arg,this._length=length+1},Queue.prototype._unshiftOne=function(value){var capacity=this._capacity;this._checkCapacity(this.length()+1);var front=this._front,i=(front-1&capacity-1^capacity)-capacity;this[i]=value,this._front=i,this._length=this.length()+1},Queue.prototype.unshift=function(fn,receiver,arg){this._unshiftOne(arg),this._unshiftOne(receiver),this._unshiftOne(fn)},Queue.prototype.push=function(fn,receiver,arg){var length=this.length()+3;if(this._willBeOverCapacity(length))return this._pushOne(fn),this._pushOne(receiver),void this._pushOne(arg);var j=this._front+length-3;this._checkCapacity(length);var wrapMask=this._capacity-1;this[j+0&wrapMask]=fn,this[j+1&wrapMask]=receiver,this[j+2&wrapMask]=arg,this._length=length},Queue.prototype.shift=function(){var front=this._front,ret=this[front];return this[front]=void 0,this._front=front+1&this._capacity-1,this._length--,ret},Queue.prototype.length=function(){return this._length},Queue.prototype._checkCapacity=function(size){this._capacity<size&&this._resizeTo(this._capacity<<1)},Queue.prototype._resizeTo=function(capacity){var oldCapacity=this._capacity;this._capacity=capacity,arrayMove(this,0,this,oldCapacity,this._front+this._length&oldCapacity-1)},module.exports=Queue},{}],29:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL,tryConvertToPromise,apiRejection){function race(promises,parent){var maybePromise=tryConvertToPromise(promises);if(maybePromise instanceof Promise)return raceLater(maybePromise);if(!isArray(promises))return apiRejection("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");var ret=new Promise(INTERNAL);void 0!==parent&&ret._propagateFrom(parent,5);for(var fulfill=ret._fulfill,reject=ret._reject,i=0,len=promises.length;i<len;++i){var val=promises[i];(void 0!==val||i in promises)&&Promise.cast(val)._then(fulfill,reject,void 0,ret,null)}return ret}var isArray=_dereq_("./util.js").isArray,raceLater=function(promise){return promise.then(function(array){return race(array,promise)})};Promise.race=function(promises){return race(promises,void 0)},Promise.prototype.race=function(){return race(this,void 0)}}},{"./util.js":38}],30:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,apiRejection,tryConvertToPromise,INTERNAL){function ReductionPromiseArray(promises,fn,accum,_each){this.constructor$(promises),this._promise._captureStackTrace(),this._preservedValues=_each===INTERNAL?[]:null,this._zerothIsAccum=void 0===accum,this._gotAccum=!1,this._reducingIndex=this._zerothIsAccum?1:0,this._valuesPhase=void 0;var maybePromise=tryConvertToPromise(accum,this._promise),rejected=!1,isPromise=maybePromise instanceof Promise;isPromise&&(maybePromise=maybePromise._target(),maybePromise._isPending()?maybePromise._proxyPromiseArray(this,-1):maybePromise._isFulfilled()?(accum=maybePromise._value(),this._gotAccum=!0):(this._reject(maybePromise._reason()),rejected=!0)),isPromise||this._zerothIsAccum||(this._gotAccum=!0);var domain=getDomain();this._callback=null===domain?fn:domain.bind(fn),this._accum=accum,rejected||async.invoke(init,this,void 0)}function init(){this._init$(void 0,-5)}function reduce(promises,fn,initialValue,_each){return"function"!=typeof fn?apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):new ReductionPromiseArray(promises,fn,initialValue,_each).promise()}var getDomain=Promise._getDomain,async=_dereq_("./async.js"),util=_dereq_("./util.js"),tryCatch=util.tryCatch,errorObj=util.errorObj;util.inherits(ReductionPromiseArray,PromiseArray),ReductionPromiseArray.prototype._init=function(){},ReductionPromiseArray.prototype._resolveEmptyArray=function(){(this._gotAccum||this._zerothIsAccum)&&this._resolve(null!==this._preservedValues?[]:this._accum)},ReductionPromiseArray.prototype._promiseFulfilled=function(value,index){var values=this._values;values[index]=value;var valuesPhaseIndex,length=this.length(),preservedValues=this._preservedValues,isEach=null!==preservedValues,gotAccum=this._gotAccum,valuesPhase=this._valuesPhase;if(!valuesPhase)for(valuesPhase=this._valuesPhase=new Array(length),valuesPhaseIndex=0;valuesPhaseIndex<length;++valuesPhaseIndex)valuesPhase[valuesPhaseIndex]=0;if(valuesPhaseIndex=valuesPhase[index],0===index&&this._zerothIsAccum?(this._accum=value,this._gotAccum=gotAccum=!0,valuesPhase[index]=0===valuesPhaseIndex?1:2):-1===index?(this._accum=value,this._gotAccum=gotAccum=!0):0===valuesPhaseIndex?valuesPhase[index]=1:(valuesPhase[index]=2,this._accum=value),gotAccum){for(var ret,callback=this._callback,receiver=this._promise._boundValue(),i=this._reducingIndex;i<length;++i)if(2!==(valuesPhaseIndex=valuesPhase[i])){if(1!==valuesPhaseIndex)return;if(value=values[i],this._promise._pushContext(),isEach?(preservedValues.push(value),ret=tryCatch(callback).call(receiver,value,i,length)):ret=tryCatch(callback).call(receiver,this._accum,value,i,length),this._promise._popContext(),ret===errorObj)return this._reject(ret.e);var maybePromise=tryConvertToPromise(ret,this._promise);if(maybePromise instanceof Promise){if(maybePromise=maybePromise._target(),maybePromise._isPending())return valuesPhase[i]=4,maybePromise._proxyPromiseArray(this,i);if(!maybePromise._isFulfilled())return this._reject(maybePromise._reason());ret=maybePromise._value()}this._reducingIndex=i+1,this._accum=ret}else this._reducingIndex=i+1;this._resolve(isEach?preservedValues:this._accum)}},Promise.prototype.reduce=function(fn,initialValue){return reduce(this,fn,initialValue,null)},Promise.reduce=function(promises,fn,initialValue,_each){return reduce(promises,fn,initialValue,_each)}}},{"./async.js":2,"./util.js":38}],31:[function(_dereq_,module,exports){"use strict";var schedule,util=_dereq_("./util"),noAsyncScheduler=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")};if(util.isNode&&"undefined"==typeof MutationObserver){var GlobalSetImmediate=global.setImmediate,ProcessNextTick=process.nextTick;schedule=util.isRecentNode?function(fn){GlobalSetImmediate.call(global,fn)}:function(fn){ProcessNextTick.call(process,fn)}}else"undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&window.navigator.standalone?schedule="undefined"!=typeof setImmediate?function(fn){setImmediate(fn)}:"undefined"!=typeof setTimeout?function(fn){setTimeout(fn,0)}:noAsyncScheduler:(schedule=function(fn){var div=document.createElement("div");return new MutationObserver(fn).observe(div,{attributes:!0}),function(){div.classList.toggle("foo")}},schedule.isStatic=!0);module.exports=schedule},{"./util":38}],32:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray){function SettledPromiseArray(values){this.constructor$(values)}var PromiseInspection=Promise.PromiseInspection;_dereq_("./util.js").inherits(SettledPromiseArray,PromiseArray),SettledPromiseArray.prototype._promiseResolved=function(index,inspection){this._values[index]=inspection,++this._totalResolved>=this._length&&this._resolve(this._values)},SettledPromiseArray.prototype._promiseFulfilled=function(value,index){var ret=new PromiseInspection;ret._bitField=268435456,ret._settledValue=value,this._promiseResolved(index,ret)},SettledPromiseArray.prototype._promiseRejected=function(reason,index){var ret=new PromiseInspection;ret._bitField=134217728,ret._settledValue=reason,this._promiseResolved(index,ret)},Promise.settle=function(promises){return new SettledPromiseArray(promises).promise()},Promise.prototype.settle=function(){return new SettledPromiseArray(this).promise()}}},{"./util.js":38}],33:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,apiRejection){function SomePromiseArray(values){this.constructor$(values),this._howMany=0,this._unwrap=!1,this._initialized=!1}function some(promises,howMany){if((0|howMany)!==howMany||howMany<0)return apiRejection("expecting a positive integer\n\n    See http://goo.gl/1wAmHx\n");var ret=new SomePromiseArray(promises),promise=ret.promise();return ret.setHowMany(howMany),ret.init(),promise}var util=_dereq_("./util.js"),RangeError=_dereq_("./errors.js").RangeError,AggregateError=_dereq_("./errors.js").AggregateError,isArray=util.isArray;util.inherits(SomePromiseArray,PromiseArray),SomePromiseArray.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var isArrayResolved=isArray(this._values);!this._isResolved()&&isArrayResolved&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},SomePromiseArray.prototype.init=function(){this._initialized=!0,this._init()},SomePromiseArray.prototype.setUnwrap=function(){this._unwrap=!0},SomePromiseArray.prototype.howMany=function(){return this._howMany},SomePromiseArray.prototype.setHowMany=function(count){this._howMany=count},SomePromiseArray.prototype._promiseFulfilled=function(value){this._addFulfilled(value),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values))},SomePromiseArray.prototype._promiseRejected=function(reason){if(this._addRejected(reason),this.howMany()>this._canPossiblyFulfill()){for(var e=new AggregateError,i=this.length();i<this._values.length;++i)e.push(this._values[i]);this._reject(e)}},SomePromiseArray.prototype._fulfilled=function(){return this._totalResolved},SomePromiseArray.prototype._rejected=function(){return this._values.length-this.length()},SomePromiseArray.prototype._addRejected=function(reason){this._values.push(reason)},SomePromiseArray.prototype._addFulfilled=function(value){this._values[this._totalResolved++]=value},SomePromiseArray.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},SomePromiseArray.prototype._getRangeError=function(count){var message="Input array must contain at least "+this._howMany+" items but contains only "+count+" items";return new RangeError(message)},SomePromiseArray.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},Promise.some=function(promises,howMany){return some(promises,howMany)},Promise.prototype.some=function(howMany){return some(this,howMany)},Promise._SomePromiseArray=SomePromiseArray}},{"./errors.js":13,"./util.js":38}],34:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise){function PromiseInspection(promise){void 0!==promise?(promise=promise._target(),this._bitField=promise._bitField,this._settledValue=promise._settledValue):(this._bitField=0,this._settledValue=void 0)}PromiseInspection.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return this._settledValue},PromiseInspection.prototype.error=PromiseInspection.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return this._settledValue},PromiseInspection.prototype.isFulfilled=Promise.prototype._isFulfilled=function(){return(268435456&this._bitField)>0},PromiseInspection.prototype.isRejected=Promise.prototype._isRejected=function(){return(134217728&this._bitField)>0},PromiseInspection.prototype.isPending=Promise.prototype._isPending=function(){return 0==(402653184&this._bitField)},PromiseInspection.prototype.isResolved=Promise.prototype._isResolved=function(){return(402653184&this._bitField)>0},Promise.prototype.isPending=function(){return this._target()._isPending()},Promise.prototype.isRejected=function(){return this._target()._isRejected()},Promise.prototype.isFulfilled=function(){return this._target()._isFulfilled()},Promise.prototype.isResolved=function(){return this._target()._isResolved()},Promise.prototype._value=function(){return this._settledValue},Promise.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue},Promise.prototype.value=function(){var target=this._target();if(!target.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return target._settledValue},Promise.prototype.reason=function(){var target=this._target();if(!target.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n")
;return target._unsetRejectionIsUnhandled(),target._settledValue},Promise.PromiseInspection=PromiseInspection}},{}],35:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){function tryConvertToPromise(obj,context){if(isObject(obj)){if(obj instanceof Promise)return obj;if(isAnyBluebirdPromise(obj)){var ret=new Promise(INTERNAL);return obj._then(ret._fulfillUnchecked,ret._rejectUncheckedCheckError,ret._progressUnchecked,ret,null),ret}var then=util.tryCatch(getThen)(obj);if(then===errorObj){context&&context._pushContext();var ret=Promise.reject(then.e);return context&&context._popContext(),ret}if("function"==typeof then)return doThenable(obj,then,context)}return obj}function getThen(obj){return obj.then}function isAnyBluebirdPromise(obj){return hasProp.call(obj,"_promise0")}function doThenable(x,then,context){function resolveFromThenable(value){promise&&(promise._resolveCallback(value),promise=null)}function rejectFromThenable(reason){promise&&(promise._rejectCallback(reason,synchronous,!0),promise=null)}function progressFromThenable(value){promise&&"function"==typeof promise._progress&&promise._progress(value)}var promise=new Promise(INTERNAL),ret=promise;context&&context._pushContext(),promise._captureStackTrace(),context&&context._popContext();var synchronous=!0,result=util.tryCatch(then).call(x,resolveFromThenable,rejectFromThenable,progressFromThenable);return synchronous=!1,promise&&result===errorObj&&(promise._rejectCallback(result.e,!0,!0),promise=null),ret}var util=_dereq_("./util.js"),errorObj=util.errorObj,isObject=util.isObject,hasProp={}.hasOwnProperty;return tryConvertToPromise}},{"./util.js":38}],36:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){function successClear(value){var handle=this;return handle instanceof Number&&(handle=+handle),clearTimeout(handle),value}function failureClear(reason){var handle=this;throw handle instanceof Number&&(handle=+handle),clearTimeout(handle),reason}var util=_dereq_("./util.js"),TimeoutError=Promise.TimeoutError,afterTimeout=function(promise,message){if(promise.isPending()){var err;!util.isPrimitive(message)&&message instanceof Error?err=message:("string"!=typeof message&&(message="operation timed out"),err=new TimeoutError(message)),util.markAsOriginatingFromRejection(err),promise._attachExtraTrace(err),promise._cancel(err)}},afterValue=function(value){return delay(+this).thenReturn(value)},delay=Promise.delay=function(value,ms){if(void 0===ms){ms=value,value=void 0;var ret=new Promise(INTERNAL);return setTimeout(function(){ret._fulfill()},ms),ret}return ms=+ms,Promise.resolve(value)._then(afterValue,null,null,ms,void 0)};Promise.prototype.delay=function(ms){return delay(this,ms)},Promise.prototype.timeout=function(ms,message){ms=+ms;var ret=this.then().cancellable();ret._cancellationParent=this;var handle=setTimeout(function(){afterTimeout(ret,message)},ms);return ret._then(successClear,failureClear,void 0,handle,void 0)}}},{"./util.js":38}],37:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,apiRejection,tryConvertToPromise,createContext){function inspectionMapper(inspections){for(var len=inspections.length,i=0;i<len;++i){var inspection=inspections[i];if(inspection.isRejected())return Promise.reject(inspection.error());inspections[i]=inspection._settledValue}return inspections}function thrower(e){setTimeout(function(){throw e},0)}function castPreservingDisposable(thenable){var maybePromise=tryConvertToPromise(thenable);return maybePromise!==thenable&&"function"==typeof thenable._isDisposable&&"function"==typeof thenable._getDisposer&&thenable._isDisposable()&&maybePromise._setDisposable(thenable._getDisposer()),maybePromise}function dispose(resources,inspection){function iterator(){if(i>=len)return ret.resolve();var maybePromise=castPreservingDisposable(resources[i++]);if(maybePromise instanceof Promise&&maybePromise._isDisposable()){try{maybePromise=tryConvertToPromise(maybePromise._getDisposer().tryDispose(inspection),resources.promise)}catch(e){return thrower(e)}if(maybePromise instanceof Promise)return maybePromise._then(iterator,thrower,null,null,null)}iterator()}var i=0,len=resources.length,ret=Promise.defer();return iterator(),ret.promise}function disposerSuccess(value){var inspection=new PromiseInspection;return inspection._settledValue=value,inspection._bitField=268435456,dispose(this,inspection).thenReturn(value)}function disposerFail(reason){var inspection=new PromiseInspection;return inspection._settledValue=reason,inspection._bitField=134217728,dispose(this,inspection).thenThrow(reason)}function Disposer(data,promise,context){this._data=data,this._promise=promise,this._context=context}function FunctionDisposer(fn,promise,context){this.constructor$(fn,promise,context)}function maybeUnwrapDisposer(value){return Disposer.isDisposer(value)?(this.resources[this.index]._setDisposable(value),value.promise()):value}var TypeError=_dereq_("./errors.js").TypeError,inherits=_dereq_("./util.js").inherits,PromiseInspection=Promise.PromiseInspection;Disposer.prototype.data=function(){return this._data},Disposer.prototype.promise=function(){return this._promise},Disposer.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null},Disposer.prototype.tryDispose=function(inspection){var resource=this.resource(),context=this._context;void 0!==context&&context._pushContext();var ret=null!==resource?this.doDispose(resource,inspection):null;return void 0!==context&&context._popContext(),this._promise._unsetDisposable(),this._data=null,ret},Disposer.isDisposer=function(d){return null!=d&&"function"==typeof d.resource&&"function"==typeof d.tryDispose},inherits(FunctionDisposer,Disposer),FunctionDisposer.prototype.doDispose=function(resource,inspection){return this.data().call(resource,resource,inspection)},Promise.using=function(){var len=arguments.length;if(len<2)return apiRejection("you must pass at least 2 arguments to Promise.using");var fn=arguments[len-1];if("function"!=typeof fn)return apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var input,spreadArgs=!0;2===len&&Array.isArray(arguments[0])?(input=arguments[0],len=input.length,spreadArgs=!1):(input=arguments,len--);for(var resources=new Array(len),i=0;i<len;++i){var resource=input[i];if(Disposer.isDisposer(resource)){var disposer=resource;resource=resource.promise(),resource._setDisposable(disposer)}else{var maybePromise=tryConvertToPromise(resource);maybePromise instanceof Promise&&(resource=maybePromise._then(maybeUnwrapDisposer,null,null,{resources:resources,index:i},void 0))}resources[i]=resource}var promise=Promise.settle(resources).then(inspectionMapper).then(function(vals){promise._pushContext();var ret;try{ret=spreadArgs?fn.apply(void 0,vals):fn.call(void 0,vals)}finally{promise._popContext()}return ret})._then(disposerSuccess,disposerFail,void 0,resources,void 0);return resources.promise=promise,promise},Promise.prototype._setDisposable=function(disposer){this._bitField=262144|this._bitField,this._disposer=disposer},Promise.prototype._isDisposable=function(){return(262144&this._bitField)>0},Promise.prototype._getDisposer=function(){return this._disposer},Promise.prototype._unsetDisposable=function(){this._bitField=-262145&this._bitField,this._disposer=void 0},Promise.prototype.disposer=function(fn){if("function"==typeof fn)return new FunctionDisposer(fn,this,createContext());throw new TypeError}}},{"./errors.js":13,"./util.js":38}],38:[function(_dereq_,module,exports){"use strict";function tryCatcher(){try{var target=tryCatchTarget;return tryCatchTarget=null,target.apply(this,arguments)}catch(e){return errorObj.e=e,errorObj}}function tryCatch(fn){return tryCatchTarget=fn,tryCatcher}function isPrimitive(val){return null==val||!0===val||!1===val||"string"==typeof val||"number"==typeof val}function isObject(value){return!isPrimitive(value)}function maybeWrapAsError(maybeError){return isPrimitive(maybeError)?new Error(safeToString(maybeError)):maybeError}function withAppended(target,appendee){var i,len=target.length,ret=new Array(len+1);for(i=0;i<len;++i)ret[i]=target[i];return ret[i]=appendee,ret}function getDataPropertyOrDefault(obj,key,defaultValue){if(!es5.isES5)return{}.hasOwnProperty.call(obj,key)?obj[key]:void 0;var desc=Object.getOwnPropertyDescriptor(obj,key);return null!=desc?null==desc.get&&null==desc.set?desc.value:defaultValue:void 0}function notEnumerableProp(obj,name,value){if(isPrimitive(obj))return obj;var descriptor={value:value,configurable:!0,enumerable:!1,writable:!0};return es5.defineProperty(obj,name,descriptor),obj}function thrower(r){throw r}function isClass(fn){try{if("function"==typeof fn){var keys=es5.names(fn.prototype),hasMethods=es5.isES5&&keys.length>1,hasMethodsOtherThanConstructor=keys.length>0&&!(1===keys.length&&"constructor"===keys[0]),hasThisAssignmentAndStaticMethods=thisAssignmentPattern.test(fn+"")&&es5.names(fn).length>0;if(hasMethods||hasMethodsOtherThanConstructor||hasThisAssignmentAndStaticMethods)return!0}return!1}catch(e){return!1}}function toFastProperties(obj){function f(){}f.prototype=obj;for(var l=8;l--;)new f;return obj}function isIdentifier(str){return rident.test(str)}function filledRange(count,prefix,suffix){for(var ret=new Array(count),i=0;i<count;++i)ret[i]=prefix+i+suffix;return ret}function safeToString(obj){try{return obj+""}catch(e){return"[no string representation]"}}function markAsOriginatingFromRejection(e){try{notEnumerableProp(e,"isOperational",!0)}catch(ignore){}}function originatesFromRejection(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===e.isOperational)}function canAttachTrace(obj){return obj instanceof Error&&es5.propertyIsWritable(obj,"stack")}function classString(obj){return{}.toString.call(obj)}function copyDescriptors(from,to,filter){for(var keys=es5.names(from),i=0;i<keys.length;++i){var key=keys[i];if(filter(key))try{es5.defineProperty(to,key,es5.getDescriptor(from,key))}catch(ignore){}}}var es5=_dereq_("./es5.js"),canEvaluate="undefined"==typeof navigator,haveGetters=function(){try{var o={};return es5.defineProperty(o,"f",{get:function(){return 3}}),3===o.f}catch(e){return!1}}(),errorObj={e:{}},tryCatchTarget,inherits=function(Child,Parent){function T(){this.constructor=Child,this.constructor$=Parent;for(var propertyName in Parent.prototype)hasProp.call(Parent.prototype,propertyName)&&"$"!==propertyName.charAt(propertyName.length-1)&&(this[propertyName+"$"]=Parent.prototype[propertyName])}var hasProp={}.hasOwnProperty;return T.prototype=Parent.prototype,Child.prototype=new T,Child.prototype},inheritedDataKeys=function(){var excludedPrototypes=[Array.prototype,Object.prototype,Function.prototype],isExcludedProto=function(val){for(var i=0;i<excludedPrototypes.length;++i)if(excludedPrototypes[i]===val)return!0;return!1};if(es5.isES5){var getKeys=Object.getOwnPropertyNames;return function(obj){for(var ret=[],visitedKeys=Object.create(null);null!=obj&&!isExcludedProto(obj);){var keys;try{keys=getKeys(obj)}catch(e){return ret}for(var i=0;i<keys.length;++i){var key=keys[i];if(!visitedKeys[key]){visitedKeys[key]=!0;var desc=Object.getOwnPropertyDescriptor(obj,key);null!=desc&&null==desc.get&&null==desc.set&&ret.push(key)}}obj=es5.getPrototypeOf(obj)}return ret}}var hasProp={}.hasOwnProperty;return function(obj){if(isExcludedProto(obj))return[];var ret=[];enumeration:for(var key in obj)if(hasProp.call(obj,key))ret.push(key);else{for(var i=0;i<excludedPrototypes.length;++i)if(hasProp.call(excludedPrototypes[i],key))continue enumeration;ret.push(key)}return ret}}(),thisAssignmentPattern=/this\s*\.\s*\S+\s*=/,rident=/^[a-z$_][a-z$_0-9]*$/i,ensureErrorObject=function(){return"stack"in new Error?function(value){return canAttachTrace(value)?value:new Error(safeToString(value))}:function(value){if(canAttachTrace(value))return value;try{throw new Error(safeToString(value))}catch(err){return err}}}(),ret={isClass:isClass,isIdentifier:isIdentifier,inheritedDataKeys:inheritedDataKeys,getDataPropertyOrDefault:getDataPropertyOrDefault,thrower:thrower,isArray:es5.isArray,haveGetters:haveGetters,notEnumerableProp:notEnumerableProp,isPrimitive:isPrimitive,isObject:isObject,canEvaluate:canEvaluate,errorObj:errorObj,tryCatch:tryCatch,inherits:inherits,withAppended:withAppended,maybeWrapAsError:maybeWrapAsError,toFastProperties:toFastProperties,filledRange:filledRange,toString:safeToString,canAttachTrace:canAttachTrace,ensureErrorObject:ensureErrorObject,originatesFromRejection:originatesFromRejection,markAsOriginatingFromRejection:markAsOriginatingFromRejection,classString:classString,copyDescriptors:copyDescriptors,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:"undefined"!=typeof process&&"[object process]"===classString(process).toLowerCase()};ret.isRecentNode=ret.isNode&&function(){var version=process.versions.node.split(".").map(Number);return 0===version[0]&&version[1]>10||version[0]>0}(),ret.isNode&&ret.toFastProperties(process);try{throw new Error}catch(e){ret.lastLineError=e}module.exports=ret},{"./es5.js":14}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise),function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory(require("Promise")):"function"==typeof define&&define.amd?define("wixmp",["Promise"],factory):"object"==typeof exports?exports.wixmp=factory(require("Promise")):root.wixmp=factory(root.Promise)}("undefined"!=typeof self?self:this,function(__WEBPACK_EXTERNAL_MODULE_27__){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};if(__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__.p="undefined"!=typeof window&&window.__STATICS_BASE_URL__||__webpack_require__.p,"undefined"!=typeof document){var style=document.getElementById("wixmp-sdk.stylable.bundle.css");style||(style=document.createElement("style"),style.id="wixmp-sdk.stylable.bundle.css",document.head.appendChild(style)),style.textContent=""}return __webpack_require__(__webpack_require__.s=69)}([function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function minMaxFinder(method,arr,predicate){var mappedArr;return predicate?(mappedArr=arr.map(predicate),arr[mappedArr.indexOf(Math[method].apply(null,mappedArr))]):Math[method].apply(this,arr)}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=_interopRequireDefault(_bluebirdExtend),_mappers=__webpack_require__(5),_mappers2=_interopRequireDefault(_mappers),utils={extend:function(dest){return dest=dest||{},Array.prototype.slice.call(arguments,1).forEach(function(source){"object"===(void 0===source?"undefined":_typeof(source))&&null!==source&&Object.keys(source).forEach(function(key){dest[key]=source[key]})}),dest},extendDeep:function extendDeep(object){object=object||{};for(var i=1,len=arguments.length;i<len;++i){var obj=arguments[i];if(obj)for(var key in obj)obj.hasOwnProperty(key)&&void 0!==obj[key]&&("[object Object]"!==Object.prototype.toString.call(obj[key])?object[key]=obj[key]:object[key]=extendDeep(object[key],obj[key]))}return object},get:function(object,path,defaultValue){if(!object||!path)return defaultValue;var paths=Array.isArray(path)?path:path.split(/[\.\[\]]/);paths=paths.filter(function(path){return path});var result=paths.reduce(function(prevValue,currentNamespace){if(prevValue&&prevValue[currentNamespace])return prevValue[currentNamespace]},object);return result||defaultValue},merge:function(){var hop=Object.prototype.hasOwnProperty;return Array.prototype.reduce.call(arguments,function(result,source){return Object.keys(result).forEach(function(key){hop.call(source,key)&&(result[key]=source[key])}),Object.keys(source).forEach(function(key){result[key]=source[key]}),result},{})},bytesToSize:function(bytes){if(0===bytes)return"0 Byte";var sizes=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(bytes)/Math.log(1024));return(bytes/Math.pow(1024,i)).toPrecision(3)+" "+sizes[i]},partial:function(func){var partialArguments=Array.prototype.slice.call(arguments,1);return function(){var args=Array.prototype.slice.call(arguments);return func.apply(this,partialArguments.concat(args))}},getParameterByName:function(searchString,name){var regex,results;return name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),regex=new RegExp("[\\?&]"+name+"=([^&#]*)"),results=regex.exec(searchString),results?decodeURIComponent(results[1].replace(/\+/g," ")):""},snakeToCamel:function(string){return string=string[0].toLowerCase()+string.slice(1),string.replace(/[_]+$/g,"").replace(/([^_]?)[_]+([^_])/g,function($0,$1,$2){return $1?$1.toLowerCase()+$2.toUpperCase():$2.toLowerCase()})},camelToSnake:function(string){return string.replace(/([a-z]?)([A-Z])/g,function($0,$1,$2){return $1?$1+"_"+$2.toLowerCase():$0.toLowerCase()})},find:function(arr,predicate){var found;return arr.some(function(el){if(!0===predicate(el))return found=el,!0}),found},encodeParams:function(a){var s=[],add=function(key,value){s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};return Object.keys(a).forEach(function(entity){add(entity,a[entity])}),s.join("&").replace(/%20/g,"+")},splitTags:function(tags){return tags?Array.isArray(tags)?tags:tags.split(/\s*,\s*/):[]},normalizeUri:function(uri){if("string"!=typeof uri)throw new Error("URI is not a string");return uri.replace(/([a-z\-_0-9]+)\/\//gi,"$1/")},getScript:function(src){return _bluebirdExtend2.default.newAbortable(function(resolve,reject){var head=document.getElementsByTagName("head")[0],script=document.createElement("script"),done=!1;script.src=src,script.onload=script.onreadystatechange=function(){done||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState?reject(_mappers2.default.toError()):(done=!0,resolve(),script.onload=script.onreadystatechange=null,head&&script.parentNode&&head.removeChild(script))},head.insertBefore(script,head.firstChild)})},startsWithGuid:function(guid){return/^\w{8}-(\w{4}-){3}\w{12}/.test(guid)},endsWith:function(string,suffix){return-1!==string.indexOf(suffix,string.length-suffix.length)},sortBy:function(arrayOfObjects,key,sortOrder){return Array.isArray(arrayOfObjects)?arrayOfObjects.slice().sort(function(a,b){var order=0;return a[key]<b[key]?order=-1:a[key]>b[key]&&(order=1),"desc"===sortOrder?-order:order}):[]},objectValues:function(object){return object?Object.keys(object).map(function(key){return object[key]}):[]},getThumbnailsUrlsFromList:function(sourceSizes,requiredSizes){function canFill(sizes,sizesToTest){return sizesToTest.width>=sizes.width&&sizesToTest.height>=sizes.height}function canFit(sizes,sizesToTest){return sizesToTest.width>=sizes.width||sizesToTest.height>=sizes.height}if(!sourceSizes.length)return{};var sourceSizesSorted=utils.sortBy(sourceSizes,"width");return Object.keys(requiredSizes).reduce(function(urls,sizeName){var requiredSize=requiredSizes[sizeName],currentSize=utils.find(sourceSizesSorted,function(size){return"fill"===requiredSize.mode?canFill(requiredSize,size):canFit(requiredSize,size)});return urls[sizeName+"Url"]=currentSize?currentSize.url:sourceSizesSorted[sourceSizesSorted.length-1].url,urls},{})},replaceHtml:function(htmlString){return(htmlString||"").replace(/<\/?[a-z]+.*?>/gi,"")},toTimeStamp:function(date){return date?Math.floor(new Date(date).getTime()/1e3):null}};utils.min=utils.partial(minMaxFinder,"min"),utils.max=utils.partial(minMaxFinder,"max"),exports.default=utils},function(module,exports,__webpack_require__){"use strict";function CancellationError(){Promise.CancellationError.apply(this,arguments),this.data={errorCode:cancellationErrorCode,errorDescription:"Canceled by user",errorInfo:{key:"wmp_error.canceled_by_user",args:[]}}}Object.defineProperty(exports,"__esModule",{value:!0});var cancellationErrorCode=-7799,Promise=__webpack_require__(27);Promise.CancellationError&&(CancellationError.prototype=Object.create(Promise.CancellationError.prototype)),Promise.newAbortable=function(func){var reject,promise=new Promise(function(){return reject=arguments[1],func.apply(this,arguments)});return promise.cancellable?(promise=promise.cancellable(),promise.abort=function(){this.cancel(new CancellationError)}):promise.abort=function(){console.warn("Bluebird is not available, requests cancellation will not work"),reject(new CancellationError)},promise},Promise.defer=function(){var resolve,reject,promise=Promise.newAbortable(function(){resolve=arguments[0],reject=arguments[1]});return{resolve:resolve,reject:reject,promise:promise}},Promise.CancellationError||(Promise.CancellationError=function(){Error.apply(this,arguments)},Promise.CancellationError.prototype=Object.create(Error.prototype)),["then","catch"].forEach(function(name){var original=Promise.prototype[name];Promise.prototype[name]=function(){var promise=original.apply(this,arguments);return promise.abort||(promise.abort=this.abort),promise}}),Promise.prototype.progress=function(callback){return this._progressCallback=callback,this},Promise.prototype.notify=function(message){return"function"==typeof this._progressCallback&&this._progressCallback(message),this},exports.default=Promise},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getUploadTimingsHeaders(request){return-1!==request.getAllResponseHeaders().indexOf(UPLOAD_TIMINGS_HEADER)?request.getResponseHeader(UPLOAD_TIMINGS_HEADER)||"":null}function parseResponseData(response){return"string"==typeof response&&(response=["{","["].indexOf(response[0])>=0?JSON.parse(response):{message:response}),response}function parseResponse(request){var response={status:request.status,statusText:request.statusText,responseSize:request.responseText.length,data:parseResponseData(request.responseText)},uploadTimingsHeaders=getUploadTimingsHeaders(request);return uploadTimingsHeaders&&(response.uploadTimingsHeaders=uploadTimingsHeaders),response}function encode(val){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function buildUrl(url,params){if(!params)return url;var parts=[];return Object.keys(params).forEach(function(key){var val=params[key];null!==val&&void 0!==val&&(val instanceof Array||(val=[val]),val.forEach(function(v){v instanceof Date&&!isNaN(v.valueOf())?v=v.toISOString():"object"===(void 0===v?"undefined":_typeof(v))&&(v=JSON.stringify(v)),parts.push(encode(key)+"="+encode(v))}))}),parts.length>0&&(url+=(-1===url.indexOf("?")?"?":"&")+parts.join("&")),url}function encodeRequestData(data,contentType){if(-1!==contentType.indexOf(contentTypes.JSON))return JSON.stringify(data);if(-1!==contentType.indexOf(contentTypes.URL_ENCODED))return _utils2.default.encodeParams(data);if(-1!==contentType.indexOf(contentTypes.MULTIPART)){var formData=new FormData;return Object.keys(data).forEach(function(name){var value=data[name],args="file"===name?[name,value,value.name]:[name,value];return formData.append.apply(formData,args)}),formData}}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.default=function(options){function setRequestOptions(settings){requestOptions=_utils2.default.extendDeep(requestOptions,settings)}function wrapRequestWithPromise(request,callSend,hasProgress){var promise=_bluebirdExtend2.default.newAbortable(function(resolve,reject){request.addEventListener("error",function(){reject(_mappers2.default.toError(_utils2.default.extend({},request,{message:"error",code:0,errorInfo:{key:request.responseText||"internal_server_error"}})))},!1),request.addEventListener("timeout",function(){reject(_mappers2.default.toError(_utils2.default.extend({},request,{message:"timeout_has_exceeded",code:408})))},!1),request.addEventListener("load",function(){request.status.toString().match(/^2\d+/i)?resolve(parseResponse(request)):reject(_mappers2.default.toError(_utils2.default.extend({},request,{message:"error",code:request.status,data:_mappers2.default.toObject(request.responseText),errorInfo:{key:request.responseText||"load_error"}})))},!1)});return hasProgress?request.upload.onprogress=function(event){var progress=Math.round(event.lengthComputable?100*event.loaded/event.total:0),status=progress<=99?"uploading":"processing";promise.notify({status:status,total:event.total,loaded:event.loaded})}:(request.addEventListener("loadstart",function(event){event&&promise.notify({status:"uploading",total:event.total,loaded:event.loaded})},!1),request.addEventListener("loadend",function(event){event&&promise.notify({status:"processing",total:event.total,loaded:event.loaded})},!1)),promise.catch(function(err){err instanceof _bluebirdExtend2.default.CancellationError&&request.abort()}),callSend(),promise}function openRequest(method,url,options){var request=new XMLHttpRequest;return!1===options.cache&&(url+=(-1===url.indexOf("?")?"?":"&")+"_="+Date.now()),request.open(method.toUpperCase(),_utils2.default.normalizeUri(url)),options.responseType&&(request.responseType=options.responseType),request.withCredentials=options.withCredentials,Object.keys(options.headers).forEach(function(name){request.setRequestHeader(name,options.headers[name])}),request.config=_utils2.default.extend({url:url,method:method},options),request}function get(url,params,options){params=_utils2.default.extend({},params,requestOptions.params);var request=openRequest("get",buildUrl(url,params),_utils2.default.extendDeep({},defaultOptions,requestOptions,options));return wrapRequestWithPromise(request,function(){request.send(null)})}function post(url,data,params,options){data=data||{},params=params||{},options=options||{};var userOptions=_utils2.default.extendDeep({},defaultOptions,{headers:{"Content-Type":"application/json; charset=utf-8"}},requestOptions,options);data=_utils2.default.extend({},data,requestOptions.params),data=encodeRequestData(data,userOptions.headers["Content-Type"]);var request=openRequest("post",buildUrl(url,params),userOptions);return wrapRequestWithPromise(request,function(){request.send(data)})}function upload(url,multipart,options){var userOptions=_utils2.default.extendDeep({},defaultOptions,options),request=openRequest("post",url,userOptions),multipartData=_utils2.default.extend({},multipart,requestOptions.params);return multipartData=encodeRequestData(multipartData,contentTypes.MULTIPART),wrapRequestWithPromise(request,function(){request.send(multipartData)},!0)}function catchError(method,onError){return function(){function callOriginalMethod(){return method.apply(self,args)}var firstPromise,self=this,args=arguments;firstPromise=callOriginalMethod();var promise=_bluebirdExtend2.default.newAbortable(function(resolve,reject){firstPromise.then(resolve,function(reason){return void 0!==onError?onError.call(this,reason,callOriginalMethod):reason}).then(resolve,reject)});return firstPromise.progress(function(progress){promise.notify(progress)}),promise.catch(function(err){err instanceof _bluebirdExtend2.default.CancellationError&&firstPromise.abort()}),promise}}function makeRetriable(method){return catchError(method,function(reason,callOriginalMethod){return reason instanceof _bluebirdExtend2.default.CancellationError||406===reason.code||403===reason.code?_bluebirdExtend2.default.reject(reason):callOriginalMethod()})}var requestOptions=_utils2.default.extend({},options);return{get:makeRetriable(get),post:makeRetriable(post),upload:makeRetriable(upload),catchError:catchError,setRequestOptions:setRequestOptions}};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=_interopRequireDefault(_bluebirdExtend),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_mappers=__webpack_require__(5),_mappers2=_interopRequireDefault(_mappers),UPLOAD_TIMINGS_HEADER="x-upload-timings",contentTypes={JSON:"application/json",URL_ENCODED:"application/x-www-form-urlencoded",MULTIPART:"multipart/form-data"},defaultOptions={withCredentials:!1,cache:!0,headers:{Accept:"application/json, text/plain, */*"}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={FOLDERS:{LIST:"folders.list",REMOVE:"folders.remove",TRASH:{LIST:"folders.trash.list",RESTORE:"folders.trash.restore",REMOVE:"folders.trash.remove"}},FOLDER:{CREATE:"folder.create",UPDATE:"folder.update"},ITEMS:{LIST:"items.list",REMOVE:"items.remove",SEARCH:"items.search",SEARCH_BY_TAG:"items.searchByTag",TRASH:{LIST:"items.trash.list",RESTORE:"items.trash.restore",REMOVE:"items.trash.remove"},SITE_MEDIA:{LIST:"items.siteMedia.list",REMOVE:"items.siteMedia.remove",ADD:"items.siteMedia.add"}},ITEM:{GET:"item.get",UPDATE:"item.update",UPLOAD:"item.upload",UPLOAD_RESUMABLE:"item.uploadResumable",UPLOAD_BY_URL:"item.uploadByUrl"},TRASH:{REMOVE:"trash.remove",RESTORE:"trash.restore"}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function addEvents(eventsTarget,events,methods){var methodsWithEvents={};return Object.keys(events).forEach(function(eventKey){var methodName=_utils2.default.snakeToCamel(eventKey.toLowerCase());if("object"===_typeof(methods[methodName])&&null!==methods[methodName]&&"object"===_typeof(events[eventKey])&&null!==events[eventKey])return void(methodsWithEvents[methodName]=addEvents(eventsTarget,events[eventKey],methods[methodName]));"function"==typeof methods[methodName]&&(methodsWithEvents[methodName]=function(){var event,wrapped,args=[].slice.call(arguments),promise=methods[methodName].apply(methods,args),params={arguments:args};return Array.isArray(promise)?(params.promises=promise,event=_notifier2.default.emit(eventsTarget,events[eventKey],params),promise.forEach(function(promise,index){var wrappedInner=promise.then(function(data){event.resolveAt(index,data)},function(reason){event.rejectAt(index,reason)});promise.progress(function(progress){wrappedInner.notify(progress)})}),promise):(event=_notifier2.default.emit(eventsTarget,events[eventKey],params),wrapped=promise.then(function(data){return event.resolve(data),data},function(reason){return event.reject(reason),_bluebirdExtend2.default.reject(reason)}),promise.progress(function(progress){wrapped.notify(progress)}),wrapped)})}),methodsWithEvents}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){
return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=_interopRequireDefault(_bluebirdExtend),_notifier=__webpack_require__(9),_notifier2=_interopRequireDefault(_notifier),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils);exports.default={addEvents:addEvents}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={toObject:function(data){if(!data)return null;if("string"==typeof data){if(["{","["].indexOf(data[0])>=0)try{return JSON.parse(data)}catch(err){return{error_code:-100,error_description:"Can`t parse JSON",error_info:{key:"wmp_error.cant_parse_json"}}}return{message:data}}return data},toError:function(error){var errorObject=new Error;return errorObject.code=error.status||error.code,errorObject.message=error.statusText||error.message||error.data.message||error.data.error&&error.data.error.message||"",errorObject.data=error.data&&(error.data.errors||error.data.error||error.data),errorObject.config=error.config,errorObject}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(reason){return reason&&403===reason.status&&reason.data&&"Missing Wix session"===reason.data.error_description&&(reason.status=401,reason.data.message="Wix Session required"),_bluebirdExtend2.default.reject(reason)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend);__webpack_require__(5)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return 403===response.status&&response.data&&"Missing Wix session"===response.data.error_description&&(response.status=401,response.data.message="Wix Session required"),_bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend);__webpack_require__(5)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(itemData,settings,thumbnailSizes,isSiteOwner){var normalizeUri=_utils2.default.normalizeUri,item={id:itemData.file_name,folderId:itemData.parent_folder_id||null,fileSize:itemData.file_size,name:itemData.original_file_name,mediaType:itemData.media_type,fileUrl:itemData.file_url?normalizeUri(itemData.file_url):null,sourceUrl:itemData.source_url||null,createdAt:itemData.created_ts,readOnly:itemData.read_only||null,isSiteOwner:isSiteOwner,labels:itemData.labels||[],tags:_utils2.default.splitTags(itemData.tags),width:itemData.width||null,height:itemData.height||null,fileInfo:itemData.file_info?_mappers2.default.toObject(itemData.file_info):null,fileInput:itemData.file_input?_mappers2.default.toObject(itemData.file_input):null,fileOutput:itemData.file_output?_mappers2.default.toObject(itemData.file_output):null,transcodingStatus:itemData.op_status},sizes=_utils2.default.extend({},settings.thumbnailSizes,thumbnailSizes);return _utils2.default.extend(item,(0,_getWixThumbnailsUrls2.default)(item,sizes,settings)),sizes.thumbnail&&!item.thumbnailUrl&&itemData.icon_url&&(item.thumbnailUrl=normalizeUri(settings.filesUrl+"/"+itemData.icon_url)),Object.keys(sizes).forEach(function(thumbType){item[thumbType+"Url"]||(item[thumbType+"Url"]=item.thumbnailUrl)}),Object.keys(item).forEach(function(prop){void 0===item[prop]&&delete item[prop]}),item.videoPreviewUrls=(0,_getWixVideoPreviewUrls2.default)(item,settings)||null,item};var _mappers=__webpack_require__(5),_mappers2=_interopRequireDefault(_mappers),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_getWixThumbnailsUrls=__webpack_require__(12),_getWixThumbnailsUrls2=_interopRequireDefault(_getWixThumbnailsUrls),_getWixVideoPreviewUrls=__webpack_require__(17),_getWixVideoPreviewUrls2=_interopRequireDefault(_getWixVideoPreviewUrls)},function(module,exports,__webpack_require__){"use strict";function noop(){}function callEach(functions,data){functions.forEach(function(currentFunction){currentFunction(data)})}function callEachAtIndex(functions,index,data){functions.forEach(function(functions){functions[index](data)})}function emitWithArrayOfPromises(eventTarget,eventName,params){if(void 0===listeners[eventName])return{resolveAt:noop,rejectAt:noop};var resolvers=[],rejectors=[];return listeners[eventName].forEach(function(listener){var thisEventResolvers=[],thisEventRejectors=[],eventPromises=params.promises.map(function(){return new _bluebirdExtend2.default(function(resolve,reject){thisEventResolvers.push(resolve),thisEventRejectors.push(reject)})});resolvers.push(thisEventResolvers),rejectors.push(thisEventRejectors),listener(eventPromises,params)}),{resolveAt:function(index,data){callEachAtIndex(resolvers,index,data)},rejectAt:function(index,data){callEachAtIndex(rejectors,index,data)}}}function emit(eventTarget,eventName,params){if("object"!==(void 0===eventTarget?"undefined":_typeof(eventTarget))||null===eventTarget)throw new Error("target should be a function");if("string"!=typeof eventName)throw new Error("eventName should be a string");if(params=params||{},params.eventTarget=eventTarget,params.eventName=eventName,params.promises&&params.promises.length)return emitWithArrayOfPromises(eventTarget,eventName,params);if(void 0===listeners[eventName])return{resolve:noop,reject:noop};var resolvers=[],rejectors=[];return listeners[eventName].forEach(function(listener){listener(new _bluebirdExtend2.default(function(resolveCurrent,rejectCurrent){resolvers.push(resolveCurrent),rejectors.push(rejectCurrent)}),params)}),{resolve:function(data){callEach(resolvers,data)},reject:function(reason){callEach(rejectors,reason)}}}function emitResolve(eventTarget,eventName,params,result){var promise=new _bluebirdExtend2.default(function(resolve){resolve(result)});params.promises=[promise];var event=emit(eventTarget,eventName,params);return promise.then(function(data){event.resolveAt(0,data)}),event}function addListener(eventName,listener){void 0===listeners[eventName]&&(listeners[eventName]=[]),listeners[eventName].push(listener)}function removeListener(eventName,listener){if(listeners[eventName]){var index=listeners[eventName].indexOf(listener);listeners[eventName].splice(index,1)}}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend),listeners={};exports.default={emit:emit,emitResolve:emitResolve,addListener:addListener,removeListener:removeListener}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={FAILED:"FAILED",IN_QUEUE:"IN-QUEUE",INPROGRESS:"INPROGRESS",PREVIEW_READY:"PREVIEW_READY",READY:"READY"}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(itemData,settings,thumbnailSizes){var normalizeUri=_utils2.default.normalizeUri,item={id:itemData.id,folderId:itemData.folder||null,fileSize:itemData.file_size,name:itemData.title,mediaType:itemData.media_type,fileUrl:_utils2.default.get(itemData,"meta.fileDescriptor.path"),fileRefId:_utils2.default.get(itemData,"meta.fileDescriptor.id"),createdAt:Date.parse(itemData.created_at),labels:_utils2.default.get(itemData,"meta.features.labels",[]).map(function(label){return label.name}),width:_utils2.default.get(itemData,"meta.basic.width"),height:_utils2.default.get(itemData,"meta.basic.height"),meta:itemData.meta||null,transcodingStatus:function(transcodingJobs){if(!transcodingJobs.length)return _transcodingStatuses2.default.IN_QUEUE;var firstVideoTranscodingJobStatus=transcodingJobs[0].status;return 1===transcodingJobs.length?firstVideoTranscodingJobStatus:transcodingJobs.some(function(job){return job.status===firstVideoTranscodingJobStatus})?firstVideoTranscodingJobStatus:_transcodingStatuses2.default.INPROGRESS}(_utils2.default.get(itemData,"meta.videoTranscodingJobs",[]))};"video"===item.mediaType&&(item.thumbnailUrl=normalizeUri(item.fileUrl+".output/posters/"+item.fileRefId+"002.jpg"));var sizes=_utils2.default.extend({},settings.thumbnailSizes,thumbnailSizes);return _utils2.default.extend(item,(0,_getWixThumbnailsUrls2.default)(item,sizes,settings)),Object.keys(sizes).forEach(function(thumbType){item[thumbType+"Url"]||(item[thumbType+"Url"]=item.thumbnailUrl)}),Object.keys(item).forEach(function(prop){void 0===item[prop]&&delete item[prop]}),item.videoPreviewUrls=function(item){var videoTranscodingJobs=_utils2.default.get(item,"meta.videoTranscodingJobs");if(videoTranscodingJobs&&videoTranscodingJobs[0]){var videoOutputs=_utils2.default.get(videoTranscodingJobs[0],"info.outputs.videoOutputs");if(videoOutputs&&videoOutputs[0]&&videoOutputs[0].url)return[settings.filesUrl+videoOutputs[0].url]}return null}(item),item};var _transcodingStatuses=__webpack_require__(10),_transcodingStatuses2=_interopRequireDefault(_transcodingStatuses),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_getWixThumbnailsUrls=__webpack_require__(12),_getWixThumbnailsUrls2=_interopRequireDefault(_getWixThumbnailsUrls)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getUrlForResize(item,filesUrl){if(item.thumbnailUrl)return filesUrl+"/"+item.thumbnailUrl;switch(item.mediaType){case"picture":case"site_icon":case"watermark":case"secure_picture":return filesUrl+"/"+item.fileUrl;case"video":return filesUrl+"/"+item.videoThumbnailUrl;case"secure_video":if(item.fileOutput&&item.fileOutput.image&&item.fileOutput.image[2]&&item.fileOutput.image[2].url)return filesUrl+"/"+item.fileOutput.image[2].url;break;case"ufont":if(item.fileOutput&&item.fileOutput.image&&item.fileOutput.image[0]&&item.fileOutput.image[0].url)return filesUrl+"/"+item.fileOutput.image[0].url}}function getSameUrls(thumbnailSizes,url){return Object.keys(thumbnailSizes).reduce(function(urls,sizeName){return urls[sizeName+"Url"]=url,urls},{})}function getResizedUrls(thumbnailSizes,urlForResize,imageOperationsApi){return Object.keys(thumbnailSizes).reduce(function(urls,sizeName){var url=(0,_resize2.default)(urlForResize,thumbnailSizes[sizeName],imageOperationsApi);return url&&(urls[sizeName+"Url"]=url),urls},{})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(item,thumbnailSizes,settings){var urlForResize=getUrlForResize(item,settings.filesUrl),urls={};return"shape"===item.mediaType?urls=getSameUrls(thumbnailSizes,_utils2.default.normalizeUri(settings.filesUrl+"/"+item.fileUrl)):urlForResize&&(urls=getResizedUrls(thumbnailSizes,urlForResize,settings.imageOperationsApi)),item.fileUrl&&(urls.originalUrl=_utils2.default.normalizeUri(settings.filesUrl+"/"+item.fileUrl)),urls};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_resize=__webpack_require__(19),_resize2=_interopRequireDefault(_resize)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(folderData){return{id:folderData.folder_id,parentId:folderData.parent_folder_id||null,name:folderData.folder_name,mediaType:folderData.media_type,filesCount:folderData.files_count,createdAt:folderData.created_ts}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={severity:{info:10,warning:20,error:30,fatal:40},BIEventsIds:{responseTime:"110",uploadSpeed:"142",uploadQueueStarted:"303",uploadQueueFinished:"304",resumableUploadStarted:"155",resumableUploadFinished:"156",resumableChunkUploadStarted:"157",resumableChunkUploadFinished:"158",apiTiming:"159"},BIAdaptersIds:{private:"01",public:"02",facebook:"03",flickr:"04",instagram:"05",picasa:"06",flickrSearch:"07",googleSearch:"08",bigStock:"09",collection:"10",drive:"11",dropbox:"12",facebookVideo:"13",instagramVideo:"14",vimeo:"15",vimeoSearch:"16",youtube:"17",youtubeSearch:"18"},BIAdaptersRequestsIds:{"folders.list":"01","folders.remove":"02","folders.trash.list":"03","folders.trash.restore":"04","folders.trash.remove":"05","folder.create":"06","folder.update":"07","items.list":"11","items.remove":"12","items.search":"13","items.searchByTag":"14","items.trash.list":"15","items.trash.restore":"16","items.trash.remove":"17","item.get":"18","item.update":"19","item.upload":"20","item.uploadByUrl":"21","trash.remove":"22","trash.restore":"23"}}},function(module,exports,__webpack_require__){"use strict";function getBaseHost(){return/\.wixpress\.com/i.test(document.location.host)||/local\./i.test(document.location.host)?"/images/43.gif?":"//frog.wix.com"}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(url,data){var biImage=document.createElement("img");biImage.setAttribute("src",getBaseHost()+url+"?"+_utils2.default.encodeParams(data)+"&_="+(new Date).getTime()),biImage=null};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(folderData){return{id:folderData.id,parentId:folderData.parent||null,name:folderData.title,mediaType:folderData.media_type,createdAt:Date.parse(folderData.created_at)}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(item,settings){return item.fileOutput&&item.fileOutput.video?item.fileOutput.video.filter(function(video){return video.quality<=settings.videoPreviewQuality}).map(function(video){return _utils2.default.normalizeUri(settings.videoFilesUrl+"/"+video.url)}):null};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function filterEvents(eventName){return function(event){return event.name===eventName}}function on(eventNames,callback){"string"==typeof eventNames&&(eventNames=[eventNames]),eventNames.forEach(function(eventName){if(-1===supportedEvents.indexOf(eventName))throw new Error("This event "+eventName+" is not supported by multiple file uploader");events.push({name:eventName,fn:callback})})}function off(eventNames,callback){"string"==typeof eventNames&&(eventNames=[eventNames]);for(var i=events.length-1;i>=0;i-=1){var event=events[i];eventNames.forEach(function(eventName){event.name!==eventName||callback&&event.fn!==callback||events.splice(i,1)})}}function emit(eventName,args){var __slice=[].slice;args=arguments.length>=2?__slice.call(arguments,1):[],events.filter(filterEvents(eventName)).forEach(function(event){event.fn.apply({event:eventName},args)})}function hasWaitingFiles(){return uploadQueue.some(function(fileToUpload){return"waiting"===fileToUpload.status})}function getWaitingFiles(){return uploadQueue.filter(function(fileToUpload){return"waiting"===fileToUpload.status})}function hasRetryableFiles(){return uploadQueue.some(function(fileToUpload){return fileToUpload.canRetry()})}function getInProgressFilesCount(){return uploadQueue.filter(function(fileToUpload){return["uploading","processing"].indexOf(fileToUpload.status)>=0}).length}function hasInProgressFiles(){return uploadQueue.some(function(fileToUpload){return["uploading","processing"].indexOf(fileToUpload.status)>=0})}function dynamicPromiseReduce(){hasWaitingFiles()||hasInProgressFiles()||deferred.resolve();var availableSlots=maxParallelUploads-getInProgressFilesCount();return availableSlots<=0?deferred.promise:(getWaitingFiles().slice(0,availableSlots).forEach(function(fileToUpload){fileToUpload.upload().then(function(res){return dynamicPromiseReduce(),res}).catch(function(err){dynamicPromiseReduce(),console.warn(err)})}),deferred.promise)}function getBytesTotal(){return uploadQueue.reduce(function(sum,fileToUpload){return sum+fileToUpload.getFileSize()},0)}function calculateItemBytesLoaded(fileToUpload,progress){switch(progress.status){case"uploading":return progress.loaded<=fileToUpload.getFileSize()?progress.loaded:fileToUpload.getFileSize();case"succeeded":case"processing":return fileToUpload.getFileSize();case"failed":default:return 0}}function processItemProgress(fileToUpload){return function(progress){-1===["failed","succeeded"].indexOf(fileToUpload.status)?fileToUpload.status=progress.status:progress.status=fileToUpload.status;var fileSize=fileToUpload.getFileSize();fileToUpload.bytesLoaded=progress.loaded>=fileSize?fileSize:progress.loaded,progress.file=fileToUpload,emit("fileStatusChanged",{bytesTotalUploaded:currentUploadedTotal+calculateItemBytesLoaded(fileToUpload,progress),bytesTotal:getBytesTotal(),currentFileProgress:progress,currentFileQueueIdx:uploadQueue.indexOf(fileToUpload),queue:uploadQueue})}}function startUploadQueue(){if(uploadIsInProgress)return void dynamicPromiseReduce();deferred=_bluebirdExtend2.default.defer(),uploadIsInProgress=!0,emit("uploadQueueStarted",uploadQueue),dynamicPromiseReduce().then(function(){uploadIsInProgress=!1,emit("uploadQueueFinished",uploadQueue)}).catch(function(err){console.warn(err)})}function addProgressNotifications(fileToUpload){var processCurrentItemProgress=processItemProgress(fileToUpload),fileSize=fileToUpload.getFileSize();fileToUpload.deferred.promise.progress(processCurrentItemProgress).then(function(result){fileToUpload.serverResponse=result,processCurrentItemProgress({status:"succeeded",total:fileSize,loaded:fileSize}),currentUploadedTotal+=fileSize}).catch(function(reason){fileToUpload.serverResponse=reason,processCurrentItemProgress({status:"failed",total:fileSize,loaded:0})})}function addRestartOnRetry(fileToUpload){var nativeRetry=fileToUpload.signUpForRetry;fileToUpload.signUpForRetry=function(){nativeRetry.apply(this,arguments),addProgressNotifications(fileToUpload),startUploadQueue()}}function clearQueue(){if(uploadIsInProgress)throw new Error("Upload queue can not be cleared while upload is running");uploadQueue.length=0,currentUploadedTotal=0}function upload(fileSources){fileSources=fileSources||[],uploadIsInProgress||hasRetryableFiles()||clearQueue();var mappedFiles=fileSources.map(_fileToUpload2.default).map(function(fileToUpload){return addProgressNotifications(fileToUpload),addRestartOnRetry(fileToUpload),uploadQueue.push(fileToUpload),fileToUpload});return emit("queueChanged",uploadQueue),startUploadQueue(),mappedFiles}Object.defineProperty(exports,"__esModule",{value:!0});var deferred,_bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=_interopRequireDefault(_bluebirdExtend),_fileToUpload=__webpack_require__(43),_fileToUpload2=_interopRequireDefault(_fileToUpload),maxParallelUploads=1,uploadQueue=[],uploadIsInProgress=!1,currentUploadedTotal=0,supportedEvents=["queueChanged","fileStatusChanged","uploadQueueStarted","uploadQueueFinished"],events=[];exports.default={on:on,off:off,upload:upload,clearQueue:clearQueue,set maxParallelUploads(number){maxParallelUploads=Number(number)||1},get maxParallelUploads(){return maxParallelUploads},get uploadQueue(){return uploadQueue},get uploadIsInProgress(){return uploadIsInProgress},get currentUploadedTotal(){return currentUploadedTotal}}},function(module,exports,__webpack_require__){"use strict";function isResizable(url){return/\.(png|jpe?g|gif)/i.test(url)}function getFullName(url){return url.split("/").pop()||""}function getFolderUrl(url){var path=url.split("/");return path.length<=1?"":(path.pop(),path.join("/")+"/")}function transformModeToVangogh(mode){return vangoghModes[mode]||mode}function createRegexp(t,options){return t=t.replace(/[()\[\]\.^$|?+]/g,"\\$&"),new RegExp(t,options)}function insertDataInTemplate(template,data){return Object.keys(data).forEach(function(key){var regExp=createRegexp("#"+key+"#","g");template=template.replace(regExp,data[key])}),template}function restoreUrlIfResized(sourceUrl){return sourceUrl.replace(REGEXPS.VANGOGH,"").replace(REGEXPS.VANBRANDT,"$1").replace(REGEXPS.REMBRANDT,"$1$2")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(sourceUrl,settings,apiName){if(sourceUrl=restoreUrlIfResized(sourceUrl),isResizable(sourceUrl)){apiName=apiName||"rembrandt",settings=_utils2.default.extend({width:200,height:200,mode:"fill"},settings),"vangogh"===apiName&&(settings.mode=transformModeToVangogh(settings.mode));var templateUrl=compilers[apiName](sourceUrl),compiledUrl=insertDataInTemplate(templateUrl,settings);return _utils2.default.normalizeUri(compiledUrl)}};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils),vangoghModes={fill:"srz",fit:"srb"},compilers={vangogh:function(sourceUrl){return getFolderUrl(sourceUrl)+getFullName(sourceUrl)+"_#mode#_#width#_#height#_75_22_0.5_1.20_0.00_jpg_#mode#"},rembrandt:function(sourceUrl){return getFolderUrl(sourceUrl)+"v1/#mode#/w_#width#,h_#height#/"+getFullName(sourceUrl)},vanbrandt:function(sourceUrl){return getFolderUrl(sourceUrl)+getFullName(sourceUrl)+"/v1/#mode#/w_#width#,h_#height#/"+getFullName(sourceUrl)}},REGEXPS={VANGOGH:/_sr[bz]_(?:[0-9\.]+_)+[a-z0-9]+_sr[bz]$/i,VANBRANDT:/([a-z0-9_\-]+\.[a-z0-9]+)\/v[0-9]+\/(?:fill|fit)\/[^\/]+\/\1$/i,REMBRANDT:/([a-z0-9_\-]+)\/v[0-9]+\/(?:fill|fit)\/[^\/]+(\/(?:\1|file)\.[a-z0-9_]+)$/i}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.default=function(newProps){return"object"!==(void 0===newProps?"undefined":_typeof(newProps))||null===newProps?{valid:!1,message:"Please specify new props"}:void 0===newProps.name||newProps.name?void 0===newProps.folderId||newProps.folderId?void 0===newProps.parentId||newProps.parentId?void 0===newProps.tags||Array.isArray(newProps.tags)?{valid:!0}:{valid:!1,message:"Tags should be an array"}:{valid:!1,message:"Please specify parent folder id"}:{valid:!1,message:"Please specify folder id"}:{valid:!1,message:"Please specify name"}}},function(module,exports){var g;g=function(){return this}();try{g=g||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(g=window)}module.exports=g},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,adapter,itemMapper,http){return function(itemId){function emitItemUpdateEvent(result){_notifier2.default.emit(adapter,_list2.default.ITEM.UPDATE,{arguments:[result.data,result.data]}).resolve(result)}return new _bluebirdExtend2.default(function(resolve,reject){function checkItemStatus(){setTimeout(function(){http.get(settings.apiUrl+"/files/"+itemId,null,{cache:!1}).then(function(response){var status=response.data.op_status;if(status===_transcodingStatuses2.default.READY){var responseItemId=response.data.file_name;return adapter.item.get(responseItemId).then(emitItemUpdateEvent),void resolve(responseItemId)}if(emitItemUpdateEvent({data:itemMapper(response.data,settings,{},!0)}),status===_transcodingStatuses2.default.FAILED)return void reject("Item transcoding failed");checkItemStatus()}).catch(checkItemStatus)},POLLING_TIMEOUT)}checkItemStatus()})}};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=_interopRequireDefault(_bluebirdExtend),_notifier=__webpack_require__(9),_notifier2=_interopRequireDefault(_notifier),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list),_transcodingStatuses=__webpack_require__(10),_transcodingStatuses2=_interopRequireDefault(_transcodingStatuses),POLLING_TIMEOUT=6e4},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function initSocket(settings,adapter,requestOptions){var socketSettings={messageUrl:settings.blackArrow.messageUrl,socketUrl:settings.blackArrow.wsUrl,tokenUrl:settings.apiUrl+settings.blackArrow.tokenUrl},socket=(0,_socket.Socket)(socketSettings,requestOptions),emitItemUpdateEvent=function(result){_notifier2.default.emit(adapter,_list2.default.ITEM.UPDATE,{arguments:[result.data,result.data]}).resolve(result)};return socket.on("message",function(message){if("status_update"===message.type&&settings.asyncTranscoding&&(_utils2.default.get(message,"file.op_status")===_transcodingStatuses2.default.READY?adapter.item.get(_utils2.default.get(message,"file.file_name")).then(emitItemUpdateEvent):emitItemUpdateEvent({data:(0,_item2.default)(message.file,settings,{},!0)})),"trash_file"===message.type&&_notifier2.default.emitResolve(adapter,_list2.default.ITEMS.REMOVE,{arguments:[[message.file_name]]},{data:{id:message.file_name}}),"item_update"===message.type){var item=(0,_item2.default)(message.file,settings,{},!0);_notifier2.default.emit(adapter,_list2.default.ITEM.UPDATE,{arguments:[item,item]}).resolve({data:item})}}),socket}Object.defineProperty(exports,"__esModule",{value:!0}),exports.initSocket=initSocket;var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_item=__webpack_require__(8),_item2=_interopRequireDefault(_item),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list),_socket=__webpack_require__(25),_transcodingStatuses=__webpack_require__(10),_transcodingStatuses2=_interopRequireDefault(_transcodingStatuses),_notifier=__webpack_require__(9),_notifier2=_interopRequireDefault(_notifier)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.default=function(newProps){return"object"!==(void 0===newProps?"undefined":_typeof(newProps))||null===newProps?{valid:!1,message:"Please specify new props"}:void 0===newProps.name||newProps.name?void 0===newProps.folderId||newProps.folderId?void 0===newProps.parentId||newProps.parentId?void 0===newProps.tags||Array.isArray(newProps.tags)?{valid:!0}:{valid:!1,message:"Tags should be an array"}:{valid:!1,message:"Please specify parent folder id"}:{valid:!1,message:"Please specify folder id"}:{valid:!1,message:"Please specify name"}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function cachePromise(factory){var pending;return function(){return pending||(pending=factory.apply(this,arguments).catch(function(reason){return pending=null,_bluebirdExtend2.default.reject(reason)}))}}function Socket(){function filterEvents(eventName){return function(event){return event.name===eventName}}function on(eventNames,callback){"string"==typeof eventNames&&(eventNames=[eventNames]),eventNames.forEach(function(eventName){if(supportedEvents.indexOf(eventName)<0)throw new Error("This event "+eventName+" is not supported by socket service");events.push({name:eventName,fn:callback})})}function off(eventNames,callback){"string"==typeof eventNames&&(eventNames=[eventNames]),events=events.filter(function(event){return!eventNames.some(function(eventName){return event.name===eventName&&(!callback||event.fn===callback)})})}function emit(eventName,args){var __slice=[].slice;args=arguments.length>=2?__slice.call(arguments,1):[],events.filter(filterEvents(eventName)).forEach(function(event){event.fn.apply({event:eventName},args)})}function open(){return socket?_bluebirdExtend2.default.resolve(socket):openStarted?socketOpeningPromise:(openStarted=!0,status="OPEN_STARTED",socketOpeningPromise=getToken().then(openSocket).catch(function(reason){return console.log(reason),_newRelic2.default.sendError("can not open socket",{code:reason.code,body:reason.responseText||reason.message}),(0,_error2.default)(reason)}))}function reopenSocket(){openStarted&&(status="REOPEN_STARTED",openTimeout=setTimeout(function(){getToken().then(openSocket)},REOPEN_TIMEOUT))}function openSocket(token){return socket=new WebSocket(settings.socketUrl+"?token="+token),socket.onmessage=onMessage,socket.onerror=function(){_newRelic2.default.sendError("socket on error"),reopenSocket()},socket.onopen=function(){status="OPENED",emit("open")},socket.onclose=function(closeEvent){socket=null,_newRelic2.default.sendError("socket on close",{code:closeEvent.code,message:closeEvent.reason}),emit("close")},new _bluebirdExtend2.default(function(resolve,reject){var rejectTimeoutId;on("open",function(){resolve(socket),clearTimeout(rejectTimeoutId)}),rejectTimeoutId=setTimeout(function(){_newRelic2.default.sendError("reject by inner timeout"),reject({code:0,message:"reject by inner timeout"})},OPEN_REJECT_TIMEOUT)})}function close(){return openStarted=!1,openTimeout&&(clearTimeout(openTimeout),openTimeout=null),socket?(status="CLOSED",socket.close(),new _bluebirdExtend2.default(function(resolve){on("close",function(){resolve("closed")})})):(_newRelic2.default.sendError("socket: no socket to close",{message:"socket: no socket to close"}),_bluebirdExtend2.default.reject("no socket to close"))}function onMessage(message){try{message=JSON.parse(message.data)}catch(error){return void _newRelic2.default.sendError("parse web socket message failed",{message:error})}emit("message",message)}function send(message,action,method){return getToken().then(function(token){if(!token)return _newRelic2.default.sendError("socket: try to send message without token"),_bluebirdExtend2.default.reject("no token to send message");if(!message)return _newRelic2.default.sendError("socket: try to send message without message"),_bluebirdExtend2.default.reject("no message to send message");var data={action:action||"send"};if("post"===method||!socket){data=_utils2.default.extend(data,{message:JSON.stringify(message),token:token});var options={headers:{"Content-Type":"application/x-www-form-urlencoded"}};return http.post(settings.messageUrl,data,null,options).catch(function(reason){return _newRelic2.default.sendError("socket: send message failed",{code:reason.code,body:reason.responseText}),(0,_error2.default)(reason)})}return data=_utils2.default.extend(data,{message:message}),socket.send(JSON.stringify(data)),message})}var settings=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},requestOptions=arguments[1];settings=_utils2.default.extend({},defaultSettings,settings);var openStarted,openTimeout,socketOpeningPromise,http=(0,_http2.default)(requestOptions),socket=null,status="INIT",events=[],supportedEvents=["open","close","message"],getToken=cachePromise(function(){return http.get(settings.tokenUrl,null,{withCredentials:!0}).then(function(response){return status="GOT_TOKEN",_utils2.default.get(response,"data.token","")}).catch(function(response){return status="GET_TOKEN_FAILED",_newRelic2.default.sendError("can not get socket token",{code:response.code,body:response.responseText}),(0,
_error2.default)(response)})});return{open:open,close:close,send:send,on:on,off:off,getStatus:function(){return status},getOpenStarted:function(){return openStarted}}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Socket=Socket;var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=_interopRequireDefault(_bluebirdExtend),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_newRelic=__webpack_require__(44),_newRelic2=_interopRequireDefault(_newRelic),_error=__webpack_require__(6),_error2=_interopRequireDefault(_error),OPEN_REJECT_TIMEOUT=5e3,REOPEN_TIMEOUT=3e4,defaultSettings={messageUrl:"https://ws.wixmp.com/message",socketUrl:"wss://ws.wixmp.com/ws",tokenUrl:"//files.wix.com/users/get-batoken"}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.default=function(SourceConstructor,settings){if("function"!=typeof SourceConstructor)throw new Error("Source constructor should be a function");if(void 0!==settings&&("object"!==(void 0===settings?"undefined":_typeof(settings))||null===settings))throw new Error("Source settings should be an object");var http=(0,_http2.default)();return new SourceConstructor(settings,_notifier2.default.emit,http)};var _http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_notifier=__webpack_require__(9),_notifier2=_interopRequireDefault(_notifier)},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_27__},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return response.data=response.data||{},response.data.message=response.message,_bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(userSettings){var settings=_utils2.default.extendDeep({},_settings2.default,userSettings),withRefreshToken=(0,_refreshTokenWrapper2.default)(settings.refreshTokenUrl),requestOptions=settings.requestOptions;_utils2.default.get(requestOptions,"params.ns")&&(settings.ns=requestOptions.params.ns);var socket=(0,_socket.initSocket)(settings,this,requestOptions),http=(0,_http2.default)(requestOptions),polling=(0,_polling2.default)(settings,this,_item4.default,http),resumable=(0,_resumable2.default)(settings,this,_item4.default,http),settingsWithRefreshToken={get:withRefreshToken(http.get),post:withRefreshToken(http.post),upload:withRefreshToken(http.upload)},httpWithRefreshToken=settings.refreshTokenUrl?settingsWithRefreshToken:http,folders=(0,_folders2.default)(settings,httpWithRefreshToken),foldersTrash=(0,_folders4.default)(settings,httpWithRefreshToken),folder=(0,_folder2.default)(settings,httpWithRefreshToken),items=(0,_items2.default)(settings,httpWithRefreshToken),itemsTrash=(0,_items4.default)(settings,httpWithRefreshToken),itemsSiteMedia=(0,_items6.default)(settings,httpWithRefreshToken),item=(0,_item2.default)(settings,httpWithRefreshToken,socket,polling,resumable),trash=(0,_trash2.default)(settings,httpWithRefreshToken);folders.trash=foldersTrash,items.trash=itemsTrash,items.siteMedia=itemsSiteMedia,this.name="private",this.folders=_decorators2.default.addEvents(this,_list2.default.FOLDERS,folders),this.folder=_decorators2.default.addEvents(this,_list2.default.FOLDER,folder),this.item=_decorators2.default.addEvents(this,_list2.default.ITEM,item),this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items),this.trash=_decorators2.default.addEvents(this,_list2.default.TRASH,trash),this.blackArrow=socket};var _folders=__webpack_require__(30),_folders2=_interopRequireDefault(_folders),_folder=__webpack_require__(31),_folder2=_interopRequireDefault(_folder),_items=__webpack_require__(32),_items2=_interopRequireDefault(_items),_item=__webpack_require__(33),_item2=_interopRequireDefault(_item),_trash=__webpack_require__(35),_trash2=_interopRequireDefault(_trash),_items3=__webpack_require__(36),_items4=_interopRequireDefault(_items3),_items5=__webpack_require__(37),_items6=_interopRequireDefault(_items5),_folders3=__webpack_require__(38),_folders4=_interopRequireDefault(_folders3),_item3=__webpack_require__(8),_item4=_interopRequireDefault(_item3),_settings=__webpack_require__(39),_settings2=_interopRequireDefault(_settings),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list),_refreshTokenWrapper=__webpack_require__(40),_refreshTokenWrapper2=_interopRequireDefault(_refreshTokenWrapper),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_polling=__webpack_require__(22),_polling2=_interopRequireDefault(_polling),_resumable=__webpack_require__(41),_resumable2=_interopRequireDefault(_resumable),_socket=__webpack_require__(23)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function mapFolderList(res){return res.data=(res.data.folders||[]).map(_folder2.default),res}function list(folderId,options){return options=options||{},http.get(settings.apiUrl+"/folders",{media_type:options.mediaType||"picture",folder_id:folderId||null},{headers:options.headers||{}}).then(mapFolderList).catch(_error2.default)}function removeFolder(folderId,options){var url=settings.apiUrl+"/folders/"+folderId+"/delete",postOptions={headers:options.headers||{}};return http.post(url,null,null,postOptions).then(function(res){return res.data={id:folderId},res}).catch(_error2.default)}function remove(folderIds,options){return options=options||{},folderIds.map(function(folderId){return removeFolder(folderId,options)})}return{list:list,remove:remove}};var _folder=__webpack_require__(13),_folder2=_interopRequireDefault(_folder),_error=__webpack_require__(6),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function mapFolder(res){return res.data=(0,_folder2.default)(res.data),res}function create(folderName,options){if(!folderName)return(0,_error2.default)(_mappers2.default.toError({status:-200,statusText:"Internal JS Error",data:{message:"Please specify name"}}));options=options||{};var url=settings.apiUrl+"/folders",data={folder_name:folderName,media_type:options.mediaType||"picture",parent_folder_id:options.parentId||null},postOptions={headers:options.headers||{}};return http.post(url,data,null,postOptions).then(mapFolder).catch(_error2.default)}function update(folder,newFolderProps,options){var arePropsValid=(0,_newProps2.default)(newFolderProps);if(!1===arePropsValid.valid)return(0,_error2.default)(_mappers2.default.toError({status:-200,statusText:"Internal JS Error",data:{message:arePropsValid.message}}));var data={};newFolderProps.name&&(data.folder_name=newFolderProps.name),newFolderProps.parentId&&(data.parent_folder_id=newFolderProps.parentId),options=options||{};var url=settings.apiUrl+"/folders/"+folder.id+"/put",postOptions={headers:options.headers||{}};return http.post(url,data,null,postOptions).then(function(res){return res.data=_utils2.default.extend({},folder,newFolderProps),res}).catch(_error2.default)}return{create:create,update:update}};var _mappers=__webpack_require__(5),_mappers2=_interopRequireDefault(_mappers),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_folder=__webpack_require__(13),_folder2=_interopRequireDefault(_folder),_error=__webpack_require__(6),_error2=_interopRequireDefault(_error),_newProps=__webpack_require__(20),_newProps2=_interopRequireDefault(_newProps)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function mapItemList(res,thumbnailSizes){return res.data=(res.data.files||[]).map(function(data){return(0,_item2.default)(data,settings,thumbnailSizes)}),res}function list(folderId,options){options=options||{};var sort=_utils2.default.extend({},defaultSort,options.sort),paging=_utils2.default.extend({},defaultPaging,options.paging),queryParams={page_size:paging.size,cursor:paging.cursor,parent_folder_id:folderId,media_type:options.mediaType||"picture"};return queryParams.order="desc"===sort.direction?"-"+sort.order:sort.order,http.get(settings.apiUrl+"/files/getpage",queryParams,{headers:options.headers||{}}).then(function(response){return response.paging={size:paging.size,cursor:response.data.cursor},mapItemList(response,options.thumbnails)}).catch(_error2.default)}function removeItem(itemId,options){var queryParams={};settings.ns&&(queryParams.ns=settings.ns);var url=settings.apiUrl+"/files/"+itemId+"/delete",postOptions={headers:options.headers||{}};return http.post(url,null,queryParams,postOptions).then(function(res){return res.data={id:itemId},res}).catch(_error2.default)}function remove(itemIds,options){return options=options||{},itemIds.map(function(itemId){return removeItem(itemId,options)})}function searchByTag(tag,options){options=options||{};var sort=_utils2.default.extend({},defaultSort,options.sort),paging=_utils2.default.extend({},defaultPaging,options.paging),queryParams={page_size:paging.size,cursor:paging.cursor,media_type:options.mediaType||"picture",order:"desc"===sort.direction?"-"+sort.order:sort.order};return http.get(settings.apiUrl+"/files/getpage?tag="+tag,queryParams,{cache:!1,headers:options.headers||{}}).then(function(response){return response.paging={size:paging.size,cursor:response.data.cursor},mapItemList(response,options.thumbnails)}).catch(_error2.default)}function search(folderId,query,options){options=options||{};var sort=_utils2.default.extend({},defaultSort,options.sort),paging=_utils2.default.extend({},defaultPaging,options.paging);query=encodeURIComponent(query);var queryParams={page_size:paging.size,cursor:paging.cursor,media_type:options.mediaType||"picture",parent_folder_id:folderId,order:"desc"===sort.direction?"-"+sort.order:sort.order};return http.get(settings.apiUrl+"/files/search/getpage?query="+query,queryParams,{cache:!1,headers:options.headers||{}}).then(function(response){return response.paging={size:paging.size,cursor:response.data.cursor},mapItemList(response,options.thumbnails)}).catch(_error2.default)}var defaultPaging={size:50,cursor:null},defaultSort={order:"date",direction:"desc"};return{list:list,remove:remove,searchByTag:searchByTag,search:search}};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_item=__webpack_require__(8),_item2=_interopRequireDefault(_item),_error=__webpack_require__(6),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function mapUploadTimings(uploadTimingsHeaders){return uploadTimingsHeaders?uploadTimingsHeaders.split(" ").reduce(function(acc,uploadTiming){var splitUploadTiming=uploadTiming.split("=");return acc[splitUploadTiming[0]]=splitUploadTiming[1],acc},{}):{}}function sendUploadTimingsBiEvent(response,fileSource,uploadUrl,startProgressMark,endProgressMark,endResponseMark){var serverUploadTimings=mapUploadTimings(response.uploadTimingsHeaders),entry=_performance2.default.getResourceTimingByUrl(uploadUrl);if("picture"===fileSource.mediaType&&entry){var requestTime=Math.ceil(endProgressMark-startProgressMark);(!requestTime||requestTime<1)&&(requestTime=1);var responseTime=entry.responseEnd-entry.responseStart,waitTime=Math.round(endResponseMark-endProgressMark-responseTime),uploadSpeed=Math.floor(fileSource.file.size/requestTime/1e3),clientUploadTimings={request_time:requestTime,wait_time:waitTime<0?0:waitTime,response_time:Math.round(responseTime),upload_speed:uploadSpeed};isNaN(waitTime)||isNaN(uploadSpeed)||isNaN(responseTime)||(0,_sendRequest2.default)("/mg",_utils2.default.merge({src:26,evid:_eventIds2.default.BIEventsIds.apiTiming,call_name:"private(item.upload)",file_size:fileSource.file.size},clientUploadTimings,serverUploadTimings))}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http,socket,pollItem,resumableUpload){function getFilesSizeLimit(mediaType){return settings.uploadLimits[_utils2.default.snakeToCamel(mediaType)]}function fileSizeIsInvalid(fileSource){return fileSource.file.size>=getFilesSizeLimit(fileSource.mediaType)}function mapItem(res,thumbnailsSizes){return res.data=(0,_item2.default)(res.data,settings,thumbnailsSizes),res}function cleanUp(){isPromiseResolved=!0,clearTimeout(rejectTimeoutId),socket.off("message",funcToUnsubscribe)}function resolveItemIdFromSocketMessage(itemIdFromResponse,resolve){return function(message){var itemId=_utils2.default.get(message,"file.file_name");"status_update"===message.type&&_utils2.default.get(message,"file.op_status")===_transcodingStatuses2.default.READY&&itemId===itemIdFromResponse&&resolve(itemId)}}function checkItemStatus(itemId,resolve){setTimeout(function(){isPromiseResolved||get(itemId).then(function(response){if(_utils2.default.get(response,"data.transcodingStatus")!==_transcodingStatuses2.default.READY)return _bluebirdExtend2.default.reject();resolve(itemId)}).catch(function(){checkItemStatus(itemId,resolve)})},POLLING_TIMEOUT)}function resolveItemIdFromResponse(itemId){return new _bluebirdExtend2.default(function(resolve,reject){if(!itemId)return void reject();checkItemStatus(itemId,resolve)})}function waitForItemFromStorage(response){isPromiseResolved=!1;var itemId=_utils2.default.get(response,"data.payload.file_name")||_utils2.default.get(response,"data.file_name"),resolveItemIdFromSocket=new _bluebirdExtend2.default(function(resolve){funcToUnsubscribe=resolveItemIdFromSocketMessage(itemId,resolve),socket.on("message",funcToUnsubscribe)}),rejectNotReadyItem=new _bluebirdExtend2.default(function(resolve,reject){rejectTimeoutId=setTimeout(function(){reject({status:406,data:{message:"Not ready item"}})},TIMEOUT_BEFORE_REJECT)});return _bluebirdExtend2.default.race([resolveItemIdFromSocket,resolveItemIdFromResponse(itemId),rejectNotReadyItem]).then(function(itemId){return cleanUp(),_bluebirdExtend2.default.resolve(itemId)}).catch(function(error){return cleanUp(),_bluebirdExtend2.default.reject(error)})}function getUploadUrl(fileSource){var file=fileSource.file,url=settings.apiUrl+"/files/"+function(mediaType){return"secure_music"===mediaType?"music-goods/upload":"video"===mediaType?"video/upload":"upload"}(fileSource.mediaType)+"/url",data={media_type:fileSource.mediaType,file_name:file.name.toLowerCase(),file_size:file.size,content_type:file.type},postOptions={withCredentials:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"}};return http.post(url,data,null,postOptions)}function uploadByUrl(fileSource,options,skipWaitingItemFromStorage){options=options||{};var data={url:_utils2.default.normalizeUri(fileSource.url),media_type:fileSource.mediaType,name:fileSource.name||"Untitled",tags:fileSource.tags?fileSource.tags.join(","):null,parent_folder_id:fileSource.folderId||null};fileSource.headers&&(data.headers=JSON.stringify(fileSource.headers)),fileSource.catalogCallbackUrl&&(data.cat_callback_url=fileSource.catalogCallbackUrl),settings.siteMediaToken&&(data.siteMediaToken=settings.siteMediaToken);var apiUrl=settings.apiUrl+"/files/upload/external";if(settings.asyncUploadByUrl||skipWaitingItemFromStorage){socket.open();var apiUrlAsync=apiUrl+"/async",headers=_utils2.default.extend({},options.headers,{"Content-Type":"application/x-www-form-urlencoded"}),postOptions={headers:headers};return http.post(apiUrlAsync,data,null,postOptions).then(function(response){return skipWaitingItemFromStorage?(pollItem(response.data.payload.file_name),response.data=(0,_item2.default)(response.data.payload,settings),response):waitForItemFromStorage(response).then(get)}).catch(_error2.default)}var uploadPromise=http.get(apiUrl,data,{headers:options.headers||{}}).progress(function(progress){uploadPromise.notify(progress)}).then(function(res){return mapItem(res,options.thumbnails)});return uploadPromise}function upload(fileSource,options){options=options||{};var data={parent_folder_id:fileSource.folderId||null,file:fileSource.file,media_type:fileSource.mediaType};if(fileSource.catalogCallbackUrl&&(data.cat_callback_url=fileSource.catalogCallbackUrl),fileSource.encodingOptions&&(data.encoding_options=JSON.stringify(fileSource.encodingOptions)),settings.vision&&(data.vision=settings.vision.join(",")),settings.siteMediaToken&&(data.siteMediaToken=settings.siteMediaToken),fileSizeIsInvalid(fileSource)){var limit=_utils2.default.bytesToSize(getFilesSizeLimit(fileSource.mediaType)),fileSize=_utils2.default.bytesToSize(fileSource.file.size);return _bluebirdExtend2.default.reject(_mappers2.default.toError({status:-406,statusText:"Not Acceptable",data:{error_code:-7752,error_description:"File size "+fileSize+" exceeds upload limit of "+limit,error_info:{key:"wmp_error.file_size_exceeded_limit",args:[fileSize,limit]}}}))}_performance2.default.clearResourceTimings();var startProgressMark,endProgressMark,uploadUrl,isAsyncFontUploadAllowed=settings.asyncFontUpload,isUploadFont="ufont"===data.media_type,isBigFile=_utils2.default.get(data,"file.size")>MIN_FONT_SIZE,isAsyncFontUpload=isAsyncFontUploadAllowed&&isUploadFont&&isBigFile,uploadPromiseChain=getUploadUrl(fileSource).then(function(response){var responseData=response.data;return data.upload_token=responseData.upload_token,uploadUrl=responseData.upload_url,isAsyncFontUpload&&(socket.open(),data.upload_async=!0),http.upload(uploadUrl,data,{headers:options.headers||{}}).progress(function(progress){startProgressMark||(startProgressMark=_performance2.default.getNow()),progress.loaded>=progress.total&&(endProgressMark=_performance2.default.getNow()),uploadPromiseChain.notify(progress)})}).then(function(response){var endResponseMark=_performance2.default.getNow();if(response.data=response.data[0],sendUploadTimingsBiEvent(response,fileSource,uploadUrl,startProgressMark,endProgressMark,endResponseMark),isAsyncFontUpload)return waitForItemFromStorage(response).then(get);var status=_utils2.default.get(response,"data.op_status");return settings.asyncTranscoding&&status&&status!==_transcodingStatuses2.default.READY&&(socket.open(),pollItem(response.data.file_name)),response.data=(0,_item2.default)(response.data,settings),response}).catch(_error2.default);return uploadPromiseChain}function uploadResumable(fileSource,options){if(fileSizeIsInvalid(fileSource)){var limit=_utils2.default.bytesToSize(getFilesSizeLimit(fileSource.mediaType)),fileSize=_utils2.default.bytesToSize(fileSource.file.size);return _bluebirdExtend2.default.reject(_mappers2.default.toError({status:-406,statusText:"Not Acceptable",data:{error_code:-7752,error_description:"File size "+fileSize+" exceeds upload limit of "+limit,error_info:{key:"wmp_error.file_size_exceeded_limit",args:[fileSize,limit]}}}))}var data={parent_folder_id:fileSource.folderId||null,file:fileSource.file,media_type:fileSource.mediaType||"picture"};return resumableUpload(data,options)}function get(itemId,options){return options=options||{},http.get(settings.apiUrl+"/files/"+itemId,null,{cache:!1,headers:options.headers||{}}).then(function(res){return mapItem(res,options.thumbnails)}).catch(_error2.default)}function update(item,newItemProps,options){var arePropsValid=(0,_newProps2.default)(newItemProps);if(!1===arePropsValid.valid)return(0,_error2.default)(_mappers2.default.toError({status:-200,statusText:"Internal JS Error",data:{message:arePropsValid.message}}));var data={};newItemProps.name&&(data.original_file_name=newItemProps.name),newItemProps.folderId&&(data.parent_folder_id=newItemProps.folderId),newItemProps.tags&&(data.tags=newItemProps.tags.join(",")),options=options||{};var url=settings.apiUrl+"/files/"+item.id+"/put",postOptions={headers:options.headers||{}};return http.post(url,data,null,postOptions).then(function(res){return res.data=_utils2.default.extend({},item,newItemProps),res}).catch(_error2.default)}var isPromiseResolved,rejectTimeoutId,funcToUnsubscribe;return{upload:upload,uploadResumable:uploadResumable,uploadByUrl:uploadByUrl,get:get,update:update}};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=_interopRequireDefault(_bluebirdExtend),_performance=__webpack_require__(34),_performance2=_interopRequireDefault(_performance),_eventIds=__webpack_require__(14),_eventIds2=_interopRequireDefault(_eventIds),_sendRequest=__webpack_require__(15),_sendRequest2=_interopRequireDefault(_sendRequest),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_item=__webpack_require__(8),_item2=_interopRequireDefault(_item),_error=__webpack_require__(6),_error2=_interopRequireDefault(_error),_newProps=__webpack_require__(20),_newProps2=_interopRequireDefault(_newProps),_mappers=__webpack_require__(5),_mappers2=_interopRequireDefault(_mappers),_transcodingStatuses=__webpack_require__(10),_transcodingStatuses2=_interopRequireDefault(_transcodingStatuses),POLLING_TIMEOUT=15e3,TIMEOUT_BEFORE_REJECT=6e5,MIN_FONT_SIZE=4096},function(module,exports,__webpack_require__){"use strict";(function(global){function _getEntries(){if(performance)return performance.getEntries?performance.getEntries():void 0}function clearResourceTimings(){isEntriesCleared||performance&&performance.clearResourceTimings&&(performance.clearResourceTimings(),isEntriesCleared=!0)}function getNow(){if(performance&&performance.now)return performance.now()}function getResourceTimingByUrl(url){var entries=_getEntries();if(!entries)return null;var performanceEntries=entries.filter(function(entry){return entry.name.indexOf(url)>=0});return _utils2.default.sortBy(performanceEntries,"startTime").pop()}Object.defineProperty(exports,"__esModule",{value:!0});var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils),isEntriesCleared=!1,performance=global.performance;exports.default={clearResourceTimings:clearResourceTimings,getNow:getNow,getResourceTimingByUrl:getResourceTimingByUrl}}).call(exports,__webpack_require__(21))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function remove(options){var url=settings.apiUrl+"/trash/delete",data={media_type:options.mediaType||"picture",all_files:!0};return http.post(url,data).catch(_error2.default)}function restore(options){var url=settings.apiUrl+"/trash/restore",data={media_type:options.mediaType||"picture",all_files:!0};return http.post(url,data).catch(_error2.default)}return{remove:remove,restore:restore}};var _error=__webpack_require__(6),_error2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function mapItemList(res,thumbnailSizes){return res.data=(res.data.trash_files||[]).map(function(_item){var item=(0,_item3.default)(_item,settings,thumbnailSizes);return item.isInTrash=!0,item}),res}function list(folderId,options){options=options||{};var sort=_utils2.default.extend({},defaultSort,options.sort),paging=_utils2.default.extend({},defaultPaging,options.paging),queryParams={page_size:paging.size,cursor:paging.cursor,parent_folder_id:folderId,media_type:options.mediaType||"picture"};return queryParams.order="desc"===sort.direction?"-"+sort.order:sort.order,http.get(settings.apiUrl+"/files/getpage/trash",queryParams,{headers:options.headers||{}}).then(function(response){return response.paging={size:paging.size,cursor:response.data.cursor},mapItemList(response,options.thumbnails)}).catch(_error2.default)}function removeItem(itemId,options){var url=settings.apiUrl+"/trash/files/"+itemId+"/delete",postOptions={headers:options.headers||{}};return http.post(url,null,null,postOptions).then(function(res){return res.data={id:itemId},res}).catch(_error2.default)}function remove(itemIds,options){return options=options||{},itemIds.map(function(itemId){return removeItem(itemId,options)})}function restoreItem(itemId,options){var url=settings.apiUrl+"/trash/files/"+itemId+"/restore",postOptions={headers:options.headers||{}};return http.post(url,null,null,postOptions).then(function(res){return res.data={id:itemId},res}).catch(_error2.default)}function restore(itemIds,options){return options=options||{},itemIds.map(function(itemId){return restoreItem(itemId,options)})}var defaultPaging={size:50,cursor:null},defaultSort={order:"date",direction:"desc"};return{list:list,remove:remove,restore:restore}};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_item2=__webpack_require__(8),_item3=_interopRequireDefault(_item2),_error=__webpack_require__(6),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function mapItemList(res,thumbnailSizes){var isSiteOwner=res.data.site_owner;return res.data=(res.data.files||[]).map(function(_item){var item=(0,_item3.default)(_item,settings,thumbnailSizes,isSiteOwner);return item.isInSiteMedia=!0,item}),res}function list(folderId,options){options=options||{};var sort=_utils2.default.extend({},defaultSort,options.sort),paging=_utils2.default.extend({},defaultPaging,options.paging),queryParams={page_size:paging.size,cursor:paging.cursor,parent_folder_id:folderId,media_type:options.mediaType||"picture",siteMediaToken:settings.siteMediaToken};return queryParams.order="desc"===sort.direction?"-"+sort.order:sort.order,http.get(settings.apiUrl+"/files/getpage/site",queryParams,{headers:options.headers||{}}).then(function(response){return response.paging={size:paging.size,cursor:response.data.cursor},mapItemList(response,options.thumbnails)}).catch(_error2.default)}function remove(itemIds,options){options=options||{};var data={files:itemIds},url=settings.apiUrl+"/files/site/remove?siteMediaToken="+settings.siteMediaToken,postOptions={headers:options.headers||{}};return http.post(url,data,null,postOptions).then(function(res){return res.data={itemIds:itemIds},res}).catch(_error2.default)}function add(itemIds,options){options=options||{};var data={files:itemIds},url=settings.apiUrl+"/files/site/add?siteMediaToken="+settings.siteMediaToken,postOptions={headers:options.headers||{}};return http.post(url,data,null,postOptions).catch(_error2.default)}var defaultPaging={size:50,cursor:null},defaultSort={order:"date",direction:"desc"};return{list:list,remove:remove,add:add}};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_item2=__webpack_require__(8),_item3=_interopRequireDefault(_item2),_error=__webpack_require__(6),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function mapFolderList(res){return res.data=(res.data.trash_folders||[]).map(function(_folder){var folder=(0,_folder3.default)(_folder);return folder.isInTrash=!0,folder}),res}function list(folderId,options){options=options||{};var queryParams={media_type:options.mediaType||"picture",folder_id:folderId||null,trash_type:"folder"};return http.get(settings.apiUrl+"/files/getpage/trash",queryParams,{headers:options.headers||{}}).then(mapFolderList).catch(_error2.default)}function removeFolder(folderId,options){var url=settings.apiUrl+"/trash/folders/"+folderId+"/delete",postOptions={headers:options.headers||{}};return http.post(url,null,null,postOptions).then(function(res){return res.data={id:folderId},res}).catch(_error2.default)}function remove(folderIds,options){return options=options||{},folderIds.map(function(folderId){return removeFolder(folderId,options)})}function restoreFolder(folderId,options){var url=settings.apiUrl+"/trash/folders/"+folderId+"/restore",postOptions={headers:options.headers||{}};return http.post(url,null,null,postOptions).then(function(res){return res.data={id:folderId},res}).catch(_error2.default)}function restore(folderIds,options){return options=options||{},folderIds.map(function(folderId){return restoreFolder(folderId,options)})}return{list:list,remove:remove,restore:restore}};var _folder2=__webpack_require__(13),_folder3=_interopRequireDefault(_folder2),_error=__webpack_require__(6),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//files.wix.com",imageOperationsApi:"vangogh",filesUrl:"//static.wixstatic.com",videoFilesUrl:"//video.wixstatic.com",refreshTokenUrl:null,requestOptions:{withCredentials:!0},uploadLimits:{default:15728640,document:15728640,picture:15728640,music:52428800,secureMusic:377487360,video:524288e3,secureVideo:1610612736},thumbnailSizes:{thumbnail:{width:210,height:210,mode:"fill"},preview:{width:375,height:375,mode:"fit"},original:{width:1e3,height:1e3,mode:"fit"}},blackArrow:{wsUrl:"wss://ws.wixmp.com/ws",messageUrl:"https://ws.wixmp.com/message",tokenUrl:"/users/get-batoken"},asyncFontUpload:!1,asyncUploadByUrl:!1,asyncTranscoding:!1,videoPreviewQuality:"480p"}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(refreshTokenUrl){function isRecentlyRefreshed(){return(new Date).valueOf()-refreshedAt<1e4}var authHeaders={},refreshedAt=0;return function(method){var methodWithAuthHeaders=function(){var originalHeaders=(arguments[2]||{}).headers||{};return method.call(this,arguments[0],arguments[1]||{},_utils2.default.merge(arguments[2]||{},{headers:_utils2.default.merge(authHeaders,originalHeaders)}))};return http.catchError(methodWithAuthHeaders,function(reason,callMethod){return 403!==reason.code||isRecentlyRefreshed()?_bluebirdExtend2.default.reject(reason):http.post(refreshTokenUrl).then(function(response){return authHeaders=response.data.set_headers||{},refreshedAt=(new Date).valueOf(),callMethod()})})}};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=_interopRequireDefault(_bluebirdExtend),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),http=(0,_http2.default)()},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getCurrentTime(){return(new Date).getTime()}function getBlobArrayBuffer(blob){
return new _bluebirdExtend2.default(function(resolve,reject){var reader=new FileReader;reader.readAsArrayBuffer(blob),reader.onload=function(event){var arrayBuffer=new Int32Array(event.target.result);resolve(arrayBuffer)},reader.onerror=function(reason){reject(reason)}})}function getHash(blob){var startedAt=getCurrentTime();return getBlobArrayBuffer(blob.slice(0,HASH_SIZE)).then(function(arrayBuffer){return console.log("time to get hash",getCurrentTime()-startedAt),_crc2.default.buf(arrayBuffer).toString(16)},_error2.default)}function getSliceFunction(file){return file.slice?"slice":file.mozSlice?"mozSlice":file.webkitSlice?"webkitSlice":"slice"}function getBytesToUpload(chunksToUpload){return chunksToUpload.reduce(function(prevValue,nextValue){return prevValue+_utils2.default.get(nextValue,"data.resumableCurrentChunkSize",0)},0)}function getFileId(file,chunksLength){var startHash=getHash(file.file.slice(0,HASH_SIZE)),endHash=getHash(file.file.slice(-HASH_SIZE));return _bluebirdExtend2.default.all([startHash,endHash]).then(function(response){return response[0]+"_"+response[1]+"_"+chunksLength},_error2.default)}function getChunkSize(size){return size<104857600?10485760:size<524288e3?26214400:size<2147483648?52428800:size<5368709120?104857600:Math.ceil(size/100)}function getChunksFromFile(fileSource){var file=fileSource.file,funcToSlice=getSliceFunction(file),chunks=[],startBytes=0,chunkSize=getChunkSize(file.size);for(console.log("chunkSize",chunkSize);startBytes<file.size;)chunks.push(file[funcToSlice](startBytes,startBytes+chunkSize)),startBytes+=chunkSize;return chunks}function getNotReadyChunks(chunksStatuses){return chunksStatuses.filter(function(chunk){return"READY"!==chunk.status})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,adapter,itemMapper,http){function checkAllChunks(fileId,chunks){var url=settings.apiUrl+"/resumable/chunk/status",data={resumableIdentifier:fileId,resumableTotalChunks:chunks.length},options={withCredentials:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"}};return http.post(url,data,null,options).then(function(response){return response.data.resumableChunks},_error2.default)}function uploadChunks(chunksToUpload,allChunksLength,file,fileId,resumableUploadPromise,options){var bytesTotalUploaded=0,currentChunkBytesLoaded=0;allChunksLength!==chunksToUpload.length&&(bytesTotalUploaded=file.file.size-getBytesToUpload(chunksToUpload));var fileToUpload=_utils2.default.find(_uploadCollection2.default.uploadQueue,function(el){return el.source.file===file.file});console.log("start chunks upload");var uploadedChunkResponses=[];return new _bluebirdExtend2.default(function(resolve,reject){function uploadChunk(chunkId){var chunk=chunksToUpload[chunkId];if(!chunk)return void resolve(uploadedChunkResponses);(0,_sendRequest2.default)("/mg",{src:26,evid:_eventIds2.default.BIEventsIds.resumableChunkUploadStarted,chunk_size:_utils2.default.get(chunk,"data.chunk.size",-1),file_id:fileId,file_size:file.file.size,total_chunks:allChunksLength});var chunkUploadStartedAt=getCurrentTime(),uploadChunkPromise=http.upload(chunk.uploadUrl,chunk.data,options).progress(function(progress){var chunkBytesLoaded=progress.loaded>=progress.total?progress.total:progress.loaded;bytesTotalUploaded+=chunkBytesLoaded-currentChunkBytesLoaded,currentChunkBytesLoaded=chunkBytesLoaded;var progressStatus="uploading";bytesTotalUploaded>=file.file.size&&(progressStatus="processing"),resumableUploadPromise.notify({loaded:bytesTotalUploaded,status:progressStatus,total:file.file.size})}).then(function(response){var chunkUploadTime=(getCurrentTime()-chunkUploadStartedAt)/1e3;(0,_sendRequest2.default)("/mg",{src:26,evid:_eventIds2.default.BIEventsIds.resumableChunkUploadFinished,chunk_size:_utils2.default.get(chunk,"data.chunk.size",-1),file_id:fileId,file_size:file.file.size,total_chunks:allChunksLength,upload_speed:Math.floor(file.file.size/chunkUploadTime),upload_time:Math.floor(chunkUploadTime)}),currentChunkBytesLoaded=0,uploadedChunkResponses.push(response.data),console.log("chunk",chunkId,"was uploaded"),uploadChunk(chunkId+1)},function(reason){return console.warn("upload file error",reason),reason instanceof _bluebirdExtend2.default.CancellationError?_bluebirdExtend2.default.reject(reason):(resumableUploadPromise.notify({loaded:bytesTotalUploaded,status:"failed",total:file.file.size}),_bluebirdExtend2.default.reject(reason))}).catch(function(reason){console.warn("error file upload!!!",reason),reject(reason)});return fileToUpload.uploadPromise.abort=function(){uploadChunkPromise.abort()},uploadChunkPromise}uploadChunk(0)})}function finalizeItem(fileId,fileSource){var params={resumableIdentifier:fileId,content_type:fileSource.file.type,file_name:fileSource.file.name,media_type:fileSource.media_type,parent_folder_id:fileSource.parent_folder_id};return http.get(settings.apiUrl+"/resumable/finalize",params)}return function(fileSource,options){console.log("resumable upload started"),options=options||{};var fileId,fileUploadStartedAt=getCurrentTime(),chunks=getChunksFromFile(fileSource);console.log("chunks",chunks.length),console.log("chunks",chunks);var resumableUploadPromise;return resumableUploadPromise=new _bluebirdExtend2.default(function(resolve,reject){getFileId(fileSource,chunks.length).then(function(responseFileId){fileId=responseFileId,console.log("fileId",fileId)}).then(function(){return checkAllChunks(fileId,chunks).then(getNotReadyChunks,_error2.default)}).then(function(notReadyChunks){console.log("notReadyChunks",notReadyChunks),(0,_sendRequest2.default)("/mg",{src:26,evid:_eventIds2.default.BIEventsIds.resumableUploadStarted,file_id:fileId,file_size:fileSource.file.size,uploaded_chunks:chunks.length-notReadyChunks.length,total_chunks:chunks.length,chunks_status_time:Math.floor((getCurrentTime()-fileUploadStartedAt)/1e3)});var defaultData={resumableIdentifier:fileId,resumableTotalChunks:chunks.length,parent_folder_id:fileSource.folderId||null,media_type:fileSource.media_type};return uploadChunks(notReadyChunks.map(function(chunk){var chunkData=_utils2.default.merge(defaultData,{chunk:chunks[chunk.chunkNumber],resumableChunkNumber:chunk.chunkNumber,resumableCurrentChunkSize:chunks[chunk.chunkNumber].size});return{uploadUrl:chunk.uploadUrl,data:chunkData}}),chunks.length,fileSource,fileId,resumableUploadPromise,options)}).then(function(uploadedChunkResponses){console.log("all chunks were uploaded"),console.log("all uploaded chunks responses",uploadedChunkResponses);var chunksUploadedInCurrentSession=uploadedChunkResponses.length;return finalizeItem(fileId,fileSource).then(function(response){console.log("chunksUploadedInCurrentSession",chunksUploadedInCurrentSession),console.log("finalizeItem response",response);var fileSize=fileSource.file.size,uploadTime=(getCurrentTime()-fileUploadStartedAt)/1e3;return(0,_sendRequest2.default)("/mg",{src:26,evid:_eventIds2.default.BIEventsIds.resumableUploadFinished,file_id:fileId,file_size:fileSource.file.size,uploaded_chunks:chunksUploadedInCurrentSession,total_chunks:chunks.length,upload_speed:Math.floor(fileSize/uploadTime),upload_time:Math.floor(uploadTime)}),resolve(response)},function(reason){return console.warn("finalize error",reason),_bluebirdExtend2.default.reject(reason)})}).catch(function(reason){console.warn("resumable",reason),reject(reason)})})}};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=_interopRequireDefault(_bluebirdExtend),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_crc=__webpack_require__(42),_crc2=_interopRequireDefault(_crc),_uploadCollection=__webpack_require__(18),_uploadCollection2=_interopRequireDefault(_uploadCollection),_sendRequest=__webpack_require__(15),_sendRequest2=_interopRequireDefault(_sendRequest),_eventIds=__webpack_require__(14),_eventIds2=_interopRequireDefault(_eventIds),_error=__webpack_require__(6),_error2=_interopRequireDefault(_error),HASH_SIZE=1048576},function(module,exports,__webpack_require__){"use strict";function crc32_bstr(bstr,seed){for(var C=-1^seed,L=bstr.length-1,i=0;i<L;)C=C>>>8^T[255&(C^bstr.charCodeAt(i++))],C=C>>>8^T[255&(C^bstr.charCodeAt(i++))];return i===L&&(C=C>>>8^T[255&(C^bstr.charCodeAt(i))]),C}function crc32_buf(buf,seed){if(buf.length>1e4)return crc32_buf_8(buf,seed);for(var C=-1^seed,L=buf.length-3,i=0;i<L;)C=C>>>8^T[255&(C^buf[i++])],C=C>>>8^T[255&(C^buf[i++])],C=C>>>8^T[255&(C^buf[i++])],C=C>>>8^T[255&(C^buf[i++])];for(;i<L+3;)C=C>>>8^T[255&(C^buf[i++])];return C}function crc32_buf_8(buf,seed){for(var C=-1^seed,L=buf.length-7,i=0;i<L;)C=C>>>8^T[255&(C^buf[i++])],C=C>>>8^T[255&(C^buf[i++])],C=C>>>8^T[255&(C^buf[i++])],C=C>>>8^T[255&(C^buf[i++])],C=C>>>8^T[255&(C^buf[i++])],C=C>>>8^T[255&(C^buf[i++])],C=C>>>8^T[255&(C^buf[i++])],C=C>>>8^T[255&(C^buf[i++])];for(;i<L+7;)C=C>>>8^T[255&(C^buf[i++])];return C}function crc32_str(str,seed){for(var c,d,C=-1^seed,i=0,L=str.length;i<L;)c=str.charCodeAt(i++),c<128?C=C>>>8^T[255&(C^c)]:c<2048?(C=C>>>8^T[255&(C^(192|c>>6&31))],C=C>>>8^T[255&(C^(128|63&c))]):c>=55296&&c<57344?(c=64+(1023&c),d=1023&str.charCodeAt(i++),C=C>>>8^T[255&(C^(240|c>>8&7))],C=C>>>8^T[255&(C^(128|c>>2&63))],C=C>>>8^T[255&(C^(128|d>>6&15|(3&c)<<4))],C=C>>>8^T[255&(C^(128|63&d))]):(C=C>>>8^T[255&(C^(224|c>>12&15))],C=C>>>8^T[255&(C^(128|c>>6&63))],C=C>>>8^T[255&(C^(128|63&c))]);return C}Object.defineProperty(exports,"__esModule",{value:!0});var CRC32={};CRC32.version="1.0.1";var T=function(){for(var c=0,table=new Array(256),n=0;256!=n;++n)c=n,c=1&c?-306674912^c>>>1:c>>>1,c=1&c?-306674912^c>>>1:c>>>1,c=1&c?-306674912^c>>>1:c>>>1,c=1&c?-306674912^c>>>1:c>>>1,c=1&c?-306674912^c>>>1:c>>>1,c=1&c?-306674912^c>>>1:c>>>1,c=1&c?-306674912^c>>>1:c>>>1,c=1&c?-306674912^c>>>1:c>>>1,table[n]=c;return"undefined"!=typeof Int32Array?new Int32Array(table):table}();CRC32.table=T,CRC32.bstr=crc32_bstr,CRC32.buf=crc32_buf,CRC32.str=crc32_str,exports.default=CRC32},function(module,exports,__webpack_require__){"use strict";function promisify(value){return value.then?value:_bluebirdExtend2.default.resolve(value)}function _canAbort(fileToUpload){return"waiting"===fileToUpload.status||"uploading"===fileToUpload.status&&_bluebirdExtend2.default.prototype.cancellable}function abortEarly(fileToUpload){fileToUpload.deferred.promise.catch(function(reason){fileToUpload.status="failed",fileToUpload.error=reason}),fileToUpload.deferred.promise.abort()}function initUpload(fileToUpload,data){fileToUpload.status="uploading",fileToUpload.uploadPromise=promisify(data.uploadFn(fileToUpload.source)).progress(function(progress){fileToUpload.deferred.promise.notify(progress)}).then(function(res){fileToUpload.deferred.resolve(res)}).catch(function(reason){fileToUpload.status="failed",fileToUpload.error=reason,fileToUpload.deferred.reject(reason)}),fileToUpload.uploadPromise.notify({status:fileToUpload.status,total:fileToUpload.getFileSize(),loaded:0})}function createDeferred(){return _bluebirdExtend2.default.defer()}function map(data){return{source:data.source,status:"waiting",bytesLoaded:0,currentChunkBytesLoaded:0,deferred:createDeferred(),isAborted:!1,error:{},upload:function(){return this.isAborted||initUpload(this,data),this.deferred.promise},abort:function(){if(_canAbort(this)){if(this.isAborted=!0,"waiting"===this.status)return void abortEarly(this);this.uploadPromise.abort()}},canRetry:function(){if(this.error instanceof _bluebirdExtend2.default.CancellationError)return!0;var codesToRetry=[-201,401,403,408];return"failed"===this.status&&-1!==codesToRetry.indexOf(this.error.code)},signUpForRetry:function(){this.status="waiting",this.isAborted=!1,this.error={},this.deferred=createDeferred()},canAbort:function(){return _canAbort(this)},getFileSize:function(){return this.source.file?this.source.file.size:1}}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=map;var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";(function(global){function sendNewRelicError(message,details){global.newrelic&&global.newrelic.addPageAction("error",{source:"wixmp-sdk",message:message,details:details})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={sendError:sendNewRelicError}}).call(exports,__webpack_require__(21))},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(userSettings){var settings=_utils2.default.extendDeep({},_settings2.default,userSettings),requestOptions=settings.requestOptions,socket=(0,_socket.initSocket)(settings,this,requestOptions),http=(0,_http2.default)(requestOptions),polling=(0,_polling2.default)(settings,this,_item4.default,http),folders=(0,_folders2.default)(settings,http),foldersTrash=(0,_folders4.default)(settings,http),folder=(0,_folder2.default)(settings,http),items=(0,_items2.default)(settings,http),itemsTrash=(0,_items4.default)(settings,http),itemsSiteMedia=(0,_items6.default)(settings,http),item=(0,_item2.default)(settings,http,socket,polling),trash=(0,_trash2.default)(settings,http);folders.trash=foldersTrash,items.trash=itemsTrash,items.siteMedia=itemsSiteMedia,this.name="platform",this.folders=_decorators2.default.addEvents(this,_list2.default.FOLDERS,folders),this.folder=_decorators2.default.addEvents(this,_list2.default.FOLDER,folder),this.item=_decorators2.default.addEvents(this,_list2.default.ITEM,item),this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items),this.trash=_decorators2.default.addEvents(this,_list2.default.TRASH,trash),this.blackArrow=socket};var _folders=__webpack_require__(46),_folders2=_interopRequireDefault(_folders),_folder=__webpack_require__(47),_folder2=_interopRequireDefault(_folder),_items=__webpack_require__(48),_items2=_interopRequireDefault(_items),_item=__webpack_require__(49),_item2=_interopRequireDefault(_item),_trash=__webpack_require__(50),_trash2=_interopRequireDefault(_trash),_items3=__webpack_require__(51),_items4=_interopRequireDefault(_items3),_items5=__webpack_require__(52),_items6=_interopRequireDefault(_items5),_folders3=__webpack_require__(53),_folders4=_interopRequireDefault(_folders3),_item3=__webpack_require__(11),_item4=_interopRequireDefault(_item3),_settings=__webpack_require__(54),_settings2=_interopRequireDefault(_settings),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_polling=__webpack_require__(22),_polling2=_interopRequireDefault(_polling),_socket=__webpack_require__(23)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function mapFolderList(res){return res.data=(res.data.objects||[]).map(_folder2.default),res}function list(folderId,options){return options=options||{},http.get(settings.apiUrl+"/objects/folders/",{media_type:options.mediaType||"picture",folder_id:folderId||null},{headers:options.headers||{}}).then(mapFolderList).catch(_error2.default)}function removeFolder(folderId,options){var url=settings.apiUrl+"/objects/folders/"+folderId+"/delete",postOptions={headers:options.headers||{}};return http.post(url,null,null,postOptions).then(function(res){return res.data={id:folderId},res}).catch(_error2.default)}function remove(folderIds,options){return options=options||{},folderIds.map(function(folderId){return removeFolder(folderId,options)})}return{list:list,remove:remove}};var _folder=__webpack_require__(16),_folder2=_interopRequireDefault(_folder),_error=__webpack_require__(7),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function mapFolder(res){return res.data=(0,_folder2.default)(res.data.object),res}function create(folderName,options){if(!folderName)return(0,_error2.default)(_mappers2.default.toError({status:-200,statusText:"Internal JS Error",data:{message:"Please specify name"}}));options=options||{};var url=settings.apiUrl+"/objects/folders/",data={title:folderName,media_type:options.mediaType||"picture",parent:options.parentId||null},postOptions={headers:options.headers||{}};return http.post(url,data,null,postOptions).then(mapFolder).catch(_error2.default)}function update(folder,newFolderProps,options){var arePropsValid=(0,_newProps2.default)(newFolderProps);if(!1===arePropsValid.valid)return(0,_error2.default)(_mappers2.default.toError({status:-200,statusText:"Internal JS Error",data:{message:arePropsValid.message}}));var data={};newFolderProps.name&&(data.folder_name=newFolderProps.name),newFolderProps.parentId&&(data.parent_folder_id=newFolderProps.parentId),options=options||{};var url=settings.apiUrl+"/objects/folders/"+folder.id+"/",postOptions={headers:options.headers||{}};return http.post(url,data,null,postOptions).then(function(res){return res.data=_utils2.default.extend({},folder,newFolderProps),res}).catch(_error2.default)}return{create:create,update:update}};var _mappers=__webpack_require__(5),_mappers2=_interopRequireDefault(_mappers),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_folder=__webpack_require__(16),_folder2=_interopRequireDefault(_folder),_error=__webpack_require__(7),_error2=_interopRequireDefault(_error),_newProps=__webpack_require__(24),_newProps2=_interopRequireDefault(_newProps)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function mapItemList(res,thumbnailSizes){return res.data=(res.data.objects||[]).map(function(data){return(0,_item2.default)(data,settings,thumbnailSizes)}),res}function list(folderId,options){options=options||{};var sort=_utils2.default.extend({},defaultSort,options.sort),paging=_utils2.default.extend({},defaultPaging,options.paging),queryParams={page_size:paging.size,cursor:paging.cursor,folder:folderId,media_type:options.mediaType||"picture"};return queryParams.order="desc"===sort.direction?"-"+sort.order:sort.order,http.get(settings.apiUrl+"/objects/items/",queryParams,{headers:options.headers||{}}).then(function(response){return response.paging={size:paging.size,cursor:response.data.cursor},mapItemList(response,options.thumbnails)}).catch(_error2.default)}function removeItem(itemId,options){var queryParams={};settings.ns&&(queryParams.ns=settings.ns);var url=settings.apiUrl+"/objects/items/"+itemId+"/delete",postOptions={headers:options.headers||{}};return http.post(url,null,queryParams,postOptions).then(function(res){return res.data={id:itemId},res}).catch(_error2.default)}function remove(itemIds,options){return options=options||{},itemIds.map(function(itemId){return removeItem(itemId,options)})}function searchByTag(tag,options){options=options||{};var sort=_utils2.default.extend({},defaultSort,options.sort),paging=_utils2.default.extend({},defaultPaging,options.paging),queryParams={page_size:paging.size,cursor:paging.cursor,media_type:options.mediaType||"picture",order:"desc"===sort.direction?"-"+sort.order:sort.order};return http.get(settings.apiUrl+"/files/getpage?tag="+tag,queryParams,{cache:!1,headers:options.headers||{}}).then(function(response){return response.paging={size:paging.size,cursor:response.data.cursor},mapItemList(response,options.thumbnails)}).catch(_error2.default)}function search(folderId,query,options){options=options||{};var sort=_utils2.default.extend({},defaultSort,options.sort),paging=_utils2.default.extend({},defaultPaging,options.paging);query=encodeURIComponent(query);var queryParams={query:query,page_size:paging.size,cursor:paging.cursor,media_type:options.mediaType||"picture",folder:folderId,order:"desc"===sort.direction?"-"+sort.order:sort.order};return http.get(settings.apiUrl+"/search/items",queryParams,{cache:!1,headers:options.headers||{}}).then(function(response){return response.paging={size:paging.size,cursor:response.data.cursor},mapItemList(response,options.thumbnails)}).catch(_error2.default)}var defaultPaging={size:50,cursor:null},defaultSort={order:"date",direction:"desc"};return{list:list,remove:remove,searchByTag:searchByTag,search:search}};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_item=__webpack_require__(11),_item2=_interopRequireDefault(_item),_error=__webpack_require__(7),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http,socket,pollItem){function getFilesSizeLimit(mediaType){return settings.uploadLimits[_utils2.default.snakeToCamel(mediaType)]}function fileSizeIsInvalid(fileSource){return fileSource.file.size>=getFilesSizeLimit(fileSource.mediaType)}function mapItem(res,thumbnailsSizes){return res.data=(0,_item2.default)(res.data,settings,thumbnailsSizes),res}function cleanUp(){isPromiseResolved=!0,clearTimeout(rejectTimeoutId),socket.off("message",funcToUnsubscribe)}function resolveItemIdFromSocketMessage(itemIdFromResponse,resolve){return function(message){var itemId=_utils2.default.get(message,"file.file_name");"status_update"===message.type&&_utils2.default.get(message,"file.op_status")===_transcodingStatuses2.default.READY&&itemId===itemIdFromResponse&&resolve(itemId)}}function checkItemStatus(itemId,resolve){setTimeout(function(){isPromiseResolved||get(itemId).then(function(response){if(_utils2.default.get(response,"data.transcodingStatus")!==_transcodingStatuses2.default.READY)return _bluebirdExtend2.default.reject();resolve(itemId)}).catch(function(){checkItemStatus(itemId,resolve)})},POLLING_TIMEOUT)}function resolveItemIdFromResponse(itemId){return new _bluebirdExtend2.default(function(resolve,reject){if(!itemId)return void reject();checkItemStatus(itemId,resolve)})}function waitForItemFromStorage(response){isPromiseResolved=!1;var itemId=_utils2.default.get(response,"data.payload.file_name")||_utils2.default.get(response,"data.file_name"),resolveItemIdFromSocket=new _bluebirdExtend2.default(function(resolve){funcToUnsubscribe=resolveItemIdFromSocketMessage(itemId,resolve),socket.on("message",funcToUnsubscribe)}),rejectNotReadyItem=new _bluebirdExtend2.default(function(resolve,reject){rejectTimeoutId=setTimeout(function(){reject({status:406,data:{message:"Not ready item"}})},TIMEOUT_BEFORE_REJECT)});return _bluebirdExtend2.default.race([resolveItemIdFromSocket,resolveItemIdFromResponse(itemId),rejectNotReadyItem]).then(function(itemId){return cleanUp(),_bluebirdExtend2.default.resolve(itemId)}).catch(function(error){return cleanUp(),_bluebirdExtend2.default.reject(error)})}function getUploadUrl(fileSource){var file=fileSource.file,url=settings.apiUrl+"/upload/url",data={media_type:fileSource.mediaType,file_name:file.name.toLowerCase(),file_size:file.size,content_type:file.type},postOptions={withCredentials:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"}};return http.post(url,data,null,postOptions)}function uploadByUrl(fileSource,options,skipWaitingItemFromStorage){options=options||{};var data={url:_utils2.default.normalizeUri(fileSource.url),media_type:fileSource.mediaType,name:fileSource.name||"Untitled",tags:fileSource.tags?fileSource.tags.join(","):null,folder:fileSource.folderId||null};fileSource.headers&&(data.headers=JSON.stringify(fileSource.headers)),fileSource.catalogCallbackUrl&&(data.cat_callback_url=fileSource.catalogCallbackUrl),settings.siteMediaToken&&(data.siteMediaToken=settings.siteMediaToken);var apiUrl=settings.apiUrl+"/files/upload/external";if(settings.asyncUploadByUrl||skipWaitingItemFromStorage){socket.open();var apiUrlAsync=apiUrl+"/async",headers=_utils2.default.extend({},options.headers,{"Content-Type":"application/x-www-form-urlencoded"}),postOptions={headers:headers};return http.post(apiUrlAsync,data,null,postOptions).then(function(response){return skipWaitingItemFromStorage?(pollItem(response.data.payload.file_name),response.data=(0,_item2.default)(response.data.payload,settings),response):waitForItemFromStorage(response).then(get)}).catch(_error2.default)}var uploadPromise=http.get(apiUrl,data,{headers:options.headers||{}}).progress(function(progress){uploadPromise.notify(progress)}).then(function(res){return mapItem(res,options.thumbnails)});return uploadPromise}function upload(fileSource,options){options=options||{};var mediaType=fileSource.mediaType,data={file:fileSource.file,media_type:mediaType};if(fileSource.catalogCallbackUrl&&(data.cat_callback_url=fileSource.catalogCallbackUrl),fileSource.encodingOptions&&(data.encoding_options=JSON.stringify(fileSource.encodingOptions)),settings.vision&&(data.vision=settings.vision.join(",")),settings.siteMediaToken&&(data.siteMediaToken=settings.siteMediaToken),fileSizeIsInvalid(fileSource)){var limit=_utils2.default.bytesToSize(getFilesSizeLimit(fileSource.mediaType)),fileSize=_utils2.default.bytesToSize(fileSource.file.size);return _bluebirdExtend2.default.reject(_mappers2.default.toError({status:-406,statusText:"Not Acceptable",data:{error_code:-7752,error_description:"File size "+fileSize+" exceeds upload limit of "+limit,error_info:{key:"wmp_error.file_size_exceeded_limit",args:[fileSize,limit]}}}))}var title=_utils2.default.get(fileSource,"file.name",""),folderId=fileSource.folderId||null,isAsyncFontUploadAllowed=settings.asyncFontUpload,isUploadFont="ufont"===data.media_type,isBigFile=_utils2.default.get(data,"file.size")>MIN_FONT_SIZE,isAsyncFontUpload=isAsyncFontUploadAllowed&&isUploadFont&&isBigFile,uploadPromiseChain=getUploadUrl(fileSource).then(function(response){var responseData=response.data;return data.directory=responseData.path,data.uploadToken=responseData.payload.uploadToken,isAsyncFontUpload&&(socket.open(),data.upload_async=!0),http.upload(responseData.payload.uploadUrl,data,{headers:options.headers||{}}).progress(function(progress){uploadPromiseChain.notify(progress)})}).then(function(response){var refId=_utils2.default.get(response,"data.payload")&&response.data.payload[0]&&response.data.payload[0].id;return refId?http.post(settings.apiUrl+"/objects/items/",{title:title,folder:folderId,media_type:mediaType,ref_id:refId}):_bluebirdExtend2.default.reject("No ref id")}).then(function(response){return response.data=response.data.object,response.data=(0,_item2.default)(response.data,settings),response}).catch(_error2.default);return uploadPromiseChain}function get(itemId,options){return options=options||{},http.get(settings.apiUrl+"/files/"+itemId,null,{cache:!1,headers:options.headers||{}}).then(function(res){return mapItem(res,options.thumbnails)}).catch(_error2.default)}function update(item,newItemProps,options){var arePropsValid=(0,_newProps2.default)(newItemProps);if(!1===arePropsValid.valid)return(0,_error2.default)(_mappers2.default.toError({status:-200,statusText:"Internal JS Error",data:{message:arePropsValid.message}}));var data={};newItemProps.name&&(data.title=newItemProps.name),newItemProps.folderId&&(data.folder=newItemProps.folderId),newItemProps.tags&&(data.tags=newItemProps.tags.join(",")),options=options||{};var url=settings.apiUrl+"/objects/items/"+item.id+"/",postOptions={headers:options.headers||{}};return http.post(url,data,null,postOptions).then(function(res){return res.data=_utils2.default.extend({},item,newItemProps),res}).catch(_error2.default)}var isPromiseResolved,rejectTimeoutId,funcToUnsubscribe;return{upload:upload,uploadByUrl:uploadByUrl,get:get,update:update}};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=_interopRequireDefault(_bluebirdExtend),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_item=__webpack_require__(11),_item2=_interopRequireDefault(_item),_error=__webpack_require__(7),_error2=_interopRequireDefault(_error),_newProps=__webpack_require__(24),_newProps2=_interopRequireDefault(_newProps),_mappers=__webpack_require__(5),_mappers2=_interopRequireDefault(_mappers),_transcodingStatuses=__webpack_require__(10),_transcodingStatuses2=_interopRequireDefault(_transcodingStatuses),POLLING_TIMEOUT=15e3,TIMEOUT_BEFORE_REJECT=6e5,MIN_FONT_SIZE=4096},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function remove(options){var url=settings.apiUrl+"/trash/delete",data={media_type:options.mediaType||"picture",all_files:!0};return http.post(url,data).catch(_error2.default)}function restore(options){var url=settings.apiUrl+"/trash/restore",data={media_type:options.mediaType||"picture",all_files:!0};return http.post(url,data).catch(_error2.default)}return{remove:remove,restore:restore}};var _error=__webpack_require__(7),_error2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function mapItemList(res,thumbnailSizes){return res.data=(res.data.trash_files||[]).map(function(_item){var item=(0,_item3.default)(_item,settings,thumbnailSizes);return item.isInTrash=!0,item}),res}function list(folderId,options){options=options||{};var sort=_utils2.default.extend({},defaultSort,options.sort),paging=_utils2.default.extend({},defaultPaging,options.paging),queryParams={page_size:paging.size,cursor:paging.cursor,parent_folder_id:folderId,media_type:options.mediaType||"picture"};return queryParams.order="desc"===sort.direction?"-"+sort.order:sort.order,http.get(settings.apiUrl+"/files/getpage/trash",queryParams,{headers:options.headers||{}}).then(function(response){return response.paging={size:paging.size,cursor:response.data.cursor},mapItemList(response,options.thumbnails)}).catch(_error2.default)}function removeItem(itemId,options){var url=settings.apiUrl+"/trash/files/"+itemId+"/delete",postOptions={headers:options.headers||{}};return http.post(url,null,null,postOptions).then(function(res){return res.data={id:itemId},res}).catch(_error2.default)}function remove(itemIds,options){return options=options||{},itemIds.map(function(itemId){return removeItem(itemId,options)})}function restoreItem(itemId,options){var url=settings.apiUrl+"/trash/files/"+itemId+"/restore",postOptions={headers:options.headers||{}};return http.post(url,null,null,postOptions).then(function(res){return res.data={id:itemId},res}).catch(_error2.default)}function restore(itemIds,options){return options=options||{},itemIds.map(function(itemId){return restoreItem(itemId,options)})}var defaultPaging={size:50,cursor:null},defaultSort={order:"date",direction:"desc"};return{list:list,remove:remove,restore:restore}};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_item2=__webpack_require__(11),_item3=_interopRequireDefault(_item2),_error=__webpack_require__(7),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function mapItemList(res,thumbnailSizes){return res.data=(res.data.files||[]).map(function(_item){var item=(0,
_item3.default)(_item,settings,thumbnailSizes);return item.isInSiteMedia=!0,item}),res}function list(folderId,options){options=options||{};var sort=_utils2.default.extend({},defaultSort,options.sort),paging=_utils2.default.extend({},defaultPaging,options.paging),queryParams={page_size:paging.size,cursor:paging.cursor,parent_folder_id:folderId,media_type:options.mediaType||"picture",siteMediaToken:settings.siteMediaToken};return queryParams.order="desc"===sort.direction?"-"+sort.order:sort.order,http.get(settings.apiUrl+"/files/getpage/site",queryParams,{headers:options.headers||{}}).then(function(response){return response.paging={size:paging.size,cursor:response.data.cursor},mapItemList(response,options.thumbnails)}).catch(_error2.default)}function removeItem(itemId,options){var data={files:[itemId]},url=settings.apiUrl+"/files/site/remove?siteMediaToken="+settings.siteMediaToken,postOptions={headers:options.headers||{}};return http.post(url,data,null,postOptions).then(function(res){return res.data={id:itemId},res}).catch(_error2.default)}function remove(itemIds,options){return options=options||{},itemIds.map(function(itemId){return removeItem(itemId,options)})}function add(itemIds,options){options=options||{};var data={files:itemIds},url=settings.apiUrl+"/files/site/add?siteMediaToken="+settings.siteMediaToken,postOptions={headers:options.headers||{}};return http.post(url,data,null,postOptions).catch(_error2.default)}var defaultPaging={size:50,cursor:null},defaultSort={order:"date",direction:"desc"};return{list:list,remove:remove,add:add}};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_item2=__webpack_require__(11),_item3=_interopRequireDefault(_item2),_error=__webpack_require__(7),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function mapFolderList(res){return res.data=(res.data.trash_folders||[]).map(function(_folder){var folder=(0,_folder3.default)(_folder);return folder.isInTrash=!0,folder}),res}function list(folderId,options){options=options||{};var queryParams={media_type:options.mediaType||"picture",folder_id:folderId||null,trash_type:"folder"};return http.get(settings.apiUrl+"/files/getpage/trash",queryParams,{headers:options.headers||{}}).then(mapFolderList).catch(_error2.default)}function removeFolder(folderId,options){var url=settings.apiUrl+"/trash/folders/"+folderId+"/delete",postOptions={headers:options.headers||{}};return http.post(url,null,null,postOptions).then(function(res){return res.data={id:folderId},res}).catch(_error2.default)}function remove(folderIds,options){return options=options||{},folderIds.map(function(folderId){return removeFolder(folderId,options)})}function restoreFolder(folderId,options){var url=settings.apiUrl+"/trash/folders/"+folderId+"/restore",postOptions={headers:options.headers||{}};return http.post(url,null,null,postOptions).then(function(res){return res.data={id:folderId},res}).catch(_error2.default)}function restore(folderIds,options){return options=options||{},folderIds.map(function(folderId){return restoreFolder(folderId,options)})}return{list:list,remove:remove,restore:restore}};var _folder2=__webpack_require__(16),_folder3=_interopRequireDefault(_folder2),_error=__webpack_require__(7),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//files.wix.com",imageOperationsApi:"vangogh",filesUrl:"//static.wixstatic.com",videoFilesUrl:"//video.wixstatic.com",refreshTokenUrl:null,requestOptions:{withCredentials:!0},uploadLimits:{default:15728640,document:15728640,picture:15728640,music:52428800,secureMusic:377487360,video:524288e3,secureVideo:1610612736},thumbnailSizes:{thumbnail:{width:210,height:210,mode:"fill"},preview:{width:375,height:375,mode:"fit"},original:{width:1e3,height:1e3,mode:"fit"}},blackArrow:{wsUrl:"wss://ws.wixmp.com/ws",messageUrl:"https://ws.wixmp.com/message",tokenUrl:"/get-batoken"},asyncFontUpload:!1,asyncUploadByUrl:!1,asyncTranscoding:!1,videoPreviewQuality:"480p"}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return _bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend);__webpack_require__(5)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function defineNonEnumerableProperty(name,value){Object.defineProperty(events,name,{enumerable:!1,value:value})}Object.defineProperty(exports,"__esModule",{value:!0});var _notifier=__webpack_require__(9),_notifier2=_interopRequireDefault(_notifier),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),events=_utils2.default.merge(_list2.default);defineNonEnumerableProperty("on",_notifier2.default.addListener),defineNonEnumerableProperty("off",_notifier2.default.removeListener),exports.default=events},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _resize=__webpack_require__(19),_resize2=_interopRequireDefault(_resize),_getWixThumbnailsUrls=__webpack_require__(12),_getWixThumbnailsUrls2=_interopRequireDefault(_getWixThumbnailsUrls),_getWixVideoPreviewUrls=__webpack_require__(17),_getWixVideoPreviewUrls2=_interopRequireDefault(_getWixVideoPreviewUrls);exports.default={resize:_resize2.default,getWixThumbnailsUrls:_getWixThumbnailsUrls2.default,getWixVideoPreviewUrls:_getWixVideoPreviewUrls2.default,APIS:{REMBRANDT:"rembrandt",VANBRANDT:"vanbrandt",VANGOGH:"vangogh"},MODES:{FILL:"fill",FIT:"fit"}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res,settings,thumbnailSizes){res.data.nextPage=res.data.nextPage||"";var cursor=_utils2.default.getParameterByName(res.data.nextPage,"pageNumber")||null,size=_utils2.default.getParameterByName(res.data.nextPage,"pageSize")||null;return res.data=(res.data.items||[]).map(function(itemData){return(0,_item2.default)(itemData,settings,thumbnailSizes)}),res.paging={cursor:cursor,size:size},res};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_item=__webpack_require__(94),_item2=_interopRequireDefault(_item)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return _bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return _bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return _bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return 500===response.code&&(response.code=403,response.data={message:"Unauthorized",result:"error"}),_bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return 400===response.code&&response.data&&190===response.data.code&&(response.code=403),_bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return _bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(entities,parentId,isFolder){return entities.filter(function(entity){return isFolder?!entity.public_properties.file_url&&(parentId?entity.public_properties.parent_id===parentId:!entity.public_properties.parent_id):entity.public_properties.file_url&&(parentId?entity.public_properties.folder_id===parentId:!entity.public_properties.folder_id)})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return _bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return 404===response.code&&response.data&&"Channel not found."===response.data.message?{data:[],status:response.code,error:response.data}:_bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return 400===response.code&&response.data&&190===response.data.code&&(response.code=403),_bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Uploader=exports.Socket=exports.connectExternalSource=exports.bi=exports.thumbnailGenerator=exports.events=exports.sources=exports.Source=void 0;var _Source=__webpack_require__(26),_Source2=_interopRequireDefault(_Source),_list=__webpack_require__(70),_list2=_interopRequireDefault(_list),_events=__webpack_require__(56),_events2=_interopRequireDefault(_events),_connector=__webpack_require__(227),_connector2=_interopRequireDefault(_connector),_bi=__webpack_require__(229),_bi2=_interopRequireDefault(_bi),_uploadCollection=__webpack_require__(18),_uploadCollection2=_interopRequireDefault(_uploadCollection),_thumbnailGenerator=__webpack_require__(57),_thumbnailGenerator2=_interopRequireDefault(_thumbnailGenerator),_socket=__webpack_require__(25);exports.Source=_Source2.default,exports.sources=_list2.default,exports.events=_events2.default,exports.thumbnailGenerator=_thumbnailGenerator2.default,exports.bi=_bi2.default,exports.connectExternalSource=_connector2.default,exports.Socket=_socket.Socket,exports.Uploader=_uploadCollection2.default,exports.default={Source:_Source2.default,sources:_list2.default,events:_events2.default,thumbnailGenerator:_thumbnailGenerator2.default,bi:_bi2.default,connectExternalSource:_connector2.default,Socket:_socket.Socket,Uploader:_uploadCollection2.default}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _BigStock=__webpack_require__(71),_BigStock2=_interopRequireDefault(_BigStock),_ShutterStock=__webpack_require__(80),_ShutterStock2=_interopRequireDefault(_ShutterStock),_Public=__webpack_require__(89),_Public2=_interopRequireDefault(_Public),_Private=__webpack_require__(29),_Private2=_interopRequireDefault(_Private),_Platform=__webpack_require__(45),_Platform2=_interopRequireDefault(_Platform),_Picasa=__webpack_require__(97),_Picasa2=_interopRequireDefault(_Picasa),_Drive=__webpack_require__(105),_Drive2=_interopRequireDefault(_Drive),_Dropbox=__webpack_require__(113),_Dropbox2=_interopRequireDefault(_Dropbox),_Instagram=__webpack_require__(121),_Instagram2=_interopRequireDefault(_Instagram),_InstagramVideo=__webpack_require__(129),_InstagramVideo2=_interopRequireDefault(_InstagramVideo),_Facebook=__webpack_require__(138),_Facebook2=_interopRequireDefault(_Facebook),_FacebookVideo=__webpack_require__(146),_FacebookVideo2=_interopRequireDefault(_FacebookVideo),_Flickr=__webpack_require__(155),_Flickr2=_interopRequireDefault(_Flickr),_FlickrSearch=__webpack_require__(163),_FlickrSearch2=_interopRequireDefault(_FlickrSearch),_GoogleSearch=__webpack_require__(169),_GoogleSearch2=_interopRequireDefault(_GoogleSearch),_Collection=__webpack_require__(175),_Collection2=_interopRequireDefault(_Collection),_Vimeo=__webpack_require__(183),_Vimeo2=_interopRequireDefault(_Vimeo),_VimeoSearch=__webpack_require__(192),_VimeoSearch2=_interopRequireDefault(_VimeoSearch),_YouTube=__webpack_require__(198),_YouTube2=_interopRequireDefault(_YouTube),_YouTubeSearch=__webpack_require__(206),_YouTubeSearch2=_interopRequireDefault(_YouTubeSearch),_Showbox=__webpack_require__(212),_Showbox2=_interopRequireDefault(_Showbox),_Deviantart=__webpack_require__(219),_Deviantart2=_interopRequireDefault(_Deviantart),sources={BIGSTOCK:_BigStock2.default,SHUTTERSTOCK:_ShutterStock2.default,PUBLIC:_Public2.default,PRIVATE:_Private2.default,PLATFORM:_Platform2.default,PICASA:_Picasa2.default,DRIVE:_Drive2.default,DROPBOX:_Dropbox2.default,INSTAGRAM:_Instagram2.default,INSTAGRAM_VIDEO:_InstagramVideo2.default,FACEBOOK:_Facebook2.default,FACEBOOK_VIDEO:_FacebookVideo2.default,FLICKR:_Flickr2.default,FLICKR_SEARCH:_FlickrSearch2.default,GOOGLE_SEARCH:_GoogleSearch2.default,COLLECTION:_Collection2.default,VIMEO:_Vimeo2.default,VIMEO_SEARCH:_VimeoSearch2.default,YOUTUBE:_YouTube2.default,YOUTUBE_SEARCH:_YouTubeSearch2.default,SHOWBOX:_Showbox2.default,DEVIANTART:_Deviantart2.default};exports.default=sources},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(userSettings){var settings=_utils2.default.extend({},_settings2.default,userSettings),http=(0,_http2.default)(),folders=(0,_folders2.default)(settings,http),items=(0,_items2.default)(settings,http);this.name="bigstock",this.folders=_decorators2.default.addEvents(this,_list2.default.FOLDERS,folders),this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items)};var _settings=__webpack_require__(72),_settings2=_interopRequireDefault(_settings),_folders=__webpack_require__(73),_folders2=_interopRequireDefault(_folders),_items=__webpack_require__(76),_items2=_interopRequireDefault(_items),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//pix.wix.com/services/bigstock"}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){function list(){return _bluebirdExtend2.default.resolve(folders)}var folders=(0,_folders2.default)({data:[{id:null,name:"All"},{id:"Abstract",name:"Abstract"},{id:"Animals",name:"Animals"},{id:"Architecture",name:"Architecture"},{id:"Backgrounds",name:"Backgrounds"},{id:"Business",name:"Business"},{id:"Communication",name:"Communication"},{id:"Computers",name:"Computers"},{id:"Conceptual",name:"Conceptual"},{id:"Editorial",name:"Editorial"},{id:"Education",name:"Education"},{id:"Food",name:"Food"},{id:"Health",name:"Health"},{id:"Holidays",name:"Holidays"},{id:"Industry",name:"Industry"},{id:"Internet",name:"Internet"},{id:"Landscapes",name:"Landscapes"},{id:"Maps",name:"Maps"},{id:"Miscellaneous",name:"Miscellaneous"},{id:"Musical",name:"Musical"},{id:"Nature",name:"Nature"},{id:"Objects",name:"Objects"},{id:"People",name:"People"},{id:"Places",name:"Places"},{id:"Sports",name:"Sports"},{id:"Transportation",name:"Transportation"}]});return{list:list}};var _folders=__webpack_require__(74),_folders2=_interopRequireDefault(_folders),_bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=_interopRequireDefault(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res){return res.data=(res.data||[]).map(_folder2.default),res};var _folder=__webpack_require__(75),_folder2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_folder)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){return{id:data.id,name:data.name,mediaType:"picture",parentId:null,filesCount:null,createdAt:null}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){options=options||{},options.paging=options.paging||{},options.sort=options.sort||{};var requestOptions={limit:options.paging.size||50,page:options.paging.cursor||null,order:options.sort.field||null,category:folderId||null,orientation:options.orientation||null};return http.get(settings.apiUrl+"/search",requestOptions,{headers:options.headers||{}}).then(_items2.default).catch(_error2.default)}function search(folderId,query,options){options=options||{},options.paging=options.paging||{},options.sort=options.sort||{};var requestOptions={q:query||null,limit:options.paging.size||50,page:options.paging.cursor||null,order:options.sort.field||null,category:folderId||null,orientation:options.orientation||null};return http.get(settings.apiUrl+"/search",requestOptions,{headers:options.headers||{}}).then(_items2.default).catch(_error2.default)}return{list:list,search:search}};var _items=__webpack_require__(77),_items2=_interopRequireDefault(_items),_error=__webpack_require__(79),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res){var data=res.data.data,cursor=data.paging&&data.paging.page<data.paging.total_pages?data.paging.page+1:null,size=Number(data.paging.items_per_page);return res.data=(data.images||[]).map(_item2.default),res.paging={cursor:cursor,size:size},res};var _item=__webpack_require__(78),_item2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_item)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){var size=_utils2.default.find(data.formats,function(format){return"l"===format.size_code});return size||(size=data.formats.pop()),{id:data.id,name:data.title,folderId:null,mediaType:"picture",fileUrl:null,thumbnailUrl:_utils2.default.normalizeUri(data.large_thumb.url),previewUrl:_utils2.default.normalizeUri(data.preview.url),createdAt:null,tags:[],width:size.width,height:size.height}};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){if(503===response.code&&response.data&&"search-critical"===response.data.code)return{data:[],status:response.code,error:response.data};response.data=response.data||{};var code,data=response.data;return code=Array.isArray(data)?data[0].code||data[0]:data.code,response.data.message=code,_bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(userSettings){var settings=_utils2.default.extend({},_settings2.default,userSettings),http=(0,_http2.default)(),folders=(0,_folders2.default)(settings,http),items=(0,_items2.default)(settings,http);this.name="shutterstock",this.folders=_decorators2.default.addEvents(this,_list2.default.FOLDERS,folders),this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items)};var _settings=__webpack_require__(81),_settings2=_interopRequireDefault(_settings),_folders=__webpack_require__(82),_folders2=_interopRequireDefault(_folders),_items=__webpack_require__(85),_items2=_interopRequireDefault(_items),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//pix.wix.com/services/shutterstock",itemsLimit:50}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){function list(){return _bluebirdExtend2.default.resolve(folders)}var folders=(0,_folders2.default)({data:[{id:null,name:"All"},{id:0,name:"Transportation"},{id:1,name:"Animals/Wildlife"},{id:2,name:"Buildings/Landmarks"},{id:3,name:"Backgrounds/Textures"},{id:4,name:"Business/Finance"},{id:5,name:"Education"},{id:6,name:"Food and Drink"},{id:7,name:"Healthcare/Medical"},{id:8,name:"Holidays"},{id:9,name:"Objects"},{id:10,name:"Industrial"},{id:11,name:"The Arts"},{id:12,name:"Nature"},{id:13,name:"People"},{id:14,name:"Religion"},{id:15,name:"Science"},{id:16,name:"Technology"},{id:17,name:"Signs/Symbols"},{id:18,name:"Sports/Recreation"},{id:21,name:"Interiors"},{id:22,name:"Miscellaneous"},{id:24,name:"Vintage"},{id:25,name:"Parks/Outdoor"},{id:26,name:"Abstract"},{id:27,name:"Beauty/Fashion"}]});return{list:list}};var _folders=__webpack_require__(83),_folders2=_interopRequireDefault(_folders),_bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=_interopRequireDefault(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res){return res.data=(res.data||[]).map(_folder2.default),res};var _folder=__webpack_require__(84),_folder2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_folder)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){return{id:data.id,name:data.name,mediaType:"picture",parentId:null,filesCount:null,createdAt:null}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function formatCategory(id){return null===id||void 0===id?null:id}function list(folderId,options){options=options||{},options.paging=options.paging||{},options.sort=options.sort||{};var requestOptions={per_page:options.paging.size||settings.itemsLimit,page:options.paging.cursor||null,order:options.sort.field||null,category:formatCategory(folderId),orientation:options.orientation||null};return http.get(settings.apiUrl+"/search",requestOptions,{headers:options.headers||{}}).then(_items2.default).catch(_error2.default)}function search(folderId,query,options){options=options||{},options.paging=options.paging||{},options.sort=options.sort||{};var requestOptions={query:query||null,per_page:options.paging.size||settings.itemsLimit,page:options.paging.cursor||null,order:options.sort.field||null,category:formatCategory(folderId),orientation:options.orientation||null};return http.get(settings.apiUrl+"/search",requestOptions,{headers:options.headers||{}}).then(_items2.default).catch(_error2.default)}return{list:list,search:search}};var _items=__webpack_require__(86),_items2=_interopRequireDefault(_items),_error=__webpack_require__(88),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res){var data=res.data,remainingItemsCount=data.total_count-data.page*data.per_page,cursor=remainingItemsCount>0?data.page+1:null,size=data.per_page;return res.data=(data.data||[]).map(_item2.default),res.paging={cursor:cursor,size:size},res};var _item=__webpack_require__(87),_item2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_item)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){var thumbnailUrl=_utils2.default.normalizeUri(data.mosaic_url),previewUrl=_utils2.default.normalizeUri(_utils2.default.get(data,"assets.preview.url"));return{id:data.id,name:data.description,folderId:null,mediaType:"picture",fileUrl:null,thumbnailUrl:thumbnailUrl,previewUrl:previewUrl,createdAt:null,tags:[],width:null,height:null}};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){response.data=response.data||{};var code,data=response.data;return code=Array.isArray(data)?data[0].code||data[0]:data.code,response.data.message=code,_bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(userSettings){var settings=_utils2.default.extend({},_settings2.default,userSettings),http=(0,_http2.default)(),folders=(0,_folders2.default)(settings,http),items=(0,_items2.default)(settings,http),item=(0,_item2.default)(settings,http);this.name="public",this.folders=_decorators2.default.addEvents(this,_list2.default.FOLDERS,folders),this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items),this.item=_decorators2.default.addEvents(this,_list2.default.ITEM,item)};var _folders=__webpack_require__(90),_folders2=_interopRequireDefault(_folders),_items=__webpack_require__(93),_items2=_interopRequireDefault(_items),_item=__webpack_require__(95),_item2=_interopRequireDefault(_item),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_settings=__webpack_require__(96),_settings2=_interopRequireDefault(_settings),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){options=options||{};var data={levels:1,language:options.language};return settings.wixUser&&(folderId+=":wix"),data.guid=folderId,http.get(settings.apiUrl+"/categories",data,{withCredentials:!0,headers:options.headers||{}}).then(_folders2.default).catch(_error2.default)}return{list:list}};var _folders=__webpack_require__(91),_folders2=_interopRequireDefault(_folders),_error=__webpack_require__(28),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res){return res.data=(res.data.category.children||[]).map(_folder2.default),res};var _folder=__webpack_require__(92),_folder2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_folder)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data,parentId){return{id:data.guid,name:data.title,mediaType:data.mediaType,parentId:parentId||null,filesCount:null,createdAt:null}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function requestItems(action,requestOptions,thumbSizeData,headers){return http.get(settings.apiUrl+action,requestOptions,{withCredentials:!0,headers:headers||{}}).then(function(response){return(0,_items2.default)(response,settings,thumbSizeData)}).catch(_error2.default)}function list(folderId,options){return options=options||{},options.paging=options.paging||{},requestItems("/light_items",{guid:folderId||null,language:options.language,pageSize:options.paging.size||settings.itemsLimit,pageNumber:options.paging.cursor||1},options.thumbnails,options.headers)}function search(folderId,query,options){return options=options||{},options.paging=options.paging||{},requestItems("/light_search",{guid:folderId||null,language:options.language,searchString:query||"",pageSize:options.paging.size||settings.itemsLimit,pageNumber:options.paging.cursor||1},options.thumbnails,options.headers)}return{list:list,search:search}};var _items=__webpack_require__(58),_items2=_interopRequireDefault(_items),_error=__webpack_require__(28),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(itemData,settings,thumbnailSizes){var item={id:itemData.guid,name:itemData.title,mediaType:itemData.mediaType,fileName:itemData.fileName,fileUrl:itemData.fileUrl,createdAt:null,tags:_utils2.default.splitTags(itemData.tags),tagsEn:_utils2.default.splitTags(itemData.tagsEn),width:itemData.width,height:itemData.height,fileOutput:itemData.fileOutput||null,fileInput:itemData.fileInput||null,vendor:itemData.vendor||null,reference:itemData.reference||null,creator:itemData.creator||null,externalId:itemData.externalId||null,subtype:itemData.subtype||null,
videoThumbnailUrl:itemData.videoThumbnailUrl||null};if(itemData.thumbnailUrl&&itemData.fileUrl){var folderName=itemData.fileUrl.split("/")[0];item.thumbnailUrl=folderName+"/"+itemData.thumbnailUrl}itemData.videoPreviewUrl&&(item.videoPreviewUrls=[settings.videoFilesUrl+"/"+itemData.videoPreviewUrl]);var sizes=_utils2.default.extend({},settings.thumbnailSizes,thumbnailSizes);return _utils2.default.extend(item,(0,_getWixThumbnailsUrls2.default)(item,sizes,settings)),item};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_getWixThumbnailsUrls=__webpack_require__(12),_getWixThumbnailsUrls2=_interopRequireDefault(_getWixThumbnailsUrls)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function getMulti(itemIds,options){options=options||{},Array.isArray(itemIds)&&(itemIds=itemIds.join(","));var postData={guid:itemIds,language:options.language},headers=_utils2.default.extend(options.headers||{},{"Content-Type":"application/x-www-form-urlencoded"});return http.post(settings.apiUrl+"/item",postData,{},{withCredentials:!0,headers:headers}).then(function(response){return(0,_items2.default)(response,settings,options.thumbnails)}).catch(_error2.default)}return{get:getMulti}};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_items=__webpack_require__(58),_items2=_interopRequireDefault(_items),_error=__webpack_require__(28),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//publicmedia.wix.com/public",itemsLimit:50,imageOperationsApi:"vangogh",filesUrl:"//static.wixstatic.com",videoFilesUrl:"//video.wixstatic.com",thumbnailSizes:{thumbnail:{width:210,height:210,mode:"fill"},preview:{width:375,height:375,mode:"fit"}},videoPreviewQuality:"480p",wixUser:!1}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){var http=(0,_http2.default)(),folders=(0,_folders2.default)(_settings2.default,http),items=(0,_items2.default)(_settings2.default,http);this.name="picasa",this.translationKey="google-photos",this.folders=_decorators2.default.addEvents(this,_list2.default.FOLDERS,folders),this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items)};var _settings=__webpack_require__(98),_settings2=_interopRequireDefault(_settings),_folders=__webpack_require__(99),_folders2=_interopRequireDefault(_folders),_items=__webpack_require__(102),_items2=_interopRequireDefault(_items),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//pix.wix.com/services/google",foldersLimit:500,itemsLimit:50}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){options=options||{},options.paging=options.paging||{};var requestOptions={thumbsize:"150c","max-results":options.paging.size||settings.foldersLimit,"start-index":options.paging.cursor||1};return http.get(settings.apiUrl+"/albums",requestOptions,{withCredentials:!0,headers:options.headers||{}}).then(_folders2.default).catch(_error2.default)}return{list:list}};var _folders=__webpack_require__(100),_folders2=_interopRequireDefault(_folders),_error=__webpack_require__(59),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res){return res.data=(res.data.feed.entry||[]).map(_folder2.default),res};var _folder=__webpack_require__(101),_folder2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_folder)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){return{id:data.gphoto$id.$t,name:data.title.$t,mediaType:"picture",thumbnailUrl:data.media$group.media$thumbnail[0].url,parentId:null,filesCount:data.gphoto$numphotos.$t,createdAt:data.published.$t}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){options=options||{},options.paging=options.paging||{};var requestOptions={album_id:folderId||null,kind:"photo",thumbsize:"150c","max-results":options.paging.size||settings.itemsLimit,"start-index":options.paging.cursor||1};return http.get(settings.apiUrl+"/photos",requestOptions,{withCredentials:!0,headers:options.headers||{}}).then(_items2.default).catch(_error2.default)}return{list:list}};var _items=__webpack_require__(103),_items2=_interopRequireDefault(_items),_error=__webpack_require__(59),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res){var paging={cursor:res.data.feed.openSearch$startIndex.$t+res.data.feed.openSearch$itemsPerPage.$t,size:res.data.feed.openSearch$itemsPerPage.$t};return res.data=(res.data.feed.entry||[]).map(_item2.default),res.paging=paging,res};var _item=__webpack_require__(104),_item2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_item)},function(module,exports,__webpack_require__){"use strict";function getLastImage(mediaGroup){var images=mediaGroup.media$thumbnail.filter(function(item){return!item.medium||"video"!==item.medium});return images[images.length-1].url||""}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){var lastImage,width,height,bigImage,preview;return lastImage=getLastImage(data.media$group),width=Number(data.gphoto$width.$t||1024),height=Number(data.gphoto$height.$t||768),bigImage=lastImage.replace(/\/s[0-9]+/,"/w"+width+"-h"+height+"-no"),preview=width>400?lastImage.replace(/\/s[0-9]+(-c)?/,"/s400"):bigImage,{id:data.id.$t,name:data.summary.$t||data.title.$t,mediaType:"picture",fileUrl:_utils2.default.normalizeUri(bigImage),thumbnailUrl:_utils2.default.normalizeUri(lastImage),previewUrl:_utils2.default.normalizeUri(preview),createdAt:data.published.$t,tags:[],width:width,height:height}};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){var http=(0,_http2.default)(),folders=(0,_folders2.default)(_settings2.default,http),items=(0,_items2.default)(_settings2.default,http);this.name="drive",this.folders=_decorators2.default.addEvents(this,_list2.default.FOLDERS,folders),this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items)};var _settings=__webpack_require__(106),_settings2=_interopRequireDefault(_settings),_folders=__webpack_require__(107),_folders2=_interopRequireDefault(_folders),_items=__webpack_require__(110),_items2=_interopRequireDefault(_items),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//pix.wix.com/services/gdrive",foldersLimit:500,itemsLimit:50}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){options=options||{},options.paging=options.paging||{};var requestOptions={maxResults:options.paging.size||settings.foldersLimit,pageToken:options.paging.cursor||""};return folderId&&(requestOptions.album_id=folderId),http.get(settings.apiUrl+"/albums",requestOptions,{withCredentials:!0}).then(_folders2.default).catch(_error2.default)}return{list:list}};var _folders=__webpack_require__(108),_folders2=_interopRequireDefault(_folders),_error=__webpack_require__(60),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res){return res.data=(res.data.items||[]).map(_folder2.default),res};var _folder=__webpack_require__(109),_folder2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_folder)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){return{id:data.id,name:data.title,mediaType:"picture",parentId:data.parents[0].id,filesCount:1,createdAt:data.createdDate}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){options=options||{},options.paging=options.paging||{};var requestOptions={album_id:folderId||null,maxResults:options.paging.size||settings.itemsLimit,pageToken:options.paging.cursor||""};return http.get(settings.apiUrl+"/photos",requestOptions,{withCredentials:!0}).then(_items2.default,_error2.default)}return{list:list}};var _items=__webpack_require__(111),_items2=_interopRequireDefault(_items),_error=__webpack_require__(60),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res){return res.paging={cursor:res.data.nextPageToken},res.data=(res.data.items||[]).map(_item2.default),res};var _item=__webpack_require__(112),_item2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_item)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){return{id:data.id,name:data.title,mediaType:"picture",fileUrl:_utils2.default.normalizeUri(data.fixedDownloadUrl||data.webContentLink),thumbnailUrl:data.thumbnailLink?_utils2.default.normalizeUri(data.thumbnailLink):null,previewUrl:data.thumbnailLink?_utils2.default.normalizeUri(data.thumbnailLink):null,createdAt:data.createdDate,tags:[],width:data.imageMediaMetadata.width,height:data.imageMediaMetadata.height}};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){var http=(0,_http2.default)(),folders=(0,_folders2.default)(_settings2.default,http),items=(0,_items2.default)(_settings2.default,http);this.name="dropbox",this.folders=_decorators2.default.addEvents(this,_list2.default.FOLDERS,folders),this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items)};var _settings=__webpack_require__(114),_settings2=_interopRequireDefault(_settings),_folders=__webpack_require__(115),_folders2=_interopRequireDefault(_folders),_items=__webpack_require__(118),_items2=_interopRequireDefault(_items),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//pix.wix.com/services/dropbox2",foldersLimit:500,itemsLimit:50}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){options=options||{},options.paging=options.paging||{};var requestOptions={};return folderId&&(requestOptions.album_id=folderId),http.get(settings.apiUrl+"/albums",requestOptions,{withCredentials:!0}).then(_folders2.default).catch(_error2.default)}return{list:list}};var _folders=__webpack_require__(116),_folders2=_interopRequireDefault(_folders),_error=__webpack_require__(61),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function isFolder(e){return"folder"==e[".tag"]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res){return res.data=(res.data.entries||[]).filter(isFolder).map(_folder2.default),res};var _folder=__webpack_require__(117),_folder2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_folder)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){return{id:data.path_lower,name:data.name,mediaType:"picture",parentId:null,filesCount:1,createdAt:null}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){options=options||{},options.paging=options.paging||{};var requestOptions={album_id:folderId||null,cursor:options.paging.cursor||null};return http.get(settings.apiUrl+"/photos",requestOptions,{withCredentials:!0}).then(_items2.default,_error2.default)}return{list:list}};var _items=__webpack_require__(119),_items2=_interopRequireDefault(_items),_error=__webpack_require__(61),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function isImage(item){var name=item.name.toLowerCase();return"file"===item[".tag"]&&(_utils2.default.endsWith(name,".jpg")||_utils2.default.endsWith(name,".jpeg")||_utils2.default.endsWith(name,".png")||_utils2.default.endsWith(name,".gif"))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res){var paging={cursor:res.data.has_more?res.data.cursor:null};return res.data=_utils2.default.get(res,"data.entries",[]).filter(isImage).map(_item2.default),res.paging=paging,res};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_item=__webpack_require__(120),_item2=_interopRequireDefault(_item)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){function encodePath(uriComponent){return encodeURIComponent(uriComponent).replace("'","%27")}return{id:data.path_lower,name:data.name,mediaType:"picture",fileUrl:data.url,thumbnailUrl:"//pix.wix.com/services/dropbox2/thumbnail?path="+encodePath(data.path_lower),previewUrl:"//pix.wix.com/services/dropbox2/thumbnail?path="+encodePath(data.path_lower)+"&size=w640h480",createdAt:data.client_modified,tags:[]}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){var http=(0,_http2.default)(),folders=(0,_folders2.default)(_settings2.default,http),items=(0,_items2.default)(_settings2.default,http);this.name="instagram",this.folders=_decorators2.default.addEvents(this,_list2.default.FOLDERS,folders),this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items)};var _settings=__webpack_require__(122),_settings2=_interopRequireDefault(_settings),_folders=__webpack_require__(123),_folders2=_interopRequireDefault(_folders),_items=__webpack_require__(126),_items2=_interopRequireDefault(_items),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//pix.wix.com/services/instagram",api2Url:"//pix.wix.com/services/instagram2",itemsLimit:50}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function successHandler(response){return(0,_folders2.default)(response.data)}function list(folderId,options){return options=options||{},http.get(settings.apiUrl+"/user",null,{withCredentials:!0,headers:options.headers||{}}).then(successHandler).catch(_error2.default)}return{list:list}};var _folders=__webpack_require__(124),_folders2=_interopRequireDefault(_folders),_error=__webpack_require__(62),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){return{data:[(0,_folder2.default)(data)]}};var _folder=__webpack_require__(125),_folder2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_folder)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){return{id:"Instagram",name:"Instagram",mediaType:"picture",parentId:null,filesCount:data.counts.media,createdAt:null}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){options=options||{},options.paging=options.paging||{};var requestOptions={count:options.paging.size||settings.itemsLimit,max_id:options.paging.cursor||null};return http.get(settings.api2Url+"/photos",requestOptions,{withCredentials:!0,headers:options.headers||{}}).then(_items2.default).catch(_error2.default)}return{list:list}};var _items=__webpack_require__(127),_items2=_interopRequireDefault(_items),_error=__webpack_require__(62),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res){res.data.next=res.data.next||{};var cursor=res.data.next.max_id||null,size=res.data.next.count||null;return res.data=(res.data.photos||[]).map(_item2.default),res.paging={cursor:cursor,size:size},res};var _item=__webpack_require__(128),_item2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_item)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){return data.caption||(data.caption={text:""}),{id:data.id,name:data.caption.text,mediaType:"picture",fileUrl:_utils2.default.normalizeUri(data.images.standard_resolution.url),thumbnailUrl:_utils2.default.normalizeUri(data.images.low_resolution.url),previewUrl:_utils2.default.normalizeUri(data.images.standard_resolution.url),createdAt:1e3*Number(data.created_time),tags:_utils2.default.splitTags(data.tags),width:data.images.standard_resolution.width,height:data.images.standard_resolution.height}};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings){settings=_utils2.default.extend({},_settings2.default,settings);var http=(0,_http2.default)(),folders=(0,_folders2.default)(settings,http),items=(0,_items2.default)(settings,http);this.name="instagramVideo",this.folders=_decorators2.default.addEvents(this,_list2.default.FOLDERS,folders),this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items)};var _settings=__webpack_require__(130),_settings2=_interopRequireDefault(_settings),_folders=__webpack_require__(131),_folders2=_interopRequireDefault(_folders),_items=__webpack_require__(134),_items2=_interopRequireDefault(_items),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//pix.wix.com/services/instagram2",itemsLimit:50,thumbnailSizes:{thumbnail:{width:210,height:210,mode:"fill"},preview:{width:375,height:375,mode:"fit"}}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){function list(){return _bluebirdExtend2.default.resolve((0,_folders2.default)())}return{list:list}};var _folders=__webpack_require__(132),_folders2=_interopRequireDefault(_folders),_bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=_interopRequireDefault(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){return{data:[(0,_folder2.default)()]}};var _folder=__webpack_require__(133),_folder2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_folder)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){return{id:"InstagramVideo",name:"InstagramVideo",mediaType:"video",parentId:null,filesCount:null,createdAt:null}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){options=options||{},options.paging=options.paging||{};var optionsThumbnailSizes=options.thumbnailSizes?{thumbnailSizes:options.thumbnailSizes}:{},listSettings=_utils2.default.merge({},settings,optionsThumbnailSizes),requestOptions={limit:options.paging.size||settings.itemsLimit,after:options.paging.cursor||null};return http.get(settings.apiUrl+"/videos",requestOptions,{withCredentials:!0,headers:options.headers||{}}).then(_utils2.default.partial(_items2.default,listSettings)).catch(_error2.default)}return{list:list}};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_items=__webpack_require__(135),_items2=_interopRequireDefault(_items),_error=__webpack_require__(137),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,res){var cursor=null,size=null;return res.data.paging&&res.data.paging.cursors&&res.data.paging.cursors.after&&res.data.paging.next&&(cursor=res.data.paging.cursors.after,size=Number(_utils2.default.getParameterByName(res.data.paging.next,"limit"))),res.data=(res.data.videos||[]).map(_utils2.default.partial(_item2.default,settings)),res.paging={cursor:cursor,size:size},res};var _item=__webpack_require__(136),_item2=_interopRequireDefault(_item),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,data){var item={id:data.id,name:_utils2.default.replaceHtml(data.caption?data.caption.text:data.id),fileName:data.id,previewUrl:data.images.thumbnail.url,thumbnailUrl:data.images.thumbnail.url,videoPreviewUrl:[data.videos.standard_resolution.url],embedHtml:'<video controls width="'+data.videos.standard_resolution.width+'" height="'+data.videos.standard_resolution.height+'" poster="'+data.images.thumbnail.url+'"><source src="'+data.videos.standard_resolution.url+'" type="video/mp4" /></video>',width:Number(data.videos.standard_resolution.width),height:Number(data.videos.standard_resolution.height),createdAt:Number(data.created_time),externalSources:{videos:data.videos,images:data.images},folderId:null,mediaType:"video"};if(!data.format)return item;var availableThumbnailsSizes=data.format.map(function(pictureSize){return _utils2.default.extend({},pictureSize,{url:pictureSize.picture})}),urls=_utils2.default.getThumbnailsUrlsFromList(availableThumbnailsSizes,settings.thumbnailSizes);return _utils2.default.extend(item,urls)};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return _bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){var http=(0,_http2.default)(),folders=(0,_folders2.default)(_settings2.default,http),items=(0,_items2.default)(_settings2.default,http);this.name="facebook",this.folders=_decorators2.default.addEvents(this,_list2.default.FOLDERS,folders),this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items)};var _settings=__webpack_require__(139),_settings2=_interopRequireDefault(_settings),_folders=__webpack_require__(140),_folders2=_interopRequireDefault(_folders),_items=__webpack_require__(143),_items2=_interopRequireDefault(_items),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//pix.wix.com/services/facebook2",foldersLimit:50,itemsLimit:50}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderID,options){options=options||{},options.paging=options.paging||{};var requestOptions={limit:options.paging.size||settings.foldersLimit,after:options.paging.cursor||null};return http.get(settings.apiUrl+"/albums",requestOptions,{withCredentials:!0,headers:options.headers||{}}).then(_utils2.default.partial(_folders2.default,settings)).catch(_error2.default)}return{list:list}};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_folders=__webpack_require__(141),_folders2=_interopRequireDefault(_folders),_error=__webpack_require__(63),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,res){return res.data=(res.data.data||[]).map(function(data){return(0,_folder2.default)(data,settings)}),res};var _folder=__webpack_require__(142),_folder2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_folder)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data,settings){return{id:data.id,name:data.name,mediaType:"picture",parentId:null,thumbnailUrl:_utils2.default.normalizeUri(settings.apiUrl+"/picture?type=album&album_id="+data.id),filesCount:data.count,createdAt:data.created_time}};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){options=options||{},options.paging=options.paging||{};var requestOptions={album_id:folderId,limit:options.paging.size||settings.itemsLimit,after:options.paging.cursor||null};return http.get(settings.apiUrl+"/photos",requestOptions,{withCredentials:!0,headers:options.headers||{}}).then(_items2.default).catch(_error2.default)}return{list:list}};var _items=__webpack_require__(144),_items2=_interopRequireDefault(_items),_error=__webpack_require__(63),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res){var cursor;return res.data.paging&&res.data.paging.cursors&&(cursor=res.data.paging.cursors.after),res.data=(res.data.data||[]).map(_item2.default),res.paging={cursor:cursor||null,size:null},res};var _item=__webpack_require__(145),_item2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_item)},function(module,exports,__webpack_require__){"use strict";function findThumbnailUrl(images,minWidth,minHeight){minHeight=minHeight||190,minWidth=minWidth||190;var bigImages,biggestImage,smallestImage;return 1===images.length?images[0].source:(bigImages=images.filter(function(image){return image.width>minWidth&&image.height>minHeight}),(smallestImage=_utils2.default.min(bigImages,function(image){return image.width+image.height}))?smallestImage.source:(biggestImage=_utils2.default.max(images,function(image){return image.width+image.height}),biggestImage.source))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){return{id:data.id,folderId:null,name:data.name||"",mediaType:"picture",fileUrl:_utils2.default.normalizeUri(data.source),thumbnailUrl:_utils2.default.normalizeUri(findThumbnailUrl(data.images)),previewUrl:_utils2.default.normalizeUri(data.source),createdAt:data.created_time,tags:[],width:data.width,height:data.height}};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(userSettings){var settings=_utils2.default.extend({},_settings2.default,userSettings),http=(0,_http2.default)(),folders=(0,_folders2.default)(settings,http),items=(0,_items2.default)(settings,http);this.name="facebookVideo",this.folders=_decorators2.default.addEvents(this,_list2.default.FOLDERS,folders),this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items)}
;var _settings=__webpack_require__(147),_settings2=_interopRequireDefault(_settings),_folders=__webpack_require__(148),_folders2=_interopRequireDefault(_folders),_items=__webpack_require__(151),_items2=_interopRequireDefault(_items),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//pix.wix.com/services/facebook2",itemsLimit:50,thumbnailSizes:{thumbnail:{width:210,height:210,mode:"fill"},preview:{width:375,height:375,mode:"fit"}}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){function list(){return _bluebirdExtend2.default.resolve((0,_folders2.default)())}return{list:list}};var _folders=__webpack_require__(149),_folders2=_interopRequireDefault(_folders),_bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=_interopRequireDefault(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){return{data:[(0,_folder2.default)()]}};var _folder=__webpack_require__(150),_folder2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_folder)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){return{id:"FacebookVideo",name:"FacebookVideo",mediaType:"video",parentId:null,filesCount:null,createdAt:null}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){var optionsThumbnailSizes=options.thumbnailSizes?{thumbnailSizes:options.thumbnailSizes}:{},listSettings=_utils2.default.merge({},settings,optionsThumbnailSizes);options=options||{},options.paging=options.paging||{};var requestOptions={limit:options.paging.size||settings.itemsLimit,after:options.paging.cursor||null};return http.get(settings.apiUrl+"/videos",requestOptions,{withCredentials:!0,headers:options.headers||{}}).then(_utils2.default.partial(_items2.default,listSettings)).catch(_error2.default)}return{list:list}};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_items=__webpack_require__(152),_items2=_interopRequireDefault(_items),_error=__webpack_require__(154),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,res){var cursor=null,size=null;return res.data.paging&&res.data.paging.cursors&&res.data.paging.cursors.after&&res.data.paging.next&&(cursor=res.data.paging.cursors.after,size=Number(_utils2.default.getParameterByName(res.data.paging.next,"limit"))),res.data=(res.data.data||[]).map(_utils2.default.partial(_item2.default,settings)),res.paging={cursor:cursor,size:size},res};var _item=__webpack_require__(153),_item2=_interopRequireDefault(_item),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,data){function getAttribute(htmlElement,attributeName){var regex=new RegExp(attributeName+'="(.+?)"',"i"),res=htmlElement.match(regex);return res?res[1]:""}var item={id:Number(data.id),name:_utils2.default.replaceHtml(data.title),iframeSrc:getAttribute(data.embed_html,"src"),embedHtml:data.embed_html,width:Number(getAttribute(data.embed_html,"width")),height:Number(getAttribute(data.embed_html,"height")),createdAt:function(date){var correctDate=date.replace(/([+\-]\d\d)(\d\d)$/,"$1:$2");return _utils2.default.toTimeStamp(correctDate)}(data.created_time),folderId:null,mediaType:"video"};if(!data.format)return item;var availableThumbnailsSizes=data.format.map(function(pictureSize){return _utils2.default.extend({},pictureSize,{url:pictureSize.picture})}),urls=_utils2.default.getThumbnailsUrlsFromList(availableThumbnailsSizes,settings.thumbnailSizes);return _utils2.default.extend(item,urls)};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return _bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){var http=(0,_http2.default)(),folders=(0,_folders2.default)(_settings2.default,http),items=(0,_items2.default)(_settings2.default,http);this.name="flickr",this.folders=_decorators2.default.addEvents(this,_list2.default.FOLDERS,folders),this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items)};var _settings=__webpack_require__(156),_settings2=_interopRequireDefault(_settings),_folders=__webpack_require__(157),_folders2=_interopRequireDefault(_folders),_items=__webpack_require__(160),_items2=_interopRequireDefault(_items),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//pix.wix.com/services/flickr",foldersLimit:50,itemsLimit:50}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){options=options||{},options.paging=options.paging||{};var requestOptions={primary_photo_extras:"url_t,url_s,url_m,url_b,url_o",per_page:options.paging.size||settings.foldersLimit,page:options.paging.cursor||null};return http.get(settings.apiUrl+"/albums",requestOptions,{withCredentials:!0,headers:options.headers||{}}).then(_folders2.default).catch(_error2.default)}return{list:list}};var _folders=__webpack_require__(158),_folders2=_interopRequireDefault(_folders),_error=__webpack_require__(64),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res){return res.data=(res.data.photosets.photoset||[]).map(_folder2.default),res};var _folder=__webpack_require__(159),_folder2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_folder)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){return{id:data.id,name:data.title._content,mediaType:"picture",thumbnailUrl:data.primary_photo_extras.url_m||data.primary_photo_extras.url_s||data.primary_photo_extras.url_t,parentId:null,filesCount:Number(data.photos)+Number(data.videos),createdAt:1e3*Number(data.date_create)}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){options=options||{},options.paging=options.paging||{};var requestOptions={extras:"url_t,url_s,url_m,url_b,url_o",set_id:folderId,per_page:options.paging.size||settings.itemsLimit,page:options.paging.cursor||null};return http.get(settings.apiUrl+"/photoset",requestOptions,{withCredentials:!0,headers:options.headers||{}}).then(_items2.default).catch(_error2.default)}return{list:list}};var _items=__webpack_require__(161),_items2=_interopRequireDefault(_items),_error=__webpack_require__(64),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res){var cursor=res.data.photoset.page<res.data.photoset.pages?Number(res.data.photoset.page)+1:null,size=Number(res.data.photoset.perpage);return res.data=(res.data.photoset.photo||[]).map(_item2.default),res.paging={cursor:cursor,size:size},res};var _item=__webpack_require__(162),_item2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_item)},function(module,exports,__webpack_require__){"use strict";function toThumbnails(photo){var thumbnail=photo.url_m||photo.url_s||photo.url_t,big=photo.url_b||thumbnail;return{fileUrl:photo.url_o||big,thumbnailUrl:thumbnail,previewUrl:big}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){var thumbnails=toThumbnails(data);return{id:data.id,name:data.title,folderId:null,mediaType:"picture",fileUrl:_utils2.default.normalizeUri(thumbnails.fileUrl),thumbnailUrl:_utils2.default.normalizeUri(thumbnails.thumbnailUrl),previewUrl:_utils2.default.normalizeUri(thumbnails.previewUrl),createdAt:null,tags:[],width:Number(data.width_o||data.width_m||data.width_s||data.width_t),height:Number(data.height_o||data.height_m||data.height_s||data.height_t)}};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){var http=(0,_http2.default)(),items=(0,_items2.default)(_settings2.default,http);this.name="flickrSearch",this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items)};var _settings=__webpack_require__(164),_settings2=_interopRequireDefault(_settings),_items=__webpack_require__(165),_items2=_interopRequireDefault(_items),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//pix.wix.com/services/flickr",itemsLimit:50}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function search(folderId,query,options){options=options||{},options.paging=options.paging||{};var requestOptions={extras:"url_t,url_s,url_m,url_b,url_o",text:query,per_page:options.paging.size||settings.itemsLimit,page:options.paging.cursor||null};return http.get(settings.apiUrl+"/search",requestOptions,{withCredentials:!1,headers:options.headers||{}}).then(_items2.default).catch(_error2.default)}return{search:search}};var _items=__webpack_require__(166),_items2=_interopRequireDefault(_items),_error=__webpack_require__(168),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res){var cursor=res.data.photos.page<res.data.photos.pages?res.data.photos.page+1:null,size=Number(res.data.photos.perpage);return res.data=(res.data.photos.photo||[]).map(_item2.default),res.paging={cursor:cursor,size:size},res};var _item=__webpack_require__(167),_item2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_item)},function(module,exports,__webpack_require__){"use strict";function toThumbnails(photo){var thumbnail=photo.url_m||photo.url_s||photo.url_t,big=photo.url_b||thumbnail;return{fileUrl:photo.url_o||big,thumbnailUrl:thumbnail,previewUrl:big}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){var thumbnails=toThumbnails(data);return{id:data.id,name:data.title,folderId:null,mediaType:"picture",fileUrl:_utils2.default.normalizeUri(thumbnails.fileUrl),thumbnailUrl:_utils2.default.normalizeUri(thumbnails.thumbnailUrl),previewUrl:_utils2.default.normalizeUri(thumbnails.previewUrl),createdAt:null,tags:[],width:Number(data.width_o||data.width_m||data.width_s||data.width_t),height:Number(data.height_o||data.height_m||data.height_s||data.height_t)}};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return _bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){var http=(0,_http2.default)(),items=(0,_items2.default)(_settings2.default,http);this.name="googleSearch",this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items)};var _settings=__webpack_require__(170),_settings2=_interopRequireDefault(_settings),_items=__webpack_require__(171),_items2=_interopRequireDefault(_items),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//pix.wix.com/services/gcs",itemsLimit:50}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function search(folderId,query,options){options=options||{},options.paging=options.paging||{};var requestOptions={q:query,count:options.paging.size||settings.itemsLimit,start:options.paging.cursor||null};return options.excludeQuery&&(requestOptions.filter=options.excludeQuery),http.get(settings.apiUrl+"/images",requestOptions,{withCredentials:!1,headers:options.headers||{}}).then(_items2.default).catch(_error2.default)}return{search:search}};var _items=__webpack_require__(172),_items2=_interopRequireDefault(_items),_error=__webpack_require__(174),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res){var cursor=null,size=null;return res.data.queries&&res.data.queries.nextPage&&res.data.queries.nextPage[0]&&(cursor=res.data.queries.nextPage[0].startIndex,size=res.data.queries.nextPage[0].count),res.data=(res.data.items||[]).map(_item2.default),res.paging={cursor:cursor>=92?null:cursor,size:size},res};var _item=__webpack_require__(173),_item2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_item)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){return{id:data.link,name:_utils2.default.replaceHtml(data.title),folderId:null,mediaType:"picture",fileUrl:_utils2.default.normalizeUri(data.link),thumbnailUrl:_utils2.default.normalizeUri(data.image.thumbnailLink||data.link),previewUrl:_utils2.default.normalizeUri(data.link),createdAt:null,tags:[],width:Number(data.image.width),height:Number(data.image.height)}};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return _bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(userSettings){var settings=_utils2.default.extend({},_settings2.default,userSettings),http=(0,_http2.default)(),folders=(0,_folders2.default)(settings,http),items=(0,_items2.default)(settings,http);this.name="collection",this.folders=_decorators2.default.addEvents(this,_list2.default.FOLDERS,folders),this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items)};var _settings=__webpack_require__(176),_settings2=_interopRequireDefault(_settings),_folders=__webpack_require__(177),_folders2=_interopRequireDefault(_folders),_items=__webpack_require__(180),_items2=_interopRequireDefault(_items),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//collections.wixstatic.com/collections",filesUrl:"//static.wixstatic.com",collectionId:"68c4b99f-d5b7-4583-b1d1-e00e31605678",imageOperationsApi:"vangogh",itemsLimit:50}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){return options=options||{},options.paging=options.paging||{},options.paging.cursor=options.paging.cursor||0,options.paging.size=options.paging.size||settings.itemsLimit,http.get(settings.apiUrl+"/"+settings.collectionId+".json",{},{withCredentials:!1,headers:options.headers||{}}).then(function(res){return(0,_folders2.default)(res,folderId,options.paging,settings)}).catch(_error2.default)}return{list:list}};var _folders=__webpack_require__(178),_folders2=_interopRequireDefault(_folders),_error=__webpack_require__(66),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res,folderId,currentPaging,settings){var foldersData=(0,_selector2.default)(res.data.collection.items,folderId,!0),paging={cursor:currentPaging.cursor+currentPaging.size,size:foldersData.length-currentPaging.cursor};return res.data=foldersData.map(function(data){var folder=(0,_folder2.default)(data,settings);return folder.filesCount=folder.filesCount||(0,_selector2.default)(res.data.collection.items,folder.id,!1).length,folder}),paging.size>0&&(res.paging=paging),res};var _folder=__webpack_require__(179),_folder2=_interopRequireDefault(_folder),_selector=__webpack_require__(65),_selector2=_interopRequireDefault(_selector)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data,settings){var privateFolderData=_utils2.default.extend({folder_id:data.id,folder_name:data.title,media_type:data.type,created_ts:data.date_created},data.public_properties),folder=(0,_folder2.default)(privateFolderData);return data.public_properties.thumbnail_url&&!folder.thumbnailUrl&&(folder.thumbnailUrl=_utils2.default.normalizeUri(settings.filesUrl+"/"+data.public_properties.thumbnail_url)),folder};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_folder=__webpack_require__(13),_folder2=_interopRequireDefault(_folder)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){return options=options||{},options.paging=options.paging||{},options.paging.cursor=options.paging.cursor||0,options.paging.size=options.paging.size||settings.itemsLimit,http.get(settings.apiUrl+"/"+settings.collectionId+".json",{},{withCredentials:!1,headers:options.headers||{}}).then(function(res){return(0,_items2.default)(res,folderId,options.paging,settings,options.thumbnails)}).catch(_error2.default)}return{list:list}};var _items=__webpack_require__(181),_items2=_interopRequireDefault(_items),_error=__webpack_require__(66),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res,folderId,currentPaging,settings,thumbnailSizes){var itemsData=(0,_selector2.default)(res.data.collection.items,folderId,!1),paging={cursor:currentPaging.cursor+currentPaging.size,size:itemsData.length-currentPaging.cursor};return res.data=itemsData.map(function(data){return(0,_item2.default)(data,settings,thumbnailSizes)}),paging.size>0&&(res.paging=paging),res};var _item=__webpack_require__(182),_item2=_interopRequireDefault(_item),_selector=__webpack_require__(65),_selector2=_interopRequireDefault(_selector)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data,settings,thumbnailSizes){var privateItemData=_utils2.default.extend({file_name:data.id,original_file_name:data.title,media_type:data.type,created_ts:data.date_created},data.public_properties);return(0,_item2.default)(privateItemData,settings,thumbnailSizes)};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_item=__webpack_require__(8),_item2=_interopRequireDefault(_item)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(userSettings){var settings=_utils2.default.extend({},_settings2.default,userSettings),http=(0,_http2.default)(),folders=(0,_folders2.default)(settings,http),items=(0,_items2.default)(settings,http);this.name="vimeo",this.folders=_decorators2.default.addEvents(this,_list2.default.FOLDERS,folders),this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items)};var _settings=__webpack_require__(184),_settings2=_interopRequireDefault(_settings),_folders=__webpack_require__(185),_folders2=_interopRequireDefault(_folders),_items=__webpack_require__(188),_items2=_interopRequireDefault(_items),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//pix.wix.com/services/vimeo2",itemsLimit:50,thumbnailSizes:{thumbnail:{width:210,height:210,mode:"fill"},preview:{width:375,height:375,mode:"fit"}}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){function list(){return _bluebirdExtend2.default.resolve((0,_folders2.default)())}return{list:list}};var _folders=__webpack_require__(186),_folders2=_interopRequireDefault(_folders),_bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=_interopRequireDefault(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){return{data:[(0,_folder2.default)()]}};var _folder=__webpack_require__(187),_folder2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_folder)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){return{id:"Vimeo",name:"Vimeo",mediaType:"video",parentId:null,filesCount:null,createdAt:null}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){var optionsThumbnailSizes=options.thumbnailSizes?{thumbnailSizes:options.thumbnailSizes}:{},listSettings=_utils2.default.merge({},settings,optionsThumbnailSizes);options=options||{},options.paging=options.paging||{};var requestOptions={per_page:options.paging.size||settings.itemsLimit,page:options.paging.cursor||null};return http.get(settings.apiUrl+"/videos",requestOptions,{withCredentials:!0,headers:options.headers||{}}).then(_utils2.default.partial(_items2.default,listSettings)).catch(_error2.default)}return{list:list}};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_items=__webpack_require__(189),_items2=_interopRequireDefault(_items),_error=__webpack_require__(191),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,res){var cursor=null,size=null;return res.data.paging&&res.data.paging.next&&(cursor=Number(res.data.paging.next.match(/\&page\=(\d+)/i)[1]),size=res.data.per_page),res.data=(res.data.data||[]).filter(function(item){return item&&item.embed&&item.embed.html}).map(_utils2.default.partial(_item2.default,settings)),res.paging={cursor:cursor,size:size},res};var _item=__webpack_require__(190),_item2=_interopRequireDefault(_item),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,data){var item={id:function(str){return Number(str.match(/\/videos\/(\d+)/i)[1])}(data.uri),name:_utils2.default.replaceHtml(data.name),description:_utils2.default.replaceHtml(data.description),link:_utils2.default.normalizeUri(data.link),iframeSrc:function(str){var res=str.match(/src="(.+?)"/i);return res?res[1]:""}(data.embed.html),embedHtml:data.embed.html,tags:function(tags){return null!==tags&&tags.length?tags.reduce(function(resultTags,tag){return tag&&resultTags.push(tag.tag),resultTags},[]):[]}(data.tags),width:Number(data.width)||0,height:Number(data.height)||0,createdAt:function(date){return Math.floor(new Date(date).getTime()/1e3)}(data.created_time),folderId:null,mediaType:"video"};if(!data.pictures||!data.pictures.sizes)return item;var availableThumbnailsSizes=data.pictures.sizes.map(function(pictureSize){return _utils2.default.extend({},pictureSize,{url:pictureSize.link})}),urls=_utils2.default.getThumbnailsUrlsFromList(availableThumbnailsSizes,settings.thumbnailSizes);return _utils2.default.extend(item,urls)};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return _bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings){var http=(0,_http2.default)();settings=_utils2.default.extend({},_settings2.default,settings);var items=(0,_items2.default)(settings,http);this.name="vimeoSearch",this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items)};var _settings=__webpack_require__(193),_settings2=_interopRequireDefault(_settings),_items=__webpack_require__(194),_items2=_interopRequireDefault(_items),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//pix.wix.com/services/vimeo2",itemsLimit:50,thumbnailSizes:{thumbnail:{width:210,height:210,mode:"fill"},preview:{width:375,height:375,mode:"fit"}}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function search(folderId,query,options){var optionsThumbnailSizes=options.thumbnailSizes?{thumbnailSizes:options.thumbnailSizes}:{},listSettings=_utils2.default.merge({},settings,optionsThumbnailSizes);options=options||{},options.paging=options.paging||{};var requestOptions={query:query,per_page:options.paging.size||settings.itemsLimit,page:options.paging.cursor||null};return http.get(settings.apiUrl+"/search",requestOptions,{withCredentials:!1,headers:options.headers||{}}).then(_utils2.default.partial(_items2.default,listSettings)).catch(_error2.default)}return{search:search}};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_items=__webpack_require__(195),_items2=_interopRequireDefault(_items),_error=__webpack_require__(197),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,res){var cursor=null,size=null;return res.data.paging&&res.data.paging.next&&(cursor=Number(res.data.paging.next.match(/\&page\=(\d+)/i)[1]),size=res.data.per_page),res.data=(res.data.data||[]).filter(function(item){return item&&item.embed&&item.embed.html}).map(_utils2.default.partial(_item2.default,settings)),res.paging={cursor:cursor,size:size},res};var _item=__webpack_require__(196),_item2=_interopRequireDefault(_item),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,data){var item={id:function(str){return Number(str.match(/\/videos\/(\d+)/i)[1])}(data.uri),name:_utils2.default.replaceHtml(data.name),
description:_utils2.default.replaceHtml(data.description),link:_utils2.default.normalizeUri(data.link),iframeSrc:function(str){var res=str.match(/src="(.+?)"/i);return res?res[1]:""}(data.embed.html),embedHtml:data.embed.html,tags:function(tags){return null!==tags&&tags.length?tags.reduce(function(resultTags,tag){return tag&&resultTags.push(tag.tag),resultTags},[]):[]}(data.tags),width:Number(data.width)||0,height:Number(data.height)||0,createdAt:_utils2.default.toTimeStamp(data.created_time),folderId:null,mediaType:"video"};if(!data.pictures||!data.pictures.sizes)return item;var availableThumbnailsSizes=data.pictures.sizes.map(function(pictureSize){return _utils2.default.extend({},pictureSize,{url:pictureSize.link})}),urls=_utils2.default.getThumbnailsUrlsFromList(availableThumbnailsSizes,settings.thumbnailSizes);return _utils2.default.extend(item,urls)};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return _bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(userSettings){var settings=_utils2.default.extend({},_settings2.default,userSettings),http=(0,_http2.default)(),folders=(0,_folders2.default)(settings,http),items=(0,_items2.default)(settings,http);this.name="youtube",this.folders=_decorators2.default.addEvents(this,_list2.default.FOLDERS,folders),this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items)};var _settings=__webpack_require__(199),_settings2=_interopRequireDefault(_settings),_folders=__webpack_require__(200),_folders2=_interopRequireDefault(_folders),_items=__webpack_require__(203),_items2=_interopRequireDefault(_items),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//pix.wix.com/services/youtube",foldersLimit:50,itemsLimit:50,thumbnailSizes:{thumbnail:{width:210,height:210,mode:"fill"},preview:{width:375,height:375,mode:"fit"}}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){var optionsThumbnailSizes=options.thumbnailSizes?{thumbnailSizes:options.thumbnailSizes}:{},listSettings=_utils2.default.merge({},settings,optionsThumbnailSizes);options=options||{},options.paging=options.paging||{};var requestOptions={maxResults:options.paging.size||settings.foldersLimit,pageToken:options.paging.cursor||null};return http.get(settings.apiUrl+"/myplaylists",requestOptions,{withCredentials:!0,headers:options.headers||{}}).then(_utils2.default.partial(_folders2.default,listSettings)).catch(_error2.default)}return{list:list}};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_folders=__webpack_require__(201),_folders2=_interopRequireDefault(_folders),_error=__webpack_require__(67),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,res){var cursor=null,size=null;return res.data&&res.data.nextPageToken&&(cursor=res.data.nextPageToken,size=res.data.pageInfo.resultsPerPage),res.data=(res.data.items||[]).map(function(data){return(0,_folder2.default)(data,settings)}),res.paging={cursor:cursor,size:size},res};var _folder=__webpack_require__(202),_folder2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_folder)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data,settings){var snippet=data.snippet,availableThumbnailsSizes=Object.keys(snippet.thumbnails).map(function(prop){return snippet.thumbnails[prop]}),urls=_utils2.default.getThumbnailsUrlsFromList(availableThumbnailsSizes,settings.thumbnailSizes);return _utils2.default.extend({id:data.id,name:snippet.title,mediaType:"video",parentId:null,filesCount:null,createdAt:_utils2.default.toTimeStamp(snippet.publishedAt)},urls)};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){var optionsThumbnailSizes=options.thumbnailSizes?{thumbnailSizes:options.thumbnailSizes}:{},listSettings=_utils2.default.merge({},settings,optionsThumbnailSizes);options=options||{},options.paging=options.paging||{};var requestOptions={playlistId:folderId,maxResults:options.paging.size||settings.itemsLimit,pageToken:options.paging.cursor||null};return http.get(settings.apiUrl+"/myplaylistitems",requestOptions,{withCredentials:!0,headers:options.headers||{}}).then(_utils2.default.partial(_items2.default,listSettings)).catch(_error2.default)}return{list:list}};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_items=__webpack_require__(204),_items2=_interopRequireDefault(_items),_error=__webpack_require__(67),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,res){var cursor=null,size=null;return res.data&&res.data.nextPageToken&&(cursor=res.data.nextPageToken,size=res.data.pageInfo.resultsPerPage),res.data=(res.data.items||[]).filter(function(item){return item&&item.snippet&&item.snippet.thumbnails}).map(function(data){return(0,_item2.default)(data,settings)}),res.paging={cursor:cursor,size:size},res};var _item=__webpack_require__(205),_item2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_item)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data,settings){var snippet=data.snippet,videoId=data.contentDetails.videoId,availableThumbnailsSizes=Object.keys(snippet.thumbnails).map(function(prop){return snippet.thumbnails[prop]}),urls=_utils2.default.getThumbnailsUrlsFromList(availableThumbnailsSizes,settings.thumbnailSizes);return _utils2.default.extend({},{id:videoId,name:_utils2.default.replaceHtml(snippet.title),iframeSrc:function(videoId){return"//www.youtube.com/embed/"+videoId}(videoId),folderId:null,mediaType:"video",createdAt:_utils2.default.toTimeStamp(snippet.publishedAt)},urls)};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(userSettings){var settings=_utils2.default.extend({},_settings2.default,userSettings),http=(0,_http2.default)(),items=(0,_items2.default)(settings,http);this.name="youtubeSearch",this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items)};var _settings=__webpack_require__(207),_settings2=_interopRequireDefault(_settings),_items=__webpack_require__(208),_items2=_interopRequireDefault(_items),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//pix.wix.com/services/youtube",itemsLimit:50,thumbnailSizes:{thumbnail:{width:210,height:210,mode:"fill"},preview:{width:375,height:375,mode:"fit"}}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function search(folderId,query,options){var optionsThumbnailSizes=options.thumbnailSizes?{thumbnailSizes:options.thumbnailSizes}:{},listSettings=_utils2.default.merge({},settings,optionsThumbnailSizes);options=options||{},options.paging=options.paging||{};var requestOptions={f:"ext",q:query,maxResults:options.paging.size||settings.itemsLimit,pageToken:options.paging.cursor||null};return http.get(settings.apiUrl+"/search",requestOptions,{withCredentials:!1,headers:options.headers||{}}).then(_utils2.default.partial(_items2.default,listSettings)).catch(_error2.default)}return{search:search}};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_items=__webpack_require__(209),_items2=_interopRequireDefault(_items),_error=__webpack_require__(211),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,res){var cursor=null,size=null;return res.data&&res.data.nextPageToken&&(cursor=res.data.nextPageToken,size=res.data.pageInfo.resultsPerPage),res.data=(res.data.items||[]).map(_utils2.default.partial(_item2.default,settings)),res.paging={cursor:cursor,size:size},res};var _item=__webpack_require__(210),_item2=_interopRequireDefault(_item),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,data){var snippet=data.snippet,videoId=data.id.videoId,availableThumbnailsSizes=Object.keys(snippet.thumbnails).map(function(prop){return snippet.thumbnails[prop]}),urls=_utils2.default.getThumbnailsUrlsFromList(availableThumbnailsSizes,settings.thumbnailSizes);return _utils2.default.extend({},{id:videoId,name:_utils2.default.replaceHtml(snippet.title),iframeSrc:function(videoId){return"//www.youtube.com/embed/"+videoId}(videoId),folderId:null,mediaType:"video"},urls)};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(response){return _bluebirdExtend2.default.reject(response)};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_bluebirdExtend)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(userSettings){this.name="showbox";var settings=_utils2.default.extendDeep({},_settings2.default,userSettings),requestOptions=settings.requestOptions,http=(0,_http2.default)(requestOptions),folders=(0,_folders2.default)(settings,http),items=(0,_items2.default)(settings,http),item=(0,_item2.default)(settings,http);this.folders=_decorators2.default.addEvents(this,_list2.default.FOLDERS,folders),this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items),this.item=_decorators2.default.addEvents(this,_list2.default.ITEM,item)};var _folders=__webpack_require__(213),_folders2=_interopRequireDefault(_folders),_items=__webpack_require__(215),_items2=_interopRequireDefault(_items),_item=__webpack_require__(217),_item2=_interopRequireDefault(_item),_settings=__webpack_require__(218),_settings2=_interopRequireDefault(_settings),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function mapFolderList(res){return res.data=(res.data.collection||[]).map(_folder2.default),res}function list(folderId,options){options=options||{};var url=settings.apiUrl+"/taxonomy/";return folderId&&(url+="cms_id/"+folderId),http.get(url,{},{withCredentials:!1,headers:options.headers||{}}).then(mapFolderList).catch(_error2.default)}return{list:list}};var _folder=__webpack_require__(214),_folder2=_interopRequireDefault(_folder),_error=__webpack_require__(55),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(folderData){return{id:folderData.cms_id,parentId:folderData.parents.pop(),name:folderData.title,createdAt:folderData.created_at}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function mapItemList(res,thumbnailSizes){return res.data=(res.data.collection||[]).map(function(data){return(0,_item2.default)(data,settings,thumbnailSizes)}),res}function list(folderId,options){options=options||{};var sort=_utils2.default.extend({},defaultSort,options.sort),paging=_utils2.default.extend({},defaultPaging,options.paging),queryParams={category:folderId,cursor:paging.cursor};queryParams.order="desc"===sort.direction?"-"+sort.order:sort.order;var url=settings.apiUrl+"/taxonomy";return http.get(url,queryParams,{withCredentials:!1,headers:options.headers||{}}).then(function(response){return response.paging={cursor:response.data.cursor},mapItemList(response,options.thumbnails)}).catch(_error2.default)}var defaultPaging={size:50,cursor:null},defaultSort={order:"date",direction:"desc"};return{list:list}};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_item=__webpack_require__(216),_item2=_interopRequireDefault(_item),_error=__webpack_require__(55),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(itemData,settings,thumbnailSizes){var item=(_utils2.default.normalizeUri,{mediaType:"showbox_template",id:[itemData.cms_id,itemData.format,itemData.package].join(":"),fileUrl:itemData.cms_id,folderId:itemData.category[0]||null,name:itemData.title,width:_utils2.default.get(itemData,"aux.width"),height:_utils2.default.get(itemData,"aux.height"),thumbnailUrl:itemData.thumbnail||null,previewUrl:itemData.thumbnail||null,video:itemData.video||null,fileOutput:_utils2.default.get(itemData,"aux.file_output"),fileInput:_utils2.default.get(itemData,"aux.file_input")});return item.videoPreviewUrls=(0,_getWixVideoPreviewUrls2.default)(item,settings),item};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_getWixVideoPreviewUrls=__webpack_require__(17),_getWixVideoPreviewUrls2=_interopRequireDefault(_getWixVideoPreviewUrls)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function mapItem(res){return res}function getExtra(itemId,options){options=options||{};var url=settings.pixUrl+"/services/showbox/videodata",query={template_id:itemId};return http.get(url,query,{withCredentials:!0,headers:options.headers||{}}).then(mapItem).catch(_error2.default)}return{get:getExtra}};var _error=__webpack_require__(55),_error2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//pix.wix.com/services/showbox/",imageOperationsApi:"rembrandt",filesUrl:"//video-showbox.wixmp.com",pixUrl:"//pix.wix.com",videoFilesUrl:"//video-showbox.wixmp.com",refreshTokenUrl:null,requestOptions:{withCredentials:!0},thumbnailSizes:{thumbnail:{width:210,height:210,mode:"fill"},preview:{width:375,height:375,mode:"fit"},original:{width:1e3,height:1e3,mode:"fit"}},asyncFontUpload:!1,asyncUploadByUrl:!1,asyncTranscoding:!1,videoPreviewQuality:"480p"}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(userSettings){this.name="deviantart";var settings=_utils2.default.extendDeep({},_settings2.default,userSettings),requestOptions=settings.requestOptions,http=(0,_http2.default)(requestOptions),folders=(0,_folders2.default)(settings,http),items=(0,_items2.default)(settings,http);this.folders=_decorators2.default.addEvents(this,_list2.default.FOLDERS,folders),this.items=_decorators2.default.addEvents(this,_list2.default.ITEMS,items)};var _folders=__webpack_require__(220),_folders2=_interopRequireDefault(_folders),_items=__webpack_require__(223),_items2=_interopRequireDefault(_items),_settings=__webpack_require__(226),_settings2=_interopRequireDefault(_settings),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_decorators=__webpack_require__(4),_decorators2=_interopRequireDefault(_decorators),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderID,options){options=options||{},options.paging=options.paging||{};var requestOptions={limit:options.paging.size||settings.foldersLimit,offset:options.paging.cursor||null};return http.get(settings.apiUrl+"/gallery/folders",requestOptions,{withCredentials:!0,headers:options.headers||{}}).then(_utils2.default.partial(_folders2.default,settings)).catch(_error2.default)}return{list:list}};var _utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_folders=__webpack_require__(221),_folders2=_interopRequireDefault(_folders),_error=__webpack_require__(68),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,res){var cursor=res.data.next_offset;return res.data=(res.data.results||[]).map(function(data){return(0,_folder2.default)(data,settings)}),res.paging={cursor:cursor||null,size:null},res};var _folder=__webpack_require__(222),_folder2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_folder)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){return{id:data.folderid,name:data.name,mediaType:"picture",parentId:data.parent,filesCount:1,createdAt:null}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(settings,http){function list(folderId,options){options=options||{},options.paging=options.paging||{};var requestOptions={limit:options.paging.size||settings.itemsLimit,offset:options.paging.cursor||null};return http.get(settings.apiUrl+"/gallery/"+folderId,requestOptions,{withCredentials:!0,headers:options.headers||{}}).then(_items2.default).catch(_error2.default)}return{list:list}};var _items=__webpack_require__(224),_items2=_interopRequireDefault(_items),_error=__webpack_require__(68),_error2=_interopRequireDefault(_error)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(res){var cursor=res.data.next_offset;return res.data=(res.data.results||[]).map(_item2.default),res.paging={cursor:cursor||null,size:null},res};var _item=__webpack_require__(225),_item2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_item)},function(module,exports,__webpack_require__){"use strict";function findThumbnailUrl(images){return _utils2.default.max(images,function(image){return image.width+image.height}).src}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(data){return{id:data.deviationid,name:data.title||"",mediaType:"picture",thumbnailUrl:_utils2.default.normalizeUri(findThumbnailUrl(data.thumbs)),createdAt:data.published_time,previewUrl:_utils2.default.normalizeUri(_utils2.default.get(data,"preview.src")),fileUrl:_utils2.default.normalizeUri(_utils2.default.get(data,"content.src")),width:_utils2.default.get(data,"content.width"),height:_utils2.default.get(data,"content.height"),tags:[]}};var _utils=__webpack_require__(0),_utils2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_utils)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={apiUrl:"//pix.wix.com/services/deviantart",foldersLimit:20,itemsLimit:20}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.default=function(adapterName,userSettings){function getParameterName(){return settings.parameterName}function isConnected(){return Boolean(localStorage.getItem(settings.parameterName))}function disconnect(){return localStorage.removeItem(settings.parameterName),http.get(settings.disconnectUrl,null,{withCredentials:!0})}function connect(){var promise;return window.open(settings.connectUrl+"?return_url="+userSettings.redirectUrl,"connector","width=950,height=550"),promise=new _bluebirdExtend2.default(function(resolve,reject){window.connectService=function(data){var token,status;token=_utils2.default.getParameterByName(data,getParameterName()),status=_utils2.default.getParameterByName(data,"status"),!token||status&&"FAIL"===status?reject(_mappers2.default.toError({code:401,message:"Not Authorized"})):resolve(token)}}),promise.then(function(token){localStorage.setItem(settings.parameterName,token)},function(reason){return reason}),promise}var settings=_connectorSettings2.default[adapterName],http=(0,_http2.default)();if("object"!==(void 0===settings?"undefined":_typeof(settings)))throw new Error("Invalid source");return{connect:connect,disconnect:disconnect,isConnected:isConnected}};var _bluebirdExtend=__webpack_require__(1),_bluebirdExtend2=_interopRequireDefault(_bluebirdExtend),_connectorSettings=__webpack_require__(228),_connectorSettings2=_interopRequireDefault(_connectorSettings),_http=__webpack_require__(2),_http2=_interopRequireDefault(_http),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),_mappers=__webpack_require__(5),_mappers2=_interopRequireDefault(_mappers)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={DEVIANTART:{connectUrl:"//pix.wix.com/services/deviantart/connect",disconnectUrl:"//pix.wix.com/services/deviantart/disconnect",parameterName:"daact"},PICASA:{connectUrl:"//pix.wix.com/services/google/connect",disconnectUrl:"//pix.wix.com/services/google/disconnect",parameterName:"goglact"},DRIVE:{connectUrl:"//pix.wix.com/services/gdrive/connect",disconnectUrl:"//pix.wix.com/services/gdrive/disconnect",parameterName:"gdrvact"},DROPBOX:{connectUrl:"//pix.wix.com/services/dropbox/connect",disconnectUrl:"//pix.wix.com/services/dropbox/disconnect",parameterName:"dbact"},INSTAGRAM:{connectUrl:"//pix.wix.com/services/instagram/connect",disconnectUrl:"//pix.wix.com/services/instagram/disconnect",parameterName:"instact"},INSTAGRAM_VIDEO:{connectUrl:"//pix.wix.com/services/instagram/connect",disconnectUrl:"//pix.wix.com/services/instagram/disconnect",parameterName:"instact"},FACEBOOK:{connectUrl:"//pix.wix.com/services/facebook/connect",disconnectUrl:"//pix.wix.com/services/facebook/disconnect",parameterName:"fbact"},FACEBOOK_VIDEO:{connectUrl:"//pix.wix.com/services/facebook/connect",disconnectUrl:"//pix.wix.com/services/facebook/disconnect",parameterName:"fbact"},FLICKR:{connectUrl:"//pix.wix.com/services/flickr/connect",disconnectUrl:"//pix.wix.com/services/flickr/disconnect",parameterName:"flact"},YOUTUBE:{connectUrl:"//pix.wix.com/services/youtube/connect",disconnectUrl:"//pix.wix.com/services/youtube/disconnect",parameterName:"ytact"},VIMEO:{connectUrl:"//pix.wix.com/services/vimeo/connect",disconnectUrl:"//pix.wix.com/services/vimeo/disconnect",parameterName:"vmact"}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(isEnabled,options){function getCurrentTime(){return(new Date).getTime()}var biListener=function(promise,params){Array.isArray(promise)&&(promise=Promise.all(promise)),_benchmarks2.default.response(promise,params);var reportSuccess=function(){},requestStartTime=getCurrentTime(),reportError=function(response){var currentOptions=_utils2.default.extend({requestTimeMs:getCurrentTime()-requestStartTime},options);(0,_errors2.default)(params.eventTarget.name,params.eventName,response,currentOptions)};return promise.then(reportSuccess,reportError)};Object.keys(_list2.default).forEach(function(group){Object.keys(_list2.default[group]).forEach(function(action){!0===isEnabled?_notifier2.default.addListener(_list2.default[group][action],biListener):_notifier2.default.removeListener(_list2.default[group][action],biListener)})}),!0===isEnabled?_notifier2.default.addListener(_list2.default.ITEM.UPLOAD,_benchmarks2.default.upload):_notifier2.default.removeListener(_list2.default.ITEM.UPLOAD,_benchmarks2.default.upload),!0===isEnabled&&(_uploadCollection2.default.on("uploadQueueStarted",_uploadQueue2.default.start),_uploadCollection2.default.on("uploadQueueFinished",_uploadQueue2.default.finish))};var _notifier=__webpack_require__(9),_notifier2=_interopRequireDefault(_notifier),_list=__webpack_require__(3),_list2=_interopRequireDefault(_list),_benchmarks=__webpack_require__(230),_benchmarks2=_interopRequireDefault(_benchmarks),_errors=__webpack_require__(231),_errors2=_interopRequireDefault(_errors),_uploadCollection=__webpack_require__(18),_uploadCollection2=_interopRequireDefault(_uploadCollection),_uploadQueue=__webpack_require__(232),_uploadQueue2=_interopRequireDefault(_uploadQueue),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils)},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getCurrentTime(){return(new Date).getTime()}function notifyResponseTime(adapter,eventName,data){var requestName=adapter.name+"("+eventName+")",responseTime=getCurrentTime()-data.startedAt;if(responseTime>0&&data.responseSize>0){var responseSpeed=Math.floor(data.responseSize/(responseTime/1e3));if(!responseSpeed)return;(0,_sendRequest2.default)("/mg",{src:26,evid:_eventIds2.default.BIEventsIds.responseTime,call_name:requestName||"",result:data.isSuccess?"success":"fail",response_speed:responseSpeed,response_time:responseTime||0,response_size:data.responseSize})}}function benchmarkResponse(promise,params){var startedAt=getCurrentTime();promise.then(function(result){notifyResponseTime(params.eventTarget,params.eventName,{startedAt:startedAt,responseSize:result.responseSize,isSuccess:!0})}).catch(function(result){notifyResponseTime(params.eventTarget,params.eventName,{startedAt:startedAt,responseSize:result.responseSize,isSuccess:!1})})}function benchmarkUpload(promise,params){var startedAt=getCurrentTime(),fileSize=params.arguments[0].file.size;fileSize<10240||promise.then(function(){var responseTime=(getCurrentTime()-startedAt)/1e3;responseTime<1||(0,_sendRequest2.default)("/mg",{src:26,evid:_eventIds2.default.BIEventsIds.uploadSpeed,time_seconds:Math.floor(responseTime),size_bytes:fileSize,bytes_per_second:Math.floor(fileSize/responseTime)})}).catch(function(err){console.warn(err)})}Object.defineProperty(exports,"__esModule",{value:!0});var _eventIds=__webpack_require__(14),_eventIds2=_interopRequireDefault(_eventIds),_sendRequest=__webpack_require__(15),_sendRequest2=_interopRequireDefault(_sendRequest);exports.default={response:benchmarkResponse,upload:benchmarkUpload}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(adapterName,eventName,response,options){var httpCode=response.code||"000",adapterCode=_eventIds2.default.BIAdaptersIds[adapterName]||"00",requestCode=_eventIds2.default.BIAdaptersRequestsIds[eventName]||"00",errorDesc=adapterName+" "+eventName+": "+response.message,errorCode=adapterCode+requestCode+httpCode,errorName=adapterName+"."+eventName+"."+httpCode;return(0,_sendRequest2.default)("/trg",{src:25,evid:10,cat:catalogIds[adapterName]||catalogIds,iss:1,sev:_eventIds2.default.severity.error,errc:errorCode||"0000000",errn:errorName||"",ver:options.version||"VERSION",did:options.siteId||"",p1:httpCode||"000",p2:_utils2.default.get(response,"data.error_code")||"",p3:_utils2.default.get(response,"data.error_info.key")||"",ts:options.requestTimeMs||"",dsc:errorDesc||""})};var _eventIds=__webpack_require__(14),_eventIds2=_interopRequireDefault(_eventIds),_sendRequest=__webpack_require__(15),_sendRequest2=_interopRequireDefault(_sendRequest),_utils=__webpack_require__(0),_utils2=_interopRequireDefault(_utils),catalogIds={default:0,private:1,public:2,bigstock:4,drive:5,dropbox:6,facebook:7,flickr:8,instagram:9,picasa:10}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function generateId(){for(var id="";id.length<32;)id+=Math.floor(1e16*Math.random());return[id.slice(0,8),id.slice(8,12),id.slice(12,16),id.slice(16,20),id.slice(20,32)].join("-")}function sendUploadStart(){currentUploadId=generateId(),(0,_sendRequest2.default)("/mg",{src:26,evid:_eventIds2.default.BIEventsIds.uploadQueueStarted,upload_queue_id:currentUploadId})}function sendUploadFinish(queue){(0,_sendRequest2.default)("/mg",{src:26,evid:_eventIds2.default.BIEventsIds.uploadQueueFinished,upload_queue_id:currentUploadId,files_count:queue.length})}Object.defineProperty(exports,"__esModule",{value:!0})
;var _eventIds=__webpack_require__(14),_eventIds2=_interopRequireDefault(_eventIds),_sendRequest=__webpack_require__(15),_sendRequest2=_interopRequireDefault(_sendRequest),currentUploadId="";exports.default={start:sendUploadStart,finish:sendUploadFinish}}])}),angular.module("pascalprecht.translate",["ng"]).run(["$translate",function($translate){var key=$translate.storageKey(),storage=$translate.storage();storage?storage.get(key)?$translate.uses(storage.get(key)):angular.isString($translate.preferredLanguage())?$translate.uses($translate.preferredLanguage()):storage.set(key,$translate.uses()):angular.isString($translate.preferredLanguage())&&$translate.uses($translate.preferredLanguage())}]),angular.module("pascalprecht.translate").provider("$translate",["$STORAGE_KEY",function($STORAGE_KEY){var $preferredLanguage,$fallbackLanguage,$uses,$nextLang,$storageFactory,$storagePrefix,$missingTranslationHandlerFactory,$interpolationFactory,$loaderFactory,$loaderOptions,$notFoundIndicatorLeft,$notFoundIndicatorRight,$translationTable={},$storageKey=$STORAGE_KEY,$interpolatorFactories=[],translations=function(langKey,translationTable){if(!langKey&&!translationTable)return $translationTable;if(langKey&&!translationTable){if(angular.isString(langKey))return $translationTable[langKey];angular.extend($translationTable,flatObject(langKey))}else angular.isObject($translationTable[langKey])||($translationTable[langKey]={}),angular.extend($translationTable[langKey],flatObject(translationTable));return this},flatObject=function(data,path,result,prevKey){var key,keyWithPath,val;path||(path=[]),result||(result={});for(key in data)data.hasOwnProperty(key)&&(val=data[key],angular.isObject(val)?flatObject(val,path.concat(key),result,key):(keyWithPath=path.length?path.join(".")+"."+key:key,path.length&&key===prevKey&&(keyWithShortPath=""+path.join("."),result[keyWithShortPath]="@:"+keyWithPath),result[keyWithPath]=val));return result};this.translations=translations,this.addInterpolation=function(factory){return $interpolatorFactories.push(factory),this},this.useMessageFormatInterpolation=function(){return this.useInterpolation("$translateMessageFormatInterpolation")},this.useInterpolation=function(factory){return $interpolationFactory=factory,this},this.preferredLanguage=function(langKey){return langKey?($preferredLanguage=langKey,this):$preferredLanguage},this.translationNotFoundIndicator=function(indicator){return this.translationNotFoundIndicatorLeft(indicator),this.translationNotFoundIndicatorRight(indicator),this},this.translationNotFoundIndicatorLeft=function(indicator){return indicator?($notFoundIndicatorLeft=indicator,this):$notFoundIndicatorLeft},this.translationNotFoundIndicatorRight=function(indicator){return indicator?($notFoundIndicatorRight=indicator,this):$notFoundIndicatorRight},this.fallbackLanguage=function(langKey){return langKey?(("string"==typeof langKey||angular.isArray(langKey))&&($fallbackLanguage=langKey),this):$fallbackLanguage},this.uses=function(langKey){if(langKey){if(!$translationTable[langKey]&&!$loaderFactory)throw new Error("$translateProvider couldn't find translationTable for langKey: '"+langKey+"'");return $uses=langKey,this}return $uses};var storageKey=function(key){if(!key)return $storagePrefix?$storagePrefix+$storageKey:$storageKey;$storageKey=key};this.storageKey=storageKey,this.useUrlLoader=function(url){return this.useLoader("$translateUrlLoader",{url:url})},this.useStaticFilesLoader=function(options){return this.useLoader("$translateStaticFilesLoader",options)},this.useLoader=function(loaderFactory,options){return $loaderFactory=loaderFactory,$loaderOptions=options||{},this},this.useLocalStorage=function(){return this.useStorage("$translateLocalStorage")},this.useCookieStorage=function(){return this.useStorage("$translateCookieStorage")},this.useStorage=function(storageFactory){return $storageFactory=storageFactory,this},this.storagePrefix=function(prefix){return prefix?($storagePrefix=prefix,this):prefix},this.useMissingTranslationHandlerLog=function(){return this.useMissingTranslationHandler("$translateMissingTranslationHandlerLog")},this.useMissingTranslationHandler=function(factory){return $missingTranslationHandlerFactory=factory,this},this.$get=["$log","$injector","$rootScope","$q",function($log,$injector,$rootScope,$q){var Storage,defaultInterpolator=$injector.get($interpolationFactory||"$translateDefaultInterpolation"),pendingLoader=!1,interpolatorHashMap={},loadAsync=function(key){if(!key)throw"No language key specified for loading.";var deferred=$q.defer();return $rootScope.$broadcast("$translateLoadingStart"),pendingLoader=!0,$injector.get($loaderFactory)(angular.extend($loaderOptions,{key:key})).then(function(data){$rootScope.$broadcast("$translateLoadingSuccess");var translationTable={};angular.isArray(data)?angular.forEach(data,function(table){angular.extend(translationTable,table)}):angular.extend(translationTable,data),pendingLoader=!1,deferred.resolve({key:key,table:translationTable}),$rootScope.$broadcast("$translateLoadingEnd")},function(key){$rootScope.$broadcast("$translateLoadingError"),deferred.reject(key),$rootScope.$broadcast("$translateLoadingEnd")}),deferred.promise};if($storageFactory&&(Storage=$injector.get($storageFactory),!Storage.get||!Storage.set))throw new Error("Couldn't use storage '"+$storageFactory+"', missing get() or set() method!");$interpolatorFactories.length>0&&angular.forEach($interpolatorFactories,function(interpolatorFactory){var interpolator=$injector.get(interpolatorFactory);interpolator.setLocale($preferredLanguage||$uses),interpolatorHashMap[interpolator.getInterpolationIdentifier()]=interpolator});var checkValidFallback=function(usesLang){if(usesLang&&$fallbackLanguage){if(angular.isArray($fallbackLanguage)){for(var fallbackLanguagesSize=$fallbackLanguage.length,current=0;current<fallbackLanguagesSize;current++)if($uses===$translationTable[$fallbackLanguage[current]])return!1;return!0}return usesLang!==$fallbackLanguage}return!1},$translate=function(translationId,interpolateParams,interpolationId){var table=$uses?$translationTable[$uses]:$translationTable,Interpolator=interpolationId?interpolatorHashMap[interpolationId]:defaultInterpolator;if(table&&table.hasOwnProperty(translationId))return angular.isString(table[translationId])&&"@:"===table[translationId].substr(0,2)?$translate(table[translationId].substr(2),interpolateParams,interpolationId):Interpolator.interpolate(table[translationId],interpolateParams);$missingTranslationHandlerFactory&&!pendingLoader&&$injector.get($missingTranslationHandlerFactory)(translationId,$uses);var normatedLanguages;if($uses&&$fallbackLanguage&&checkValidFallback($uses)){"string"==typeof $fallbackLanguage?(normatedLanguages=[],normatedLanguages.push($fallbackLanguage)):normatedLanguages=$fallbackLanguage;for(var fallbackLanguagesSize=normatedLanguages.length,current=0;current<fallbackLanguagesSize;current++)if($uses!==$translationTable[normatedLanguages[current]]){var translationFromList=$translationTable[normatedLanguages[current]][translationId];if(translationFromList){var returnValFromList;return Interpolator.setLocale(normatedLanguages[current]),returnValFromList=Interpolator.interpolate(translationFromList,interpolateParams),Interpolator.setLocale($uses),returnValFromList}}}return $notFoundIndicatorLeft&&(translationId=[$notFoundIndicatorLeft,translationId].join(" ")),$notFoundIndicatorRight&&(translationId=[translationId,$notFoundIndicatorRight].join(" ")),translationId};if($translate.preferredLanguage=function(){return $preferredLanguage},$translate.fallbackLanguage=function(){return $fallbackLanguage},$translate.proposedLanguage=function(){return $nextLang},$translate.storage=function(){return Storage},$translate.uses=function(key){function useLanguage(key){$uses=key,$rootScope.$broadcast("$translateChangeSuccess"),$storageFactory&&Storage.set($translate.storageKey(),$uses),defaultInterpolator.setLocale($uses),angular.forEach(interpolatorHashMap,function(interpolator,id){interpolatorHashMap[id].setLocale($uses)}),deferred.resolve(key),$rootScope.$broadcast("$translateChangeEnd")}if(!key)return $uses;var deferred=$q.defer();return $rootScope.$broadcast("$translateChangeStart"),!$translationTable[key]&&$loaderFactory?($nextLang=key,loadAsync(key).then(function(translation){$nextLang=void 0,translations(translation.key,translation.table),useLanguage(translation.key)},function(key){$nextLang=void 0,$rootScope.$broadcast("$translateChangeError"),deferred.reject(key),$rootScope.$broadcast("$translateChangeEnd")})):useLanguage(key),deferred.promise},$translate.storageKey=function(){return storageKey()},$translate.refresh=function(langKey){function onLoadSuccess(){deferred.resolve(),$rootScope.$broadcast("$translateRefreshEnd")}function onLoadFailure(){deferred.reject(),$rootScope.$broadcast("$translateRefreshEnd")}if(!$loaderFactory)throw new Error("Couldn't refresh translation table, no loader registered!");var deferred=$q.defer();if(langKey)if($translationTable.hasOwnProperty(langKey)){$rootScope.$broadcast("$translateRefreshStart");var loader=loadAsync(langKey);langKey===$uses?loader.then(function(newTranslation){$translationTable[langKey]=newTranslation.table,$translate.uses($uses),onLoadSuccess()},function(){$rootScope.$broadcast("$translateChangeError"),onLoadFailure()}):loader.then(function(newTranslation){$translationTable[langKey]=newTranslation.table,onLoadSuccess()},onLoadFailure)}else deferred.reject();else{$rootScope.$broadcast("$translateRefreshStart");var loaders=[];if($fallbackLanguage)if("string"==typeof $fallbackLanguage)loaders.push(loadAsync($fallbackLanguage));else for(var fallbackLanguagesSize=$fallbackLanguage.length,current=0;current<fallbackLanguagesSize;current++)loaders.push(loadAsync($fallbackLanguage[current]));$uses&&loaders.push(loadAsync($uses)),loaders.length>0?$q.all(loaders).then(function(newTranslations){for(var lang in $translationTable)$translationTable.hasOwnProperty(lang)&&delete $translationTable[lang];for(var i=0,len=newTranslations.length;i<len;i++)translations(newTranslations[i].key,newTranslations[i].table);$uses&&$translate.uses($uses),onLoadSuccess()},function(key){key===$uses&&$rootScope.$broadcast("$translateChangeError"),onLoadFailure()}):onLoadSuccess()}return deferred.promise},$loaderFactory&&(angular.equals($translationTable,{})&&$translate.uses($translate.uses()),$fallbackLanguage))if("string"!=typeof $fallbackLanguage||$translationTable[$fallbackLanguage])for(var fallbackLanguagesSize=$fallbackLanguage.length,current=0;current<fallbackLanguagesSize;current++)$translationTable[$fallbackLanguage[current]]||loadAsync($fallbackLanguage[current]);else loadAsync($fallbackLanguage);return $translate}]}]),angular.module("pascalprecht.translate").factory("$translateDefaultInterpolation",["$interpolate",function($interpolate){var $locale,$translateInterpolator={};return $translateInterpolator.setLocale=function(locale){$locale=locale},$translateInterpolator.getInterpolationIdentifier=function(){return"default"},$translateInterpolator.interpolate=function(string,interpolateParams){return $interpolate(string)(interpolateParams)},$translateInterpolator}]),angular.module("pascalprecht.translate").constant("$STORAGE_KEY","NG_TRANSLATE_LANG_KEY"),angular.module("pascalprecht.translate").directive("translate",["$filter","$interpolate","$parse",function($filter,$interpolate,$parse){var translate=$filter("translate");return{restrict:"AE",scope:!0,link:function(scope,element,attr){attr.translateInterpolation&&(scope.interpolation=attr.translateInterpolation),attr.$observe("translate",function(translationId){angular.equals(translationId,"")||void 0===translationId?scope.translationId=$interpolate(element.text().replace(/^\s+|\s+$/g,""))(scope.$parent):scope.translationId=translationId}),attr.$observe("translateValues",function(interpolateParams){interpolateParams&&scope.$parent.$watch(function(){scope.interpolateParams=$parse(interpolateParams)(scope.$parent)})}),scope.$on("$translateChangeSuccess",function(){element.html(translate(scope.translationId,scope.interpolateParams,scope.interpolation))}),scope.$watch("[translationId, interpolateParams]",function(nValue){scope.translationId&&element.html(translate(scope.translationId,scope.interpolateParams,scope.interpolation))},!0)}}}]),angular.module("pascalprecht.translate").filter("translate",["$parse","$translate",function($parse,$translate){return function(translationId,interpolateParams,interpolation){return angular.isObject(interpolateParams)||(interpolateParams=$parse(interpolateParams)()),$translate(translationId,interpolateParams,interpolation)}}]);try{angular.module("styleTranslations")}catch(e){angular.module("styleTranslations",["pascalprecht.translate"])}angular.module("styleTranslations").config(["$translateProvider",function($translateProvider){var translations={general:{YO:"Hello"},calendar:{clear:"clear"}};$translateProvider.translations("en",translations),$translateProvider.translations(translations),$translateProvider.preferredLanguage&&$translateProvider.preferredLanguage("en")}]).value("preferredLanguage","en"),function(a,b){"use strict";if("function"==typeof define&&define.amd)define(["angular"],b);else if("object"==typeof module&&module.exports){var c=angular||require("angular");c&&c.module||"undefined"==typeof angular||(c=angular),module.exports=b(c)}else b(a.angular)}(this,function(a){"use strict";var b=a.module("rzModule",[]).factory("RzSliderOptions",function(){var b={floor:0,ceil:null,step:1,precision:0,minRange:null,maxRange:null,pushRange:!1,minLimit:null,maxLimit:null,id:null,translate:null,getLegend:null,stepsArray:null,bindIndexForStepsArray:!1,draggableRange:!1,draggableRangeOnly:!1,showSelectionBar:!1,showSelectionBarEnd:!1,showSelectionBarFromValue:null,hidePointerLabels:!1,hideLimitLabels:!1,autoHideLimitLabels:!0,readOnly:!1,disabled:!1,interval:350,showTicks:!1,showTicksValues:!1,ticksArray:null,ticksTooltip:null,ticksValuesTooltip:null,vertical:!1,getSelectionBarColor:null,getTickColor:null,getPointerColor:null,keyboardSupport:!0,scale:1,enforceStep:!0,enforceRange:!1,noSwitching:!1,onlyBindHandles:!1,onStart:null,onChange:null,onEnd:null,rightToLeft:!1,boundPointerLabels:!0,mergeRangeLabelsIfSame:!1,customTemplateScope:null,logScale:!1,customValueToPosition:null,customPositionToValue:null,selectionBarGradient:null},c={},d={};return d.options=function(b){a.extend(c,b)},d.getOptions=function(d){return a.extend({},b,c,d)},d}).factory("rzThrottle",["$timeout",function(a){return function(b,c,d){var e,f,g,h=Date.now||function(){return(new Date).getTime()},i=null,j=0;d=d||{};var k=function(){j=h(),i=null,g=b.apply(e,f),e=f=null};return function(){var l=h(),m=c-(l-j);return e=this,f=arguments,0>=m?(a.cancel(i),i=null,j=l,g=b.apply(e,f),e=f=null):i||!1===d.trailing||(i=a(k,m)),g}}}]).factory("RzSlider",["$timeout","$document","$window","$compile","RzSliderOptions","rzThrottle",function(b,c,d,e,f,g){var h=function(a,b){this.scope=a,this.lowValue=0,this.highValue=0,this.sliderElem=b,this.range=void 0!==this.scope.rzSliderModel&&void 0!==this.scope.rzSliderHigh,this.dragging={active:!1,value:0,difference:0,position:0,lowLimit:0,highLimit:0},this.positionProperty="left",this.dimensionProperty="width",this.handleHalfDim=0,this.maxPos=0,this.precision=0,this.step=1,this.tracking="",this.minValue=0,this.maxValue=0,this.valueRange=0,this.intermediateTicks=!1,this.initHasRun=!1,this.firstKeyDown=!1,this.internalChange=!1,this.cmbLabelShown=!1,this.currentFocusElement=null,this.fullBar=null,this.selBar=null,this.minH=null,this.maxH=null,this.flrLab=null,this.ceilLab=null,this.minLab=null,this.maxLab=null,this.cmbLab=null,this.ticks=null,this.init()};return h.prototype={init:function(){var b,c,e=this,f=function(){e.calcViewDimensions()};this.applyOptions(),this.syncLowValue(),this.range&&this.syncHighValue(),this.initElemHandles(),this.manageElementsStyle(),this.setDisabledState(),this.calcViewDimensions(),this.setMinAndMax(),this.addAccessibility(),this.updateCeilLab(),this.updateFloorLab(),this.initHandles(),this.manageEventsBindings(),this.scope.$on("reCalcViewDimensions",f),a.element(d).on("resize",f),this.initHasRun=!0,b=g(function(){e.onLowHandleChange()},e.options.interval),c=g(function(){e.onHighHandleChange()},e.options.interval),this.scope.$on("rzSliderForceRender",function(){e.resetLabelsValue(),b(),e.range&&c(),e.resetSlider()}),this.scope.$watch("rzSliderOptions()",function(a,b){a!==b&&(e.applyOptions(),e.syncLowValue(),e.range&&e.syncHighValue(),e.resetSlider())},!0),this.scope.$watch("rzSliderModel",function(a,c){e.internalChange||a!==c&&b()}),this.scope.$watch("rzSliderHigh",function(a,b){e.internalChange||a!==b&&(null!=a&&c(),(e.range&&null==a||!e.range&&null!=a)&&(e.applyOptions(),e.resetSlider()))}),this.scope.$on("$destroy",function(){e.unbindEvents(),a.element(d).off("resize",f),e.currentFocusElement=null})},findStepIndex:function(b){for(var c=0,d=0;d<this.options.stepsArray.length;d++){var e=this.options.stepsArray[d];if(e===b){c=d;break}if(a.isDate(e)){if(e.getTime()===b.getTime()){c=d;break}}else if(a.isObject(e)&&(a.isDate(e.value)&&e.value.getTime()===b.getTime()||e.value===b)){c=d;break}}return c},syncLowValue:function(){this.options.stepsArray?this.options.bindIndexForStepsArray?this.lowValue=this.scope.rzSliderModel:this.lowValue=this.findStepIndex(this.scope.rzSliderModel):this.lowValue=this.scope.rzSliderModel},syncHighValue:function(){this.options.stepsArray?this.options.bindIndexForStepsArray?this.highValue=this.scope.rzSliderHigh:this.highValue=this.findStepIndex(this.scope.rzSliderHigh):this.highValue=this.scope.rzSliderHigh},getStepValue:function(b){var c=this.options.stepsArray[b];return a.isDate(c)?c:a.isObject(c)?c.value:c},applyLowValue:function(){this.options.stepsArray?this.options.bindIndexForStepsArray?this.scope.rzSliderModel=this.lowValue:this.scope.rzSliderModel=this.getStepValue(this.lowValue):this.scope.rzSliderModel=this.lowValue},applyHighValue:function(){this.options.stepsArray?this.options.bindIndexForStepsArray?this.scope.rzSliderHigh=this.highValue:this.scope.rzSliderHigh=this.getStepValue(this.highValue):this.scope.rzSliderHigh=this.highValue},onLowHandleChange:function(){this.syncLowValue(),this.range&&this.syncHighValue(),this.setMinAndMax(),this.updateLowHandle(this.valueToPosition(this.lowValue)),this.updateSelectionBar(),this.updateTicksScale(),this.updateAriaAttributes(),this.range&&this.updateCmbLabel()},onHighHandleChange:function(){this.syncLowValue(),this.syncHighValue(),this.setMinAndMax(),this.updateHighHandle(this.valueToPosition(this.highValue)),this.updateSelectionBar(),this.updateTicksScale(),this.updateCmbLabel(),this.updateAriaAttributes()},applyOptions:function(){var b;b=this.scope.rzSliderOptions?this.scope.rzSliderOptions():{},this.options=f.getOptions(b),this.options.step<=0&&(this.options.step=1),this.range=void 0!==this.scope.rzSliderModel&&void 0!==this.scope.rzSliderHigh,this.options.draggableRange=this.range&&this.options.draggableRange,this.options.draggableRangeOnly=this.range&&this.options.draggableRangeOnly,this.options.draggableRangeOnly&&(this.options.draggableRange=!0),this.options.showTicks=this.options.showTicks||this.options.showTicksValues||!!this.options.ticksArray,this.scope.showTicks=this.options.showTicks,(a.isNumber(this.options.showTicks)||this.options.ticksArray)&&(this.intermediateTicks=!0),this.options.showSelectionBar=this.options.showSelectionBar||this.options.showSelectionBarEnd||null!==this.options.showSelectionBarFromValue,this.options.stepsArray?this.parseStepsArray():(this.options.translate?this.customTrFn=this.options.translate:this.customTrFn=function(a){return String(a)},this.getLegend=this.options.getLegend),this.options.vertical&&(this.positionProperty="bottom",this.dimensionProperty="height"),this.options.customTemplateScope&&(this.scope.custom=this.options.customTemplateScope)},parseStepsArray:function(){this.options.floor=0,this.options.ceil=this.options.stepsArray.length-1,this.options.step=1,this.options.translate?this.customTrFn=this.options.translate:this.customTrFn=function(a){return this.options.bindIndexForStepsArray?this.getStepValue(a):a},this.getLegend=function(b){var c=this.options.stepsArray[b];return a.isObject(c)?c.legend:null}},resetSlider:function(){this.manageElementsStyle(),this.addAccessibility(),this.setMinAndMax(),this.updateCeilLab(),this.updateFloorLab(),this.unbindEvents(),this.manageEventsBindings(),this.setDisabledState(),this.calcViewDimensions(),this.refocusPointerIfNeeded()},refocusPointerIfNeeded:function(){this.currentFocusElement&&(this.onPointerFocus(this.currentFocusElement.pointer,this.currentFocusElement.ref),this.focusElement(this.currentFocusElement.pointer))},initElemHandles:function(){a.forEach(this.sliderElem.children(),function(b,c){var d=a.element(b);switch(c){case 0:this.fullBar=d;break;case 1:this.selBar=d;break;case 2:this.minH=d;break;case 3:this.maxH=d;break;case 4:this.flrLab=d;break;case 5:this.ceilLab=d;break;case 6:this.minLab=d;break;case 7:this.maxLab=d;break;case 8:this.cmbLab=d;break;case 9:this.ticks=d}},this),this.selBar.rzsp=0,this.minH.rzsp=0,this.maxH.rzsp=0,this.flrLab.rzsp=0,this.ceilLab.rzsp=0,this.minLab.rzsp=0,this.maxLab.rzsp=0,this.cmbLab.rzsp=0},manageElementsStyle:function(){this.range?this.maxH.css("display",""):this.maxH.css("display","none"),this.alwaysHide(this.flrLab,this.options.showTicksValues||this.options.hideLimitLabels),this.alwaysHide(this.ceilLab,this.options.showTicksValues||this.options.hideLimitLabels);var a=this.options.showTicksValues&&!this.intermediateTicks;this.alwaysHide(this.minLab,a||this.options.hidePointerLabels),this.alwaysHide(this.maxLab,a||!this.range||this.options.hidePointerLabels),this.alwaysHide(this.cmbLab,a||!this.range||this.options.hidePointerLabels),this.alwaysHide(this.selBar,!this.range&&!this.options.showSelectionBar),this.options.vertical&&this.sliderElem.addClass("rz-vertical"),this.options.draggableRange?this.selBar.addClass("rz-draggable"):this.selBar.removeClass("rz-draggable"),this.intermediateTicks&&this.options.showTicksValues&&this.ticks.addClass("rz-ticks-values-under")},alwaysHide:function(a,b){a.rzAlwaysHide=b,b?this.hideEl(a):this.showEl(a)},manageEventsBindings:function(){this.options.disabled||this.options.readOnly?this.unbindEvents():this.bindEvents()},setDisabledState:function(){this.options.disabled?this.sliderElem.attr("disabled","disabled"):this.sliderElem.attr("disabled",null)},resetLabelsValue:function(){this.minLab.rzsv=void 0,this.maxLab.rzsv=void 0},initHandles:function(){this.updateLowHandle(this.valueToPosition(this.lowValue)),this.range&&this.updateHighHandle(this.valueToPosition(this.highValue)),this.updateSelectionBar(),this.range&&this.updateCmbLabel(),this.updateTicksScale()},translateFn:function(a,b,c,d){d=void 0===d||d;var e="",f=!1,g=b.hasClass("no-label-injection");d?(this.options.stepsArray&&!this.options.bindIndexForStepsArray&&(a=this.getStepValue(a)),e=String(this.customTrFn(a,this.options.id,c))):e=String(a),(void 0===b.rzsv||b.rzsv.length!==e.length||b.rzsv.length>0&&0===b.rzsd)&&(f=!0,b.rzsv=e),g||b.html(e),this.scope[c+"Label"]=e,f&&this.getDimension(b)},setMinAndMax:function(){if(this.step=+this.options.step,this.precision=+this.options.precision,this.minValue=this.options.floor,this.options.logScale&&0===this.minValue)throw Error("Can't use floor=0 with logarithmic scale");this.options.enforceStep&&(this.lowValue=this.roundStep(this.lowValue),this.range&&(this.highValue=this.roundStep(this.highValue))),null!=this.options.ceil?this.maxValue=this.options.ceil:this.maxValue=this.options.ceil=this.range?this.highValue:this.lowValue,this.options.enforceRange&&(this.lowValue=this.sanitizeValue(this.lowValue),this.range&&(this.highValue=this.sanitizeValue(this.highValue))),this.applyLowValue(),this.range&&this.applyHighValue(),this.valueRange=this.maxValue-this.minValue},addAccessibility:function(){this.minH.attr("role","slider"),this.updateAriaAttributes(),!this.options.keyboardSupport||this.options.readOnly||this.options.disabled?this.minH.attr("tabindex",""):this.minH.attr("tabindex","0"),this.options.vertical&&this.minH.attr("aria-orientation","vertical"),this.range&&(this.maxH.attr("role","slider"),!this.options.keyboardSupport||this.options.readOnly||this.options.disabled?this.maxH.attr("tabindex",""):this.maxH.attr("tabindex","0"),this.options.vertical&&this.maxH.attr("aria-orientation","vertical"))},updateAriaAttributes:function(){this.minH.attr({"aria-valuenow":this.scope.rzSliderModel,"aria-valuetext":this.customTrFn(this.scope.rzSliderModel,this.options.id,"model"),"aria-valuemin":this.minValue,"aria-valuemax":this.maxValue}),this.range&&this.maxH.attr({"aria-valuenow":this.scope.rzSliderHigh,"aria-valuetext":this.customTrFn(this.scope.rzSliderHigh,this.options.id,"high"),"aria-valuemin":this.minValue,"aria-valuemax":this.maxValue})},calcViewDimensions:function(){var a=this.getDimension(this.minH);if(this.handleHalfDim=a/2,this.barDimension=this.getDimension(this.fullBar),this.maxPos=this.barDimension-a,this.getDimension(this.sliderElem),this.sliderElem.rzsp=this.sliderElem[0].getBoundingClientRect()[this.positionProperty],this.initHasRun){this.updateFloorLab(),this.updateCeilLab(),this.initHandles();var c=this;b(function(){c.updateTicksScale()})}},updateTicksScale:function(){if(this.options.showTicks){var a=this.options.ticksArray||this.getTicksArray(),b=this.options.vertical?"translateY":"translateX",c=this;this.options.rightToLeft&&a.reverse(),this.scope.ticks=a.map(function(a){var d=c.valueToPosition(a);c.options.vertical&&(d=c.maxPos-d);var e={selected:c.isTickSelected(a),style:{transform:b+"("+Math.round(d)+"px)"}};if(e.selected&&c.options.getSelectionBarColor&&(e.style["background-color"]=c.getSelectionBarColor()),!e.selected&&c.options.getTickColor&&(e.style["background-color"]=c.getTickColor(a)),c.options.ticksTooltip&&(e.tooltip=c.options.ticksTooltip(a),e.tooltipPlacement=c.options.vertical?"right":"top"),c.options.showTicksValues&&(e.value=c.getDisplayValue(a,"tick-value"),c.options.ticksValuesTooltip&&(e.valueTooltip=c.options.ticksValuesTooltip(a),e.valueTooltipPlacement=c.options.vertical?"right":"top")),c.getLegend){var f=c.getLegend(a,c.options.id);f&&(e.legend=f)}return e})}},getTicksArray:function(){var a=this.step,b=[];this.intermediateTicks&&(a=this.options.showTicks);for(var c=this.minValue;c<=this.maxValue;c+=a)b.push(c);return b},isTickSelected:function(a){if(!this.range)if(null!==this.options.showSelectionBarFromValue){var b=this.options.showSelectionBarFromValue;if(this.lowValue>b&&a>=b&&a<=this.lowValue)return!0;if(this.lowValue<b&&b>=a&&a>=this.lowValue)return!0}else if(this.options.showSelectionBarEnd){if(a>=this.lowValue)return!0}else if(this.options.showSelectionBar&&a<=this.lowValue)return!0;return!!(this.range&&a>=this.lowValue&&a<=this.highValue)},updateFloorLab:function(){this.translateFn(this.minValue,this.flrLab,"floor"),this.getDimension(this.flrLab);var a=this.options.rightToLeft?this.barDimension-this.flrLab.rzsd:0;this.setPosition(this.flrLab,a)},updateCeilLab:function(){this.translateFn(this.maxValue,this.ceilLab,"ceil"),this.getDimension(this.ceilLab);var a=this.options.rightToLeft?0:this.barDimension-this.ceilLab.rzsd;this.setPosition(this.ceilLab,a)},updateHandles:function(a,b){"lowValue"===a?this.updateLowHandle(b):this.updateHighHandle(b),this.updateSelectionBar(),this.updateTicksScale(),this.range&&this.updateCmbLabel()},getHandleLabelPos:function(a,b){var c=this[a].rzsd,d=b-c/2+this.handleHalfDim,e=this.barDimension-c;return this.options.boundPointerLabels?this.options.rightToLeft&&"minLab"===a||!this.options.rightToLeft&&"maxLab"===a?Math.min(d,e):Math.min(Math.max(d,0),e):d},updateLowHandle:function(a){if(this.setPosition(this.minH,a),this.translateFn(this.lowValue,this.minLab,"model"),this.setPosition(this.minLab,this.getHandleLabelPos("minLab",a)),this.options.getPointerColor){var b=this.getPointerColor("min");this.scope.minPointerStyle={backgroundColor:b}}this.options.autoHideLimitLabels&&this.shFloorCeil()},updateHighHandle:function(a){if(this.setPosition(this.maxH,a),this.translateFn(this.highValue,this.maxLab,"high"),this.setPosition(this.maxLab,this.getHandleLabelPos("maxLab",a)),this.options.getPointerColor){var b=this.getPointerColor("max");this.scope.maxPointerStyle={backgroundColor:b}}this.options.autoHideLimitLabels&&this.shFloorCeil()},shFloorCeil:function(){if(!this.options.hidePointerLabels){var a=!1,b=!1,c=this.isLabelBelowFloorLab(this.minLab),d=this.isLabelAboveCeilLab(this.minLab),e=this.isLabelAboveCeilLab(this.maxLab),f=this.isLabelBelowFloorLab(this.cmbLab),g=this.isLabelAboveCeilLab(this.cmbLab);if(c?(a=!0,this.hideEl(this.flrLab)):(a=!1,this.showEl(this.flrLab)),d?(b=!0,this.hideEl(this.ceilLab)):(b=!1,this.showEl(this.ceilLab)),this.range){var h=this.cmbLabelShown?g:e,i=this.cmbLabelShown?f:c;h?this.hideEl(this.ceilLab):b||this.showEl(this.ceilLab),i?this.hideEl(this.flrLab):a||this.showEl(this.flrLab)}}},isLabelBelowFloorLab:function(a){var b=this.options.rightToLeft,c=a.rzsp,d=a.rzsd,e=this.flrLab.rzsp,f=this.flrLab.rzsd;return b?c+d>=e-2:e+f+2>=c},isLabelAboveCeilLab:function(a){var b=this.options.rightToLeft,c=a.rzsp,d=a.rzsd,e=this.ceilLab.rzsp,f=this.ceilLab.rzsd;return b?e+f+2>=c:c+d>=e-2},updateSelectionBar:function(){var a=0,b=0,c=this.options.rightToLeft?!this.options.showSelectionBarEnd:this.options.showSelectionBarEnd,d=this.options.rightToLeft?this.maxH.rzsp+this.handleHalfDim:this.minH.rzsp+this.handleHalfDim;if(this.range)b=Math.abs(this.maxH.rzsp-this.minH.rzsp),a=d;else if(null!==this.options.showSelectionBarFromValue){var e=this.options.showSelectionBarFromValue,f=this.valueToPosition(e),g=this.options.rightToLeft?this.lowValue<=e:this.lowValue>e;g?(b=this.minH.rzsp-f,a=f+this.handleHalfDim):(b=f-this.minH.rzsp,a=this.minH.rzsp+this.handleHalfDim)}else c?(b=Math.abs(this.maxPos-this.minH.rzsp)+this.handleHalfDim,a=this.minH.rzsp+this.handleHalfDim):(b=Math.abs(this.maxH.rzsp-this.minH.rzsp)+this.handleHalfDim,a=0);if(this.setDimension(this.selBar,b),this.setPosition(this.selBar,a),this.options.getSelectionBarColor){var h=this.getSelectionBarColor();this.scope.barStyle={backgroundColor:h}}else if(this.options.selectionBarGradient){var i=null!==this.options.showSelectionBarFromValue?this.valueToPosition(this.options.showSelectionBarFromValue):0,j=i-a>0^c,k=this.options.vertical?j?"bottom":"top":j?"left":"right";this.scope.barStyle={backgroundImage:"linear-gradient(to "+k+", "+this.options.selectionBarGradient.from+" 0%,"+this.options.selectionBarGradient.to+" 100%)"},this.options.vertical?(this.scope.barStyle.backgroundPosition="center "+(i+b+a+(j?-this.handleHalfDim:0))+"px",this.scope.barStyle.backgroundSize="100% "+(this.barDimension-this.handleHalfDim)+"px"):(this.scope.barStyle.backgroundPosition=i-a+(j?this.handleHalfDim:0)+"px center",this.scope.barStyle.backgroundSize=this.barDimension-this.handleHalfDim+"px 100%")}},getSelectionBarColor:function(){return this.range?this.options.getSelectionBarColor(this.scope.rzSliderModel,this.scope.rzSliderHigh):this.options.getSelectionBarColor(this.scope.rzSliderModel)},getPointerColor:function(a){return"max"===a?this.options.getPointerColor(this.scope.rzSliderHigh,a):this.options.getPointerColor(this.scope.rzSliderModel,a)},getTickColor:function(a){return this.options.getTickColor(a)},updateCmbLabel:function(){if(this.options.rightToLeft?this.minLab.rzsp-this.minLab.rzsd-10<=this.maxLab.rzsp:this.minLab.rzsp+this.minLab.rzsd+10>=this.maxLab.rzsp){var b=this.getDisplayValue(this.lowValue,"model"),c=this.getDisplayValue(this.highValue,"high"),d="";d=this.options.mergeRangeLabelsIfSame&&b===c?b:this.options.rightToLeft?c+" - "+b:b+" - "+c,this.translateFn(d,this.cmbLab,"cmb",!1)
;var e=this.options.boundPointerLabels?Math.min(Math.max(this.selBar.rzsp+this.selBar.rzsd/2-this.cmbLab.rzsd/2,0),this.barDimension-this.cmbLab.rzsd):this.selBar.rzsp+this.selBar.rzsd/2-this.cmbLab.rzsd/2;this.setPosition(this.cmbLab,e),this.cmbLabelShown=!0,this.hideEl(this.minLab),this.hideEl(this.maxLab),this.showEl(this.cmbLab)}else this.cmbLabelShown=!1,this.showEl(this.maxLab),this.showEl(this.minLab),this.hideEl(this.cmbLab);this.options.autoHideLimitLabels&&this.shFloorCeil()},getDisplayValue:function(a,b){return this.options.stepsArray&&!this.options.bindIndexForStepsArray&&(a=this.getStepValue(a)),this.customTrFn(a,this.options.id,b)},roundStep:function(a,b){var c=b||this.step,d=parseFloat((a-this.minValue)/c).toPrecision(12);return d=Math.round(+d)*c,+(this.minValue+d).toFixed(this.precision)},hideEl:function(a){return a.css({visibility:"hidden"})},showEl:function(a){return a.rzAlwaysHide?a:a.css({visibility:"visible"})},setPosition:function(a,b){a.rzsp=b;var c={};return c[this.positionProperty]=Math.round(b)+"px",a.css(c),b},getDimension:function(a){var b=a[0].getBoundingClientRect();return this.options.vertical?a.rzsd=(b.bottom-b.top)*this.options.scale:a.rzsd=(b.right-b.left)*this.options.scale,a.rzsd},setDimension:function(a,b){a.rzsd=b;var c={};return c[this.dimensionProperty]=Math.round(b)+"px",a.css(c),b},sanitizeValue:function(a){return Math.min(Math.max(a,this.minValue),this.maxValue)},valueToPosition:function(a){var b=this.linearValueToPosition;this.options.customValueToPosition?b=this.options.customValueToPosition:this.options.logScale&&(b=this.logValueToPosition),a=this.sanitizeValue(a);var c=b(a,this.minValue,this.maxValue)||0;return this.options.rightToLeft&&(c=1-c),c*this.maxPos},linearValueToPosition:function(a,b,c){return(a-b)/(c-b)},logValueToPosition:function(a,b,c){return a=Math.log(a),b=Math.log(b),c=Math.log(c),(a-b)/(c-b)},positionToValue:function(a){var b=a/this.maxPos;this.options.rightToLeft&&(b=1-b);var c=this.linearPositionToValue;return this.options.customPositionToValue?c=this.options.customPositionToValue:this.options.logScale&&(c=this.logPositionToValue),c(b,this.minValue,this.maxValue)||0},linearPositionToValue:function(a,b,c){return a*(c-b)+b},logPositionToValue:function(a,b,c){b=Math.log(b),c=Math.log(c);var d=a*(c-b)+b;return Math.exp(d)},getEventXY:function(a){var b=this.options.vertical?"clientY":"clientX";return void 0!==a[b]?a[b]:void 0===a.originalEvent?a.touches[0][b]:a.originalEvent.touches[0][b]},getEventPosition:function(a){var b=this.sliderElem.rzsp;return(this.options.vertical?-this.getEventXY(a)+b:this.getEventXY(a)-b)*this.options.scale-this.handleHalfDim},getEventNames:function(a){var b={moveEvent:"",endEvent:""};return a.touches||void 0!==a.originalEvent&&a.originalEvent.touches?(b.moveEvent="touchmove",b.endEvent="touchend"):(b.moveEvent="mousemove",b.endEvent="mouseup"),b},getNearestHandle:function(a){if(!this.range)return this.minH;var b=this.getEventPosition(a),c=Math.abs(b-this.minH.rzsp),d=Math.abs(b-this.maxH.rzsp);return d>c?this.minH:c>d?this.maxH:this.options.rightToLeft?b>this.minH.rzsp?this.minH:this.maxH:b<this.minH.rzsp?this.minH:this.maxH},focusElement:function(a){a[0].focus()},bindEvents:function(){var b,c,d;this.options.draggableRange?(b="rzSliderDrag",c=this.onDragStart,d=this.onDragMove):(b="lowValue",c=this.onStart,d=this.onMove),this.options.onlyBindHandles||(this.selBar.on("mousedown",a.bind(this,c,null,b)),this.selBar.on("mousedown",a.bind(this,d,this.selBar))),this.options.draggableRangeOnly?(this.minH.on("mousedown",a.bind(this,c,null,b)),this.maxH.on("mousedown",a.bind(this,c,null,b))):(this.minH.on("mousedown",a.bind(this,this.onStart,this.minH,"lowValue")),this.range&&this.maxH.on("mousedown",a.bind(this,this.onStart,this.maxH,"highValue")),this.options.onlyBindHandles||(this.fullBar.on("mousedown",a.bind(this,this.onStart,null,null)),this.fullBar.on("mousedown",a.bind(this,this.onMove,this.fullBar)),this.ticks.on("mousedown",a.bind(this,this.onStart,null,null)),this.ticks.on("mousedown",a.bind(this,this.onTickClick,this.ticks)))),this.options.onlyBindHandles||(this.selBar.on("touchstart",a.bind(this,c,null,b)),this.selBar.on("touchstart",a.bind(this,d,this.selBar))),this.options.draggableRangeOnly?(this.minH.on("touchstart",a.bind(this,c,null,b)),this.maxH.on("touchstart",a.bind(this,c,null,b))):(this.minH.on("touchstart",a.bind(this,this.onStart,this.minH,"lowValue")),this.range&&this.maxH.on("touchstart",a.bind(this,this.onStart,this.maxH,"highValue")),this.options.onlyBindHandles||(this.fullBar.on("touchstart",a.bind(this,this.onStart,null,null)),this.fullBar.on("touchstart",a.bind(this,this.onMove,this.fullBar)),this.ticks.on("touchstart",a.bind(this,this.onStart,null,null)),this.ticks.on("touchstart",a.bind(this,this.onTickClick,this.ticks)))),this.options.keyboardSupport&&(this.minH.on("focus",a.bind(this,this.onPointerFocus,this.minH,"lowValue")),this.range&&this.maxH.on("focus",a.bind(this,this.onPointerFocus,this.maxH,"highValue")))},unbindEvents:function(){this.minH.off(),this.maxH.off(),this.fullBar.off(),this.selBar.off(),this.ticks.off()},onStart:function(b,d,e){var f,g,h=this.getEventNames(e);e.stopPropagation(),e.preventDefault(),this.calcViewDimensions(),b?this.tracking=d:(b=this.getNearestHandle(e),this.tracking=b===this.minH?"lowValue":"highValue"),b.addClass("rz-active"),this.options.keyboardSupport&&this.focusElement(b),f=a.bind(this,this.dragging.active?this.onDragMove:this.onMove,b),g=a.bind(this,this.onEnd,f),c.on(h.moveEvent,f),c.one(h.endEvent,g),this.callOnStart()},onMove:function(b,c,d){var e,f=this.getEventPosition(c),g=this.options.rightToLeft?this.minValue:this.maxValue,h=this.options.rightToLeft?this.maxValue:this.minValue;0>=f?e=h:f>=this.maxPos?e=g:(e=this.positionToValue(f),e=d&&a.isNumber(this.options.showTicks)?this.roundStep(e,this.options.showTicks):this.roundStep(e)),this.positionTrackingHandle(e)},onEnd:function(a,b){var d=this.getEventNames(b).moveEvent;this.options.keyboardSupport||(this.minH.removeClass("rz-active"),this.maxH.removeClass("rz-active"),this.tracking=""),this.dragging.active=!1,c.off(d,a),this.callOnEnd()},onTickClick:function(a,b){this.onMove(a,b,!0)},onPointerFocus:function(b,c){this.tracking=c,b.one("blur",a.bind(this,this.onPointerBlur,b)),b.on("keydown",a.bind(this,this.onKeyboardEvent)),b.on("keyup",a.bind(this,this.onKeyUp)),this.firstKeyDown=!0,b.addClass("rz-active"),this.currentFocusElement={pointer:b,ref:c}},onKeyUp:function(){this.firstKeyDown=!0,this.callOnEnd()},onPointerBlur:function(a){a.off("keydown"),a.off("keyup"),this.tracking="",a.removeClass("rz-active"),this.currentFocusElement=null},getKeyActions:function(a){var b=a+this.step,c=a-this.step,d=a+this.valueRange/10,e=a-this.valueRange/10,f={UP:b,DOWN:c,LEFT:c,RIGHT:b,PAGEUP:d,PAGEDOWN:e,HOME:this.minValue,END:this.maxValue};return this.options.rightToLeft&&(f.LEFT=b,f.RIGHT=c,this.options.vertical&&(f.UP=c,f.DOWN=b)),f},onKeyboardEvent:function(a){var c=this[this.tracking],d=a.keyCode||a.which,e={38:"UP",40:"DOWN",37:"LEFT",39:"RIGHT",33:"PAGEUP",34:"PAGEDOWN",36:"HOME",35:"END"},f=this.getKeyActions(c),g=e[d],h=f[g];if(null!=h&&""!==this.tracking){a.preventDefault(),this.firstKeyDown&&(this.firstKeyDown=!1,this.callOnStart());var i=this;b(function(){var a=i.roundStep(i.sanitizeValue(h));if(i.options.draggableRangeOnly){var b,c,d=i.highValue-i.lowValue;"lowValue"===i.tracking?(b=a,(c=a+d)>i.maxValue&&(c=i.maxValue,b=c-d)):(c=a,(b=a-d)<i.minValue&&(b=i.minValue,c=b+d)),i.positionTrackingBar(b,c)}else i.positionTrackingHandle(a)})}},onDragStart:function(a,b,c){var d=this.getEventPosition(c);this.dragging={active:!0,value:this.positionToValue(d),difference:this.highValue-this.lowValue,lowLimit:this.options.rightToLeft?this.minH.rzsp-d:d-this.minH.rzsp,highLimit:this.options.rightToLeft?d-this.maxH.rzsp:this.maxH.rzsp-d},this.onStart(a,b,c)},getValue:function(a,b,c,d){var e=this.options.rightToLeft,f=null;return f="min"===a?c?d?e?this.minValue:this.maxValue-this.dragging.difference:e?this.maxValue-this.dragging.difference:this.minValue:e?this.positionToValue(b+this.dragging.lowLimit):this.positionToValue(b-this.dragging.lowLimit):c?d?e?this.minValue+this.dragging.difference:this.maxValue:e?this.maxValue:this.minValue+this.dragging.difference:e?this.positionToValue(b+this.dragging.lowLimit)+this.dragging.difference:this.positionToValue(b-this.dragging.lowLimit)+this.dragging.difference,this.roundStep(f)},onDragMove:function(a,b){var c,d,e,f,g,h,i,j,k=this.getEventPosition(b);if(this.options.rightToLeft?(e=this.dragging.lowLimit,f=this.dragging.highLimit,i=this.maxH,j=this.minH):(e=this.dragging.highLimit,f=this.dragging.lowLimit,i=this.minH,j=this.maxH),g=f>=k,h=k>=this.maxPos-e,g){if(0===i.rzsp)return;c=this.getValue("min",k,!0,!1),d=this.getValue("max",k,!0,!1)}else if(h){if(j.rzsp===this.maxPos)return;d=this.getValue("max",k,!0,!0),c=this.getValue("min",k,!0,!0)}else c=this.getValue("min",k,!1),d=this.getValue("max",k,!1);this.positionTrackingBar(c,d)},positionTrackingBar:function(a,b){null!=this.options.minLimit&&a<this.options.minLimit&&(a=this.options.minLimit,b=a+this.dragging.difference),null!=this.options.maxLimit&&b>this.options.maxLimit&&(b=this.options.maxLimit,a=b-this.dragging.difference),this.lowValue=a,this.highValue=b,this.applyLowValue(),this.range&&this.applyHighValue(),this.applyModel(),this.updateHandles("lowValue",this.valueToPosition(a)),this.updateHandles("highValue",this.valueToPosition(b))},positionTrackingHandle:function(a){var b=!1;a=this.applyMinMaxLimit(a),this.range&&(this.options.pushRange?(a=this.applyPushRange(a),b=!0):(this.options.noSwitching&&("lowValue"===this.tracking&&a>this.highValue?a=this.applyMinMaxRange(this.highValue):"highValue"===this.tracking&&a<this.lowValue&&(a=this.applyMinMaxRange(this.lowValue))),a=this.applyMinMaxRange(a),"lowValue"===this.tracking&&a>this.highValue?(this.lowValue=this.highValue,this.applyLowValue(),this.updateHandles(this.tracking,this.maxH.rzsp),this.updateAriaAttributes(),this.tracking="highValue",this.minH.removeClass("rz-active"),this.maxH.addClass("rz-active"),this.options.keyboardSupport&&this.focusElement(this.maxH),b=!0):"highValue"===this.tracking&&a<this.lowValue&&(this.highValue=this.lowValue,this.applyHighValue(),this.updateHandles(this.tracking,this.minH.rzsp),this.updateAriaAttributes(),this.tracking="lowValue",this.maxH.removeClass("rz-active"),this.minH.addClass("rz-active"),this.options.keyboardSupport&&this.focusElement(this.minH),b=!0))),this[this.tracking]!==a&&(this[this.tracking]=a,"lowValue"===this.tracking?this.applyLowValue():this.applyHighValue(),this.updateHandles(this.tracking,this.valueToPosition(a)),this.updateAriaAttributes(),b=!0),b&&this.applyModel()},applyMinMaxLimit:function(a){return null!=this.options.minLimit&&a<this.options.minLimit?this.options.minLimit:null!=this.options.maxLimit&&a>this.options.maxLimit?this.options.maxLimit:a},applyMinMaxRange:function(a){var b="lowValue"===this.tracking?this.highValue:this.lowValue,c=Math.abs(a-b);return null!=this.options.minRange&&c<this.options.minRange?"lowValue"===this.tracking?this.highValue-this.options.minRange:this.lowValue+this.options.minRange:null!=this.options.maxRange&&c>this.options.maxRange?"lowValue"===this.tracking?this.highValue-this.options.maxRange:this.lowValue+this.options.maxRange:a},applyPushRange:function(a){var b="lowValue"===this.tracking?this.highValue-a:a-this.lowValue,c=null!==this.options.minRange?this.options.minRange:this.options.step,d=this.options.maxRange;return c>b?("lowValue"===this.tracking?(this.highValue=Math.min(a+c,this.maxValue),a=this.highValue-c,this.applyHighValue(),this.updateHandles("highValue",this.valueToPosition(this.highValue))):(this.lowValue=Math.max(a-c,this.minValue),a=this.lowValue+c,this.applyLowValue(),this.updateHandles("lowValue",this.valueToPosition(this.lowValue))),this.updateAriaAttributes()):null!==d&&b>d&&("lowValue"===this.tracking?(this.highValue=a+d,this.applyHighValue(),this.updateHandles("highValue",this.valueToPosition(this.highValue))):(this.lowValue=a-d,this.applyLowValue(),this.updateHandles("lowValue",this.valueToPosition(this.lowValue))),this.updateAriaAttributes()),a},applyModel:function(){this.internalChange=!0,this.scope.$apply(),this.callOnChange(),this.internalChange=!1},callOnStart:function(){if(this.options.onStart){var a=this,b="lowValue"===this.tracking?"min":"max";this.scope.$evalAsync(function(){a.options.onStart(a.options.id,a.scope.rzSliderModel,a.scope.rzSliderHigh,b)})}},callOnChange:function(){if(this.options.onChange){var a=this,b="lowValue"===this.tracking?"min":"max";this.scope.$evalAsync(function(){a.options.onChange(a.options.id,a.scope.rzSliderModel,a.scope.rzSliderHigh,b)})}},callOnEnd:function(){if(this.options.onEnd){var a=this,b="lowValue"===this.tracking?"min":"max";this.scope.$evalAsync(function(){a.options.onEnd(a.options.id,a.scope.rzSliderModel,a.scope.rzSliderHigh,b)})}this.scope.$emit("slideEnded")}},h}]).directive("rzslider",["RzSlider",function(a){return{restrict:"AE",replace:!0,scope:{rzSliderModel:"=?",rzSliderHigh:"=?",rzSliderOptions:"&?",rzSliderTplUrl:"@"},templateUrl:function(a,b){return b.rzSliderTplUrl||"rzSliderTpl.html"},link:function(b,c){b.slider=new a(b,c)}}}]);return b.run(["$templateCache",function(a){a.put("rzSliderTpl.html",'<div class=rzslider><span class=rz-bar-wrapper><span class=rz-bar></span></span> <span class=rz-bar-wrapper><span class="rz-bar rz-selection" ng-style=barStyle></span></span> <span class="rz-pointer rz-pointer-min" ng-style=minPointerStyle></span> <span class="rz-pointer rz-pointer-max" ng-style=maxPointerStyle></span> <span class="rz-bubble rz-limit rz-floor"></span> <span class="rz-bubble rz-limit rz-ceil"></span> <span class=rz-bubble></span> <span class=rz-bubble></span> <span class=rz-bubble></span><ul ng-show=showTicks class=rz-ticks><li ng-repeat="t in ticks track by $index" class=rz-tick ng-class="{\'rz-selected\': t.selected}" ng-style=t.style ng-attr-uib-tooltip="{{ t.tooltip }}" ng-attr-tooltip-placement={{t.tooltipPlacement}} ng-attr-tooltip-append-to-body="{{ t.tooltip ? true : undefined}}"><span ng-if="t.value != null" class=rz-tick-value ng-attr-uib-tooltip="{{ t.valueTooltip }}" ng-attr-tooltip-placement={{t.valueTooltipPlacement}}>{{ t.value }}</span> <span ng-if="t.legend != null" class=rz-tick-legend>{{ t.legend }}</span></li></ul></div>')}]),b.name});try{angular.module("wixStyleInternal")}catch(e){angular.module("wixStyleInternal",[])}angular.module("wixStyleInternal").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("views/directives/wix-dropdown.html",'<div ng-class="{\'dropdown-no-hover\': openOnClick, \'dropdown-open\': isOpen}" class="wix-dropdown">\n    <div class="dropdown-title" ng-click="openOnClick && openDropdown()">{{selectedItem.text}}</div>\n    <ul>\n        <li ng-repeat="item in items" ng-class="{\'selected\': item.selected}">\n            <a ng-click="selectOption(item)">\n               {{item.text}}\n             </a>\n        </li>\n    </ul>\n</div>')}]);try{angular.module("wixStyleInternal")}catch(e){angular.module("wixStyleInternal",[])}angular.module("wixStyleInternal").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("views/directives/wix-tabs.html",'<div class="tabs-wrapper">\n    <a ng-repeat="tab in wixTabsVM.tabControllers" class="tab-container tab-title" ng-class="{\'active\': wixTabsVM.isActive(tab), \'disabled\': tab.disabled}" href ng-click="wixTabsVM.onTabClick(tab)">{{tab.getLabel()}}</a>\n</div>\n\x3c!--<div ng-repeat="tab in wixTabsVM.tabsArray" class="tab-content" ng-class="{\'active-tab-content\': wixTabsVM.isActive(tab)}" ng-bind-html="wixTabsVM.getTabContent(tab)">\n</div>--\x3e\n\n<div class="active-tab-content" ng-transclude></div>\n\n')}]);try{angular.module("wixStyleInternal")}catch(e){angular.module("wixStyleInternal",[])}angular.module("wixStyleInternal").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("views/directives/wix-wizard.html",'<ul class="wizard-steps">\n    <li class="step" ng-repeat="step in steps">\n        <div class="step-status" ng-class="{\'active\': step.state===\'active\'}"><span>1</span></div>\n        <a class="step-name">{{step.name}}</a>\n        </li>\n    </ul>\n<button class="next-button wix-button is-button-large">Next</button>')}]);try{angular.module("wixStyleInternal")}catch(e){angular.module("wixStyleInternal",[])}angular.module("wixStyleInternal").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("views/directives/wix-search.html",'<label class="wix-search-icon wix-style-svg-font-icons-search-new"></label>\n<span class="wix-search-wrapper">\n  <input type="text" ng-focus="onFocusIn($event)" ng-blur="onFocusOut($event)">\n  <span class="wix-search-clear wix-style-svg-font-icons-x" ng-mousedown="clearSearch($event)" ng-class="{\'visible\': shouldShowClear()}"></span>\n</span>\n\n')}]);try{angular.module("wixStyleInternal")}catch(e){angular.module("wixStyleInternal",[])}angular.module("wixStyleInternal").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("views/directives/wix-list.html",'<wix-list-item ng-repeat="item in items track by $index" ng-class="{\'empty\': item.empty}" index="{{$index}}" ng-if="!transcluded">\n    <div class="wix-list-item-blue-section" ng-if="!checkableItem() && !imageSquare()"></div>\n    <wix-checkbox ng-class="{\'wix-list-item-checkbox-circular-image\': !imageSquare()}"\n                  ng-if="checkableProperty" ng-model="item.checked"></wix-checkbox>\n    <div class="wix-list-item-content" ng-include="contentTemplate"\n         ng-class="imageSquare() ? \'wix-list-square-image\' : \'wix-list-circular-image\'"></div>\n    <div class="wix-list-draggable" ng-if="draggableItem"></div>\n</wix-list-item>\n<div ng-transclude="true"></div>')}]);try{angular.module("wixStyleInternal")}catch(e){angular.module("wixStyleInternal",[])}angular.module("wixStyleInternal").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("views/directives/wix-monthly-picker.html",'<div class="dp-wrapper"\n     ng-class="{\'is-open\': dp.isOpen}">\n\n    <wix-input\n            readonly="true"\n            placeholder="{{dp.startDate | date:dp.format}}"\n            ng-model="dp.displayDate"\n            ng-click="dp.toggleIsOpen($event)"></wix-input>\n\n    <div class="dp"\n         ng-class="{\'dp--alternate\': dp.direction == \'bottom\'}">\n        <div class="dp-header">\n            <span class="dp-prev"\n                  ng-click="dp.goPrev()"></span>\n\n            <span class="dp-current"\n                  ng-click="dp.unpick()"\n                  ng-switch="dp.state.type">\n                <span ng-switch-when="year">\n                    {{dp.min().year}} - {{dp.max().year}}\n                </span>\n                <span ng-switch-when="month">\n                    {{dp.state.year}}\n                </span>\n                <span ng-switch-when="day">\n                    {{dp.state.month | padZero}}\n                </span>\n            </span>\n\n            <span class="dp-next"\n                  ng-click="dp.goNext()"></span>\n        </div>\n\n        <div ng-show="dp.isOpen"\n             ng-switch="dp.state.type">\n            <div class="dp-grid dp-grid-year"\n                 ng-switch-when="year">\n                <div class="dp-grid-item"\n                     ng-click="dp.pick(option)"\n                     ng-repeat="option in dp.options().year">\n                    <div class="dp-year"\n                         ng-class="{\n                        \'dp--active\': dp.isActive(option),\n                        \'dp--today\': dp.isToday(option)\n                     }">\n                        {{option}}\n                    </div>\n                </div>\n            </div>\n            <div class="dp-grid dp-grid-month"\n                 ng-switch-when="month">\n                <div class="dp-grid-item"\n                     ng-click="dp.pick(option)"\n                     ng-repeat="option in dp.options().month">\n                    <div class="dp-month"\n                         ng-class="{\n                        \'dp--active\': dp.isActive(option),\n                        \'dp--today\': dp.isToday(option)\n                     }">\n                        {{option | padZero}}\n                    </div>\n                </div>\n            </div>\n            <div class="dp-grid dp-grid-day"\n                 ng-switch-when="day">\n                <div class="dp-grid-item"\n                     ng-click="dp.pick(option)"\n                     ng-repeat="option in dp.options().day track by $index">\n                    <div class="dp-day"\n                         ng-class="{\n                        \'dp--active\': dp.isActive(option),\n                        \'dp--today\': dp.isToday(option)\n                     }">\n                        {{option}}\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n</div>\n')}]);try{angular.module("wixStyleInternal")}catch(e){angular.module("wixStyleInternal",[])}angular.module("wixStyleInternal").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("views/directives/calendar/day-calendar.html",'<table>\n  <thead>\n  <tr class="wix-day-calendar-header">\n    <th>\n      <button type="button" class="calendar-primary-btn calendar-arrow-btn pull-left uib-left"\n              data-hook="prev"\n              ng-click="$ctrl.move({ direction: -1 })" tabindex="-1">\n        <i class="previous wix-style-svg-font-icons-data-picker-arrow"></i>\n      </button>\n    </th>\n    <th colspan="5" class="title"><span data-hook="title">{{$ctrl.title}}</span></th>\n    <th>\n      <button type="button" class="calendar-primary-btn calendar-arrow-btn pull-right uib-right"\n              data-hook="next"\n              ng-click="$ctrl.move({ direction: 1 })" tabindex="-1">\n        <i class="wix-style-svg-font-icons-data-picker-arrow"></i>\n      </button>\n    </th>\n  </tr>\n  <tr class="week-labels">\n    <th ng-repeat="label in ::$ctrl.labels track by $index" class="text-center">\n      <small aria-label="{{::label.full}}" data-hook="weekDay">{{::label.abbr}}</small>\n    </th>\n  </tr>\n  </thead>\n  <tbody>\n  <tr class="uib-weeks" ng-repeat="row in $ctrl.rows track by $index">\n    <td ng-repeat="dt in row"\n        class="calendar-day text-center"\n        id="{{::dt.uid}}"\n        data-hook="day">\n      <button type="button" class="calendar-primary-btn"\n              data-hook="day-btn"\n              ng-class="::[dt.customClass, {\'max-date\': dt.isMaxDate, \'min-date\': dt.isMinDate, \'selected\': dt.selected, \'active\': $ctrl.active === dt}]"\n              ng-click="$ctrl.select({ date: dt.date })"\n              ng-disabled="::dt.disabled"\n              ng-if="::!dt.secondary">\n        <span data-hook="day-label">{{::dt.label}}</span>\n      </button>\n      <div class="empty-state" ng-if="::dt.secondary"></div>\n    </td>\n  </tr>\n  </tbody>\n</table>')}]);try{angular.module("wixStyleInternal")}catch(e){angular.module("wixStyleInternal",[])}angular.module("wixStyleInternal").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("views/directives/calendar/calendar.html",'<div class="wix-calendar">\n  <div uib-datepicker\n       ng-model="$ctrl.internalDate"\n       template-url="views/directives/calendar/patchViews/datePickerPatch.html"\n       class="calendar"\n       datepicker-options="$ctrl.uibOptions">\n  </div>\n\n  <div class="control-buttons" data-hook="control-buttons" ng-if="::$ctrl.showControlButtons">\n    <a data-hook="clear-btn" ng-click="$ctrl.clear()" translate="calendar.clear"></a>\n  </div>\n</div>')}]);try{angular.module("wixStyleInternal")}catch(e){angular.module("wixStyleInternal",[])}angular.module("wixStyleInternal").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("views/directives/calendar/popover-calendar.html",'<label class="popover-calendar" data-hook="popover-button">\n    <ng-transclude></ng-transclude>\n    <wix-popover placement="{{ $ctrl.placement }}"\n                 tooltip-trigger="click click"\n                 append-to-body="true"\n                 is-open="$ctrl.isOpen"\n                 tooltip-class="tooltip-in-dropdown popover-calendar-popover"\n                 tooltip-close-on-content="true">\n        <wix-calendar data-hook="popover-content-calendar"\n                     on-select="$ctrl.onSelectDate($event)"\n                     show-control-buttons="$ctrl.showControlButtons"\n                     date="$ctrl.date"\n                     options="$ctrl.options"></wix-calendar>\n    </wix-popover>\n</label>\n')}]);try{angular.module("wixStyleInternal")}catch(e){angular.module("wixStyleInternal",[])}angular.module("wixStyleInternal").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("views/directives/calendar/patchViews/datePickerPatch.html",'<div class="uib-datepicker" ng-switch="datepickerMode" data-hook="calendar" ng-keydown="keydown($event)">\n    <div uib-daypicker template-url="views/directives/calendar/patchViews/dayPickerPatch.html" ng-switch-when="day" tabindex="0"></div>\n    <div uib-monthpicker ng-switch-when="month" tabindex="0"></div>\n    <div uib-yearpicker ng-switch-when="year" tabindex="0"></div>\n</div>')}]);try{angular.module("wixStyleInternal")}catch(e){angular.module("wixStyleInternal",[])}angular.module("wixStyleInternal").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("views/directives/calendar/patchViews/dayPickerPatch.html",'<div>\n    <wix-day-calendar labels="labels"\n                   move="move(direction)"\n                   data-title="title"\n                   select="select(date)"\n                   active="activeDt"\n                   rows="rows"></wix-day-calendar>\n</div>\n')}]);try{angular.module("wixStyleInternal")}catch(e){angular.module("wixStyleInternal",[])}angular.module("wixStyleInternal").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("views/components/modals/wix-modal-header1.html","<div class='wix-modal--header' ng-class='$ctrl.getCssClasses()'>\n<div class='wix-modal--title' data-hook='modal-title' ng-if='title'>{{title}}</div>\n<div class='wix-modal--subtitle' data-hook='modal-subtitle' ng-if='subtitle'>{{subtitle}}</div>\n<button class='wix-modal--close-button wix-style-svg-font-icons-close' data-hook='close-button' md-autofocus='{{autofocusOnClose}}' ng-click='onClose({$event: $event})' ng-if='onClose' type='button'></button>\n</div>\n")}]);try{angular.module("wixStyleInternal")}catch(e){angular.module("wixStyleInternal",[])}angular.module("wixStyleInternal").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("views/components/modals/wix-modal-header2.html","<div class='wix-modal--header' ng-class='{&#39;with-subtitle&#39;:subtitle}'>\n<label>I'm header preset number 2!</label>\n<div class='wix-modal--title' data-hook='modal-title' ng-if='title'>{{title}}</div>\n<div class='wix-modal--subtitle' data-hook='modal-subtitle' ng-if='subtitle'>{{subtitle}}</div>\n<button class='wix-modal--close-button wix-style-svg-font-icons-close' data-hook='close-button' md-autofocus='{{autofocusOnClose}}' ng-click='onClose({$event: $event})' type='button'></button>\n</div>\n")}]);try{angular.module("wixStyleInternal")}catch(e){angular.module("wixStyleInternal",[])}angular.module("wixStyleInternal").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("views/components/modals/wix-modal-message-window.html","<div class='wix-modal' ng-class='customClass' ng-style='customStyle'>\n<div class='wix-modal--message-window' data-hook='modal-container' ng-class='style'>\n<wix-modal-header1 css-class='headerClass' data-hook='modal-header' ng-if='headerPreset === 1' on-close='windowCtrl.close($event)' subtitle='subtitle' title='title'></wix-modal-header1>\n<wix-modal-header2 data-hook='modal-header' ng-if='headerPreset === 2' on-close='windowCtrl.close($event)' subtitle='subtitle' title='title'></wix-modal-header2>\n<div class='wix-modal--body-wrapper'>\n<div class='wix-modal--body' ng-class='{&#39;wix-modal--body_footer-floating&#39; : floatingFooter}' ng-style='customBodyStyle'>\n<div class='wix-modal--icon-wrapper' data-hook='modal-icon-wrapper' ng-if='iconUrl'>\n<img class='wix-modal--icon' ng-src='{{iconUrl}}'>\n</div>\n<div class='wix-modal--content' data-hook='modal-content-inline' ng-bind-html='htmlContent' ng-if='htmlContent'></div>\n<div class='wix-modal--content' data-hook='modal-content-external' ng-if='contentUrl' ng-include='contentUrl'></div>\n</div>\n<div class='wix-modal--footer' data-hook='modal-footer' ng-class='{&#39;wix-modal--footer_floating&#39; : floatingFooter}' ng-if='confirmButton.label || cancelButton.label'>\n<button class='modal-button wix-modal--confirm-button' data-hook='modal-confirm-button' ng-class='confirmButton.buttonClass' ng-click='windowCtrl.confirm($event)' ng-if='confirmButton.label'>{{confirmButton.label}}</button>\n<button class='modal-button is-button-outline wix-modal--cancel-button' data-hook='modal-cancel-button' ng-class='cancelButton.buttonClass' ng-click='windowCtrl.cancel($event)' ng-if='cancelButton.label'>{{cancelButton.label}}</button>\n</div>\n</div>\n<div class='wix-modal--disclaimer' data-hook='modal-disclaimer' ng-if='disclaimer' translate='{{disclaimer}}'></div>\n</div>\n</div>\n")}]);try{angular.module("wixStyleInternal")}catch(e){angular.module("wixStyleInternal",[])}angular.module("wixStyleInternal").run(["$templateCache",function($templateCache){"use strict"
;$templateCache.put("views/components/modals/wix-message-window.html","<div class='wix-modal' ng-class='customClass' ng-style='customStyle'>\n<div class='wix-modal--message-window' data-hook='modal-container' ng-class='style'>\n<div class='wix-modal--header' data-hook='modal-header' ng-class='{&#39;with-subtitle&#39;:subtitle}' ng-if='title'>\n<div class='wix-modal--title' data-hook='modal-title'>{{title}}</div>\n<div class='wix-modal--subtitle' data-hook='modal-subtitle' ng-if='subtitle'>{{subtitle}}</div>\n<div class='wix-modal--header-icon-wrapper' data-hook='modal-header-icon' ng-if='headerIcon'>\n<img class='wix-modal--icon' ng-src='{{headerIcon}}'>\n</div>\n<button class='wix-modal--close-button wix-style-svg-font-icons-close' data-hook='close-button' md-autofocus='{{autofocusOnClose}}' ng-click='windowCtrl.close($event)' type='button'></button>\n</div>\n<div class='wix-modal--body-wrapper'>\n<div class='wix-modal--body' ng-class='{&#39;wix-modal--body_footer-floating&#39; : floatingFooter}' ng-style='customBodyStyle'>\n<div class='wix-modal--icon-wrapper' data-hook='modal-icon-wrapper' ng-if='iconUrl'>\n<img class='wix-modal--icon' ng-src='{{iconUrl}}'>\n</div>\n<div class='wix-modal--content' data-hook='modal-content-inline' ng-bind-html='htmlContent' ng-if='htmlContent'></div>\n<div class='wix-modal--content' data-hook='modal-content-external' ng-if='contentUrl' ng-include='contentUrl'></div>\n</div>\n<div class='wix-modal--footer' data-hook='modal-footer' ng-class='{&#39;wix-modal--footer_floating&#39; : floatingFooter}' ng-if='confirmButton.label || cancelButton.label'>\n<button class='modal-button wix-modal--confirm-button' data-hook='modal-confirm-button' ng-class='confirmButton.buttonClass' ng-click='windowCtrl.confirm($event)' ng-if='confirmButton.label'>{{confirmButton.label}}</button>\n<button class='modal-button is-button-outline wix-modal--cancel-button' data-hook='modal-cancel-button' ng-class='cancelButton.buttonClass' ng-click='windowCtrl.cancel($event)' ng-if='cancelButton.label'>{{cancelButton.label}}</button>\n</div>\n</div>\n<div class='wix-modal--disclaimer' data-hook='modal-disclaimer' ng-if='disclaimer' translate='{{disclaimer}}'></div>\n</div>\n</div>\n")}]);try{angular.module("wixStyleInternal")}catch(e){angular.module("wixStyleInternal",[])}angular.module("wixStyleInternal").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("views/components/modals/wix-premium-window.html","<div class='wix-modal' ng-style='customStyle'>\n<div class='wix-modal--premium-window'>\n<div class='wix-modal--premium-header'>\n<button class='wix-modal--premium-close-button wix-style-svg-font-icons-close' md-autofocus ng-click='windowCtrl.close($event)'></button>\n<div class='wix-modal--premium-title'>{{title}}</div>\n<div class='wix-modal--premium-sub-title'>{{subtitle}}</div>\n</div>\n<div class='wix-modal--premium-modal-body'>\n<img class='wix-modal--premium-icon' ng-show='iconUrl' ng-src='{{iconUrl}}'>\n<div class='wix-modal--premium-content'>{{htmlContent}}</div>\n<div class='wix-modal--premium-buttons'>\n<button class='wix-modal--premium-confirm-button' ng-class='confirmButton.buttonClass' ng-click='windowCtrl.confirm($event)' ng-show='confirmButton'>{{confirmButton.label}}</button>\n<button class='wix-modal--premium-cancel-button' ng-class='cancelButton.buttonClass' ng-click='windowCtrl.cancel($event)' ng-show='cancelButton'>{{cancelButton.label}}</button>\n</div>\n</div>\n</div>\n</div>\n")}]);try{angular.module("wixStyleInternal")}catch(e){angular.module("wixStyleInternal",[])}angular.module("wixStyleInternal").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("views/components/modals/wix-modal-custom-example.html","<div class='wix-modal-custom-example-class'>\n<div>Hey I'm a custom modal</div>\n<button class='wix-button' ng-click='myCustomController.confirm($event)'>Click to Close</button>\n<label>{{myCustomController.footer}}</label>\n</div>\n")}]);try{angular.module("wixStyleInternal")}catch(e){angular.module("wixStyleInternal",[])}angular.module("wixStyleInternal").provider("wixStyleConfig",function(){var _newWixInput=!1;return{useNewWixInput:function(decision){_newWixInput=decision},$get:function(){return{shouldUseNewWixInput:function(){return _newWixInput}}}}}),angular.module("wixStyle",["wixStyleInternal","styleTranslations","rzModule"]).config(function(){}),angular.module("wixStyleMaterialInternal",[]),angular.module("wixStyleMaterial",["wixStyleMaterialInternal","wixStyle","ngMaterial"]).config(function(){}),angular.module("wixStyleInternal").value("TODAY",{DATE:new Date}).factory("DateService",["$window","TODAY",function($window,TODAY){return{getToday:function(){return TODAY.DATE}}}]),function(){function WixMdDialogBuilder(provider,$sce,$rootScope){function BaseModal(scope){this.scope=scope,this.title=function(value){return scope.title=value,this},this.subtitle=function(value){return scope.subtitle=value,this},this.content=function(value){return scope.htmlContent=$sce.trustAsHtml(value),this},this.contentUrl=function(url){return scope.contentUrl=url,this},this.iconUrl=function(url){return scope.iconUrl=url,this},this.windowClass=function(value){return this.modalClass=value,this},this.modalController=function(controllerName){return this.controller=controllerName,this},this.modalControllerAs=function(controllerAs){return this.controllerAs=controllerAs,this},this.customStyle=function(style){return scope.customStyle=style||{},this},this.customBodyStyle=function(style){return scope.customBodyStyle=style||{},this},this.customClass=function(className){return scope.customClass=className||"",this},this.disclaimer=function(disclaimer){return scope.disclaimer=disclaimer,this},this.autofocusOnClose=function(autofocusOnClose){return scope.autofocusOnClose=void 0===autofocusOnClose||autofocusOnClose,this},this.modalLocals=function(locals){return this.locals={locals:locals||{}},this},this.floatingFooter=function(value){return scope.floatingFooter=value,this},this.headerIcon=function(value){return scope.headerIcon=value,this},this.windowClass("").modalController("mdMessageWindowCtrl").modalControllerAs("windowCtrl"),this.withParent=function(elementOrSelector){var element="string"==typeof elementOrSelector?angular.element(document.querySelector(elementOrSelector)):elementOrSelector;return this.parent=element,this},provider.parent&&this.withParent(provider.parent)}var ALERT_TYPES={DANGER:{wrapperClass:"wix-modal--danger",buttonClass:"wix-button-danger is-button-small"},ALERT:{wrapperClass:"wix-modal--alert",buttonClass:"wix-button is-button-small"}};this.alert=function(){var scope=$rootScope.$new(),alertModal=new BaseModal(scope);return alertModal.scope.style=ALERT_TYPES.ALERT.wrapperClass,alertModal.scope.confirmButton={buttonClass:ALERT_TYPES.ALERT.buttonClass},alertModal.scope.cancelButton={buttonClass:ALERT_TYPES.ALERT.buttonClass},alertModal.templateUrl="views/components/modals/wix-message-window.html",alertModal.confirm=function(text){return alertModal.scope.confirmButton.label=text,this},alertModal.cancel=function(text){return alertModal.scope.cancelButton.label=text,this},alertModal.style=function(type){var selectedType=ALERT_TYPES[type];return void 0!==selectedType&&(this.scope.style=selectedType.wrapperClass,this.scope.confirmButton.buttonClass=selectedType.buttonClass,this.scope.cancelButton.buttonClass=selectedType.buttonClass),this},alertModal},this.premium=function(){var scope=$rootScope.$new(),premiumModal=new BaseModal(scope);return premiumModal.templateUrl="views/components/modals/wix-premium-window.html",premiumModal.subtitle=function(text){return this.scope.subtitle=text,this},premiumModal.confirm=function(label,buttonClass){return this.scope.confirmButton={label:label,buttonClass:buttonClass},this},premiumModal.cancel=function(label,buttonClass){return this.scope.cancelButton={label:label,buttonClass:buttonClass},this},premiumModal}}WixMdDialogBuilder.$inject=["provider","$sce","$rootScope"],angular.module("wixStyleMaterialInternal").provider("wixMdDialogBuilder",function(){this.setParent=function(parent){this.parent=parent},this.$get=["$injector",function($injector){return $injector.instantiate(WixMdDialogBuilder,{provider:this})}],this.$get.$inject=["$injector"]})}(),function(){function WixMdToastBuilder(provider,$log){function removeUnSupportedFeatures(toastType,toastObject){angular.forEach(unSupportedFeatures[toastType],function(unSupportedFeature){toastObject[unSupportedFeature.functionName]=function(){return $log.error(unSupportedFeature.name+" on "+toastType+" is not supported"),this}})}function BaseToast(tType){var toastType=allowedTypes[tType]||allowedTypes.general;this.controller="wixToastController",this.controllerAs="toastCtrl",this.position="top",this.template=template,this.autoHide=5e3,this.promise={},this.locals={content:"",isFullWidth:!1,type:toastType,isLightColored:!1,action:{type:allowedActionTypes.none,text:"",onClick:angular.noop,url:"",targetType:allowedTargetTypes.blank},icon:{url:"",cssClass:"",isDark:!1}},this.autoHide=function(milliSeconds){return this.hideDelay=parseInt(milliSeconds,10),this},this.content=function(value){return this.locals.content=value,this},this.showLightColored=function(){return this.locals.isLightColored=!0,this},this.showFullWidth=function(){return this.locals.isFullWidth=!0,this},this.showCloseButton=function(){return this.locals.closeVisible=!0,this},this.showAction=function(opts){var actionType,actionOnClick,actionUrl,actionTargetType,options=opts||{};return actionType=allowedActionTypes[options.type]||"",actionOnClick=options.onClick?options.onClick:angular.noop,actionUrl=options.url?options.url:"",actionTargetType=options.url&&options.targetType?options.targetType:allowedTargetTypes.blank,actionType&&(this.locals.action={type:actionType,text:options.text,onClick:actionOnClick,url:actionUrl,targetType:actionTargetType}),this},this.showIcon=function(opts){var options=opts||{};return this.locals.icon.url=options.url||"",this.locals.icon.cssClass=options.cssClass||"",this.locals.icon.isDark=options.isDark||!1,this},this.withParent=function(elementOrSelector){var element="string"==typeof elementOrSelector?angular.element(document.querySelector(elementOrSelector)):elementOrSelector;return this.parent=element,this.locals.parent=element,this.locals.hasParent=!0,this},provider.parent&&this.withParent(provider.parent)}var template='<md-toast ng-class="toastCtrl.getToastClass()"><div class="wix-md-notification-wrapper"><div ng-class="toastCtrl.icon.cssClasses" ng-show = "toastCtrl.icon.visible"><img ng-src = "{{toastCtrl.icon.url}}"/></div><div class="wix-md-notification-content" ng-bind="toastCtrl.content"></div><a ng-class="toastCtrl.action.cssClass" ng-show="toastCtrl.action.visible" ng-click="toastCtrl.action.onClick($event)" ng-href="{{toastCtrl.action.url}}" target="{{toastCtrl.action.targetType}}">{{toastCtrl.action.text}}</a><button class="wix-md-notification-button wix-md-notification-close" ng-show="toastCtrl.closeVisible" ng-click="toastCtrl.close()"><svg version="1.1" id="Layer_1" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="10px" x="0px" y="0px" viewBox="-2.4 21.6 9.7 9.7" style="enable-background:new -2.4 21.6 9.7 9.7;" xml:space="preserve"><polygon points="7.3,22.4 6.6,21.6 2.5,25.8 -1.6,21.6 -2.4,22.4 1.8,26.5 -2.4,30.6 -1.6,31.3 2.5,27.2 6.6,31.3 7.3,30.6 3.2,26.5 "/></svg></button></div></md-toast>',allowedTypes={general:"general",warning:"warning",error:"error",success:"success"},allowedActionTypes={none:"none",button:"button",link:"link"},allowedTargetTypes={blank:"_blank",self:"_self"},unSupportedFeatures={warning:{showAction:{name:"action",functionName:"showAction"},showIcon:{name:"icon",functionName:"showIcon"},showCloseButton:{name:"close",functionName:"showCloseButton"},showFullWidth:{name:"full width",functionName:"showFullWidth"}}};this.toastTypes=allowedTypes,this.actionTypes=allowedActionTypes,this.targetTypes=allowedTargetTypes,angular.forEach(allowedTypes,function(value,key){this[key]=function(){var alertToast=new BaseToast(allowedTypes[key]);return removeUnSupportedFeatures(key,alertToast),alertToast}},this)}WixMdToastBuilder.$inject=["provider","$log"],angular.module("wixStyleMaterialInternal").provider("wixMdToastBuilder",function(){this.setParent=function(parent){this.parent=parent},this.$get=["$injector",function($injector){return $injector.instantiate(WixMdToastBuilder,{provider:this})}],this.$get.$inject=["$injector"]})}();var WixStyle;!function(WixStyle){var WixDirectivesUtils=function(){function WixDirectivesUtils(){this.attrsToExcludeInMove=[]}return WixDirectivesUtils.prototype.moveAttributesToChild=function(parent,child,attrs,attrsToExclude){var excludes=this.attrsToExcludeInMove.concat(attrsToExclude);for(var attrCamelCase in attrs.$attr)if(attrs.$attr.hasOwnProperty(attrCamelCase)&&-1===excludes.indexOf(attrCamelCase)){var attrKebabCase=attrs.$attr[attrCamelCase],attrValue=attrs[attrCamelCase];child.attr(attrKebabCase,attrValue),parent.removeAttr(attrKebabCase),"id"===attrCamelCase&&(delete attrs.id,delete attrs.$attr.id)}},WixDirectivesUtils.prototype.getStringOrObject=function(ztring){try{return angular.fromJson(ztring)}catch(error){return ztring}},WixDirectivesUtils}();WixStyle.WixDirectivesUtils=WixDirectivesUtils,angular.module("wixStyleInternal").service("wixDirectivesUtils",WixDirectivesUtils)}(WixStyle||(WixStyle={}));var MdMessageWindowCtrl=function(){function MdMessageWindowCtrl($injector,$mdDialog){this.$mdDialog=$mdDialog;var locals;try{locals=$injector.get("locals")}catch(e){locals={}}angular.extend(this,locals)}return MdMessageWindowCtrl.$inject=["$injector","$mdDialog"],MdMessageWindowCtrl.prototype.close=function($event){this.$mdDialog.cancel(),$event.stopImmediatePropagation()},MdMessageWindowCtrl.prototype.cancel=function($event){this.$mdDialog.cancel(),$event.stopImmediatePropagation()},MdMessageWindowCtrl.prototype.confirm=function($event){this.$mdDialog.hide(),$event.stopImmediatePropagation()},MdMessageWindowCtrl}();angular.module("wixStyleMaterialInternal").controller("mdMessageWindowCtrl",MdMessageWindowCtrl),function(){function WixToastController($scope,$mdToast,locals,$document,$timeout){function removePlaceholder(){placeholderElement.removeClass(placeholderElementClass+"-open"),$timeout(function(){placeholderElement.remove()},HIDE_DURATION)}function manageParentOverflowStyle(duration){parentElement.css("overflow","hidden"),$timeout(function(){parentElement.css("overflow","")},duration)}function onClose(){removePlaceholder(),locals.hasParent&&manageParentOverflowStyle(HIDE_DURATION)}var _self=this,placeholderElementClass="wix-style-md-material-toast-full-width-placeholder",placeholderElement=angular.element('<div class="'+placeholderElementClass+'"></div>'),parentElement=locals.hasParent?locals.parent:$document.find("body"),HIDE_DURATION=300;locals.hasParent&&manageParentOverflowStyle(450),locals.isFullWidth&&function(){parentElement.prepend(placeholderElement),$timeout(function(){placeholderElement.addClass(placeholderElementClass+"-open")},0)}(),this.closeVisible=locals.closeVisible,this.content=locals.content,this.action=angular.extend(locals.action),this.action.visible="none"!==locals.action.type,Object.defineProperty(this.action,"cssClass",{get:function(){var cssClasses=["wix-md-notification-action","wix-md-notification-action-"+locals.action.type];return"button"===locals.action.type&&(cssClasses.push("wix-button"),cssClasses.push("wix-md-notification-button"),cssClasses.push("is-button-small")),cssClasses}}),this.icon=angular.extend(locals.icon),this.icon.visible=""!==locals.icon.url,Object.defineProperty(this.icon,"cssClasses",{get:function(){var cssClasses=["wix-md-notification-icon-wrapper"];return locals.icon.cssClass&&cssClasses.push(locals.icon.cssClass),locals.icon.isDark&&cssClasses.push("wix-md-notification-icon-wrapper-dark"),cssClasses}}),this.getToastClass=function(){var cssClasses=["wix-md-notification-container","wix-md-notification-"+locals.type];return locals.isLightColored&&cssClasses.push("wix-md-notification-light"),locals.isFullWidth&&cssClasses.push("wix-md-notification-full-width"),_self.closeVisible&&cssClasses.push("wix-md-notification-with-close"),locals.hasParent&&cssClasses.push("wix-md-notification-under-parent"),cssClasses},this.close=function(){$mdToast.hide(),onClose()},$scope.$on("$destroy",function(){onClose()})}WixToastController.$inject=["$scope","$mdToast","locals","$document","$timeout"],angular.module("wixStyleMaterialInternal").controller("wixToastController",WixToastController)}();var MessageWindowCtrl=function(){function MessageWindowCtrl(modal){this.modal=modal}return MessageWindowCtrl.$inject=["modal"],MessageWindowCtrl.prototype.close=function($event){this.modal.close("CLOSE"),$event.stopImmediatePropagation()},MessageWindowCtrl.prototype.cancel=function($event){this.modal.close("CANCEL"),$event.stopImmediatePropagation()},MessageWindowCtrl.prototype.confirm=function($event){this.modal.close("CONFIRM"),$event.stopImmediatePropagation()},MessageWindowCtrl}();angular.module("wixStyleInternal").controller("MessageWindowCtrl",MessageWindowCtrl);var WixModalCustomExample=function(){function WixModalCustomExample(modal,footer){this.modal=modal,this.footer=footer}return WixModalCustomExample.$inject=["modal","footer"],WixModalCustomExample.prototype.confirm=function($event){this.modal.close("CONFIRM"),$event.stopImmediatePropagation()},WixModalCustomExample}();angular.module("wixStyleInternal").controller("WixModalCustomExample",WixModalCustomExample),function(){function dropdown(){return{templateUrl:"views/directives/wix-dropdown.html",restrict:"E",scope:{openOnClick:"=openOnClick",items:"=items",selectedItem:"=?selectedItem",ngDisabled:"=ngDisabled"},link:function(scope){if(scope.items&&!scope.selectedItem){var firstItem=scope.items[0];firstItem.selected=!0,scope.selectedItem=firstItem}scope.openDropdown=function(){scope.isOpen=!scope.isOpen&&!scope.ngDisabled},scope.selectOption=function(item){if(!item)throw new Error("item is missing");scope.selectedItem&&(scope.selectedItem.selected=!1),item.selected=!0,scope.selectedItem=item,scope.isOpen=!1}}}}angular.module("wixStyleInternal").directive("wixDropdown",dropdown)}(),function(){function wixToggle(wixDirectivesUtils,$compile){return{template:'<label class="wix-toggle" allow-propagation-from="input">\n          <input type="checkbox" />\n          <span>\n            <i class="toggle-circle"></i>\n          </span>\n        </label>',restrict:"E",priority:550,terminal:!0,compile:function(element,$attrs){var input=element.find("input");return wixDirectivesUtils.moveAttributesToChild(element,input,$attrs,["ngRepeat","ngIf"]),function($scope,$element){$compile($element.find("label"))($scope)}}}}wixToggle.$inject=["wixDirectivesUtils","$compile"],angular.module("wixStyleInternal").directive("wixToggle",wixToggle)}(),function(){function wixInputNew(wixDirectivesUtils,$compile){return{restrict:"E",transclude:!0,priority:550,terminal:!0,template:'<div class="wix-input"><input data-hook="input"/><i class="icon wix-style-svg-font-icons-validation" data-hook="tooltip"></i></div>',compile:function(element,$attrs){var input=element.find("input");return wixDirectivesUtils.moveAttributesToChild(element,input,$attrs,["ngRepeat","ngIf"]),function(scope,element,attrs,controller,transcludeFn){function buildErrorMessagesWithTooltip(){function addTooltip(errorMessagesTemplate,tooltipClass){var icon=element.find("i");icon.attr("wix-tooltip",""),icon.attr("tooltip-template",errorMessagesTemplate),icon.attr("tooltip-scope","tooltipScope"),icon.attr("placement","top"),icon.attr("append-to-body","true"),icon.attr("max-width","250px"),icon.attr("tooltip-class",tooltipClass||""),compileIcon(icon)}function compileIcon(icon){var iconScope=scope.$new(!0),inputCtrls=element.find("input").controller("ngModel");iconScope.tooltipScope={error:inputCtrls&&inputCtrls.$error},$compile(icon)(iconScope)}var errorMessage=attrs.errorMessage;if(errorMessage)addTooltip(errorMessage,attrs.errorTooltipClass);else{var errorMessages=wixDirectivesUtils.getStringOrObject(attrs.errorMessages);if("object"==typeof errorMessages){addTooltip(function(errorMessages){var template='<ng-messages for="error">';for(var errorKey in errorMessages)errorMessages.hasOwnProperty(errorKey)&&(template+='<ng-message when="'+errorKey+'">'+errorMessages[errorKey]+"</ng-message>");return template+="</ng-messages>"}(errorMessages),attrs.errorTooltipClass)}else transcludeFn(scope,function(clone){var content=clone.find("error-message").parent()[0];if(content){addTooltip(content.outerHTML.replace(/error-message/g,"ng-message"),attrs.errorTooltipClass)}})}}!function(){$compile(element[0].querySelector(".wix-input"))(scope),buildErrorMessagesWithTooltip()}()}}}}function innerInput(wixStyleConfig){return{restrict:"E",require:"?ngModel",link:{pre:function(scope,element,attr,ctrls){if(!wixStyleConfig.shouldUseNewWixInput()){var parentFn=element.parents||element.parent,wixInputCtrls=parentFn.call(element,"wix-input").controller("ngModel");if(ctrls&&wixInputCtrls){var outerSetValidity=wixInputCtrls.$setValidity,innerSetValidity=ctrls.$setValidity;ctrls.$setValidity=function(){outerSetValidity.apply(wixInputCtrls,arguments),innerSetValidity.apply(ctrls,arguments)}}}}}}}function wixInputOld(wixDirectivesUtils,$compile){return{restrict:"E",require:"?ngModel",transclude:!0,template:'<div class="wix-input"><input data-hook="input"/><i class="icon wix-style-svg-font-icons-validation" data-hook="tooltip"></i></div>',compile:function(element,$attrs,transcludeFn){function addTooltip(errorMessagesTemplate,tooltipClass){var icon=element.find("i");icon.attr("wix-tooltip",""),icon.attr("tooltip-template",errorMessagesTemplate),icon.attr("tooltip-scope","tooltipScope"),icon.attr("placement","top"),icon.attr("append-to-body","true"),icon.attr("max-width","250px"),icon.attr("tooltip-class",tooltipClass||"")}var rows=$attrs.$attr.rows;rows&&function(){element.find("input").replaceWith(angular.element('<textarea data-hook="textarea"></textarea>'))}();var errorMessage=$attrs.errorMessage;if(errorMessage){"tooltip"===($attrs.errorType||"tooltip")&&addTooltip(errorMessage,$attrs.errorTooltipClass)}var inputOrTextarea=element.find(rows?"textarea":"input");return wixDirectivesUtils.moveAttributesToChild(element,inputOrTextarea,$attrs),{post:function(scope,element,attrs,controller){function compileIcon(){var icon=element.find("i"),iconScope=scope.$new(!0);iconScope.tooltipScope={error:controller&&controller.$error},$compile(icon)(iconScope)}var errorMessages=wixDirectivesUtils.getStringOrObject(attrs.errorMessages);if("object"==typeof errorMessages){if("tooltip"===(attrs.errorType||"tooltip")){addTooltip(function(errorMessages){var template='<ng-messages for="error">';for(var errorKey in errorMessages)errorMessages.hasOwnProperty(errorKey)&&(template+='<ng-message when="'+errorKey+'">'+errorMessages[errorKey]+"</ng-message>");return template+="</ng-messages>"}(errorMessages),attrs.errorTooltipClass),compileIcon()}}transcludeFn(scope,function(clone){var content=clone.find("error-message").parent()[0];if(content){addTooltip(content.outerHTML.replace(/error-message/g,"ng-message")),compileIcon()}})}}}}}wixInputNew.$inject=["wixDirectivesUtils","$compile"],wixInputOld.$inject=["wixDirectivesUtils","$compile"],innerInput.$inject=["wixStyleConfig"],angular.module("wixStyleInternal").directive("input",innerInput).directive("wixInput",["wixDirectivesUtils","$compile","wixStyleConfig",function(wixDirectivesUtils,$compile,wixStyleConfig){return wixStyleConfig.shouldUseNewWixInput()?wixInputNew(wixDirectivesUtils,$compile):wixInputOld(wixDirectivesUtils,$compile)}])}(),function(){function wixTextarea(wixDirectivesUtils,$compile){return{template:'<div class="wix-textarea"><textarea data-hook="textarea"></textarea></div>',restrict:"E",priority:550,terminal:!0,compile:function(element,$attrs){var input=element.find("textarea");return wixDirectivesUtils.moveAttributesToChild(element,input,$attrs,["ngRepeat","ngIf"]),function($scope,$element){$compile($element.find("textarea"))($scope)}}}}wixTextarea.$inject=["wixDirectivesUtils","$compile"],angular.module("wixStyleInternal").directive("wixTextarea",wixTextarea)}(),angular.module("wixStyleInternal").directive("wixInputContainer",function(){return{restrict:"E",link:function(scope,element,attrs){var input=element.find("input"),icon=element.find("i");icon.length>0&&function(){var iconWrapper=angular.element('<div class="icon-container"></div>');-1!==icon.attr("class").indexOf("error-icon-red")&&icon.addClass("wix-style-svg-font-icons-validation"),iconWrapper.append(input),iconWrapper.append(icon),element.append(iconWrapper)}()}}}),function(){function defaults(options){for(var key in _defaults)void 0===options[key]&&(options[key]=_defaults[key])}function toUniqueClassesString(bodyClassNamesStack){return bodyClassNamesStack.filter(function(className,index){return bodyClassNamesStack.indexOf(className)===index}).join(" ")}function WixModal($q,$sce,$templateCache,$http,$rootScope,$controller,$compile,$document){function BaseModal(scope){this.scope=scope,this.modalClass="",this.escapeToClose=!0,this.clickOutsideToClose=!0,this.enterToConfirm=!1,this.title=function(value){return scope.title=value,scope.headerPreset||this.setHeaderPresetNumberOne(),this},this.locals=function(localsObject){return this.locals=localsObject,this},this.subtitle=function(value){return scope.subtitle=value,this},this.setHeaderPresetNumberOne=function(){return scope.headerPreset=1,this},this.setHeaderPresetNumberTwo=function(){return scope.headerPreset=2,this},this.disclaimer=function(disclaimer){return scope.disclaimer=disclaimer,this},this.customBodyStyle=function(style){return scope.customBodyStyle=style||{},this},this.modalController=function(controllerName){return this.controller=controllerName,this},this.modalControllerAs=function(controllerAs){return this.controllerAs=controllerAs,this},this.modalTemplateUrl=function(templateUrl){return this.template=null,this.templateUrl=templateUrl,this},this.modalTemplate=function(template){return this.templateUrl=null,this.template=template,this},this.modalEscapeToClose=function(escapeToClose){return this.escapeToClose=escapeToClose,this},this.modalEnterToConfirm=function(enterToConfirm){return this.enterToConfirm=enterToConfirm,this},this.modalClickOutsideToClose=function(clickOutsideToClose){return this.clickOutsideToClose=clickOutsideToClose,this},this.customStyle=function(style){return scope.customStyle=style||{},this},this.floatingFooter=function(value){return scope.floatingFooter=value,this},this.contentUrl=function(url){return scope.contentUrl=url,this},this.content=function(value){return scope.htmlContent=$sce.trustAsHtml(value),this},this.iconUrl=function(url){return scope.iconUrl=url,this},this.windowClass=function(value){return this.modalClass=value,this},this.openedBodyClass=function(value){return this.bodyClass=value,this},this.confirm=function(text,buttonClass){return this.scope.confirmButton=this.scope.confirmButton||{},this.scope.confirmButton={buttonClass:buttonClass||this.scope.confirmButton.buttonClass,label:text||this.scope.confirmButton.label},this},this.cancel=function(text,buttonClass){return this.scope.cancelButton=this.scope.cancelButton||{},this.scope.cancelButton={buttonClass:buttonClass||this.scope.cancelButton.buttonClass,label:text||this.scope.cancelButton.label},this}}function getTemplate(template,templateUrl){return templateUrl?$http({method:"GET",url:templateUrl,cache:$templateCache}).then(function(response){return response.data}):$q.when(template)}function removeModal(modalElement,options){removeBackDrop(options),focusedElementsStack.length&&focusedElementsStack.pop().focus(),modalElement.remove()}function removeBackDrop(options){0===modalStack.length&&(self.modalContainer.off("click"),body.off("keyup"),self.modalContainer.remove(),self.modalContainer=null),dropClassName(options.bodyClass)}function dropClassName(bodyClass){var index=bodyClassNamesStack.indexOf(bodyClass);body.removeClass(toUniqueClassesString(bodyClassNamesStack)),index>-1&&bodyClassNamesStack.splice(index,1),body.addClass(toUniqueClassesString(bodyClassNamesStack))}function addBackDrop(options){bodyClassNamesStack.push(options.bodyClass),body.addClass(toUniqueClassesString(bodyClassNamesStack)),null===self.modalContainer&&(self.modalContainer=angular.element('<div class="wix-modal wix-modal--container"></div>'),body.append(self.modalContainer),options.escapeToClose&&body.on("keyup",function(e){27===e.keyCode&&self.close("BLUR")}),options.enterToConfirm&&body.on("keypress",function(e){13===e.keyCode&&self.close("CONFIRM")}),options.clickOutsideToClose&&self.modalContainer.on("click",function(e){angular.element(e.target).hasClass("wix-modal--container")&&self.close("BLUR")}))}function createController(options,modalInstance){var controllerName=options.controller;options.controllerAs&&(controllerName=controllerName+" as "+options.controllerAs);var locals={$scope:options.scope,modal:modalInstance};options.locals&&Object.assign(locals,options.locals),$controller(controllerName,locals)}function createModalElement(options,result){var renderTemplate='<div class="wix-modal-window-wrapper"><div class="wix-modal--window '+options.modalClass+'" style="width:'+options.width+'px;">'+result+"</div></div>";return angular.element(renderTemplate),$compile(renderTemplate)(options.scope)}function createModalWindow(options,modalInstance){return getTemplate(options.template,options.templateUrl).then(function(result){addBackDrop(options),createController(options,modalInstance);var modalElement=createModalElement(options,result);return self.modalContainer.append(modalElement),focusedElementsStack.push($document[0].activeElement),$document[0].activeElement?$document[0].activeElement.blur():document.body.blur(),modalElement})}function createModalInstance(defer){return{close:function(reason){var index=modalStack.findIndex(function(obj){return obj===defer});return modalStack.splice(index,1),defer.resolve(reason)}}}var ALERT_TYPES={DANGER:{wrapperClass:"wix-modal--danger",buttonClass:"wix-button-danger is-button-small",headerClass:"wix-modal-header-danger"},ALERT:{wrapperClass:"wix-modal--alert",buttonClass:"wix-button is-button-small",headerClass:"wix-modal-header-alert"}},body=$document.find("body"),modalStack=[],focusedElementsStack=[],bodyClassNamesStack=[],self=this;self.modalContainer=null,this.base=function(){var scope=$rootScope.$new(),baseModal=new BaseModal(scope);return baseModal.modalTemplateUrl("views/components/modals/wix-modal-message-window.html"),baseModal.modalController("MessageWindowCtrl"),baseModal.modalControllerAs("windowCtrl"),baseModal.scope.style="wix-modal--base",baseModal},this.alert=function(){function setAlertType(type){var selectedType=ALERT_TYPES[type];void 0!==selectedType&&(alertModal.scope.style=selectedType.wrapperClass,alertModal.scope.headerClass=selectedType.headerClass,alertModal.confirm(null,selectedType.buttonClass),alertModal.cancel(null,selectedType.buttonClass))}var alertModal=this.base();return setAlertType("ALERT"),alertModal.style=function(type){return setAlertType(type),this},alertModal},this.danger=function(){var dangerModal=this.alert();return dangerModal.style("DANGER"),dangerModal},this.premium=function(){var scope=$rootScope.$new(),premiumModal=new BaseModal(scope);return premiumModal.templateUrl="views/components/modals/wix-premium-window.html",premiumModal.controller="MessageWindowCtrl",premiumModal.controllerAs="windowCtrl",premiumModal.subtitle=function(text){return this.scope.subtitle=text,this},premiumModal.confirm=function(label,buttonClass){return this.scope.confirmButton={label:label,buttonClass:buttonClass},this},
premiumModal.cancel=function(label,buttonClass){return this.scope.cancelButton={label:label,buttonClass:buttonClass},this},premiumModal},this.confirm=function(result){var defer=modalStack.pop();defer&&defer.reject(result)},this.close=function(reason){var defer=modalStack.pop();defer&&defer.resolve(reason)},this.open=function(options){var modalElement=null,defer=$q.defer();return defaults(options),createModalWindow(options,createModalInstance(defer)).then(function(result){return modalElement=result,modalStack.push(defer),defer.promise}).then(function(result){return removeModal(modalElement,options),result}).catch(function(reason){return removeModal(modalElement,options),reason})}}WixModal.$inject=["$q","$sce","$templateCache","$http","$rootScope","$controller","$compile","$document"];var _defaults=Object.create(null);_defaults.bodyClass="wix-modal-body-open",_defaults.width=564,angular.module("wixStyleInternal").service("wixModal",WixModal)}(),function(){function wixCheckbox(wixDirectivesUtils,$compile){return{template:'<label allow-propagation-from="input">\n                  <input type="checkbox"/>\n                  <span class="wix-checkbox-inner"></span>\n                </label>',restrict:"E",priority:550,terminal:!0,compile:function(element,$attrs){var input=element.find("input");return wixDirectivesUtils.moveAttributesToChild(element,input,$attrs,["ngRepeat","ngIf"]),function($scope,$element){$compile($element.find("label"))($scope);var checkboxElement=$element.find("input"),indeterminateExpression=checkboxElement.attr("checkbox-indeterminate");indeterminateExpression&&$scope.$watch(indeterminateExpression,function(newValue){checkboxElement[0].indeterminate=newValue})}}}}wixCheckbox.$inject=["wixDirectivesUtils","$compile"],angular.module("wixStyleInternal").directive("wixCheckbox",wixCheckbox)}(),function(){function notification($timeout){return{template:'<div class="wix-notification-container" ng-if="notificationTemplate === \'with-shadow\'"><div class="wix-notification-{{ notificationType }} is-notification-with-shadow" ng-transclude></div></div><div ng-if="notificationTemplate === \'with-close-button\'" class="wix-notification-{{ notificationType }} is-notification-closable"><span ng-transclude></span><span class="wix-notification-close-button" ng-click="close()"></span></div><div ng-if="notificationTemplate === \'with-inner-button\'" class="wix-notification-{{ notificationType }} is-notification-closable-with-inner-button"><span ng-transclude></span><span class="wix-notification-close-button" ng-click="close()"></span></div><div ng-if="notificationTemplate === \'with-icon\'" class="wix-notification-{{ notificationType }} is-notification-closable-with-icon"><span class="wix-notification-icon"></span><span ng-transclude></span><span class="wix-notification-close-button" ng-click="close()"></span></div><div ng-if="notificationTemplate === \'with-icon-dark\'" class="wix-notification-{{ notificationType }} is-notification-closable-with-icon-dark"><span class="wix-notification-icon"></span><span ng-transclude></span><span class="wix-notification-close-button" ng-click="close()"></span></div>',restrict:"E",transclude:!0,scope:{template:"@",type:"@",onClose:"&",autoHide:"@"},link:function(scope,element){var notificationTypes={general:"general",error:"error",warning:"warning",success:"success"},templateTypes={"with-shadow":"with-shadow","with-close-button":"with-close-button","with-inner-button":"with-inner-button","with-icon":"with-icon","with-icon-dark":"with-icon-dark"};scope.notificationTemplate=templateTypes[scope.template]||"with-close-button",scope.notificationType=notificationTypes[scope.type]||"general",scope.close=function(){scope.onClose(),element.remove()},"with-shadow"===scope.notificationTemplate&&(scope.timeout=scope.autoHide>0?scope.autoHide:5e3,$timeout(scope.close,scope.timeout))}}}notification.$inject=["$timeout"],angular.module("wixStyleInternal").directive("wixNotification",notification)}();var WixWizard=function(){function WixWizard($scope,$element){$scope.steps[0].state="active"}return WixWizard.$inject=["$scope","$element"],WixWizard}();angular.module("wixStyle").directive("wixWizard",function(){return{templateUrl:"views/directives/wix-wizard.html",restrict:"E",scope:{steps:"="},controller:WixWizard,controllerAs:"wixWizard"}}),angular.module("wixStyle").directive("wixModalHeader1",function(){return{templateUrl:"views/components/modals/wix-modal-header1.html",restrict:"E",scope:{title:"=",subtitle:"=?",onClose:"&?",cssClass:"=?"},controllerAs:"$ctrl",controller:["$scope",function($scope){this.getCssClasses=function(){var classesArray=[];return $scope.cssClass&&classesArray.push($scope.cssClass),$scope.subtitle&&classesArray.push("with-subtitle"),classesArray}}],link:function(scope,element){element.removeAttr("title")}}}),angular.module("wixStyle").directive("wixModalHeader2",function(){return{templateUrl:"views/components/modals/wix-modal-header2.html",restrict:"E",scope:{title:"=",subtitle:"=?",onClose:"&?"},link:function(scope,element){element.removeAttr("title")}}}),function(){function wixRadio(wixDirectivesUtils,$compile){return{template:'<label allow-propagation-from="input"> \n                  <input type="radio"/>\n                  <span class="wix-radio-inner"></span>\n                </label>',restrict:"E",priority:550,terminal:!0,compile:function(element,$attrs){var input=element.find("input");return wixDirectivesUtils.moveAttributesToChild(element,input,$attrs,["ngRepeat","ngIf"]),function($scope,$element){$compile($element.find("label"))($scope)}}}}wixRadio.$inject=["wixDirectivesUtils","$compile"],angular.module("wixStyleInternal").directive("wixRadio",wixRadio)}(),function(){angular.module("wixStyle").directive("wixTooltip",["wixTooltipFactory",function(wixTooltipFactory){return wixTooltipFactory()}]),angular.module("wixStyle").factory("wixPosition",["$document","$window",function($document,$window){function getStyle(el,cssprop){return el.currentStyle?el.currentStyle[cssprop]:$window.getComputedStyle?$window.getComputedStyle(el)[cssprop]:el.style[cssprop]}function isStaticPositioned(element){return"static"===(getStyle(element,"position")||"static")}var parentOffsetEl=function(element){for(var docDomEl=$document[0],offsetParent=element.offsetParent||docDomEl;offsetParent&&offsetParent!==docDomEl&&isStaticPositioned(offsetParent);)offsetParent=offsetParent.offsetParent;return offsetParent||docDomEl},fixMarginBelowBody=function(rect){return rect.top=rect.top-$document.find("body")[0].getBoundingClientRect().top-($window.pageYOffset||$document[0].documentElement.scrollTop),rect};return{position:function(element){var elBCR=this.offset(element),offsetParentBCR={top:0,left:0},offsetParentEl=parentOffsetEl(element[0]);offsetParentEl!==$document[0]&&(offsetParentBCR=this.offset(angular.element(offsetParentEl)),offsetParentBCR.top+=offsetParentEl.clientTop-offsetParentEl.scrollTop,offsetParentBCR.left+=offsetParentEl.clientLeft-offsetParentEl.scrollLeft);var boundingClientRect=element[0].getBoundingClientRect();return{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:elBCR.top-offsetParentBCR.top,left:elBCR.left-offsetParentBCR.left}},offset:function(element){var boundingClientRect=element[0].getBoundingClientRect();return{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:boundingClientRect.top+($window.pageYOffset||$document[0].documentElement.scrollTop),left:boundingClientRect.left+($window.pageXOffset||$document[0].documentElement.scrollLeft)}},positionElements:function(hostEl,targetEl,positionStr,appendToBody,align){var hostElPos,targetElWidth,targetElHeight,targetElPos,positionStrParts=positionStr.split("-"),pos0=positionStrParts[0],pos1=positionStrParts[1]||"center";hostElPos=appendToBody?fixMarginBelowBody(this.offset(hostEl)):this.position(hostEl),targetElWidth=targetEl.prop("offsetWidth"),targetElHeight=targetEl.prop("offsetHeight");var shiftWidth={center:function(){return hostElPos.left+hostElPos.width/2-targetElWidth/2},left:function(){return hostElPos.left},right:function(){return hostElPos.left+hostElPos.width}},shiftHeight={center:function(){return hostElPos.top+hostElPos.height/2-targetElHeight/2},top:function(){return hostElPos.top},bottom:function(){return hostElPos.top+hostElPos.height}};switch(pos0){case"right":targetElPos={top:shiftHeight[pos1](),left:shiftWidth[pos0]()};break;case"left":targetElPos={top:shiftHeight[pos1](),left:hostElPos.left-targetElWidth};break;case"bottom":targetElPos={top:shiftHeight[pos0](),left:shiftWidth[pos1]()};break;default:targetElPos={top:hostElPos.top-targetElHeight,left:shiftWidth[pos1]()}}switch(align){case"right":targetElPos.left=hostElPos.left+hostElPos.width-targetElWidth;break;case"left":targetElPos.left=hostElPos.left;break;case"bottom":targetElPos.top=hostElPos.top+hostElPos.height-targetElHeight;break;case"top":targetElPos.top=hostElPos.top}return targetElPos}}}]),angular.module("wixStyle").factory("wixTooltipFactory",["$timeout","$compile","wixPosition","$sce","$document",function($timeout,$compile,wixPosition,$sce,$document){return function(isPopover){var directiveScope={maxWidth:"@",appendToBody:"=?",debug:"=?",tooltipTemplate:"@?",tooltipScope:"=?",tooltipTrigger:"@?",isOpen:"=?",tooltipCloseOnContent:"=?",untrusted:"=?",preventScroll:"=?",alignTooltip:"@?",alwaysCloseOnClickOutside:"=?"};return isPopover&&(delete directiveScope.tooltipTemplate,delete directiveScope.tooltipScope),{restrict:isPopover?"E":"A",transclude:!!isPopover,scope:directiveScope,controllerAs:"vm",link:function(scope,element,attrs,controller,transcludeFn){function destroyTooltip(){tooltipElement&&(backdrop.detach(),setVisibility(!1),scope.preventScroll&&$document.find("body").removeClass("tooltip-open"),tooltipElement.remove(),tooltipElement=null,ttScope.$destroy(),ttScope=null,isPopover&&(transclusionScope.$destroy(),transclusionScope=null))}function newPlacementToFit(_a){function appropriatePlacementForElement(_a){var placement=_a.placement,element=_a.element,tooltip=_a.tooltip,body=_a.body;switch(placement){case allowedPlacements.top:if(element.top-tooltip.height>0)return!0;break;case allowedPlacements.right:if(element.right+tooltip.width<body.width)return!0;break;case allowedPlacements.bottom:if(element.bottom+tooltip.height<body.height)return!0;break;case allowedPlacements.left:if(element.left-tooltip.width>0)return!0}return!1}var wantedPlacement=_a.wantedPlacement,element=_a.element,tooltipElement=_a.tooltipElement,tooltipPosition=tooltipElement.getBoundingClientRect(),elementPosition=element.getBoundingClientRect(),bodyPosition=$document.find("body")[0].getBoundingClientRect(),placementFallbackList=function(placement){var placemenFallbackOrder={};return placemenFallbackOrder[allowedPlacements.top]=[allowedPlacements.bottom,allowedPlacements.left,allowedPlacements.right],placemenFallbackOrder[allowedPlacements.bottom]=[allowedPlacements.top,allowedPlacements.left,allowedPlacements.right],placemenFallbackOrder[allowedPlacements.left]=[allowedPlacements.right,allowedPlacements.top,allowedPlacements.bottom],placemenFallbackOrder[allowedPlacements.right]=[allowedPlacements.left,allowedPlacements.top,allowedPlacements.bottom],[placement].concat(placemenFallbackOrder[placement])}(wantedPlacement),newPlacement=null;return placementFallbackList.some(function(placement){return!!appropriatePlacementForElement({placement:placement,element:elementPosition,tooltip:tooltipPosition,body:bodyPosition})&&(newPlacement=placement)}),newPlacement||wantedPlacement}function positionTooltip(){if(tooltipElement){var fitterPlacement=placementForce?placement:newPlacementToFit({wantedPlacement:placement,element:element[0],tooltipElement:tooltipElement[0]}),originalPlacement=placement;placement=fitterPlacement,tooltipElement.addClass("placement-"+placement),scope.maxWidth&&"string"==typeof scope.maxWidth&&tooltipElement.css({"max-width":scope.maxWidth});var isHorizontalAlign=!("right"!==scope.alignTooltip&&"left"!==scope.alignTooltip||"bottom"!==placement&&"top"!==placement),isVerticalAlign=!("top"!==scope.alignTooltip&&"bottom"!==scope.alignTooltip||"right"!==placement&&"left"!==placement),isAlignValid=isHorizontalAlign||isVerticalAlign,alignTooltip=isAlignValid?scope.alignTooltip:"center",ttPosition=wixPosition.positionElements(element,tooltipElement,placement,shouldAppendToBody,alignTooltip);switch(placement){case allowedPlacements.bottom:ttPosition.top+=-2;break;case allowedPlacements.left:ttPosition.left+=2;break;case allowedPlacements.right:ttPosition.left+=-2;break;default:ttPosition.top+=2}if(ttPosition.top+="px",ttPosition.left+="px",tooltipElement.css(ttPosition),isAlignValid){tooltipElement.addClass("hide-pseudo-elements"),arrowBefore=angular.element('<div class="arrow-before"></div>'),arrowAfter=angular.element('<div class="arrow-after"></div>'),tooltipElement.prepend(arrowBefore),tooltipElement.append(arrowAfter);var arrowPositionRight,arrowPositionTop;switch(alignTooltip){case"right":arrowPositionRight=wixPosition.offset(element).width/2,arrowBefore.css("right",arrowPositionRight),arrowAfter.css("right",arrowPositionRight);break;case"left":arrowPositionRight=wixPosition.offset(tooltipElement).width-wixPosition.offset(element).width/2,arrowBefore.css("right",arrowPositionRight),arrowAfter.css("right",arrowPositionRight);break;case"top":arrowPositionTop=wixPosition.offset(element).height/2,arrowBefore.css("top",arrowPositionTop),arrowAfter.css("top",arrowPositionTop);break;case"bottom":arrowPositionTop=wixPosition.offset(tooltipElement).height-wixPosition.offset(element).height/2,arrowBefore.css("top",arrowPositionTop),arrowAfter.css("top",arrowPositionTop)}}placement=originalPlacement}}function cancelTooltipRemove(){$timeout.cancel(tooltipDestroyTimeout),tooltipDestroyTimeout=null}function onElementMouseOver(){tooltipDestroyTimeout?cancelTooltipRemove():showTooltip()}function showTooltip(){hasEnableExp&&!scope.$eval(attrs.tooltipEnable)||(createTooltip(),ttScope.$apply(),positionTooltip(),ttScope.$apply())}function onElementMouseLeave(){disableTooltipDestroy||isClickTrigger()||destroyTooltipGracefully()}function onTooltipMouseOver(){closeOnContent||cancelTooltipRemove()}function onTooltipMouseLeave(){onElementMouseLeave()}function createScope(){var res=scope.$new(!0);return angular.extend(res,scope.tooltipScope||{}),res}function getTooltipTemplate(){var placeholder='<div class="wix-tooltip-content" ng-bind-html="htmlContent"></div>';return"string"==typeof scope.tooltipTemplate?placeholder="<div>"+scope.tooltipTemplate+"</div>":isPopover&&(placeholder='<div class="wix-tooltip-content"></div>'),'<div class="wix-tooltip" ng-mouseover="onTooltipMouseOver()" ng-mouseleave="onTooltipMouseLeave()"><div class="wix-tooltip-container"><div class="wix-tooltip-arrow"></div>'+placeholder+"</div></div>"}function setVisibility(visible){ttScope.tooltipVisible=visible,scope.isOpen=visible}function createTooltip(){tooltipElement&&destroyTooltip(),ttScope=createScope(),shouldAppendToBody=!!scope.appendToBody&&scope.appendToBody,isPopover||(ttScope.htmlContent=trustContent?$sce.trustAsHtml(attrs.wixTooltip):attrs.wixTooltip),setVisibility(!1),ttScope.onTooltipMouseOver=onTooltipMouseOver,ttScope.onTooltipMouseLeave=onTooltipMouseLeave,tooltipElement=$compile(getTooltipTemplate())(ttScope,function(tooltip){shouldAppendToBody?$document.find("body").append(tooltip):element.after(tooltip),isPopover&&transcludeFn(function(clone,scope){angular.element(tooltip[0].querySelector(".wix-tooltip-content")).append(clone),transclusionScope=scope})}),tooltipElement.addClass(attrs.tooltipClass),setVisibility(!0),scope.preventScroll&&$document.find("body").addClass("tooltip-open")}function setPlacement(){var userDefinedPlacement=attrs.placement;userDefinedPlacement&&allowedPlacements[userDefinedPlacement]&&(placement=userDefinedPlacement),attrs.placementForce&&"false"!==attrs.placementForce&&(placementForce=!0)}function destroyTooltipGracefully(){tooltipDestroyTimeout=$timeout(function(){destroyTooltip(),tooltipDestroyTimeout=null},0)}function isClickTrigger(){return"click click"===scope.tooltipTrigger}function isClickHoverTrigger(){return"click hover"===scope.tooltipTrigger}function isTriggerDisabled(){return"false"===scope.tooltipTrigger}function bindClickToCloseFromTriggerElement(){element.bind("click",function(){scope.isOpen&&destroyTooltipGracefully()})}function bindClickTriggerToBackdrop(){backdrop.bind("click",function(){destroyTooltipGracefully()})}function bindClickTriggers(){element.bind("click",function(){showTooltip(),attachBackdrop()}),bindClickTriggerToBackdrop()}function attachBackdrop(){$document.find("body").append(backdrop)}function bindTooltipTriggers(){isTriggerDisabled()||(isClickTrigger()?bindClickTriggers():(bindClickToCloseFromTriggerElement(),element.bind(isClickHoverTrigger()?"click":"mouseenter",onElementMouseOver),element.bind("mouseleave",onElementMouseLeave)))}isPopover&&(element=element.parent());var ttScope,transclusionScope,tooltipDestroyTimeout,tooltipElement,arrowBefore,arrowAfter,shouldAppendToBody,disableTooltipDestroy=""===attrs.debug||"true"===attrs.debug||"false"===scope.tooltipTrigger,trustContent=!(""===attrs.untrusted||"true"===attrs.untrusted),closeOnContent=!!scope.tooltipCloseOnContent,allowedPlacements={top:"top",bottom:"bottom",left:"left",right:"right"},defaultOptions={placement:"top"},placement=defaultOptions.placement,placementForce=!1,hasEnableExp=angular.isDefined(attrs.tooltipEnable),backdrop=angular.element('<div class="wix-tooltip-backdrop"></div>');scope.$on("$destroy",destroyTooltip),scope.$watch("isOpen",function(newVal,oldVal){oldVal&&!1===newVal&&tooltipElement?destroyTooltipGracefully():!0!==newVal||tooltipElement||$timeout(function(){setPlacement(),showTooltip(),scope.alwaysCloseOnClickOutside&&(attachBackdrop(),bindClickTriggerToBackdrop())},0)}),function(){setPlacement(),bindTooltipTriggers(),scope.isOpen&&isClickTrigger()&&attachBackdrop()}()}}}}])}();var directives;!function(directives){function wixTab(){return{template:'<div ng-if="wixTabVM.isActive" ng-transclude></div>',controller:WixTabController,controllerAs:"wixTabVM",bindToController:{label:"@"},transclude:!0,scope:!0,link:function($scope,$element,attrs,ctrl){ctrl.isActive=attrs.hasOwnProperty("active"),ctrl.disabled=attrs.hasOwnProperty("disabled"),ctrl.label=attrs.label},restrict:"E"}}function wixTabs(){function getActiveTabIndex(tabsElements){var activeIndex=0;return angular.forEach(tabsElements,function(value,index){!0===value.isActive&&(activeIndex=index)}),activeIndex}return{templateUrl:"views/directives/wix-tabs.html",controller:WixTabsController,controllerAs:"wixTabsVM",transclude:!0,scope:!0,link:function($scope,$element,attrs,ctrl){$element.addClass("wix-tabs");var tabControllers=[];angular.forEach($element.find("wix-tab"),function(element,index){var jqLiteElement=angular.element(element);tabControllers.push(jqLiteElement.controller("wixTab"))}),ctrl.tabControllers=tabControllers,attrs.hasOwnProperty("mdSelected")?ctrl.activeTabIndex=parseInt(attrs.mdSelected,10):ctrl.activeTabIndex=getActiveTabIndex(tabControllers)},restrict:"E"}}var WixTabController=function(){function WixTabController($scope){this.$scope=$scope,this.isActive=!0}return WixTabController.$inject=["$scope"],WixTabController.prototype.getLabel=function(){return this.label},WixTabController}();directives.WixTabController=WixTabController,directives.wixTab=wixTab;var WixTabsController=function(){function WixTabsController(){}return WixTabsController.prototype.onTabClick=function(tab){tab.disabled||(this.activeTabIndex=this.tabControllers.indexOf(tab))},Object.defineProperty(WixTabsController.prototype,"activeTabIndex",{get:function(){return this._activeTabIndex},set:function(value){this._activeTabIndex=value;for(var i=0;i<this.tabControllers.length;i++)this.tabControllers[i].isActive=!1;this.tabControllers[value].isActive=!0},enumerable:!0,configurable:!0}),WixTabsController.prototype.isActive=function(tab){return this.tabControllers.indexOf(tab)===this.activeTabIndex},WixTabsController}();directives.WixTabsController=WixTabsController,directives.wixTabs=wixTabs}(directives||(directives={})),angular.module("wixStyle").directive("wixTab",directives.wixTab),angular.module("wixStyle").directive("wixTabs",directives.wixTabs),function(){function wixSearch(wixDirectivesUtils){return{templateUrl:"views/directives/wix-search.html",restrict:"E",compile:function(element,$attrs){var isAnimated=element.hasClass("animated"),isShrank=element.hasClass("shrank"),input=element.find("input");return wixDirectivesUtils.moveAttributesToChild(element,input,$attrs,["skin"]),element.addClass("wix-search"),isAnimated&&element.addClass("animated"),isShrank&&element.addClass("shrank"),function(scope,element,attr){function evalOnClear(event){scope.$eval(attr.onClear,{event:event,oldValue:input.val()})}var input=element.find("input");scope.clearSearch=function(event){evalOnClear(event),input.val("").triggerHandler("change")},scope.shouldShowClear=function(){return input.val()},scope.onFocusIn=function(){element.addClass("focus")},scope.onFocusOut=function(){element.removeClass("focus")},input.bind("keyup",function(event){13===event.which&&input.val()&&(scope.$eval(attr.onSearch,{event:event}),event.preventDefault())})}}}}wixSearch.$inject=["wixDirectivesUtils"],angular.module("wixStyleInternal").directive("wixSearch",wixSearch)}(),function(){function list(){return{restrict:"E",transclude:!0,require:"ngModel",scope:{draggableItem:"&",checkableProperty:"&",imageSquare:"&",contentTemplate:"@",transcluded:"="},templateUrl:"views/directives/wix-list.html",link:function(scope,element,attr,ngModelCtrl){var dragSrcEl,dragTempEl,dragSrcElItem,startY=0,y=0;ngModelCtrl.$render=function(){scope.items=ngModelCtrl.$viewValue},scope.checkableProperty=attr.checkableProperty;var list={indexOfPlaceholder:void 0,movePlaceholder:function(target){if(void 0!==target){var placeholder=scope.items.splice(this.indexOfPlaceholder,1);scope.items.splice(target,0,placeholder[0]),this.indexOfPlaceholder=target,scope.$digest()}},replacePlaceholderWithSrcItem:function(target){void 0===target&&(target=this.indexOfPlaceholder),scope.items.splice(this.indexOfPlaceholder,1),scope.items.splice(target,0,dragSrcElItem),scope.$apply(function(){ngModelCtrl.$setViewValue(scope.items)})},replaceSrcItemWithPlaceholder:function(itemIndex){dragSrcElItem=scope.items[itemIndex],this.indexOfPlaceholder=itemIndex,scope.items.splice(itemIndex,1),scope.items.splice(itemIndex,0,{empty:!0}),scope.$digest()}},getIndex=function(target){return target.attr("index")?target.attr("index"):target.parent().attr("index")?target.parent().attr("index"):void 0};element.on("mousedown",function(event){event.preventDefault();var dragButton=angular.element(event.target);dragButton.hasClass("wix-list-draggable")&&(dragSrcEl=dragButton.parent(),dragTempEl=angular.element('<div><div class="wix-list-item">'+dragSrcEl[0].innerHTML+"</div></div>"),element.append(dragTempEl),dragTempEl.css({position:"absolute",width:"calc(100% - 18px)",top:dragSrcEl[0].offsetTop+"px","pointer-events":"none"}),startY=dragSrcEl[0].offsetTop-y,list.replaceSrcItemWithPlaceholder(dragButton.parent().scope().$index))});var getCorrectPosition=function(event,target){var currentY=event.screenY+window.scrollY-1.5*target.offsetHeight,heightMax=element[0].offsetHeight-target.offsetHeight+element[0].offsetTop;return currentY<element[0].offsetTop?y:heightMax<currentY?y:currentY};element.on("mousemove",function(event){return dragSrcEl&&(event.preventDefault&&event.preventDefault(),dragSrcEl!==event.target&&(list.movePlaceholder(getIndex(angular.element(event.target))),y=getCorrectPosition(event,dragSrcEl[0]),dragTempEl.css({top:y+"px"}))),!1}),element.on("mouseup",function(event){if(dragSrcEl)return event.stopPropagation&&event.stopPropagation(),dragSrcEl!==event.target&&list.replacePlaceholderWithSrcItem(getIndex(angular.element(event.target))),dragSrcEl=null,dragSrcElItem=null,dragTempEl.remove(),!1})}}}angular.module("wixStyleInternal").directive("wixList",list)}(),function(){angular.module("wixStyle").directive("wixPopover",["wixTooltipFactory",function(wixTooltipFactory){return wixTooltipFactory(!0)}])}();var directives;!function(directives){!function(Calendar){function removeLeadingZeros(dates){dates.forEach(function(day){return day.label=_.parseInt(day.label,10)})}function markMinAndMaxDate(dates){var possibleDates=dates.filter(function(date){return!date.disabled}),minDate=_.first(possibleDates),maxDate=_.last(possibleDates);minDate&&(minDate.isMinDate=!0),maxDate&&(maxDate.isMaxDate=!0)}var CustomizedDayPicker=function(){function CustomizedDayPicker($animate,$scope){this.$animate=$animate,this.$scope=$scope}return CustomizedDayPicker.$inject=["$animate","$scope"],CustomizedDayPicker.prototype.mutateDays=function(dates){var flattenDates=_.flatten(dates);removeLeadingZeros(flattenDates),markMinAndMaxDate(flattenDates)},CustomizedDayPicker}();Calendar.CustomizedDayPicker=CustomizedDayPicker}(directives.Calendar||(directives.Calendar={}))}(directives||(directives={})),angular.module("wixStyleInternal").directive("wixDayCalendar",function(){return{templateUrl:"views/directives/calendar/day-calendar.html",controller:directives.Calendar.CustomizedDayPicker,scope:{labels:"=",rows:"=",title:"=",active:"=",move:"&",select:"&"},bindToController:!0,controllerAs:"$ctrl",link:function(scope,element,attributes,ctrl){scope.$watch(function(){return ctrl.rows},function(newData){newData&&ctrl.mutateDays(newData)})}}});var _this=this,directives;!function(directives){!function(Calendar_1){var Calendar=function(){function Calendar($scope){this.$scope=$scope}return Calendar.$inject=["$scope"],Calendar.prototype.init=function(){var _this=this;_.isBoolean(this.showControlButtons)||(this.showControlButtons=!0);var overridesOptions={showWeeks:!1,maxMode:"day"};this.uibOptions=_.merge({},this.options,overridesOptions),this.options&&this.options.theme&&(this.uibOptions.customClass=function(){return"theme theme-"+_this.options.theme}),this.watchDateSelected()},Calendar.prototype.onChanges=function(changes){changes.date&&changes.date.currentValue!==this.internalDate&&(this.internalDate=angular.copy(changes.date.currentValue))},Calendar.prototype.clear=function(){this.internalDate=null},Calendar.prototype.watchDateSelected=function(){var _this=this;this.$scope.$watch(function(){return _this.internalDate},function(newValue,preValue){if(preValue!==newValue){var changes={date:{currentValue:newValue}};_this.onChanges(changes),_this.onSelect({$event:{date:_this.internalDate}})}})},Calendar}();Calendar_1.Calendar=Calendar}(directives.Calendar||(directives.Calendar={}))}(directives||(directives={})),angular.module("wixStyleInternal").directive("wixCalendar",function(){return{templateUrl:"views/directives/calendar/calendar.html",controller:directives.Calendar.Calendar,scope:{options:"=",date:"=",onSelect:"&",showControlButtons:"="},bindToController:!0,controllerAs:"$ctrl",link:{pre:function(scope,element,attributes,ctrl){ctrl.internalDate=ctrl.date,scope.$watch(function(){return ctrl.date},function(newVal,prevVal){newVal!==prevVal&&(_this.internalDate=newVal)})},post:function(scope,element,attributes,ctrl){ctrl.init()}}}});var directives;!function(directives){!function(PopoverCalendar_1){var PopoverCalendar=function(){function PopoverCalendar(){this.isOpen=!1}return PopoverCalendar.prototype.onSelectDate=function($event){this.isOpen=!1,this.onSelect({$event:{date:$event.date}})},PopoverCalendar}();PopoverCalendar_1.PopoverCalendar=PopoverCalendar}(directives.PopoverCalendar||(directives.PopoverCalendar={}))}(directives||(directives={})),angular.module("wixStyleInternal").directive("wixPopoverCalendar",function(){return{templateUrl:"views/directives/calendar/popover-calendar.html",transclude:!0,scope:{options:"=",placement:"@",date:"=",onSelect:"&",showControlButtons:"="},bindToController:!0,controller:directives.PopoverCalendar.PopoverCalendar,controllerAs:"$ctrl"}}),function(){function wixSlider(wixDirectivesUtils,$compile){return{template:'<rzslider data-hook="slider"/>',restrict:"E",priority:550,terminal:!0,compile:function(element,$attrs){var container=element.find("rzslider");return wixDirectivesUtils.moveAttributesToChild(element,container,$attrs,["ngRepeat","ngIf"]),function($scope,$element){$compile($element.find("rzslider"))($scope)}}}}wixSlider.$inject=["wixDirectivesUtils","$compile"],angular.module("wixStyleInternal").directive("wixSlider",wixSlider)}(),function(){function WixSwitchToggles($timeout){return{template:'\n        <div class="switch-slider" \n             data-hook="switch-slider"\n             ng-style="{\n                width: $ctrl.sliderWidth + \'px\',\n                transform: \'translateX(\' + $ctrl.switchSliderOffset + \'px)\'\n             }"></div>\n        <div class="toggles"></div>\n      ',restrict:"E",require:["wixSwitchToggles","ngModel"],scope:{},transclude:!0,controllerAs:"$ctrl",controller:["$element","$attrs","$scope","$q","$transclude",function($element,$attrs,$scope,$q,$transclude){var _this=this;this.cssWidth="auto",this.width=0,this.sliderWidth=0,this.switchSliderOffset=0,this.toggles=[],this.value="",this.selectedItem=void 0,this.selectedIndex=0,this.getToggles=$q.defer(),this.getInitialValue=$q.defer(),this.togglesToWaitFor=0,this.childrenReady=!1,this.addToggle=function(toggle,isLast){var newToggleIndex=_this.toggles.push(toggle)-1;return _this.togglesToWaitFor--,_this.childrenReady||0!==_this.togglesToWaitFor&&!isLast||(_this.childrenReady=!0,_this.getToggles.resolve(_this.toggles)),newToggleIndex},this.getSelectedToggleIndex=function(value){for(var i=0;i<_this.toggles.length;i++)if(value===_this.toggles[i].getValue())return i},this.switchSlider=function(index){var sliderStyle=getComputedStyle($element[0].querySelector(".switch-slider")),sliderBorderRadius=parseInt(sliderStyle.getPropertyValue("border-radius"),10)||8,addWidth=sliderBorderRadius,fixOffset=-sliderBorderRadius;0===index&&(fixOffset=0),index>0&&index<_this.toggles.length-1&&(addWidth*=2),_this.sliderWidth=_this.width+addWidth,_this.switchSliderOffset=_this.width*index+fixOffset},this.getWidth=function(){var width=Number($attrs.toggleWidth)||0,labels=$element[0].querySelectorAll("label");if(!width){for(var i=0;i<labels.length;i++)width=Math.max(labels[i].offsetWidth,width);width+=2}return width},this.setWidth=function(width){_this.cssWidth=width+"px",_this.width=width,_this.toggles.forEach(function(toggle){return toggle.setWidth(width)})},this.setWatchers=function(ngModelCtrl){$scope.$watch(function(){return _this.selectedIndex},function(newIndex){void 0===newIndex&&(newIndex=0),_this.selectedItem=_this.toggles[newIndex],_this.switchSlider(newIndex)}),$scope.$watch(function(){return _this.selectedItem.getValue()},function(newValue){_this.value=newValue,ngModelCtrl.$setViewValue(newValue)})},this.renderChildren=function(){$transclude(function(clone){for(var toggles=$element[0].querySelector(".toggles"),hasNgRepeat=!1,i=0;i<clone.length;i++){var el=clone[i];el.tagName&&"label"===el.tagName.toLowerCase()?_this.togglesToWaitFor++:8===el.nodeType&&el.textContent.search(/ngRepeat:/)&&(hasNgRepeat=!0),toggles.appendChild(el)}hasNgRepeat&&_this.togglesToWaitFor>0&&console.error("wix-switch-toggles: you can't use \nngRepeat-ed wix-switch-toggle and inline at the same time. \nIt can lead to unexpected result.")})},this.load=function(ngModelCtrl){var initialValueIsGotten=!1;_this.renderChildren(),$q.all([_this.getToggles.promise,_this.getInitialValue.promise]).then(function(_a){var value=_a[1];_this.selectedIndex=_this.getSelectedToggleIndex(value),_this.setWatchers(ngModelCtrl),$timeout(function(){return _this.onLoad()})}),ngModelCtrl.$render=function(){
_this.value=ngModelCtrl.$viewValue,_this.selectedIndex=_this.getSelectedToggleIndex(ngModelCtrl.$viewValue),initialValueIsGotten||(initialValueIsGotten=!0,_this.getInitialValue.resolve(ngModelCtrl.$viewValue))}},this.onLoad=function(){_this.setWidth(_this.getWidth()),_this.switchSlider(_this.selectedIndex)}}],link:function(scope,iElement,iAttrs,_a){var $ctrl=_a[0],ngModelCtrl=_a[1];$ctrl.load(ngModelCtrl)}}}function WixSwitchToggle(){return{template:'\n        <label data-hook="toggle" ng-style="{ width: $ctrl.cssWidth }">\n          <div class="toggle-content" data-hook="toggle-content" ng-transclude></div>\n          <input\n            name="switch"\n            type="radio"\n            ng-value="$ctrl.index"\n            ng-model="$ctrl.switchCtrl.selectedIndex">\n        </label>',restrict:"E",require:["wixSwitchToggle","^^wixSwitchToggles"],transclude:!0,replace:!0,bindToController:!0,controllerAs:"$ctrl",scope:{value:"="},controller:["$element",function($element){var _this=this;this.cssWidth="auto",this.index=0,this.setWidth=function(width){return _this.cssWidth=width+"px"},this.getValue=function(){return _this.value||$element[0].textContent.trim()}}],link:function(scope,iElement,iAttrs,_a){var $ctrl=_a[0],wixSwitchTogglesCtrl=_a[1];$ctrl.index=wixSwitchTogglesCtrl.addToggle($ctrl,scope.$parent.$last),$ctrl.switchCtrl=wixSwitchTogglesCtrl}}}WixSwitchToggles.$inject=["$timeout"],angular.module("wixStyleInternal").directive("wixSwitchToggles",WixSwitchToggles).directive("wixSwitchToggle",WixSwitchToggle)}(),function(){function allowPropagationFrom(){return{restrict:"A",link:function($scope,$element,$attrs){var eventType=$attrs.eventType||"click",innerElement=$attrs.allowPropagationFrom;$element.on(eventType,function(event){event.target.tagName.toLowerCase()!==innerElement&&event.stopPropagation()}),$scope.$on("$destroy",function(){return $element.off(eventType)})}}}angular.module("wixStyleInternal").directive("allowPropagationFrom",allowPropagationFrom)}(),function(){function _range(from,to){for(var items=[];from<=to;)items.push(from++);return items}function _daysRange(to){return DAYS_RANGE.slice(0,to)}function isLeapYear(year){return 1===new Date(year,1,29).getMonth()}function getDaysInMonths(year){return[31,isLeapYear(year)?29:28,31,30,31,30,31,31,30,31,30,31]}function getObjectFromDate(d){return{year:d.getFullYear(),month:d.getMonth()+1,day:d.getDate()}}function createDate(state){return new Date(state.year,state.month?state.month-1:0,state.day||1)}function padZero(n){return n<10?"0"+n:""+n}function WixMonthlyPickerController($filter,$timeout,DateService){var dp=this,TODAY_DATE=DateService.getToday();dp.direction=dp.direction||"top",dp.format=dp.format||"MM/dd/yyyy",dp.flow=dp.flow||["year","month"],dp.today=getObjectFromDate(TODAY_DATE);var startDate=dp.startDate||TODAY_DATE;angular.extend(dp,{startDate:startDate,start:getObjectFromDate(startDate),isOpen:!1,$timeout:$timeout,$filter:$filter,defaultType:dp.flow[0],picked:{isEmpty:!0}}),dp.state=angular.extend({type:dp.defaultType},dp.start),this.init(dp.date)}function monthlyPicker($document){return{templateUrl:"views/directives/wix-monthly-picker.html",restrict:"E",scope:{date:"=",startDate:"=?",flow:"=?",format:"@?",direction:"@?"},bindToController:!0,link:function(scope,el){$document.on("click",function(e){scope.dp.isOpen&&(el===e.target||el[0].contains(e.target)||scope.$apply(function(){scope.dp.toggle()}))})},controller:WixMonthlyPickerController,controllerAs:"dp"}}WixMonthlyPickerController.$inject=["$filter","$timeout","DateService"],monthlyPicker.$inject=["$document"];var DAYS_RANGE=_range(1,31),MAX_ITEMS={year:12,month:12,day:36},MONTHS=_range(1,12);angular.extend(WixMonthlyPickerController.prototype,{init:function(date){if(date&&!isNaN(date)){var dp=this;dp.date=date,dp.state=angular.extend(dp.state,getObjectFromDate(dp.date)),dp.picked=getObjectFromDate(dp.date),dp.picked.isEmpty||(dp.date=createDate(dp.picked)),dp.displayDate=dp.getDisplayDate(dp.date)}},options:function(){var dp=this,min=dp.min(),max=dp.max();return{year:_range(min.year,max.year),month:MONTHS,day:_daysRange(max.day)}},min:function(){return{year:this.state.year-parseInt(MAX_ITEMS.year/2),month:1,day:1}},max:function(){return{year:this.state.year+parseInt(MAX_ITEMS.year/2)-1,month:12,day:getDaysInMonths(this.state.year)[this.state.month-1]}},goPrev:function(){this._prev[this.state.type].call(this)},_prev:{year:function(){this.state.year-=MAX_ITEMS.year},month:function(){this.state.year-=1},day:function(){this.state.month=(this.state.month-1)%12||12}},goNext:function(){this._next[this.state.type].call(this)},_next:{year:function(){this.state.year+=MAX_ITEMS.year},month:function(){this.state.year+=1},day:function(){this.state.month=(this.state.month+1)%12||12}},isActive:function(option){return this.picked[this.state.type]===Number(option)},isToday:function(option){return this._isToday[this.state.type].call(this,option)},_isToday:{year:function(option){return this.today.year===(option||this.state.year)},month:function(option){return this.today.month===Number(option||this.state.month)},day:function(option){return this.today.day===(option||this.state.day)}},pick:function(pick){var dp=this,type=dp.state.type,index=dp.flow.indexOf(type);dp.$timeout(function(){if(dp.picked[type]=Number(pick),dp.state[type]=Number(pick),dp.date=createDate(dp.picked),dp.displayDate=dp.getDisplayDate(dp.date),dp.flow[index+1])return void(dp.state.type=dp.flow[index+1]);dp.toggle(),dp.$timeout(function(){dp.state.type=dp.defaultType})})},unpick:function(){var dp=this,type=dp.state.type,index=dp.flow.indexOf(type);dp.$timeout(function(){dp.flow[index-1]&&(dp.state.type=dp.flow[index-1])})},toggleIsOpen:function(event){event.stopPropagation(),this.toggle()},toggle:function(){var nextState=!this.isOpen;nextState&&(this.state.type=this.defaultType),this.isOpen=nextState},getDisplayDate:function(date){return this.$filter("date")(date,this.format)}}),angular.module("wixStyleInternal").filter("padZero",function(){return padZero}).directive("wixMonthlyPicker",monthlyPicker)}(),function(){angular.module("wixStyleInternal").directive("mdDatepicker",function(){return{priority:9999,link:function(scope,element,attrs){var datepickerInput=element.find("input"),datepickerButton=element.find("button")[1];attrs.mdClickOnInput&&(datepickerInput.attr("readonly","true"),datepickerInput.bind("click",function($event){angular.element($event.target).blur(),datepickerButton.click()}))}}})}(),angular.module("wixStyleInternal").directive("mdAutocomplete",["$compile","$timeout",function($compile,$timeout){return{require:"mdAutocomplete",link:function(scope,element,attrs,ctrl){var inputElement=find(element,"input");if(attrs.mdActionText&&(scope.actionText=attrs.mdActionText,scope.actionFn=function(){inputElement.blur().attr("disabled",""),scope.$eval(attrs.mdAction).finally(function(){inputElement.removeAttr("disabled")})},find(element,".md-autocomplete-suggestions-container").append($compile('<div class="md-autocomplete-action">\n                            <div ng-click="actionFn()">{{actionText}}</div>\n                          </div>')(scope)),scope.ctrl=ctrl),attrs.errorMessage){"tooltip"===(attrs.errorType||"tooltip")&&function(errorMessage){scope.errorMessage=errorMessage,$timeout(function(){inputElement=find(element,"input"),inputElement.addClass("error md-autocomplete-input");var iconElement=$compile('<i class="icon wix-style-svg-font-icons-validation"\n                                  wix-tooltip="{{errorMessage}}"\n                                  append-to-body="true"\n                                  placement="top"\n                                  max-width="250px">\n                        </i>')(scope);inputElement.after(iconElement)},0)}(attrs.errorMessage)}}}}]),function(){"use strict";var logger,bind=function(fn,me){return function(){return fn.apply(me,arguments)}};logger=new Logger("WindowMessenger"),this.WindowMessenger=function(){function WindowMessenger(targetWindow){if(this.targetWindow=targetWindow,this._eventHandler=bind(this._eventHandler,this),this.emit=bind(this.emit,this),this.off=bind(this.off,this),this.one=bind(this.one,this),this.on=bind(this.on,this),void 0===this.targetWindow)throw new Error("target window should be defined");this.observers=[],window.addEventListener("message",this._eventHandler,!1)}return WindowMessenger.prototype.on=function(event,fn){return this.observers.push({event:event,fn:fn})},WindowMessenger.prototype.one=function(event,fn){return this.observers.push({event:event,fn:fn,once:!0})},WindowMessenger.prototype.off=function(event,fn){var i,j;for(i=j=this.observers.length-1;j>=0;i=j+=-1)this.observers[i].event!==event||this.observers[i].fn!==fn&&void 0!==fn||this.observers.splice(i,1)},WindowMessenger.prototype.emit=function(event,data){return logger.log("postMessage emitted",event,data),this.targetWindow.postMessage(JSON.stringify({event:event,data:data}),"*")},WindowMessenger.prototype._eventHandler=function(event){var data;if(event.source===this.targetWindow)return data=JSON.parse(event.data),logger.log("postMessage received",data),this.observers.filter(function(observer){return observer.event===data.event}).forEach(function(_this){return function(observer){if(observer.fn.call(event,data.data),observer.once)return _this.off(observer.event,observer.fn)}}(this))},WindowMessenger}()}.call(this),function(){"use strict";this.app=angular.module("mediaGalleryApp",["templates","ngResource","ui.router","restangular","ngDialog","ui.bootstrap","wixStyle"])}.call(this),angular.module("templates",[]).run(["$templateCache",function($templateCache){"use strict";$templateCache.put("scripts/directives/breadcrumbs/breadcrumbs.html",'<div class="breadcrumbs"><div ng-repeat="(index, folder) in existedList()" ng-switch="index != existedList().length - 1" class="item"><button ng-click="action({folder: folder})" ng-switch-when="true">{{folder.name}}</button><span ng-switch-when="false">{{folder.name}}</span></div></div>'),$templateCache.put("scripts/directives/draggable/draggable-helper.html",'<div ng-show="count" ng-class="{folder: isFolder(entity)}" class="draggable-helper"><div covered-background="{{entity.thumbnailUrl}}" class="box"><div ng-bind="count" class="count"></div><div class="name">{{entity.name}}</div></div><div ng-show="count &gt;= 2" class="box two"></div><div ng-show="count &gt;= 3" class="box many"></div></div>'),$templateCache.put("scripts/directives/entities-grid/entities-grid.html",'<ul multi-select="entities" ng-hide="entities.length == 0" ng-class="adapterName" class="items"><li ng-repeat="entity in entities track by entity.id" bi-click="{eventName: \'itemSelect.click\', data: { target: entity.id }}" more-actions-tooltip="{}" multi-select-entity="entity" can-select-multiple="canSelectMultiple" ng-class="{selected: isSelected(entity), processing: entity._isProcessing, renaming: renameCtrl.isVisible(entity), folder: isFolder(entity), transcoding: entity.can.transcode() &amp;&amp; !entity.isTranscoded()}" ng-click="click({entity: entity})" ng-dblclick="doubleClick({entity: entity})" draggable="entity" can-drag="entity.can.move()" droppable="moveSelectedToFolder({folder: entity})" can-drop-entities="entity.can.moveItemIn()" item-url="{{entity.fileUrl}}" class="item mt-{{entity.mediaType}}"><div ng-if="isFolder(entity)" class="folder-background"></div><div covered-background="{{entity.thumbnailUrl}}" load-visible-for=".entities-wrapper" load-if-changed="selectedLayoutId + entities.length" on-load-success="onThumbnailLoaded()" ng-class="{item: !isFolder(entity), folder:isFolder(entity)}" class="image"></div><div ng-show="entity.can.transcode() &amp;&amp; !entity.isTranscoded()" ng-switch="entity.transcodingStatus" ng-class="entity.transcodingStatus.toLowerCase()" class="transcoding-status"><div class="title inprogress">{{ "private_media.transcoding" | translate }}</div><div class="spinner inprogress"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div><div class="title in-queue">{{ "private_media.transcoding" | translate }}:</div><div class="message in-queue">{{ "private_media.transcoding_in_queue" | translate }}</div><div class="title failed">{{ "private_media.transcoding_fails.title" | translate }}</div><div class="message failed">{{ "private_media.transcoding_fails.message" | translate }}</div></div><renamable-name entity="entity" rename-ctrl="renameCtrl" redraw-on-change="selectedLayoutId"></renamable-name><ul ng-hide="!entity.can.showImagePreview() &amp;&amp; !entity.can.showVideoPreview() &amp;&amp; !entity.can.showExternalVideoPreview() &amp;&amp; !entity.can.makeFavorites() &amp;&amp; !entity.can.rename() &amp;&amp; !entity.can.remove() &amp;&amp; !entity.can.removeFromFolder() &amp;&amp; !entity.can.edit() &amp;&amp; !entity.can.getDownloadLink() &amp;&amp; !entity.can.restore() &amp;&amp; !entity.can.buy()" ng-class="&quot;transcoding-&quot; + entity.transcodingStatus.toLowerCase()" class="actions"><li ng-if="entity.can.showImagePreview() || entity.can.showVideoPreview() || entity.can.showExternalVideoPreview()"><preview adapter-name="adapterName" folder-name="folderName(entity)" item="entity"></preview></li><li ng-if="entity.can.makeFavorites()"><button ng-class="{active: entity.isFavorites()}" deny-bubbling="mousedown" bi-click="{eventName: \'makeItemFavoritesButton.click\', data: {target: entity.id}}" ng-click="entity.isFavorites() ? entity.unmakeFavorites() : entity.makeFavorites()" tooltip-append-to-body="true" tooltip="{{\'private_media.make_favorites\' | translate}}" class="action favorites"></button></li><li ng-if="entity.can.rename()"><button bi-click="{eventName: \'renameButton.click\', data: {target: entity.id}}" deny-bubbling="mousedown" ng-click="renameCtrl.show(entity)" tooltip-append-to-body="true" tooltip="{{\'private_media.rename_item\' | translate}}" class="action rename"></button></li><li ng-if="entity.can.remove()"><button bi-click="{eventName: \'removeItemButton.click\', data: {target: entity.id}}" deny-bubbling="mousedown" ng-click="remove.one(entity)" tooltip-append-to-body="true" tooltip="{{ settings.hasTrash ? \'private_media.move_to_trash\' : \'private_media.remove_item\' | translate}}" class="action remove"></button></li><li ng-if="entity.can.removeFromFolder()"><button bi-click="{eventName: \'removeFromFolderItemButton.click\', data: {target: entity.id}}" deny-bubbling="mousedown" ng-click="remove.one(entity)" tooltip-append-to-body="true" tooltip="{{\'private_media.remove_item_from_folder\' | translate}}" class="action remove"></button></li><li ng-if="entity.can.edit()"><button bi-click="{eventName: \'editItemButton.click\', data: {target: entity.id}}" deny-bubbling="mousedown" ng-click="editItemInAviary(entity)" tooltip-append-to-body="true" tooltip="{{\'private_media.edit_item\' | translate}}" class="action edit"></button></li><li ng-if="entity.can.getDownloadLink()"><a bi-click="{eventName: \'downloadItemButton.click\', data: {target: entity.id}}" deny-bubbling="mousedown" download="{{entity.name}}" href="{{entity.getDownloadLink()}}" target="_blank" tooltip-append-to-body="true" tooltip="{{\'private_media.download_item\' | translate}}" class="action download"></a></li><li ng-if="entity.can.restore()"><button bi-click="{eventName: \'restoreItemButton.click\', data: {target: entity.id}}" ng-click="entity.restore();" deny-bubbling="mousedown" tooltip-append-to-body="true" tooltip="{{\'private_media.restore_item\' | translate}}" class="action restore"></button></li><li ng-if="entity.can.buy()"><button ng-click="selectAndSubmitItem({item: entity})" class="action price"><span ng-bind-html="price"></span></button></li></ul></li></ul>'),$templateCache.put("scripts/directives/folder-actions/folder-actions.html",'<a deny-bubbling="click" ng-show="folder.can.rename() || folder.can.remove() || folder.can.restore() || folder.can.deleteAll()" popup="{contentClass: \'context-menu\', offsetLeft: 10, offsetTop: 18}" class="actions"></a><div class="context-menu menu"><button bi-click="{eventName: \'renameFolderButton.click\', data: {target: folder.id}}" ng-click="showRenaming()" ng-if="folder.can.rename()" class="rename-folder">{{"private_media.rename_folder" | translate}}</button><button bi-click="{eventName: \'removeFolderButton.click\', data: {target: folder.id}}" ng-click="remove.folder(folder)" ng-if="folder.can.remove()" class="remove-folder">{{"private_media.remove_folder" | translate}}</button><button ng-if="folder.can.restore()" ng-click="folder.restore()" class="restore-all">{{\'private_media.restore_all\' | translate}}</button><button ng-if="folder.can.deleteAll()" ng-click="folder.deleteAll()" class="delete-all">{{\'private_media.empty_trash\' | translate}}</button></div>'),$templateCache.put("scripts/directives/help-popup/help-popup.html",'<div><div ng-show="$help.popupIsVisible" class="inner-popup-underlay"></div><div id="help" ng-if="$help.popupIsVisible" class="inner-popup"><div class="popup-header"><h2><button ng-click="$help.hidePopup()" class="close"></button></h2></div><div class="popup-content"><iframe ng-src="{{$help.url}}" on-load="hideLoader()"></iframe></div><div class="popup-loader loading loaders"><spinner></spinner></div></div></div>'),$templateCache.put("scripts/directives/more-actions-tooltip/show-more.html","<li class=\"show-more\"><button popup=\"{contentClass: 'context-menu', align: 'bottom center', offsetTop: 18, centeredTip: true, event: 'mouseover', parentSelector: options.actionsContainerSelector, parentActiveClass: 'more-actions-visible', containerClass: 'popup-container black'}\" class=\"action show-more\">more</button><ul class=\"context-menu menu more-actions\"></ul></li>"),$templateCache.put("scripts/directives/no-entities/no-entities.html",'<div ng-class="{search: isSearch(), &quot;all-folder&quot;: !selectedFolder, &quot;can-upload&quot;: canUpload, &quot;multiline-description&quot;: adapterType !== &quot;user-owned&quot; &amp;&amp; selectedFolder == allFolder}" class="no-entities {{&quot;no-&quot; + (selectedFolder.mediaType || settings.mediaType)}} {{adapterType}} {{selectedFolder.type}}"><div ng-if="!isSearch()" ng-include="\'scripts/directives/no-entities/no-items-loaded.html\'"></div><div ng-if="isSearch()" ng-include="\'scripts/directives/no-entities/\' + searchTemplate"></div></div>'),$templateCache.put("scripts/directives/no-entities/no-items-loaded.html",'<h3>{{ getHeader() }}</h3><div ng-switch="selectedFolder.type"><div ng-switch-when="siteMedia"><div class="description"><span ng-bind-html="&quot;no_items.text_siteMedia&quot; | unsafe : getDescription()"></span></div></div><div ng-switch-default="ng-switch-default"><div ng-if="canUpload" class="description"><span ng-bind-html="descriptionTranslationKey() | unsafe"></span><div ng-if="showDescriptionLink &amp;&amp; !settings.disableUpload" file-select="uploadFiles({files: files})" class="upload-link">&nbsp;<button>&nbsp;{{ \'uploader.upload\' | translate }}</button><input id="files-input" accept="*" bi-click="{eventName: &quot;noItems.uploadButton.click&quot;,data:{target:selectedFolder.id}}" bi-file-upload="change" multiple="true" name="file" type="file" title=""/></div></div><div ng-if="!canUpload &amp;&amp; getDescription().description" class="description"><span ng-bind-html="getDescription().description | unsafe"></span><button ng-if="getDescription().link" ng-click="changeState(getDescription().state)">&nbsp;{{ getDescription().link | translate }}</button></div></div></div>'),$templateCache.put("scripts/directives/no-entities/no-search-results.html",'\x3c!--h3--\x3e\x3c!--  span(ng-if=\'selectedFolder\')--\x3e\x3c!--    | {{ \'no_search_results_at_folder\' | translate : getSearchQuery() : selectedFolder.name }}--\x3e\x3c!--  span(ng-if=\'!selectedFolder\')--\x3e\x3c!--    | {{ \'no_search_results\' | translate : getSearchQuery() }}--\x3e<div ng-switch="selectedFolder == allFolder"><div ng-switch-when="false"><h3>{{ \'no_search_results.cant_find_at_folder\' | translate : getSearchQuery() : selectedFolder.name }}</h3><div ng-if="allFolder" class="description">{{ \'no_search_results.try_search_at_all\' | translate }}&nbsp;<button ng-click="selectFolder({folder: allFolder})">{{ allFolder.name }}</button></div><div ng-if="!allFolder" class="description">{{ \'no_search_results.use_different_term\' | translate }}</div></div><div ng-switch-when="true"><h3><span ng-bind-html="\'no_search_results.cant_find_at_all\' | unsafe : getSearchQuery()"></span></h3><div class="description"><div class="item">{{ \'no_search_results.check_spelling\' | translate }}</div><div class="item">{{ \'no_search_results.use_different_keywords\' | translate }}</div></div></div></div>'),$templateCache.put("scripts/directives/no-entities/no-user-owned-search-results.html","\x3c!--h3--\x3e\x3c!--  span(ng-if='selectedFolder')--\x3e\x3c!--    | {{ 'no_search_results_at_folder' | translate : getSearchQuery() : selectedFolder.name }}--\x3e\x3c!--  span(ng-if='!selectedFolder')--\x3e\x3c!--    | {{ 'no_search_results' | translate : getSearchQuery() }}--\x3e<div ng-switch=\"selectedFolder == allFolder\"><div ng-switch-when=\"false\"><h3>{{ 'no_search_results.user_owned.cant_find_at_folder' | translate : getSearchQuery() : selectedFolder.name }}</h3><div ng-if=\"allFolder\" class=\"description\">{{ 'no_search_results.user_owned.try_search_at_all' | translate }}&nbsp;<button ng-click=\"selectFolder({folder: allFolder})\">{{ allFolder.name }}</button></div><div ng-if=\"!allFolder\" class=\"description\">{{ 'no_search_results.user_owned.use_different_term' | translate }}</div></div><div ng-switch-when=\"true\"><h3>{{ 'no_search_results.user_owned.cant_find_at_all' | translate : getSearchQuery() }}</h3><div class=\"description\">{{ 'no_search_results.user_owned.use_different_term' | translate }}</div></div></div>"),$templateCache.put("scripts/directives/preview/popup-content.html",'<div ng-class="adapterName" class="popup-content item-preview"><div class="cut"><img ng-show="item.can.showImagePreview()" ng-class="item.mediaType" ng-src="{{item.previewUrl}}"/><div ng-if="item.can.showVideoPreview()" ng-class="item.mediaType"><video ng-attr-poster="{{item.previewUrl}}" preload="none" autoplay="autoplay" loop="loop" muted="muted"><source ng-repeat="videoSource in videoSources" ng-src="{{videoSource}}"/></video></div><div ng-if="item.can.showExternalVideoPreview()" ng-class="item.mediaType"><iframe type="text/html" ng-src="{{iframeSrc}}" frameborder="0" volume="0" allowfullscreen="allowfullscreen"></iframe></div></div><div class="image-data-labels"><p class="name"><span ng-show="item.name" class="label">{{\'item_preview_label.name\' | translate}}</span></p><p ng-show="item.width" class="size"><span class="label">{{\'item_preview_label.size\' | translate}}</span></p><p ng-show="showFolderName &amp;&amp; folderName" class="folder-name"><span class="label">{{\'item_preview_label.folder_name\' | translate}}</span></p><p ng-show="item.isInSiteMedia" class="folder-name"><span class="label">{{\'item_preview_label.uploaded_by\' | translate}}</span></p><p ng-show="item.labels" class="folder-name"><span class="label">{{\'item_preview_label.labels\' | translate}}</span></p></div><div class="image-data-values"><p class="name"><span ng-show="item.name">{{item.name}}</span></p><p ng-show="item.width" class="size"><span>{{item.width}}x{{item.height}}</span></p><p ng-show="showFolderName &amp;&amp; folderName" class="folder-name"><span>{{folderName}}</span></p><p ng-show="item.isInSiteMedia" class="folder-name"><span>{{uploadedBy(item) | translate}} ({{uploadedTime(item)}})</span></p><p ng-show="item.labels" class="folder-name"><span>{{item.labels.join(\', \')}}</span></p></div></div>'),$templateCache.put("scripts/directives/preview/preview.html",'<div popup="{event: &quot;mouseover&quot;, activeClass: &quot;active&quot;, containerClass: &quot;popup-container item-preview-container&quot;, parentSelector: (parentSelector || &quot;li.item&quot;), template: &quot;scripts/directives/preview/popup-content.html&quot;}" class="action item-preview"></div>'),$templateCache.put("scripts/directives/renamable-name/renamable-name.html",'<div class="name"><div folder="entity" folder-long-name="entity" redraw-on-change="redrawOnChange" ng-bind="entity.name.toString()" ng-hide="renameCtrl.isVisible(entity)" class="name-inner"></div><input ng-show="renameCtrl.isVisible(entity)" focus-me="renameCtrl.isVisible(entity)" maxlength="256" ng-blur="renameCtrl.runOrHide(entity, renameCtrl.newName)" ng-model="renameCtrl.newName" on-enter="renameCtrl.run(entity, renameCtrl.newName);" on-esc="renameCtrl.hide()" deny-bubbling="dblclick"/></div>'),$templateCache.put("scripts/directives/spinner/spinner.html",'<svg width="90px" height="90px" viewbox="0 0 66 66" xmlns="http://www.w3.org/2000/svg" class="spinner"><circle fill="none" stroke-width="2" stroke-linecap="round" cx="33" cy="33" r="30" class="path"></circle></svg>'),$templateCache.put("scripts/directives/upload-button/upload-button.html",'<div file-select="uploadFiles({files: files})" ng-show="canUpload" class="upload-button"><input id="files-input" accept="*" bi-click="{eventName: &quot;uploadButton.click&quot;, data: {}}" bi-file-upload="change" multiple="true" name="file" type="file" title=""/><button>{{ \'uploader.upload\' | translate}}</button></div>'),$templateCache.put("scripts/pages/_base/base.html",'<div ng-include="\'scripts/pages/_partials/window-header.html\'" class="header"></div><div drag-highlight="" can-upload="$upload.adapter.can.item.upload()" items-grid-resize="$layouts.selected.itemWidth" class="content"><div class="content-top"><div ng-include="\'scripts/pages/_partials/tabs.html\'" class="tabs"></div><upload-button upload-files="$upload.addFiles(files, getSelectedFolder())" can-upload="tabs.private.canShow() &amp;&amp; !settings.disableUpload" bi-file-upload="change"></upload-button><div ng-include="\'scripts/pages/_partials/group-actions.html\'" class="group-actions"></div><span ng-include="\'scripts/pages/_partials/upload-message.html\'"></span></div><div class="sidebar"><div ng-include="\'scripts/pages/_partials/folders.html\'" class="sidebar-inner"></div></div><div bi-file-upload="drop" drop-files="$upload.addFiles(files)" entities="$nestedEntities.list" can-upload="$upload.adapter.can.item.upload()" ng-class="$layouts.selected.id" reset-scroll-on="$folders.selectedFolder" select-all="" delete-by-key="" when-scrolled-to-bottom="$nestedEntities.more()" droppable="$nestedEntities.moveSelectedToFolder(getSelectedFolder())" can-drop-entities="getSelectedFolder().can.moveItemIn()" class="entities-wrapper"><breadcrumbs list="selectedFoldersPath" action="selectFolderOrNested(folder)" ng-if="settings.hasSubfolders || $nestedEntities.list.length"></breadcrumbs><no-entities ng-class="{\'no-entities-placeholder\':!$searchQuery.query}" selected-folder="getSelectedFolder()" search-query="$searchQuery.query" upload-files="$upload.addFiles(files, getSelectedFolder())" can-upload="getSelectedFolder().can.uploadIn()" ng-show="!$nestedEntities.isLoading &amp;&amp; $nestedEntities.list.length == 0" select-folder="$folders.selectFolder(folder)" all-folder="getAllFolder()" adapter-type="user-owned"></no-entities><div ng-include="\'scripts/pages/_partials/notifications.html\'" class="notifications"></div><div ng-class="{processing: $nestedEntities.$createFolder.isProcessing(true)}" ng-show="$nestedEntities.$createFolder.isVisible(true) || $nestedEntities.$createFolder.isProcessing(true)" class="add-subfolder-input">Subfolder name:<input focus-me="$nestedEntities.$createFolder.isVisible(true)" maxlength="256" ng-blur="$nestedEntities.$createFolder.hide()" ng-model="$nestedEntities.$createFolder.newName" on-enter="$nestedEntities.$createFolder.run($nestedEntities.$createFolder.newName)" on-esc="$nestedEntities.$createFolder.hide()"/></div><entities-grid adapter-name="adapter.name" folder-name-by-id="getFolderNameById(id)" entities="$nestedEntities.list" reset-scroll="getSelectedFolder()" double-click="$nestedEntities.isFolder(entity) ? $nestedEntities.selectFolder(entity) : selectAndSubmitItem(entity)" selected-layout-id="$layouts.selected.id" selected-folder="getSelectedFolder()" move-selected-to-folder="$nestedEntities.moveSelectedToFolder(folder)" rename-ctrl="$nestedEntities.$rename" can-select-multiple="true" remove="$remove" on-all-thumbnails-loaded="measureImagesLoadSpeed()" class="entities-grid"></entities-grid><div ng-include="\'scripts/pages/_partials/loaders.html\'" class="loaders"></div></div></div><div ng-include="\'scripts/pages/_partials/upload-popup.html\'" class="uploader"></div><div ng-include="\'scripts/pages/_partials/footer.html\'" class="footer"></div>'),$templateCache.put("scripts/pages/_partials/confirmation.html",'<div class="header">{{confirmTitle}}</div><div ng-bind-html="confirmMessage" class="text"></div><div class="buttons"><div class="cancel"><button ng-click="closeThisDialog()">{{confirmNo}}</button></div><div class="confirm"><button ng-click="confirm(); closeThisDialog();" autofocus="autofocus">{{confirmYes}}</button></div></div>'),$templateCache.put("scripts/pages/_partials/folders.html",'<div><div ng-class="{\'offset-bottom\': adapter.can.folder.create()}" ng-if="$folders.list.length" droppable="$folders.moveSelectedToFolder(getUnsorted())" can-drop-entities="getUnsorted().can.moveItemIn()" class="folders"><ul><li ng-repeat="folder in $folders.list | orderBy:$folders.sortOrder" bi-click="{eventName: \'folderSelect.click\', data: { target: folder.id }}" ng-class="{current: $folders.selectedFolder.id == folder.id, processing: folder._isProcessing, renaming: $folders.$rename.isVisible(folder), \'virtual-folder\': folder.isVirtual}" ng-click="$folders.selectFolder(folder);filter.parent_folder_id = folder.folder_id" droppable="$folders.moveSelectedToFolder(folder)" can-drop-entities="folder.can.moveItemIn()" draggable="folder" select-entity="folder" can-drag="folder.can.move()" bi-file-upload="drop" drop-files="$upload.addFiles(files, folder)" drag-highlight="" can-upload="$upload.adapter.can.item.upload()" data-id="{{folder.id}}" class="{{settings.mediaType}}{{folder.type ? &quot; &quot; + folder.type : &quot;&quot;}}"><renamable-name entity="folder" rename-ctrl="$folders.$rename"></renamable-name><folder-actions folder="folder" show-renaming="$folders.$rename.show(folder)" remove="$remove"></folder-actions><div ng-click="$event.stopPropagation()" ng-if="isSiteMediaFolder(folder)" wix-tooltip="{{siteMediaTooltip}}" tooltip-class="site-media-folder-tooltip" placement="right" append-to-body="true" class="site-media-folder-tooltip-icon"></div></li><li ng-class="{processing: $folders.$createFolder.isProcessing(true)}" ng-show="$folders.$createFolder.isVisible(true) || $folders.$createFolder.isProcessing(true)" class="add-folder-input"><input focus-me="$folders.$createFolder.isVisible(true)" maxlength="256" ng-blur="$folders.$createFolder.runOrHide(null, $folders.$createFolder.newName)" ng-model="$folders.$createFolder.newName" on-enter="$folders.$createFolder.run($folders.$createFolder.newName)" on-esc="$folders.$createFolder.hide()"/></li></ul></div><button ng-show="adapter.can.folder.create()" bi-click="{eventName: \'newFolderButton.click\', data: {}}" ng-click="$folders.$createFolder.show(true)" class="add-folder">{{\'private_media.create_folder\' | translate}}</button></div>'),
$templateCache.put("scripts/pages/_partials/footer.html",'<div class="submit"><button bi-click="{eventName: \'chooseButton.click\', data: {}}" ng-class="{disabled: !canSubmitItems()}" ng-click="submitItems()" ng-show="settings.submitItems" title="{{submitItemsTooltip()}}">{{footerSubmitTranslationKey | translate}}</button></div><div ng-if="$upload.getFilesQueue().length" ng-class="{\'has-failed\': $upload.hasFailedFiles(), \'in-progress\': $upload.hasInProgress(), maximize: $upload.popupIsVisible, minimize: !$upload.popupIsVisible}" ng-click="$upload.showPopup()" class="upload-status"><div class="title">{{$upload.hasInProgress() ? \'uploader.uploading\' : \'uploader.uploaded\' | translate}}&nbsp;<span class="numbers">({{$upload.succeededFilesCount()}}/{{$upload.allFilesCount()}}<span ng-switch="$upload.allFilesCount() &gt; 1"><span ng-switch-when="true">{{\'uploader.files\' | translate}})</span><span ng-switch-when="false">{{\'uploader.file\' | translate}})</span></span></span></div><div ng-show="$upload.hasInProgress()" class="progress-bar"><div ng-style="{\'width\': $upload.totalProgressPercent + \'%\'}" class="progress"></div></div><div ng-show="$upload.failedFilesCount() &gt; 0" class="fails"><span ng-if="$upload.failedFilesCount() - $upload.cancelledFilesCount() &gt; 0" class="failed-count">{{$upload.failedFilesCount() - $upload.cancelledFilesCount()}}<span ng-switch="$upload.failedFilesCount() - $upload.cancelledFilesCount() &gt; 1"><span ng-switch-when="true">{{\'uploader.errors\' | translate}}</span><span ng-switch-when="false">{{\'uploader.error\' | translate}}</span></span></span></div><button ng-click="$upload.showPopup()" class="show-upload-popup">{{\'uploader.footer.view_details\' | translate}}</button></div><div ng-show="selectedEntitiesCount()" ng-switch="selectedEntitiesCount() &gt; 1" class="selected-items-size"><span ng-switch-when="true">{{\'many_selected_items\' | translate:selectedEntitiesCount()}}</span><span ng-switch-when="false">{{\'one_selected_item\' | translate:selectedEntitiesCount()}}</span></div>'),$templateCache.put("scripts/pages/_partials/group-actions.html",'<ul><li ng-show="settings.hasSubfolders &amp;&amp; adapter.can.folder.create() &amp;&amp; $folders.selectedFolder.id &amp;&amp; $folders.selectedFolder.parentId"><div class="add-subfolder"><button ng-click="$nestedEntities.$createFolder.show(true)">{{\'private_media.create_subfolder\' | translate}}</button></div></li><li ng-show="isSomeRemovable() &amp;&amp; adapter.can.items.remove() &amp;&amp; selectedEntitiesCount() &amp;&amp; !$nestedEntities.isLoading &amp;&amp; $nestedEntities.list.length" class="remove-item"><div class="delete"><button ng-click="$remove.selected($nestedEntities, selectedEntities)">{{deleteButtonText() | translate}}</button></div></li><li ng-show="$nestedEntities.$orientation" class="orientation-switch-wrapper"><button ng-class="{ current : $nestedEntities.$orientation.selected == orientation }" ng-click="$nestedEntities.$orientation.select(orientation)" ng-repeat="orientation in $nestedEntities.$orientation.list" title="{{\'orientation.\' + orientation.name | translate}}" class="action orientation {{orientation.name}}"></button></li><li ng-show="$nestedEntities.sortOrder"><div popup="{containerClass: \'popup-container dropdown\', contentClass:\'sort-options\',  align: \'bottom center\', offsetTop: 22, centeredTip: true}" class="action change-sort-order">{{\'sort_order.title\' | translate}} {{$nestedEntities.sortOrder.selected.name}}</div><div class="sort-options menu centered-tip"><div ng-repeat="sortOption in $nestedEntities.sortOrder.list"><button ng-class="{current: sortOption == $nestedEntities.sortOrder.selected}" ng-click="$nestedEntities.sortOrder.select(sortOption)">{{sortOption.name}}</button></div></div></li><li ng-show="!isSelectedSiteMediaFolder() &amp;&amp; adapter.items.search" class="search"><form><input ng-class="{fail: !$nestedEntities.isLoading &amp;&amp; $nestedEntities.list.length == 0 &amp;&amp; $searchQuery.query &amp;&amp; $searchQuery.currentQuery == $searchQuery.query}" ng-model="$searchQuery.currentQuery" on-enter="$searchQuery.query = $searchQuery.currentQuery; $nestedEntities.load()" placeholder="{{\'search\' | translate}}" type="text"/><input ng-click="$searchQuery.currentQuery = \'\'; $searchQuery.query = \'\'; $nestedEntities.load()" ng-show="$searchQuery.currentQuery &amp;&amp; $searchQuery.currentQuery == $searchQuery.query" type="reset" value="x"/><input ng-click="$searchQuery.query = $searchQuery.currentQuery; $nestedEntities.load()" ng-show="$searchQuery.currentQuery != $searchQuery.query" type="submit" value=""/></form></li><li ng-show="$layouts &amp;&amp; !$services.isAllDisconnected()"><div popup="{containerClass: \'popup-container dropdown\', contentClass: \'layout-options\', align: \'bottom center\', offsetTop: 22, centeredTip: true}" class="action switch-grid"><button ng-class="$layouts.selected.id" class="selected">switch</button><div class="layout-options menu"><ul><li ng-repeat="layout in $layouts.list"><button ng-class="{current: $layouts.selected.id == layout.id}" ng-click="$layouts.select(layout)" class="{{layout.id}}">{{layout.name}}</button></li></ul></div></div></li></ul>'),$templateCache.put("scripts/pages/_partials/import.html",'<div ng-show="isImporting" class="import"><div class="loading"><div class="spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>{{ importingCount == 1 ? \'external_media.importing_single.header\' : \'external_media.importing.header\' | translate}}</div><div ng-style="{width: (getImportingProgress() * 100) + \'%\'}" class="progress"></div></div>'),$templateCache.put("scripts/pages/_partials/loaders.html",'<div ng-if="$folders.isLoading" class="loading folders"><spinner></spinner></div><div ng-if="($folders.selectedFolder || !$folders) &amp;&amp; !$nestedEntities.list.length &amp;&amp; $nestedEntities.isLoading" class="loading items"><spinner></spinner></div><div ng-if="($folders.selectedFolder || !$folders) &amp;&amp; $nestedEntities.list.length &amp;&amp; $nestedEntities.isLoading" class="loading items more"><spinner></spinner></div>'),$templateCache.put("scripts/pages/_partials/notifications.html",'<ul ng-show="$notifications.list.length &gt; 0"><li ng-repeat="notification in $notifications.list track by notification.id" class="{{notification.type}}"><span>{{notification.message}}</span><button ng-click="$notifications.expire(notification)" class="expire-notification"></button></li></ul>'),$templateCache.put("scripts/pages/_partials/tabs.html",'<ul ng-show="settings.showTabs"><li><button bi-click="{eventName: \'tabSelect.click\', data: {target: tabId}}" ng-class="{active: isActiveTab(tabs[tabId])}" ng-repeat="tabId in settings.tabsList" ng-show="tabs[tabId].canShow()" ui-sref="{{tabs[tabId].state}}"><span ng-if="tabs[tabId].translationKey">{{tabs[tabId].translationKey | translate}}</span><span ng-if="tabs[tabId].getTitle()">{{tabs[tabId].getTitle()}}</span></button></li></ul>'),$templateCache.put("scripts/pages/_partials/upload-message.html",'<div ng-show="!!$upload &amp;&amp; descriptionTranslationKey" title="{{ descriptionTranslationKey | translate : $upload.getFileSizeLimit().size : $upload.getFileSizeLimit().sizeType }}" class="upload-message">{{ descriptionTranslationKey | translate : $upload.getFileSizeLimit().size : $upload.getFileSizeLimit().sizeType }}</div>'),$templateCache.put("scripts/pages/_partials/upload-popup.html",'<div ng-show="$upload.popupIsVisible" ng-click="$upload.hidePopup()" class="inner-popup-underlay"></div><div id="uploader" ng-if="$upload.getFilesQueue().length &amp;&amp; ($upload.isMinimization || $upload.popupIsVisible)" bi-file-upload="drop" drop-files="$upload.addFiles(files, adapter.name === &quot;private&quot; ? $folders.selectedFolder : null)" can-upload="$upload.adapter.can.item.upload()" ng-class="{&quot;has-failed&quot;: $upload.hasFailedFiles(), &quot;in-progress&quot;: $upload.hasInProgress(), minimize: $upload.isMinimization}" class="inner-popup"><div class="popup-header"><h2>{{$upload.hasInProgress() ? \'uploader.uploading\' : \'uploader.uploaded\' | translate}}<span class="numbers">&nbsp;({{$upload.succeededFilesCount()}}/{{$upload.allFilesCount()}}<span ng-switch="$upload.allFilesCount() &gt; 1"><span ng-switch-when="true">{{\'uploader.files\' | translate}})</span><span ng-switch-when="false">{{\'uploader.file\' | translate}})</span></span></span><span ng-if="$upload.failedFilesCount() - $upload.cancelledFilesCount() &gt; 0" class="fails">&nbsp;-&nbsp;<span class="failed-count">{{$upload.failedFilesCount() - $upload.cancelledFilesCount()}}<span ng-switch="$upload.failedFilesCount() - $upload.cancelledFilesCount() &gt; 1"><span ng-switch-when="true">{{\'uploader.errors\' | translate}}</span><span ng-switch-when="false">{{\'uploader.error\' | translate}}</span></span></span></span><div ng-click="$upload.hidePopup()" class="close"></div></h2><div ng-show="$upload.hasInProgress()" class="progress-bar"><div ng-style="{&quot;width&quot;: $upload.totalProgressPercent + &quot;%&quot;}" class="progress"></div></div><div class="message">{{\'uploader.popup_message\' | translate}}</div></div><div class="popup-content"><div class="uploads-list"><ul><li ng-class="{cancelled: $upload.isCancelled(fileToUpload)}" ng-repeat="fileToUpload in $upload.getFilesQueue()" class="{{fileToUpload.status}}"><div ng-click="fileToUpload.abort()" ng-show="$upload.canCancelUpload(fileToUpload) &amp;&amp; fileToUpload.canAbort()" class="cancel-file"></div><div ng-show="fileToUpload.status === &quot;succeeded&quot;" class="success">&check;</div><div ng-click="fileToUpload.signUpForRetry()" ng-show="!$upload.isInProgress(fileToUpload) &amp;&amp; fileToUpload.canRetry() &amp;&amp; !$upload.isFolder(fileToUpload)" class="retry">&nbsp;{{\'uploader.retry\' | translate}}</div><div thumb="fileToUpload.source.file" media-type="fileToUpload.source.mediaType" class="item-preview {{fileToUpload.source.mediaType}}"><div ng-show="fileToUpload.status === &quot;uploading&quot;" class="progress-number">{{ (fileToUpload.bytesLoaded/fileToUpload.source.file.size) * 100 | number : 0 }}%</div><div ng-show="fileToUpload.status === &quot;processing&quot;" class="progress-processing"></div><div ng-show="$upload.isInProgress(fileToUpload) &amp;&amp; !$upload.isWaiting(fileToUpload)" ng-style="{width: ((fileToUpload.bytesLoaded/fileToUpload.source.file.size) * 100 | number : 0) + &quot;%&quot;}" class="progress"></div></div><div class="item-wrapper"><div class="item-inner"><div title="{{fileToUpload.source.file.name.length &gt; 40 ? fileToUpload.source.file.name : &quot;&quot;}} " class="item-name">{{fileToUpload.source.file.name}}</div><div ng-switch="fileToUpload.status === &quot;failed&quot;" class="item-description"><div ng-switch-when="false" class="item-size"><span ng-bind="($upload.getReadableFileSize(fileToUpload.bytesLoaded).size | number : 0) + $upload.getReadableFileSize(fileToUpload.bytesLoaded).sizeType"></span></div><div ng-switch-when="false" ng-show="fileToUpload.source.folderName.length &lt; 30" class="item-folder"><span ng-show="$upload.isInProgress(fileToUpload)">&nbsp;{{\'uploader.of\' | translate}}&nbsp;<span ng-bind="($upload.getReadableFileSize(fileToUpload.source.file.size).size | number : 0) + $upload.getReadableFileSize(fileToUpload.source.file.size).sizeType"></span></span>&nbsp;<span class="item-folder-description">{{\'uploader.uploaded_to_folder\' | translate : fileToUpload.source.folderName}}</span></div><div ng-switch-when="false" ng-show="fileToUpload.source.folderName.length &gt; 30" title="{{&quot;uploader.uploaded_to_folder&quot; | translate : fileToUpload.source.folderName}}" class="item-folder"><span ng-show="$upload.isInProgress(fileToUpload)">&nbsp;{{\'uploader.of\' | translate}}&nbsp;<span ng-bind="($upload.getReadableFileSize(fileToUpload.source.file.size).size | number : 0) + $upload.getReadableFileSize(fileToUpload.source.file.size).sizeType"></span></span>&nbsp;</div><div ng-switch-when="true" class="item-folder"><span title="{{$upload.translateError(fileToUpload)}}" class="item-folder-description">{{$upload.translateError(fileToUpload)}}</span></div></div></div></div></li></ul></div></div><div class="popup-footer"><div ng-click="$upload.hidePopup()" class="close">{{\'uploader.hide\' | translate}}</div><div ng-click="$upload.confirmAbortAll()" ng-show="$upload.hasInProgress() &amp;&amp; $upload.hasAbortable()" class="cancel-upload">{{\'uploader.cancel_all\' | translate}}</div><div ng-click="$upload.retryAll()" ng-show="$upload.hasRetryable() &amp;&amp; !$upload.hasInProgress()" class="retry-all">{{\'uploader.retry_all\' | translate}}</div></div></div>'),$templateCache.put("scripts/pages/_partials/window-header.html",'<h1>{{\'header\' | translate}}<button bi-click="{ eventName: \'closeButton.click\', data: {} }" ng-click="closeWindow()" class="close"></button><button bi-click="{ eventName: \'helpButton.click\', data: {} }" ng-click="$help.showPopup()" class="help">| ?</button></h1><help-popup></help-popup>'),$templateCache.put("scripts/pages/app.html",'<link ng-href="{{settings.cssUrl}}" ng-if="settings.cssUrl" rel="stylesheet"/><div ui-view="" class="window-wrapper {{settings.windowStyle}}{{settings.showTabs ? \'\' : \' without-tabs\'}}"></div>'),$templateCache.put("scripts/pages/custom/custom.html",'<div ng-include="\'scripts/pages/_partials/window-header.html\'" class="header"></div><div drag-highlight="" can-upload="$upload.adapter.can.item.upload()" items-grid-resize="$layouts.selected.itemWidth" class="content"><div class="content-top custom-tab-top"><div ng-include="\'scripts/pages/_partials/tabs.html\'" class="tabs"></div><upload-button upload-files="$upload.addFiles(files, getSelectedFolder())" can-upload="tabs.private.canShow() &amp;&amp; !settings.disableUpload" bi-file-upload="change"></upload-button></div><div class="custom-tab-content-wrapper"><div class="custom-tab-content"><div ng-repeat="section in sections" ng-if="showSection(section)" class="custom-tab-section"><div class="custom-tab-section-header"><div class="custom-tab-section-title">{{section.title}}</div></div><div class="custom-tab-section-content-wrapper"><div ng-repeat="item in section.data track by item.id" ng-click="toggle(item)" ng-dblclick="selectAndSubmitItem(item)" ng-selected="isSelected(item)" class="content-item"><div class="item-name">{{item.name}}</div><div class="items-actions"><div class="actions"><preview item="item" parent-selector=".content-item"></preview></div></div><img ng-src="{{item.thumbnailUrl}}" width="128" height="128"/></div><a ui-sref="app.{{section.action.url.split(&quot;/&quot;)[0]}}" ng-if="showAction(section)" class="custom-tab-section-action"><div class="content-item custom-tab-section-action">{{section.action.title}}</div></a></div></div></div><div ng-include="\'scripts/pages/_partials/loaders.html\'" class="loaders"></div></div></div><div ng-include="\'scripts/pages/_partials/footer.html\'" class="footer"></div>'),$templateCache.put("scripts/pages/empty/empty.html",'<div ng-include="\'scripts/pages/_partials/window-header.html\'" class="header"></div><div class="content"><div class="content-top"><div ng-include="\'scripts/pages/_partials/tabs.html\'" class="tabs"></div><upload-button upload-files="$upload.addFiles(files, getSelectedFolder())" can-upload="tabs.private.canShow() &amp;&amp; !settings.disableUpload" bi-file-upload="change"></upload-button></div></div><div ng-include="\'scripts/pages/_partials/footer.html\'" class="footer"></div>'),$templateCache.put("scripts/pages/external-search/_partials/intro.html",'<div ng-hide="$searchQuery.query" class="start-work"><h3>{{ \'external_search.start_work.header\' | translate }}</h3><div class="description">{{ \'external_search.start_work.description\' | translate }}</div><div ng-class="&quot;search-&quot; + settings.mediaType"></div></div>'),$templateCache.put("scripts/pages/external-search/_partials/services-list.html",'<div class="folders"><ul><li ng-class="{current: $services.selected == service}" ng-repeat="service in $services.list"><button ng-class="service.id" ng-click="$services.select(service)" class="name service">{{service.name}}</button></li></ul></div>'),$templateCache.put("scripts/pages/external-search/external-search.html",'<div ng-include="\'scripts/pages/_partials/window-header.html\'" class="header"></div><div items-grid-resize="$layouts.selected.itemWidth + $services.selected.id" class="content"><div class="content-top"><div ng-include="\'scripts/pages/_partials/tabs.html\'" class="tabs"></div><upload-button upload-files="$upload.addFiles(files)" can-upload="tabs.private.canShow() &amp;&amp; !settings.disableUpload" bi-file-upload="change"></upload-button><div ng-include="\'scripts/pages/_partials/group-actions.html\'" class="group-actions"></div><span ng-include="\'scripts/pages/_partials/upload-message.html\'"></span></div><div class="sidebar"><div ng-include="\'scripts/pages/external-search/_partials/services-list.html\'" class="sidebar-inner"></div></div><div bi-file-upload="drop" drop-files="$upload.addFiles(files)" can-upload="$upload.adapter.can.item.upload()" ng-class="$layouts.selected.id" when-scrolled-to-bottom="$nestedEntities.more()" class="entities-wrapper"><breadcrumbs list="[$services.selected]"></breadcrumbs><no-entities search-query="$searchQuery.query" upload-files="$upload.addFiles(files)" can-upload="$upload.adapter.can.item.upload()" ng-show="$nestedEntities.list.length == 0"></no-entities><div ng-include="\'scripts/pages/external-search/_partials/intro.html\'"></div><div ng-include="\'scripts/pages/_partials/notifications.html\'" class="notifications"></div><entities-grid adapter-name="adapter.name" entities="$nestedEntities.list" ng-if="$searchQuery.query" double-click="selectAndSubmitItem(entity)" selected-layout-id="$layouts.selected.id" can-select-multiple="true" class="entities-grid"></entities-grid><div ng-include="\'scripts/pages/_partials/loaders.html\'" class="loaders"></div></div><div ng-include="\'scripts/pages/_partials/import.html\'"></div></div><div ng-include="\'scripts/pages/_partials/upload-popup.html\'" class="uploader"></div><div ng-include="\'scripts/pages/_partials/footer.html\'" class="footer"></div>'),$templateCache.put("scripts/pages/external/_partials/connect-service.html",'<div class="services-intro"><div ng-class="settings.mediaType"></div><h2>{{\'external_media.no_services.connect\' | translate : $services.selected.name}}</h2><h3>{{\'external_media.no_services.service_header2\' | translate : $services.selected.name}}</h3><button bi-click="{eventName: \'socialService.connectButton.click\', data: { target: $services.selected.id}}" ng-click="$services.connect($services.selected)" class="connect-service {{$services.selected.translationKey || $services.selected.id}}">{{\'external_media.no_services.connect\' | translate : $services.selected.name}}</button></div>'),$templateCache.put("scripts/pages/external/_partials/intro.html",'<div class="services-intro-wrapper"><div class="services-intro large"><h2>{{\'external_media.no_services.header1\' | translate}}</h2><h3>{{\'external_media.no_services.header2\' | translate}}</h3><div ng-class="{\'one-child\':$services.disconnectedList().length == 1}" class="services"><button ng-repeat="service in $services.disconnectedList()" bi-click="{eventName: \'socialService.connectButton.click\', data: { target: service.id}}" ng-click="$services.connect(service)" class="{{service.translationKey || service.id}}">{{service.name}}</button></div></div></div>'),$templateCache.put("scripts/pages/external/_partials/services.html",'<div class="folders"><ul class="services"><li ng-class="{current: $services.selected.id == service.id}" ng-repeat="service in $services.list"><button ng-click="$services.select(service)" class="name service {{service.translationKey}}">{{service.name}}</button><div popup="{contentClass: \'context-menu\', offsetLeft: 10, offsetTop: 18}" class="actions"><div ng-switch="$services.isConnected(service)" class="context-menu context-menu menu"><button ng-click="$services.disconnect(service)" ng-switch-when="true" class="disconnect">{{"external_media.services_list.disconnect" | translate}}</button><button ng-click="$services.connect(service)" ng-switch-when="false" class="connect">{{"external_media.services_list.connect" | translate}}</button></div></div></li></ul></div>'),$templateCache.put("scripts/pages/external/external.html",'<div ng-include="\'scripts/pages/_partials/window-header.html\'" class="header"></div>{{$services.selected.name}}<div items-grid-resize="$layouts.selected.itemWidth + $services.selected.id" class="content"><div class="content-top"><div ng-include="\'scripts/pages/_partials/tabs.html\'" class="tabs"></div><upload-button upload-files="$upload.addFiles(files, getSelectedFolder())" can-upload="tabs.private.canShow() &amp;&amp; !settings.disableUpload" bi-file-upload="change"></upload-button><div ng-include="\'scripts/pages/_partials/group-actions.html\'" class="group-actions"></div><span ng-include="\'scripts/pages/_partials/upload-message.html\'"></span></div><div ng-hide="$services.isAllDisconnected()" class="sidebar"><div ng-include="\'scripts/pages/external/_partials/services.html\'" class="sidebar-inner"></div></div><div bi-file-upload="drop" drop-files="$upload.addFiles(files)" can-upload="$upload.adapter.can.item.upload()" ng-if="$services.selected &amp;&amp; !$services.isAllDisconnected()" ng-class="$layouts.selected.id" when-scrolled-to-bottom="getSelectedFolder() ? $nestedEntities.more() : null" select-all="" class="entities-wrapper"><breadcrumbs list="breadcrumbsList()" action="selectFolderOrService(folder)" ng-if="($services.selected &amp;&amp; $services.isConnected($services.selected)) || $folders.list.length"></breadcrumbs><div ng-class="&quot;no-&quot; + settings.mediaType" ng-show="$nestedEntities.list.length == 0 &amp;&amp; $services.isConnected($services.selected) &amp;&amp; !isLoading" class="no-entities"><h3>{{ \'no_social_items_in_folder\' | translate : getSelectedFolderOrServiceName() }}</h3></div><div ng-include="\'scripts/pages/_partials/notifications.html\'" class="notifications"></div><entities-grid ng-show="$services.isConnected($services.selected)" adapter-name="adapter.name" folder-name-by-id="$folders.nameById(id) || $nestedEntities.nameById(id)" entities="$nestedEntities.list" reset-scroll="getSelectedFolder()" click="$nestedEntities.isFolder(entity) ? $nestedEntities.selectFolder(entity) : &quot;&quot; " double-click="$nestedEntities.isFolder(entity) ? $nestedEntities.selectFolder(entity) : selectAndSubmitItem(entity)" selected-layout-id="$layouts.selected.id" selected-folder="getSelectedFolder()" move-selected-to-folder="$nestedEntities.moveSelectedToFolder(folder)" rename-ctrl="$nestedEntities.$rename" can-select-multiple="true" class="entities-grid"></entities-grid><div ng-include="\'scripts/pages/_partials/loaders.html\'" class="loaders"></div><div ng-if="!$services.isConnected($services.selected)" ng-include="\'scripts/pages/external/_partials/connect-service.html\'"></div></div><div ng-if="$services.isAllDisconnected()" ng-include="\'scripts/pages/external/_partials/intro.html\'"></div><div ng-include="\'scripts/pages/_partials/import.html\'"></div></div><div ng-include="\'scripts/pages/_partials/upload-popup.html\'" class="uploader"></div><div ng-include="\'scripts/pages/_partials/footer.html\'" class="footer"></div>'),$templateCache.put("scripts/pages/photo-stock/photo-stock.html",'<div ng-include="\'scripts/pages/_partials/window-header.html\'" class="header"></div><div items-grid-resize="$layouts.selected.itemWidth" class="content"><div class="content-top"><div ng-include="\'scripts/pages/_partials/tabs.html\'" class="tabs"></div><upload-button upload-files="$upload.addFiles(files, getSelectedFolder())" can-upload="tabs.private.canShow() &amp;&amp; !settings.disableUpload" bi-file-upload="change"></upload-button><div ng-include="\'scripts/pages/_partials/group-actions.html\'" class="group-actions"></div><span ng-include="\'scripts/pages/_partials/upload-message.html\'"></span></div><div ng-include="\'scripts/pages/public/_partials/parent-folders.html\'" class="parent-folders"></div><div class="sidebar"><div ng-include="\'scripts/pages/_partials/folders.html\'" class="sidebar-inner"></div></div><div bi-file-upload="drop" drop-files="$upload.addFiles(files)" can-upload="$upload.adapter.can.item.upload()" ng-class="$layouts.selected.id" reset-scroll-on="$folders.selectedFolder" when-scrolled-to-bottom="$nestedEntities.more()" class="entities-wrapper"><breadcrumbs list="[$folders.selectedFolder]" ng-if="$nestedEntities.list.length || settings.hasSubfolders"></breadcrumbs><no-entities selected-folder="$folders.selectedFolder" search-query="$searchQuery.query" upload-files="$upload.addFiles(files)" can-upload="adapter.can.items.upload()" ng-show="$nestedEntities.list.length == 0" all-folder="getAllFolder()" select-folder="$folders.selectFolder(folder)"></no-entities><div ng-include="\'scripts/pages/_partials/notifications.html\'" class="notifications"></div><entities-grid adapter-name="adapter.name" folder-name-by-id="$folders.nameById(id)" entities="$nestedEntities.list" reset-scroll="$folders.selectedFolder" select-and-submit-item="selectAndSubmitItem(item)" double-click="$nestedEntities.isFolder(entity) ? $nestedEntities.selectFolder(entity) : selectAndSubmitItem(entity)" selected-layout-id="$layouts.selected.id" selected-folder="$folders.selectedFolder" can-select-multiple="false" class="entities-grid"></entities-grid><div ng-include="\'scripts/pages/_partials/loaders.html\'" class="loaders"></div></div></div><div ng-include="\'scripts/pages/_partials/upload-popup.html\'" class="uploader"></div><div ng-include="\'scripts/pages/_partials/footer.html\'" class="footer"></div>'),$templateCache.put("scripts/pages/platform/platform.html",'<div ng-include="\'scripts/pages/_partials/window-header.html\'" class="header"></div><div drag-highlight="" can-upload="$upload.adapter.can.item.upload()" items-grid-resize="$layouts.selected.itemWidth" class="content"><div class="content-top"><div ng-include="\'scripts/pages/_partials/tabs.html\'" class="tabs"></div><upload-button upload-files="$upload.addFiles(files, getSelectedFolder())" can-upload="tabs.platform.canShow() &amp;&amp; !settings.disableUpload" bi-file-upload="change"></upload-button><div ng-include="\'scripts/pages/_partials/group-actions.html\'" class="group-actions"></div><span ng-include="\'scripts/pages/_partials/upload-message.html\'"></span></div><div class="sidebar"><div ng-include="\'scripts/pages/_partials/folders.html\'" class="sidebar-inner"></div></div><div bi-file-upload="drop" drop-files="$upload.addFiles(files, $folders.selectedFolder)" entities="$nestedEntities.list" can-upload="$upload.adapter.can.item.upload()" ng-class="$layouts.selected.id" reset-scroll-on="$folders.selectedFolder" select-all="" delete-by-key="" when-scrolled-to-bottom="$nestedEntities.more()" droppable="$nestedEntities.moveSelectedToFolder(getSelectedFolder())" can-drop-entities="getSelectedFolder().can.moveItemIn()" class="entities-wrapper"><breadcrumbs list="selectedFoldersPath" action="selectFolderOrNested(folder)" ng-if="settings.hasSubfolders || $nestedEntities.list.length"></breadcrumbs><no-entities ng-class="{\'no-entities-placeholder\':!$searchQuery.query}" selected-folder="getSelectedFolder()" search-query="$searchQuery.query" upload-files="$upload.addFiles(files, getSelectedFolder())" can-upload="getSelectedFolder().can.uploadIn()" ng-show="!$nestedEntities.isLoading &amp;&amp; $nestedEntities.list.length == 0" select-folder="$folders.selectFolder(folder)" all-folder="getAllFolder()" adapter-type="user-owned" show-description-link="showNoEntitiesDescriptionLink()"></no-entities><div ng-include="\'scripts/pages/_partials/notifications.html\'" class="notifications"></div><div ng-class="{processing: $nestedEntities.$createFolder.isProcessing(true)}" ng-show="$nestedEntities.$createFolder.isVisible(true) || $nestedEntities.$createFolder.isProcessing(true)" class="add-subfolder-input">Subfolder name:<input focus-me="$nestedEntities.$createFolder.isVisible(true)" maxlength="256" ng-blur="$nestedEntities.$createFolder.hide()" ng-model="$nestedEntities.$createFolder.newName" on-enter="$nestedEntities.$createFolder.run($nestedEntities.$createFolder.newName)" on-esc="$nestedEntities.$createFolder.hide()"/></div><entities-grid adapter-name="adapter.name" folder-name-by-id="getFolderNameById(id)" entities="$nestedEntities.list" reset-scroll="getSelectedFolder()" double-click="$nestedEntities.isFolder(entity) ? $nestedEntities.selectFolder(entity) : selectAndSubmitItem(entity)" selected-layout-id="$layouts.selected.id" selected-folder="getSelectedFolder()" move-selected-to-folder="$nestedEntities.moveSelectedToFolder(folder)" rename-ctrl="$nestedEntities.$rename" can-select-multiple="true" remove="$remove" on-all-thumbnails-loaded="measureImagesLoadSpeed()" class="entities-grid"></entities-grid><div ng-include="\'scripts/pages/_partials/loaders.html\'" class="loaders"></div></div></div><div ng-include="\'scripts/pages/_partials/upload-popup.html\'" class="uploader"></div><div ng-include="\'scripts/pages/_partials/footer.html\'" class="footer"></div>'),
$templateCache.put("scripts/pages/private/private.html",'<div ng-include="\'scripts/pages/_partials/window-header.html\'" class="header"></div><div drag-highlight="" can-upload="$upload.adapter.can.item.upload()" items-grid-resize="$layouts.selected.itemWidth" class="content"><div class="content-top"><div ng-include="\'scripts/pages/_partials/tabs.html\'" class="tabs"></div><upload-button upload-files="$upload.addFiles(files, getSelectedFolder())" can-upload="tabs.private.canShow() &amp;&amp; !settings.disableUpload" bi-file-upload="change"></upload-button><div ng-include="\'scripts/pages/_partials/group-actions.html\'" class="group-actions"></div><span ng-include="\'scripts/pages/_partials/upload-message.html\'"></span></div><div class="sidebar"><div ng-include="\'scripts/pages/_partials/folders.html\'" class="sidebar-inner"></div></div><div bi-file-upload="drop" drop-files="$upload.addFiles(files, $folders.selectedFolder)" entities="$nestedEntities.list" can-upload="$upload.adapter.can.item.upload()" ng-class="$layouts.selected.id" reset-scroll-on="$folders.selectedFolder" select-all="" delete-by-key="" when-scrolled-to-bottom="$nestedEntities.more()" droppable="$nestedEntities.moveSelectedToFolder(getSelectedFolder())" can-drop-entities="getSelectedFolder().can.moveItemIn()" class="entities-wrapper"><breadcrumbs list="selectedFoldersPath" action="selectFolderOrNested(folder)" ng-if="settings.hasSubfolders || $nestedEntities.list.length"></breadcrumbs><no-entities ng-class="{\'no-entities-placeholder\':!$searchQuery.query}" selected-folder="getSelectedFolder()" search-query="$searchQuery.query" upload-files="$upload.addFiles(files, getSelectedFolder())" can-upload="getSelectedFolder().can.uploadIn()" ng-show="!$nestedEntities.isLoading &amp;&amp; $nestedEntities.list.length == 0" select-folder="$folders.selectFolder(folder)" all-folder="getAllFolder()" adapter-type="user-owned"></no-entities><div ng-include="\'scripts/pages/_partials/notifications.html\'" class="notifications"></div><div ng-class="{processing: $nestedEntities.$createFolder.isProcessing(true)}" ng-show="$nestedEntities.$createFolder.isVisible(true) || $nestedEntities.$createFolder.isProcessing(true)" class="add-subfolder-input">Subfolder name:<input focus-me="$nestedEntities.$createFolder.isVisible(true)" maxlength="256" ng-blur="$nestedEntities.$createFolder.hide()" ng-model="$nestedEntities.$createFolder.newName" on-enter="$nestedEntities.$createFolder.run($nestedEntities.$createFolder.newName)" on-esc="$nestedEntities.$createFolder.hide()"/></div><entities-grid adapter-name="adapter.name" folder-name-by-id="getFolderNameById(id)" entities="$nestedEntities.list" reset-scroll="getSelectedFolder()" double-click="$nestedEntities.isFolder(entity) ? $nestedEntities.selectFolder(entity) : selectAndSubmitItem(entity)" selected-layout-id="$layouts.selected.id" selected-folder="getSelectedFolder()" move-selected-to-folder="$nestedEntities.moveSelectedToFolder(folder)" rename-ctrl="$nestedEntities.$rename" can-select-multiple="true" remove="$remove" on-all-thumbnails-loaded="measureImagesLoadSpeed()" class="entities-grid"></entities-grid><div ng-include="\'scripts/pages/_partials/loaders.html\'" class="loaders"></div></div></div><div ng-include="\'scripts/pages/_partials/upload-popup.html\'" class="uploader"></div><div ng-include="\'scripts/pages/_partials/footer.html\'" class="footer"></div>'),$templateCache.put("scripts/pages/public/_partials/parent-folders.html",'<ul><li ng-class="{current: $parentFolders.selectedFolder.id == folder.id}" ng-repeat="folder in $parentFolders.list"><button ng-click="$parentFolders.selectFolder(folder)">{{folder.name}}</button></li></ul>'),$templateCache.put("scripts/pages/public/public.html",'<div ng-include="\'scripts/pages/_partials/window-header.html\'" class="header"></div><div items-grid-resize="$layouts.selected.itemWidth" class="content"><div class="content-top"><div ng-include="\'scripts/pages/_partials/tabs.html\'" class="tabs"></div><upload-button upload-files="$upload.addFiles(files, getSelectedFolder())" can-upload="tabs.private.canShow() &amp;&amp; !settings.disableUpload" bi-file-upload="change"></upload-button><div ng-include="\'scripts/pages/_partials/group-actions.html\'" class="group-actions"></div><span ng-include="\'scripts/pages/_partials/upload-message.html\'"></span></div><div ng-include="\'scripts/pages/public/_partials/parent-folders.html\'" class="parent-folders"></div><div class="sidebar"><div ng-include="\'scripts/pages/_partials/folders.html\'" class="sidebar-inner"></div></div><div bi-file-upload="drop" drop-files="$upload.addFiles(files)" can-upload="$upload.adapter.can.item.upload()" ng-class="$layouts.selected.id" reset-scroll-on="$folders.selectedFolder" when-scrolled-to-bottom="$nestedEntities.more()" class="entities-wrapper"><breadcrumbs list="[$parentFolders.selectedFolder, $folders.selectedFolder]" action="$folders.selectFolder($folders.list[0])" ng-if="$nestedEntities.list.length || settings.hasSubfolders"></breadcrumbs><no-entities selected-folder="$folders.selectedFolder" search-query="$searchQuery.query" upload-files="$upload.addFiles(files)" can-upload="adapter.can.items.upload()" ng-show="$nestedEntities.list.length == 0" select-folder="$folders.selectFolder(folder)" all-folder="getAllFolder()"></no-entities><div ng-include="\'scripts/pages/_partials/notifications.html\'" class="notifications"></div><entities-grid adapter-name="adapter.name" folder-name-by-id="$folders.nameById(id)" entities="$nestedEntities.list" reset-scroll="$folders.selectedFolder" double-click="selectAndSubmitItem(entity)" selected-folder="$folders.selectedFolder" selected-layout-id="$layouts.selected.id" can-select-multiple="true" class="entities-grid"></entities-grid><div ng-include="\'scripts/pages/_partials/loaders.html\'" class="loaders"></div></div></div><div ng-include="\'scripts/pages/_partials/upload-popup.html\'" class="uploader"></div><div ng-include="\'scripts/pages/_partials/footer.html\'" class="footer"></div>'),$templateCache.put("scripts/pages/showbox/_partials/parent-folders.html",'<ul><li ng-class="{current: $parentFolders.selectedFolder.id == folder.id}" ng-repeat="folder in $parentFolders.list"><button ng-click="$parentFolders.selectFolder(folder)">{{folder.name}}</button></li></ul>'),$templateCache.put("scripts/pages/showbox/showbox.html",'<div ng-include="\'scripts/pages/_partials/window-header.html\'" class="header"></div><div items-grid-resize="$layouts.selected.itemWidth" class="content"><div class="content-top"><div ng-include="\'scripts/pages/_partials/tabs.html\'" class="tabs"></div><upload-button upload-files="$upload.addFiles(files, getSelectedFolder())" can-upload="tabs.private.canShow() &amp;&amp; !settings.disableUpload" bi-file-upload="change"></upload-button><div ng-include="\'scripts/pages/_partials/group-actions.html\'" class="group-actions"></div><span ng-include="\'scripts/pages/_partials/upload-message.html\'"></span></div><div ng-include="\'scripts/pages/public/_partials/parent-folders.html\'" class="parent-folders"></div><div class="sidebar"><div ng-include="\'scripts/pages/_partials/folders.html\'" class="sidebar-inner"></div></div><div bi-file-upload="drop" drop-files="$upload.addFiles(files)" can-upload="$upload.adapter.can.item.upload()" ng-class="$layouts.selected.id" reset-scroll-on="$folders.selectedFolder" when-scrolled-to-bottom="$nestedEntities.more()" class="entities-wrapper"><breadcrumbs list="[$parentFolders.selectedFolder, $folders.selectedFolder]" action="$folders.selectFolder($folders.list[0])" ng-if="$nestedEntities.list.length || settings.hasSubfolders"></breadcrumbs><no-entities selected-folder="$folders.selectedFolder" search-query="$searchQuery.query" upload-files="$upload.addFiles(files)" can-upload="adapter.can.items.upload()" ng-show="$nestedEntities.list.length == 0" select-folder="$folders.selectFolder(folder)" all-folder="getAllFolder()"></no-entities><div ng-include="\'scripts/pages/_partials/notifications.html\'" class="notifications"></div><entities-grid adapter-name="adapter.name" folder-name-by-id="$folders.nameById(id)" entities="$nestedEntities.list" reset-scroll="$folders.selectedFolder" double-click="selectAndSubmitItem(entity)" selected-folder="$folders.selectedFolder" selected-layout-id="$layouts.selected.id" can-select-multiple="true" class="entities-grid"></entities-grid><div ng-include="\'scripts/pages/_partials/loaders.html\'" class="loaders"></div></div></div><div ng-include="\'scripts/pages/_partials/upload-popup.html\'" class="uploader"></div><div ng-include="\'scripts/pages/_partials/footer.html\'" class="footer"></div>'),$templateCache.put("scripts/pages/shutter-stock/shutter-stock.html",'<div ng-include="\'scripts/pages/_partials/window-header.html\'" class="header"></div><div items-grid-resize="$layouts.selected.itemWidth" class="content"><div class="content-top"><div ng-include="\'scripts/pages/_partials/tabs.html\'" class="tabs"></div><upload-button upload-files="$upload.addFiles(files, getSelectedFolder())" can-upload="tabs.private.canShow() &amp;&amp; !settings.disableUpload" bi-file-upload="change"></upload-button><div ng-include="\'scripts/pages/_partials/group-actions.html\'" class="group-actions"></div><span ng-include="\'scripts/pages/_partials/upload-message.html\'"></span></div><div ng-include="\'scripts/pages/public/_partials/parent-folders.html\'" class="parent-folders"></div><div class="sidebar"><div ng-include="\'scripts/pages/_partials/folders.html\'" class="sidebar-inner"></div></div><div bi-file-upload="drop" drop-files="$upload.addFiles(files)" can-upload="$upload.adapter.can.item.upload()" ng-class="$layouts.selected.id" reset-scroll-on="$folders.selectedFolder" when-scrolled-to-bottom="$nestedEntities.more()" class="entities-wrapper"><breadcrumbs list="[$folders.selectedFolder]" ng-if="$nestedEntities.list.length || settings.hasSubfolders"></breadcrumbs><no-entities selected-folder="$folders.selectedFolder" search-query="$searchQuery.query" upload-files="$upload.addFiles(files)" can-upload="adapter.can.items.upload()" ng-show="$nestedEntities.list.length == 0" all-folder="getAllFolder()" select-folder="$folders.selectFolder(folder)"></no-entities><div ng-include="\'scripts/pages/_partials/notifications.html\'" class="notifications"></div><entities-grid adapter-name="adapter.name" folder-name-by-id="$folders.nameById(id)" entities="$nestedEntities.list" reset-scroll="$folders.selectedFolder" select-and-submit-item="selectAndSubmitItem(item)" double-click="$nestedEntities.isFolder(entity) ? $nestedEntities.selectFolder(entity) : selectAndSubmitItem(entity)" selected-layout-id="$layouts.selected.id" selected-folder="$folders.selectedFolder" can-select-multiple="false" class="entities-grid"></entities-grid><div ng-include="\'scripts/pages/_partials/loaders.html\'" class="loaders"></div></div></div><div ng-include="\'scripts/pages/_partials/upload-popup.html\'" class="uploader"></div><div ng-include="\'scripts/pages/_partials/footer.html\'" class="footer"></div>')}]),angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.tooltip","ui.bootstrap.position","ui.bootstrap.bindHtml"]),angular.module("ui.bootstrap.tpls",["template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html"]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).provider("$tooltip",function(){function snake_case(name){var regexp=/[A-Z]/g;return name.replace(regexp,function(letter,pos){return(pos?"-":"")+letter.toLowerCase()})}var defaultOptions={placement:"top",animation:!0,popupDelay:0},triggerMap={mouseenter:"mouseleave",click:"click",focus:"blur"},globalOptions={};this.options=function(value){angular.extend(globalOptions,value)},this.setTriggers=function(triggers){angular.extend(triggerMap,triggers)},this.$get=["$window","$compile","$timeout","$document","$position","$interpolate",function($window,$compile,$timeout,$document,$position,$interpolate){return function(type,prefix,defaultTriggerShow){function getTriggers(trigger){var show=trigger||options.trigger||defaultTriggerShow;return{show:show,hide:triggerMap[show]||show}}var options=angular.extend({},defaultOptions,globalOptions),directiveName=snake_case(type),startSym=$interpolate.startSymbol(),endSym=$interpolate.endSymbol(),template="<div "+directiveName+'-popup title="'+startSym+"title"+endSym+'" content="'+startSym+"content"+endSym+'" placement="'+startSym+"placement"+endSym+'" animation="animation" is-open="isOpen"></div>';return{restrict:"EA",compile:function(tElem,tAttrs){var tooltipLinker=$compile(template);return function(scope,element,attrs){function toggleTooltipBind(){ttScope.isOpen?hideTooltipBind():showTooltipBind()}function showTooltipBind(){hasEnableExp&&!scope.$eval(attrs[prefix+"Enable"])||(prepareTooltip(),ttScope.popupDelay?popupTimeout||(popupTimeout=$timeout(show,ttScope.popupDelay,!1),popupTimeout.then(function(reposition){reposition()})):show()())}function hideTooltipBind(){scope.$apply(function(){hide()})}function show(){return popupTimeout=null,transitionTimeout&&($timeout.cancel(transitionTimeout),transitionTimeout=null),ttScope.content?(createTooltip(),tooltip.css({top:0,left:0,display:"block"}),ttScope.$digest(),positionTooltip(),ttScope.isOpen=!0,ttScope.$digest(),positionTooltip):angular.noop}function hide(){ttScope.isOpen=!1,$timeout.cancel(popupTimeout),popupTimeout=null,ttScope.animation?transitionTimeout||(transitionTimeout=$timeout(removeTooltip,500)):removeTooltip()}function createTooltip(){tooltip&&removeTooltip(),tooltipLinkedScope=ttScope.$new(),tooltip=tooltipLinker(tooltipLinkedScope,function(tooltip){appendToBody?$document.find("body").append(tooltip):element.after(tooltip)})}function removeTooltip(){transitionTimeout=null,tooltip&&(tooltip.remove(),tooltip=null),tooltipLinkedScope&&(tooltipLinkedScope.$destroy(),tooltipLinkedScope=null)}function prepareTooltip(){prepPlacement(),prepPopupDelay()}function prepPlacement(){var val=attrs[prefix+"Placement"];ttScope.placement=angular.isDefined(val)?val:options.placement}function prepPopupDelay(){var val=attrs[prefix+"PopupDelay"],delay=parseInt(val,10);ttScope.popupDelay=isNaN(delay)?options.popupDelay:delay}var tooltip,tooltipLinkedScope,transitionTimeout,popupTimeout,appendToBody=!!angular.isDefined(options.appendToBody)&&options.appendToBody,triggers=getTriggers(void 0),hasEnableExp=angular.isDefined(attrs[prefix+"Enable"]),ttScope=scope.$new(!0),positionTooltip=function(){var ttPosition=$position.positionElements(element,tooltip,ttScope.placement,appendToBody);ttPosition.top+="px",ttPosition.left+="px",tooltip.css(ttPosition)};ttScope.isOpen=!1,attrs.$observe(type,function(val){ttScope.content=val,!val&&ttScope.isOpen&&hide()}),attrs.$observe(prefix+"Title",function(val){ttScope.title=val});var unregisterTriggers=function(){element.unbind(triggers.show,showTooltipBind),element.unbind(triggers.hide,hideTooltipBind)};!function(){var val=attrs[prefix+"Trigger"];unregisterTriggers(),triggers=getTriggers(val),triggers.show===triggers.hide?element.bind(triggers.show,toggleTooltipBind):(element.bind(triggers.show,showTooltipBind),element.bind(triggers.hide,hideTooltipBind))}();var animation=scope.$eval(attrs[prefix+"Animation"]);ttScope.animation=angular.isDefined(animation)?!!animation:options.animation;var appendToBodyVal=scope.$eval(attrs[prefix+"AppendToBody"]);appendToBody=angular.isDefined(appendToBodyVal)?appendToBodyVal:appendToBody,appendToBody&&scope.$on("$locationChangeSuccess",function(){ttScope.isOpen&&hide()}),scope.$on("$destroy",function(){$timeout.cancel(transitionTimeout),$timeout.cancel(popupTimeout),unregisterTriggers(),removeTooltip(),ttScope=null})}}}}}]}).directive("tooltipPopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function($tooltip){return $tooltip("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function($tooltip){return $tooltip("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function($document,$window){function getStyle(el,cssprop){return el.currentStyle?el.currentStyle[cssprop]:$window.getComputedStyle?$window.getComputedStyle(el)[cssprop]:el.style[cssprop]}function isStaticPositioned(element){return"static"===(getStyle(element,"position")||"static")}var parentOffsetEl=function(element){for(var docDomEl=$document[0],offsetParent=element.offsetParent||docDomEl;offsetParent&&offsetParent!==docDomEl&&isStaticPositioned(offsetParent);)offsetParent=offsetParent.offsetParent;return offsetParent||docDomEl};return{position:function(element){var elBCR=this.offset(element),offsetParentBCR={top:0,left:0},offsetParentEl=parentOffsetEl(element[0]);offsetParentEl!=$document[0]&&(offsetParentBCR=this.offset(angular.element(offsetParentEl)),offsetParentBCR.top+=offsetParentEl.clientTop-offsetParentEl.scrollTop,offsetParentBCR.left+=offsetParentEl.clientLeft-offsetParentEl.scrollLeft);var boundingClientRect=element[0].getBoundingClientRect();return{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:elBCR.top-offsetParentBCR.top,left:elBCR.left-offsetParentBCR.left}},offset:function(element){var boundingClientRect=element[0].getBoundingClientRect();return{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:boundingClientRect.top+($window.pageYOffset||$document[0].documentElement.scrollTop),left:boundingClientRect.left+($window.pageXOffset||$document[0].documentElement.scrollLeft)}},positionElements:function(hostEl,targetEl,positionStr,appendToBody){var hostElPos,targetElWidth,targetElHeight,targetElPos,positionStrParts=positionStr.split("-"),pos0=positionStrParts[0],pos1=positionStrParts[1]||"center";hostElPos=appendToBody?this.offset(hostEl):this.position(hostEl),targetElWidth=targetEl.prop("offsetWidth"),targetElHeight=targetEl.prop("offsetHeight");var shiftWidth={center:function(){return hostElPos.left+hostElPos.width/2-targetElWidth/2},left:function(){return hostElPos.left},right:function(){return hostElPos.left+hostElPos.width}},shiftHeight={center:function(){return hostElPos.top+hostElPos.height/2-targetElHeight/2},top:function(){return hostElPos.top},bottom:function(){return hostElPos.top+hostElPos.height}};switch(pos0){case"right":targetElPos={top:shiftHeight[pos1](),left:shiftWidth[pos0]()};break;case"left":targetElPos={top:shiftHeight[pos1](),left:hostElPos.left-targetElWidth};break;case"bottom":targetElPos={top:shiftHeight[pos0](),left:shiftWidth[pos1]()};break;default:targetElPos={top:hostElPos.top-targetElHeight,left:shiftWidth[pos1]()}}return targetElPos}}}]),angular.module("ui.bootstrap.bindHtml",[]).directive("bindHtmlUnsafe",function(){return function(scope,element,attr){element.addClass("ng-binding").data("$binding",attr.bindHtmlUnsafe),scope.$watch(attr.bindHtmlUnsafe,function(value){element.html(value||"")})}}),angular.module("template/tooltip/tooltip-html-unsafe-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tooltip/tooltip-html-unsafe-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" bind-html-unsafe="content"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tooltip/tooltip-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind="content"></div>\n</div>\n')}]),function(exports){"use strict";function createCollection(proto,objectOnly){function Collection(a){if(!this||this.constructor!==Collection)return new Collection(a);this._keys=[],this._values=[],this._itp=[],this.objectOnly=objectOnly,a&&init.call(this,a)}return objectOnly||defineProperty(proto,"size",{get:sharedSize}),proto.constructor=Collection,Collection.prototype=proto,Collection}function init(a){this.add?a.forEach(this.add,this):a.forEach(function(a){this.set(a[0],a[1])},this)}function sharedDelete(key){return this.has(key)&&(this._keys.splice(i,1),this._values.splice(i,1),this._itp.forEach(function(p){i<p[0]&&p[0]--})),-1<i}function sharedGet(key){return this.has(key)?this._values[i]:void 0}function has(list,key){if(this.objectOnly&&key!==Object(key))throw new TypeError("Invalid value used as weak collection key");if(key!=key||0===key)for(i=list.length;i--&&!is(list[i],key););else i=list.indexOf(key);return-1<i}function setHas(value){return has.call(this,this._values,value)}function mapHas(value){return has.call(this,this._keys,value)}function sharedSet(key,value){return this.has(key)?this._values[i]=value:this._values[this._keys.push(key)-1]=value,this}function sharedAdd(value){return this.has(value)||this._values.push(value),this}function sharedClear(){this._values.length=0}function sharedKeys(){return sharedIterator(this._itp,this._keys)}function sharedValues(){return sharedIterator(this._itp,this._values)}function mapEntries(){return sharedIterator(this._itp,this._keys,this._values)}function setEntries(){return sharedIterator(this._itp,this._values,this._values)}function sharedIterator(itp,array,array2){var p=[0],done=!1;return itp.push(p),{next:function(){var v,k=p[0];return!done&&k<array.length?(v=array2?[array[k],array2[k]]:array[k],p[0]++):(done=!0,itp.splice(itp.indexOf(p),1)),{done:done,value:v}}}}function sharedSize(){return this._values.length}function sharedForEach(callback,context){for(var it=this.entries();;){var r=it.next();if(r.done)break;callback.call(context,r.value[1],r.value[0],this)}}var i,defineProperty=Object.defineProperty,is=function(a,b){return isNaN(a)?isNaN(b):a===b};"undefined"==typeof WeakMap&&(exports.WeakMap=createCollection({delete:sharedDelete,clear:sharedClear,get:sharedGet,has:mapHas,set:sharedSet},!0)),"undefined"==typeof Map&&(exports.Map=createCollection({delete:sharedDelete,has:mapHas,get:sharedGet,set:sharedSet,keys:sharedKeys,values:sharedValues,entries:mapEntries,forEach:sharedForEach,clear:sharedClear})),"undefined"==typeof Set&&(exports.Set=createCollection({has:setHas,add:sharedAdd,delete:sharedDelete,clear:sharedClear,keys:sharedValues,values:sharedValues,entries:setEntries,forEach:sharedForEach})),"undefined"==typeof WeakSet&&(exports.WeakSet=createCollection({delete:sharedDelete,add:sharedAdd,clear:sharedClear,has:setHas},!0))}("undefined"!=typeof exports&&"undefined"!=typeof global?global:window),UUID.generate=function(){var rand=UUID._gri,hex=UUID._ha;return hex(rand(32),8)+"-"+hex(rand(16),4)+"-"+hex(16384|rand(12),4)+"-"+hex(32768|rand(14),4)+"-"+hex(rand(48),12)},UUID._gri=function(x){return x<0?NaN:x<=30?0|Math.random()*(1<<x):x<=53?(0|Math.random()*(1<<30))+(0|Math.random()*(1<<x-30))*(1<<30):NaN},UUID._ha=function(num,length){for(var str=num.toString(16),i=length-str.length,z="0";i>0;i>>>=1,z+=z)1&i&&(str=z+str);return str},function(){"use strict";this.app.directive("draggable",function($compile,$templateCache,SelectedEntities,Folder,settings){return{scope:{entity:"=draggable",canDrag:"="},link:function(scope,el,attrs){var $el,canNotDragItem,enableDrag,helper,template;if(scope.canDrag)return template=$templateCache.get("scripts/directives/draggable/draggable-helper.html"),helper=function(){return scope.count=SelectedEntities.size||1,$compile(template)(scope)},scope.isFolder=function(entity){return entity instanceof Folder},canNotDragItem=function(){return"single"===settings.selectionType&&!SelectedEntities.has(scope.entity)&&SelectedEntities.size>0},$el=$(el),enableDrag=function(){return $el.draggable("instance")&&$el.draggable("destroy"),$el.draggable({revert:"invalid",helper:helper,delay:100,appendTo:"body",cursorAt:{left:57,top:57},addClasses:!0,zIndex:1e4,start:function(){return!canNotDragItem()&&el.addClass("ui-dragging")},stop:function(){return el.removeClass("ui-dragging")}})},$el.mouseover(enableDrag),$el.mousedown(enableDrag)}}})}.call(this),function(){app.directive("folderActions",function(){return{restrict:"E",scope:{folder:"=",showRenaming:"&",remove:"="},templateUrl:"scripts/directives/folder-actions/folder-actions.html"}})}.call(this),function(){"use strict";app.directive("preview",function($sce,localizeDate){return{restrict:"E",replace:!0,templateUrl:"scripts/directives/preview/preview.html",scope:{item:"=",folderName:"=",adapterName:"=",parentSelector:"@"},link:function(scope){var hasAttributes,url;return scope.isRetina=window.devicePixelRatio>1,scope.videoSources=[],scope.showFolderName=!0,hasAttributes=function(url){var ref;return(null!=(ref=/\?((?:&?[^&])+)/.exec(url))?ref[1]:void 0)||""},scope.uploadedBy=function(item){return item.readOnly?"item_preview_label.uploaded_by_contributor":"item_preview_label.uploaded_by_owner"},"shutterstock"===scope.adapterName&&(scope.showFolderName=!1),scope.uploadedTime=function(item){return localizeDate(1e3*item.createdAt)},scope.item.can.showExternalVideoPreview()?(url=scope.item.iframeSrc+(hasAttributes(scope.item.iframeSrc)?"&autoplay=1":"?autoplay=1"),"youtube"===scope.adapterName&&(url+="&showinfo=0"),scope.iframeSrc=$sce.trustAsResourceUrl(url)):"video"===scope.item.mediaType?_.forEach(scope.item.videoPreviewUrls,function(videoPreviewUrl){return scope.videoSources.push($sce.trustAsResourceUrl(videoPreviewUrl))}):void 0}}})}.call(this),function(){"use strict";this.app.directive("entitiesGrid",function($sce,SelectedEntities,Notifications,Aviary,Folder,i18n,bigstockPrice){return{restrict:"E",templateUrl:"scripts/directives/entities-grid/entities-grid.html",scope:{entities:"=",folderNameById:"&",selectedFolder:"=",adapterName:"=",renameCtrl:"=",moveSelectedToFolder:"&",click:"&",doubleClick:"&",selectAndSubmitItem:"&",onAllThumbnailsLoaded:"&",canSelectMultiple:"=",selectedLayoutId:"=",remove:"="},link:function(scope){return _.includes(["bigstock","shutterstock"],scope.adapterName)&&(scope.price=$sce.trustAsHtml(i18n.translate("photo_stock.big_stock.buy_short")),bigstockPrice().then(function(response){return scope.price=$sce.trustAsHtml(""+response.currencySymbol+response.priceValue)})),scope.isSelected=function(entity){return SelectedEntities.has(entity)},scope.isFolder=function(entity){return entity instanceof Folder},scope.folderName=function(item){return item.isInSiteMedia?i18n.translate("private_media.site_media"):"function"==typeof scope.folderNameById?scope.folderNameById({id:item.folderId}):void 0},scope.onThumbnailLoaded=_.debounce(function(){return"function"==typeof scope.onAllThumbnailsLoaded?scope.onAllThumbnailsLoaded():void 0},1e3),scope.editItemInAviary=function(item){return Aviary.upload(item.name,null!=item?item.originalUrl:void 0,scope.selectedFolder)},scope.rename=function(newName,entity){return 0===$.trim(newName).length?Notifications.send(i18n.translate("errors.rename_item_failed.empty_name")):$.trim(newName).length>256?Notifications.send(i18n.translate("errors.rename_item_failed.long_name")):entity.rename(newName)}}}})}.call(this),function(){"use strict";app.directive("moreActionsTooltip",function($compile,$templateCache,$parse,settings){return{restrict:"A",link:function(scope,element,attrs){var actionsContainer,defaultOptions,getActionsWidth,hiddenActionsContainer,hideActions,oldActionsWidth,oldContainerWidth,restoreHiddenActions,showMore,showMoreTemplate;if(settings.hasFavorites)return showMoreTemplate=$templateCache.get("scripts/directives/more-actions-tooltip/show-more.html"),defaultOptions={drawOnEvent:"mouseover",actionsContainerSelector:".actions"},scope.options=_.assign({},defaultOptions,$parse(attrs.popup)(scope)),actionsContainer=element.find(scope.options.actionsContainerSelector),showMore=$compile(showMoreTemplate)(scope),hiddenActionsContainer=showMore.find(".more-actions"),oldActionsWidth=0,oldContainerWidth=0,getActionsWidth=function(){var actions;return actions=actionsContainer.children(":not(.ng-hide)"),_.reduce(actions,function(memo,el){return memo+$(el).outerWidth()},0)},restoreHiddenActions=function(hiddenActions){if(null!=hiddenActions?hiddenActions.length:void 0)return actionsContainer.append(hiddenActions)},hideActions=function(){var lastAction,results;for(results=[];getActionsWidth()>actionsContainer.width()&&0!==actionsContainer.children(":not(.show-more, .ng-hide)").length;)lastAction=actionsContainer.children(":not(.show-more, .ng-hide)").last(),hiddenActionsContainer.prepend(lastAction),actionsContainer.children(".show-more").length?results.push(actionsContainer.children(".show-more").show()):results.push(actionsContainer.append(showMore));return results},element.on(scope.options.drawOnEvent,function(){if(oldActionsWidth!==getActionsWidth()||oldContainerWidth!==actionsContainer.width())return actionsContainer.children(".show-more").hide(),restoreHiddenActions(hiddenActionsContainer.children()),hideActions(),oldContainerWidth=actionsContainer.width(),oldActionsWidth=getActionsWidth()})}}})}.call(this),function(){app.directive("spinner",function(){return{restrict:"E",templateUrl:"scripts/directives/spinner/spinner.html",link:function(scope,el,attrs){var $path,$svg,animateColor,animateRotation,animateStroke,applyAnimation,ref,setColor2,setColor3,setColor4;if($svg=$(el).find(".spinner"),$path=$(el).find(".path"),applyAnimation=function(val,tween){if("strokeDashoffset"===tween.prop&&$(this).css("stroke-dashoffset",val),"transformRotate"===tween.prop)return $(this).css("transform","rotate("+val+"deg)")},animateRotation=function(){return $svg.css({"transform-rotate":0}),$svg.animate({"transform-rotate":270},{step:applyAnimation,duration:1400,complete:animateRotation})},animateStroke=function(){return $path.animate({"transform-rotate":135,"stroke-dashoffset":46.75},{step:applyAnimation,duration:700,complete:function(){return $path.animate({"transform-rotate":450,"stroke-dashoffset":187},{step:applyAnimation,duration:700,complete:animateStroke})}})},animateColor=function(){return $path.css({stroke:"#3899ec"}),setTimeout(setColor2,1400)},setColor2=function(){return $path.css({stroke:"#42c5bf"}),setTimeout(setColor3,1400)},setColor3=function(){return $path.css({stroke:"#6ccc65"}),setTimeout(setColor4,1400)},setColor4=function(){return $path.css({stroke:"#79b6f0"}),setTimeout(animateColor,1400)},/MSIE|Trident/i.test(null!=(ref=window.navigator)?ref.userAgent:void 0))return $svg.css({"z-index":1e3}),$svg.css({animation:"none"}),$path.css({animation:"none"}),animateStroke(),animateRotation(),animateColor()}}})}.call(this),function(){"use strict";this.app.directive("uploadButton",function(){return{restrict:"E",scope:{uploadFiles:"&",canUpload:"="},templateUrl:"scripts/directives/upload-button/upload-button.html",link:function(scope){return scope.uploadFiles=_.throttle(scope.uploadFiles)}}})}.call(this),function(){"use strict";this.app.directive("noEntities",function($state,$sce,i18n,htmlEncode,settings){return{restrict:"E",templateUrl:"scripts/directives/no-entities/no-entities.html",scope:{selectedFolder:"=",canUpload:"=",uploadFiles:"&",searchQuery:"=",adapterType:"@",allFolder:"=",selectFolder:"&",showDescriptionLink:"&"},link:function(scope){return scope.settings=settings,_.isBoolean("function"==typeof scope.showDescriptionLink?scope.showDescriptionLink():void 0)?scope.showDescriptionLink=scope.showDescriptionLink():scope.showDescriptionLink=!0,scope.getHeader=function(){var ref,ref1,ref2,ref3,ref4,ref5,ref6,ref7
;return"allMedia"===(null!=(ref=scope.selectedFolder)?ref.type:void 0)&&i18n.isTranslatable("no_items.header_allMedia")?i18n.translate("no_items.header_allMedia"):"siteMedia"===(null!=(ref1=scope.selectedFolder)?ref1.type:void 0)&&i18n.isTranslatable("no_items.header_siteMedia")?i18n.translate("no_items.header_siteMedia"):(null!=(ref2=scope.selectedFolder)?ref2.can.uploadIn():void 0)?_.includes(["allMedia","siteMedia"],null!=(ref3=scope.selectedFolder)?ref3.type:void 0)?_.includes(["picture","secure_picture","video","secure_video"],settings.mediaType)?i18n.translate("no_items.header_allMedia"):i18n.translate("no_items.header_"+(null!=(ref4=scope.selectedFolder)?ref4.type:void 0)):"unsorted"===(null!=(ref5=scope.selectedFolder)?ref5.type:void 0)?i18n.translate("no_items.header_allMedia"):i18n.translate("no_items.header_user_folder",[scope.selectedFolder.name]):"purchased"===(null!=(ref6=scope.selectedFolder)?ref6.type:void 0)?i18n.translate("no_items.header_"+scope.selectedFolder.type):(null!=(ref7=scope.selectedFolder)?ref7.name:void 0)?i18n.translate("no_items_in_readonly_folder.header",[scope.selectedFolder.name]):void 0},scope.descriptionTranslationKey=function(){var ref,ref1;return"allMedia"===(null!=(ref=scope.selectedFolder)?ref.type:void 0)&&i18n.isTranslatable("no_items.text_allMedia")?"no_items.text_allMedia":"siteMedia"===(null!=(ref1=scope.selectedFolder)?ref1.type:void 0)&&i18n.isTranslatable("no_items.text_siteMedia")?"no_items.text_siteMedia":i18n.isTranslatable("no_items.text_user_folder")?"no_items.text_user_folder":"no_items.text"},scope.getDescription=function(){var ref,ref1;return"purchased"===(null!=(ref=scope.selectedFolder)?ref.type:void 0)?{description:"no_items.text_"+scope.selectedFolder.type,link:"no_items.text_"+scope.selectedFolder.type+"_link",state:"app.photoStock"}:"siteMedia"===(null!=(ref1=scope.selectedFolder)?ref1.type:void 0)?'<a href="'+$sce.trustAsResourceUrl(i18n.translate("help_contributors_url"))+'" target="_blank">'+i18n.translate("no_items.text_siteMedia_link")+"</a>":void 0},scope.changeState=function(state){return $state.go(state)},scope.getSearchQuery=function(){return htmlEncode(scope.searchQuery)},scope.isSearch=function(){return!!scope.searchQuery},scope.searchTemplate="user-owned"===scope.adapterType?"no-user-owned-search-results.html":"no-search-results.html"}}})}.call(this),function(){app.directive("breadcrumbs",function(){return{restrict:"E",templateUrl:"scripts/directives/breadcrumbs/breadcrumbs.html",scope:{list:"&",action:"&"},link:function(scope,el,attr){return scope.existedList=function(){return _.filter(scope.list(),function(folder){return!!folder})}}}})}.call(this),function(){this.app.directive("renamableName",function(){return{restrict:"E",scope:{entity:"=",renameCtrl:"=",redrawOnChange:"="},link:function(scope){return scope.newName=scope.entity.name},templateUrl:"scripts/directives/renamable-name/renamable-name.html"}})}.call(this),function(){this.app.directive("folderLongName",["$timeout","$window","$parse","Folder",function($timeout,$window,$parse,Folder){return{restrict:"A",scope:{folder:"=",redrawOnChange:"="},compile:function(elem,attr,linker){return function(scope,element,attributes){var buildEllipsis,drawNameTooltip,isOverflowed;scope.folder instanceof Folder&&(buildEllipsis=function(){isOverflowed(element)&&drawNameTooltip(element,scope.folder.name)},drawNameTooltip=function(element,name){var folder,tooltip;if(folder=element.parents(".item.folder"),!$(".folder-name-tooltip",folder).length)return tooltip=angular.element('<div class="folder-name-tooltip ng-hide">'+name+"</div>"),folder.append(tooltip),$(".name",folder).on("mouseenter",function(){return tooltip.removeClass("ng-hide")}),folder.on("mouseleave",function(){return tooltip.addClass("ng-hide")})},isOverflowed=function(thisElement){return thisElement[0].scrollWidth>thisElement[0].clientWidth},attributes.lastWindowResizeTime=0,attributes.lastWindowResizeWidth=0,attributes.lastWindowResizeHeight=0,attributes.lastWindowTimeoutEvent=null,attributes.isTruncated=!1,scope.$watch("ngBind",function(){buildEllipsis()}),scope.$watch("redrawOnChange",function(){buildEllipsis()}),angular.element($window).bind("resize",function(){$timeout.cancel(attributes.lastWindowTimeoutEvent),attributes.lastWindowTimeoutEvent=$timeout(function(){attributes.lastWindowResizeWidth===window.innerWidth&&attributes.lastWindowResizeHeight===window.innerHeight||buildEllipsis(),attributes.lastWindowResizeWidth=window.innerWidth,attributes.lastWindowResizeHeight=window.innerHeight},75)}))}}}}])}.call(this),function(){app.directive("autoscroll",function(){return{restrict:"A",link:function(scope,element,attrs){return setTimeout(function(){return element[0].scrollTop="bottom"===attrs.autoscroll?element[0].scrollHeight-element[0].clientHeight:0},200)}}})}.call(this),function(){app.directive("focusMe",function($timeout){return function(scope,element,attrs){return scope.$watch(attrs.focusMe,function(value){if(value)return $timeout(function(){return element[0].focus()})})}})}.call(this),function(){"use strict";var slice=[].slice;app.directive("thumb",function($parse,mediaTypes,supportedArchiveTypes,supportedDocsTypes){return{link:function(scope,element,attrs){var extension,file,fileSpecificBGImage,mediaType,setImageAsBackground;return mediaType=$parse(attrs.mediaType)(scope),_.includes([mediaTypes.ARCHIVE,mediaTypes.DOCUMENT],mediaType)?(file=$parse(attrs.thumb)(scope),extension=_.last(file.name.split(".")),void(_.includes(slice.call(supportedArchiveTypes).concat(slice.call(supportedDocsTypes)),extension)&&(fileSpecificBGImage="images/thumbnails/"+mediaType+"-"+extension+".svg",element.css({"background-image":"url("+fileSpecificBGImage+")","background-size":"cover"})))):(file=$parse(attrs.thumb)(scope),setImageAsBackground=function(img){return element.append(img),element.css({"background-image":"none"})},file&&/image/i.test(file.type)?loadImage(file,setImageAsBackground,{maxWidth:element.innerWidth(),maxHeight:element.innerHeight(),crop:!0}):void 0)}}})}.call(this),function(){app.directive("denyBubbling",function(){return{restrict:"A",link:function(scope,element,attrs){var eventName;return eventName=attrs.denyBubbling||"click",$(element).on(eventName,function(event){return event.cancelBubble=!0,"function"==typeof event.stopPropagation?event.stopPropagation():void 0})}}})}.call(this),function(){app.directive("onEnter",function(){return{restrict:"A",link:function(scope,element,attrs){return element.on("keydown",function(e){if(13===e.keyCode)return scope.$apply(attrs.onEnter)})}}})}.call(this),function(){app.directive("autoEnterDelayed",function(){return{restrict:"A",link:function(scope,element,attrs){return element.on("keydown",_.debounce(function(){return scope.$apply(attrs.onEnter)},800))}}})}.call(this),function(){app.directive("onEsc",function(){return{restrict:"A",link:function(scope,element,attrs){return element.on("keyup",function(e){if(e.stopPropagation(),27===e.keyCode)return scope.$apply(attrs.onEsc)})}}})}.call(this),function(){app.directive("onClickOutside",function(){return{restrict:"A",link:function(scope,element,attrs){return element.on("focus",function(event){return $(document).off(".hideInput"),$(document).on("mousedown.hideInput",function(event){return event.target!==element[0]&&scope.$apply(attrs.onClickOutside),$(document).off(".hideInput")})})}}})}.call(this),function(){app.directive("multiSelect",function(SelectedEntities){return{controller:function($scope,$attrs,$parse){var lastSelectedItem;return lastSelectedItem=null,this.selectRange=function(entity){var endPosition,entities,i,j,ref,ref1,startPosition;if(!1===$scope.canSelectMultiple)return this.selectSingle(entity);for(entities=$parse($attrs.multiSelect)($scope),startPosition=entities.indexOf(lastSelectedItem||entity),endPosition=entities.indexOf(entity),SelectedEntities.clear(),i=j=ref=startPosition,ref1=endPosition;ref<=ref1?j<=ref1:j>=ref1;i=ref<=ref1?++j:--j)SelectedEntities.add(entities[i]);return!0},this.addSingle=function(entity){return!1===$scope.canSelectMultiple?this.selectSingle(entity):(!SelectedEntities.has(entity)||1!==SelectedEntities.size)&&(SelectedEntities.add(entity),lastSelectedItem=entity,!0)},this.selectSingle=function(entity){return SelectedEntities.has(entity)&&1===SelectedEntities.size?SelectedEntities.clear():(SelectedEntities.clear(),SelectedEntities.add(entity),lastSelectedItem=entity,!0)},this.unselectSingle=function(entity){return lastSelectedItem=null,SelectedEntities.delete(entity)},this.invertSingle=function(entity){var method;return method=SelectedEntities.has(entity)?"unselectSingle":"addSingle",this[method](entity)},this}}}),app.directive("selectEntity",function(settings,SelectedEntities,$parse){return{link:function(scope,element,attrs){var entity;return entity=$parse(attrs.selectEntity)(scope),element.on("mousedown",function(event){if(event.stopPropagation(),entity.can.select())return SelectedEntities.clear(),SelectedEntities.add(entity),scope.$apply()}),element.on("mouseup",function(event){return SelectedEntities.clear(),scope.$apply()})}}}),app.directive("multiSelectEntity",function(settings,SelectedEntities,$parse){return{require:"?^multiSelect",link:function(scope,element,attrs,multiSelect){var entity,preventMouseUp;return preventMouseUp=!0,entity=$parse(attrs.multiSelectEntity)(scope),element.on("mousedown",function(event){var canDoScopeApply,isCtrl,isShift;if(preventMouseUp=!1,canDoScopeApply=!1,isShift=event.shiftKey,isCtrl=event.metaKey||event.ctrlKey,event.stopPropagation(),entity.can.select())return isShift?(multiSelect.selectRange(entity),preventMouseUp=!0,canDoScopeApply=!0):isCtrl?SelectedEntities.has(entity)||(multiSelect.addSingle(entity),preventMouseUp=!0,canDoScopeApply=!0):0===SelectedEntities.size?(multiSelect.selectSingle(entity),preventMouseUp=!0,canDoScopeApply=!0):SelectedEntities.size>0&&"single"!==settings.selectionType&&!SelectedEntities.has(entity)&&(multiSelect.addSingle(entity),preventMouseUp=!0,canDoScopeApply=!0),canDoScopeApply?scope.$apply():void 0}),element.on("mouseup",function(event){var canDoScopeApply,isCtrl,isShift;if(!preventMouseUp&&(preventMouseUp=!0,isShift=event.shiftKey,isCtrl=event.metaKey||event.ctrlKey,canDoScopeApply=!1,!isShift&&(entity=$parse(attrs.multiSelectEntity)(scope),entity.can.select())))return isCtrl?SelectedEntities.has(entity)&&(multiSelect.unselectSingle(entity,!0),canDoScopeApply=!0):("single"===settings.selectionType?multiSelect.selectSingle(entity):multiSelect.invertSingle(entity,!0),canDoScopeApply=!0),canDoScopeApply?scope.$apply():void 0})}}}),app.directive("selectAll",function(SelectedEntities){return{scope:{entities:"="},link:function(scope,element){var ctrlOrCmdIsActiveInEvent,keyCodeIsForAlpha,targetIsNotInput;return targetIsNotInput=function(target){return"INPUT"!==target.tagName&&"TEXTAREA"!==target.tagName},keyCodeIsForAlpha=function(keyCode){return 65===keyCode},ctrlOrCmdIsActiveInEvent=function(event){return event.metaKey||event.ctrlKey},$(document).on("keydown",function(event){if(targetIsNotInput(event.target)&&keyCodeIsForAlpha(event.keyCode)&&ctrlOrCmdIsActiveInEvent(event))return SelectedEntities.clear(),scope.$apply(function(){return _.forEach(scope.entities,function(entity){return SelectedEntities.add(entity)})}),event.preventDefault(),event.stopPropagation(),!1}),element.on("mousedown",function(event){if(event.target!==element[0])return SelectedEntities.clear(),scope.$apply()})}}})}.call(this),function(){"use strict";this.app.directive("biClick",function($parse,biUiEvents){return{restrict:"A",link:function(scope,el,attrs){return el.bind("click",function(){var options,params;return params=$parse(attrs.biClick)(scope),options=params.data,biUiEvents(params.eventName,options)})}}})}.call(this),function(){"use strict";this.app.directive("biFileUpload",function($parse,biReport,settings){return{restrict:"A",link:function(scope,el,attrs){var event,modes,onFileUpload;return event=attrs.biFileUpload,modes={change:"click",drop:"drop"},onFileUpload=function(ev){var filesCount,ref,ref1;if(ev.stopPropagation(),filesCount=(null!=(ref=ev.originalEvent.dataTransfer)?ref.files.length:void 0)||(null!=(ref1=ev.originalEvent.srcElement)?ref1.files.length:void 0))return biReport("uploadStarted",{files:filesCount,media_type:settings.mediaType,mode:modes[event]})},el.on(event,onFileUpload)}}})}.call(this),function(){this.app.directive("whenScrolledToBottom",function(){return function(scope,element,attrs){var $element,applyOnScrollBottom,callAction,getContentHeight;return $element=$(element),callAction=_.throttle(function(){return scope.$apply(attrs.whenScrolledToBottom)},100),applyOnScrollBottom=function(){if($element.scrollTop()>0&&$element.scrollTop()>=element.prop("scrollHeight")-2*$element.height())return callAction()},$element.on("scroll",applyOnScrollBottom),$element.on("mousemove",applyOnScrollBottom),getContentHeight=function(element){var contentHeight;return contentHeight=0,element.children().each(function(i,el){return contentHeight+=el.offsetHeight}),contentHeight},$element.on("mousewheel DOMMouseScroll",function(){if(0===$element.scrollTop()&&getContentHeight(element)<element.prop("scrollHeight"))return callAction()})}})}.call(this),function(){var isVisibleAt,loadImage,loadedImagesCount;loadedImagesCount=0,loadImage=function(url,callback,errorCallback){var image;return image=new Image,image.onload=function(){if(callback(image),10===++loadedImagesCount)return"undefined"!=typeof appLoadNotifiers&&null!==appLoadNotifiers?appLoadNotifiers.first10ImagesLoaded():void 0},image.onerror=errorCallback,image.src=url,image},isVisibleAt=function(el,container){var offsetTop;return(offsetTop=el.offset().top-container.offset().top)>-el.outerHeight()&&offsetTop<=container.height()},this.app.directive("coveredBackground",function(){return{restrict:"A",scope:{coveredBackground:"@",loadIfChanged:"=",loadVisibleFor:"@",scrollDebounce:"@",onLoadSuccess:"&"},link:function(scope,element){var container,isLoaded,isLoading,setBackgroundSize,showImage,showOnEvent;if(isLoaded=!1,isLoading=!1,scope.scrollDebounce||(scope.scrollDebounce=1500),setBackgroundSize=function(image){var backgroundSize;if(!/\.svg$/i.test(image.src))return backgroundSize=image.width>=element.innerWidth()||image.height>=element.innerHeight()?"cover":"auto",element.css("background-size",backgroundSize)},showImage=function(url){if(!isLoaded&&!isLoading)return isLoading=!0,loadImage(url,function(image){return element.css("background-image",'url("'+url+'")'),setBackgroundSize(image),isLoaded=!0,isLoading=!1,scope.onLoadSuccess()},function(){return isLoading=!1})},container=element.parents(scope.loadVisibleFor).first(),showOnEvent=_.throttle(function(){if(!scope.loadVisibleFor||isVisibleAt(element,container))return isLoaded=!1,showImage(scope.coveredBackground)},scope.scrollDebounce),scope.$watch("coveredBackground",showOnEvent),scope.$watch("loadIfChanged",function(){if(!isLoaded&&!isLoading)return showOnEvent()}),scope.loadVisibleFor)return container.scroll(function(){if(!isLoaded&&!isLoading)return showOnEvent()}),$(window).resize(function(){if(!isLoaded&&!isLoading)return showOnEvent()})}}})}.call(this),function(){"use strict";var hideFns;hideFns=[],app.directive("popup",function($compile,$parse,$templateCache,$document){var defaultOptions;return defaultOptions={event:"click",offsetTop:0,offsetLeft:0,pinTo:"element",pinToSelector:null,align:"bottom right",activeClass:"popup-opened",containerClass:"popup-container",contentClass:"popup-content",parentSelector:null,parentActiveClass:"active",centeredTip:!1,template:null,disable:!1,fadeOut:0},{restrict:"A",link:function(scope,el,attrs){var MARGIN_TOP,compileTemplate,options;if(MARGIN_TOP=25,compileTemplate=function(templateId){return $compile($templateCache.get(templateId))(scope)},options=_.assign({},defaultOptions,$parse(attrs.popup)(scope)),!options.disable)return el.on(options.event,function(event){var activeElementWidth,adjustPopupPosition,align,autoHide,calculateAlign,calculatePosition,containerEl,containerHeight,containerWidth,contentEl,contentInside,handlePopup,hideFn,injectToDOM,onOutsideClick,position;if(event.stopPropagation(),!el.hasClass(options.activeClass))return options.template&&el.html(compileTemplate(options.template)),_.forEach(hideFns,function(hide){return hide()}),containerWidth=0,containerHeight=0,activeElementWidth=0,contentInside=!!el.find("."+options.contentClass).length,contentEl=el.find(contentInside?"."+options.contentClass:"+ ."+options.contentClass),containerEl=angular.element("<div class='"+options.containerClass+"'></div>").append(contentEl),hideFn=function(){var revertBlock;return containerEl.find("iframe").prop("src","about:blank"),containerEl.find("iframe").remove(),$document.off("click",onOutsideClick),el.off("mouseleave.popup"),el.off("mouseenter.popup"),el.off("click.popup"),containerEl.off("mousemove.popup"),containerEl.off("mouseenter.popup"),containerEl.off("click.popup"),$(window).off("resize.popup"),$(window).off("click.popup"),$(window).off("mousemove.popup"),_.remove(hideFns,function(fn){return fn===hideFn}),revertBlock=function(){return el.removeClass(options.activeClass),options.parentSelector&&el.closest(options.parentSelector).removeClass(options.parentActiveClass),contentInside?el.append(contentEl):el.parent().append(contentEl),containerEl.remove()},options.fadeOut?(containerEl.css({opacity:1}),containerEl.animate({opacity:0},options.fadeOut,revertBlock)):revertBlock()},onOutsideClick=function(){return hideFn()},$document.on("click",onOutsideClick),position={},align={vertical:_.intersection(options.align.split(" "),["top","bottom"])[0],horizontal:_.intersection(options.align.split(" "),["left","right","center"])[0]},injectToDOM=function(){return el.addClass(options.activeClass),options.parentSelector&&el.closest(options.parentSelector).addClass(options.parentActiveClass),options.centeredTip&&containerEl.addClass("centered-tip"),$("body").append(containerEl)},autoHide=function(){var delay;return delay=300,hideFns.push(hideFn),containerEl.on("click.popup",hideFn),$(window).on("resize.popup",hideFn),setTimeout(function(){return $(window).on("click.popup",hideFn,100)}),el.one("mouseleave.popup",function(){var timeout;return containerEl.on("mousemove.popup",function(){return!1}),timeout=null,$(window).on("mousemove.popup",_.throttle(function(){var clearTimeout,hideContainer;return el.off("mouseenter.popup"),containerEl.off("mouseenter.popup"),clearTimeout=function(){if(timeout)return window.clearTimeout(timeout)},hideContainer=function(){return clearTimeout(),timeout=window.setTimeout(hideFn,delay)},containerEl.on("mousemove.popup",function(){return clearTimeout()}),el.on("mouseenter.popup",function(){return clearTimeout()}),hideContainer()},300))})},adjustPopupPosition=function(){var windowHeight;if(windowHeight=angular.element(window).height(),containerHeight+position.top+MARGIN_TOP>windowHeight)return position.top=windowHeight-containerHeight-MARGIN_TOP,containerEl.addClass("popup-no-arrow")},calculatePosition=function(){if(position="mouse"===options.pinTo?{top:event.clientY,left:event.clientX}:(options.pinToSelector&&el.find(options.pinToSelector)||el).offset(),position.top+=options.offsetTop+$(window).scrollTop(),position.left+=$(window).scrollLeft(),position.left+=/-?[0-9]+%/.test(options.offsetLeft)?parseFloat(options.offsetLeft)*activeElementWidth/100:options.offsetLeft,"left"===align.horizontal&&(position.left-=containerWidth),"top"===align.vertical&&(position.top-=containerHeight),"center"===align.horizontal)return position.left+=activeElementWidth/2-containerWidth/2},calculateAlign=function(){var horizontalAlign,possibleHorizontal,possibleVertical,verticalAlign,windowHeight;return windowHeight=angular.element(window).height(),possibleVertical=[],position.top+containerHeight<=windowHeight&&possibleVertical.push("bottom"),position.top-containerHeight>=0&&possibleVertical.push("top"),possibleHorizontal=[],position.left+containerWidth<=angular.element(window).width()&&possibleHorizontal.push("right"),position.left-containerWidth>=0&&possibleHorizontal.push("left"),"center"===align.horizontal&&position.left+activeElementWidth/2-containerWidth/2<=angular.element(window).width()&&possibleHorizontal.push("center"),verticalAlign=_.find(possibleVertical,function(possibleAlign){return possibleAlign===align.vertical}),horizontalAlign=_.find(possibleHorizontal,function(possibleAlign){return possibleAlign===align.horizontal}),align={vertical:verticalAlign||possibleVertical[0]||align.vertical||"bottom",horizontal:horizontalAlign||possibleHorizontal[0]||align.horizontal||"right"}},handlePopup=function(){if(containerWidth=containerEl.outerWidth(),containerHeight=containerEl.outerHeight(),activeElementWidth=el.outerWidth(),calculatePosition(),calculateAlign(),calculatePosition(),adjustPopupPosition(),containerEl.addClass(align.vertical+" "+align.horizontal).css({top:position.top,left:position.left}),options.fadeOut)return containerEl.css({opacity:1})},injectToDOM(),autoHide(),el.hasClass("item-preview")?(containerEl.hide(),contentEl.find("img").on("load",function(){return setTimeout(function(){return containerEl.show(),handlePopup()},0)})):handlePopup()})}}})}.call(this),function(){this.app.directive("resetScroll",function(){return function(scope,el,attrs){return scope.$watch(attrs.resetScroll,function(){return $(el).scrollTop(0)},!0)}})}.call(this),function(){this.app.directive("dragHighlight",function($parse,settings){return function(scope,element,attrs){var canUpload,disableUpload,dragEnterTarget,dragLeaveTarget,target;return canUpload=$parse(attrs.canUpload),target=attrs.dragHighlight?$(attr.dragHighlight):element,target=element,dragEnterTarget=null,dragLeaveTarget=null,disableUpload=function(){settings.disableUpload||canUpload(scope)},target.on("dragenter",function(e){if(e.stopPropagation(),e.preventDefault(),disableUpload())return dragEnterTarget=e.target,element.hasClass("drag")?void 0:element.addClass("drag")}),target.on("drop",function(e){if(!settings.disableUpload)return element.removeClass("drag")}),target.on("dragstop",function(e){if(e.stopPropagation(),e.preventDefault(),disableUpload())return dragEnterTarget=null,dragLeaveTarget=null,element.removeClass("drag")}),target.on("dragleave",function(e){if(e.stopPropagation(),e.preventDefault(),disableUpload())return dragLeaveTarget=e.target,dragEnterTarget===dragLeaveTarget?element.removeClass("drag"):void 0})}})}.call(this),function(){this.app.directive("dropFiles",function($parse,settings){return function(scope,element,attrs){var canUpload,dragOver,mapMultipart,upload;return upload=$parse(attrs.dropFiles),canUpload=$parse(attrs.canUpload),dragOver=function(e){return e.stopPropagation(),e.preventDefault()},mapMultipart=function(files){return _.map(files,function(file){return{file:file,name:file.name,size:file.size}})},$(element)[0].addEventListener("dragover",dragOver,!1),$(element).on("drop",function(e){var mappedFiles,ref;if(!settings.disableUpload&&canUpload(scope)&&null!=(null!=(ref=e.originalEvent.dataTransfer)?ref.files:void 0))return e.stopPropagation(),e.preventDefault(),e.originalEvent.dataTransfer.files.length?(mappedFiles=mapMultipart(e.originalEvent.dataTransfer.files),upload(scope,{files:mappedFiles})):void 0})}})}.call(this),function(){var hasParent,hoverClassName,lastOverElement;lastOverElement=null,hoverClassName="drop-hover",hasParent=function(element,parentElement){var parentToSearch;return parentToSearch=$(parentElement)[0],_.some($(element).parents(),function(parentEl){return parentEl===parentToSearch})},this.app.directive("droppable",function($parse){return function(scope,element,attrs){return $(document).on("drop",function(){return element.removeClass(hoverClassName)}),$(element).droppable({addClasses:!0,hoverClass:hoverClassName,greedy:!0,tolerance:"pointer",accept:function(draggableElement){return draggableElement[0]!==element[0]&&!hasParent(draggableElement,element)},over:function(){return $parse(attrs.canDropEntities)(scope)||element.removeClass(hoverClassName),lastOverElement&&lastOverElement!==element&&!element.parents("[droppable]").length&&element.removeClass(hoverClassName),lastOverElement=element,setTimeout(function(){return lastOverElement=null},10)},drop:function(event,ui){var fn;if($parse(attrs.canDropEntities)(scope)&&!hasParent(event.toElement,element)&&event.toElement!==element[0])return fn=$parse(attrs.droppable),scope.$apply(function(){return fn(scope)})}})}})}.call(this),function(){"use strict";this.app.directive("fileSelect",function($parse){return function(scope,element,attrs){var bindOnChange,input,mapInput,mapMultipart,parseFileName,upload;return upload=$parse(attrs.fileSelect),input=function(){return $(element).find('input[type="file"]')},parseFileName=function(path){return _.last(path.split("\\"))},mapMultipart=function(files){return _.map(files,function(file){return{file:file,name:file.name,size:file.size}})},mapInput=function(input,form,iframe){var fileToUpload;return fileToUpload={form:form,iframe:iframe,input:input,name:parseFileName(input.val()),size:1e3},[fileToUpload]},bindOnChange=function(e){var clone,form,iframe,mappedFiles;return e.target.files?(mappedFiles=mapMultipart(e.target.files,e.target),input().replaceWith(input().clone(!0,!0))):(input=$(e.target),form=$(angular.element("<form/>")),clone=input.clone(!0,!0),iframe=$(angular.element('<iframe name="iframeTransport'+Date.now()+'"/>')),form.insertAfter(input),form.append(input).append(iframe),clone.insertBefore(form),form.addClass("form-in-progress"),mappedFiles=mapInput(input,form,iframe)),input()[0].value="",upload(scope,{files:mappedFiles})},input().on("change",bindOnChange)}})}.call(this),function(){window.containerWidth=null,this.app.directive("itemsGridResize",function($parse){return{link:function(scope,element,attr){var adjustGrid,applyAdjusment,getContainerWidth,getItemsOffset,options;return getContainerWidth=function(){return $("entities-grid").width()&&(window.containerWidth=$("entities-grid").width()),window.containerWidth},options={gridSize:$parse(attr.itemsGridResize)(scope),initialSidebarWidth:200,freeze:!0},applyAdjusment=function(offset){var sidebarOffset;return sidebarOffset=options.initialSidebarWidth+offset,$(".entities-wrapper").css({left:sidebarOffset+1}),$(".sidebar").css({width:sidebarOffset})},getItemsOffset=function(){var itemsContainerWidth;return itemsContainerWidth=Math.floor(getContainerWidth()/(options.gridSize+16))*(options.gridSize+16),getContainerWidth()-itemsContainerWidth},adjustGrid=function(){if(applyAdjusment(0),!options.freeze)return applyAdjusment(Math.floor(getItemsOffset()/2))},scope.$watch(attr.itemsGridResize,function(gridSize){return gridSize?(options.gridSize=gridSize,options.freeze=!1):options.freeze=!0,adjustGrid()}),window.onresize=function(){if(!options.freeze)return adjustGrid()}}}})}.call(this),function(){"use strict";app.directive("deleteByKey",function($document,SelectedEntities){return{link:function(scope){var canRemove,pressBackspace,pressDelete;return pressBackspace=function(keyCode){return 8===keyCode},pressDelete=function(keyCode){return 46===keyCode},canRemove=function(){return scope.selectedEntitiesCount()&&(pressBackspace(event.keyCode)||pressDelete(event.keyCode))},$document.off("keydown.deleteByKey"),$document.on("keydown.deleteByKey",function(event){if(canRemove()&&"INPUT"!==event.target.tagName)return event.stopPropagation(),event.preventDefault(),scope.$remove.selected(scope.$nestedEntities,SelectedEntities)})}}})}.call(this),function(){app.directive("helpPopup",function(){return{restrict:"E",templateUrl:"scripts/directives/help-popup/help-popup.html",link:function(scope,el,attrs){return scope.hideLoader=function(){el.find(".popup-loader").hide()}}}})}.call(this),function(){app.directive("onLoad",function(){return{restrict:"A",scope:{callBack:"&onLoad"},link:function(scope,el,attrs){return el.on("load",function(){return scope.callBack()})}}})}.call(this),function(){this.app.factory("NotificationsCtrlPartial",function(events,Notifications,i18n){return function(){return this.list=Notifications.get(),this.expire=function(notification){return Notifications.expire(notification.id)},events.on(events.FOLDERS.LIST,function(promise){return promise.catch(function(){return Notifications.send(i18n.translate("errors.get_folders_failed"))})}),events.on(events.ITEMS.LIST,function(promise){return promise.catch(function(){return Notifications.send(i18n.translate("errors.get_items_failed"))})}),events.on(events.ITEMS.SEARCH,function(promise,event){return promise.catch(function(error){if("bigstock"!==event.eventTarget.name||503!==error.code)return Notifications.send(i18n.translate("errors.search_items_failed"))})}),events.on(events.ITEMS.SEARCH_BY_TAG,function(promise){return promise.catch(function(){return Notifications.send(i18n.translate("errors.get_items_by_tag_failed"))})}),events.on(events.FOLDER.CREATE,function(promise){return promise.catch(function(reason){return Notifications.send(i18n.translate("errors.create_folder_failed",reason))})}),events.on(events.FOLDER.RENAME,function(promise){return promise.catch(function(reason){return Notifications.send(i18n.translate("errors.rename_folder_failed",reason))})}),events.on(events.FOLDERS.REMOVE,function(promises){return _.forEach(promises,function(promise){return promise.catch(function(reason){return Notifications.send(i18n.translate("errors.remove_folder_failed"))})})}),events.on(events.ITEM.RENAME,function(promise){return promise.catch(function(reason){return Notifications.send(i18n.translate("errors.rename_item_failed",reason))})}),events.on(events.ITEMS.REMOVE,function(promises){return _.forEach(promises,function(promise){return promise.catch(function(reason){return Notifications.send(i18n.translate("errors.remove_item_failed"))})})}),events.on(events.ITEM.MOVE,function(promise){return promise.catch(function(reason){return Notifications.send(i18n.translate("errors.move_item_failed",reason))})}),events.on(events.ITEM.MAKE_FAVORITES,function(promise){return promise.catch(function(reason){return Notifications.send(i18n.translate("errors.make_item_favorites_failed",reason))})}),this}})}.call(this),function(){"use strict";this.app.directive("fileSize",function($parse){return function(scope,el,attr){return console.log($parse(attr.fileSize)(scope))}}),this.app.factory("UploadCtrlPartial",function($state,$rootScope,$timeout,mediaTypes,settings,i18n,getFileSizeLimit,editorConnection,confirm,getReadableFileSize,path){return function(adapter){var getCancelledFiles,getFailedFiles,getSucceededFiles,isFirstOpen,minimizationTimeout,redirectToPrivate,safeApply,updateProgress;return this.popupIsVisible=!1,this.totalProgressPercent=0,this.queue=[],this.adapter=adapter,this.getFilesQueue=function(_this){return function(){return _.filter(_this.queue,function(data){return data.source.file&&data.source.mediaType===settings.mediaType})}}(this),this.getFileSizeLimit=function(){return getReadableFileSize(getFileSizeLimit(settings.mediaType))},this.isFolder=function(fileToUpload){var ref,ref1,ref2,ref3;return""===(null!=(ref=fileToUpload.source)&&null!=(ref1=ref.file)?ref1.type:void 0)&&(null!=(ref2=fileToUpload.source)&&null!=(ref3=ref2.file)?ref3.size:void 0)<1e4},this.translateError=function(fileToUpload){var error,errorCode,key,message,ref,ref1,ref2;return this.isFolder(fileToUpload)?i18n.translate("uploader.upload_folder_error"):fileToUpload.error instanceof Promise.CancellationError?i18n.translate("error.upload.cancelled"):(error=fileToUpload.error||{},key="uploader."+(null!=(ref=error.data)&&null!=(ref1=ref.error_info)?ref1.key:void 0),i18n.isTranslatable(key)?i18n.translate(key,error.data.error_info.args||[]):(message="uploader.failed",errorCode=error.code||error.status,
_.includes([500,406],+errorCode)&&null!=(null!=(ref2=error.data)?ref2.error_description:void 0)?i18n.translate("uploader.request_fail",[error.data.error_description.replace(/for .*$/i,"")]):(key="error.upload."+errorCode,i18n.isTranslatable(key)&&(message=key),i18n.translate(message))))},this.isMinimization=!1,minimizationTimeout=null,this.showPopup=function(_this){return function(){return _this.popupIsVisible=!0,minimizationTimeout&&$timeout.cancel(minimizationTimeout),_this.isMinimization=!1}}(this),this.hidePopup=function(_this){return function(){_this.isMinimization=!0,minimizationTimeout&&$timeout.cancel(minimizationTimeout),minimizationTimeout=$timeout(function(){return _this.isMinimization=!1,$rootScope.$apply()},550),_this.popupIsVisible=!1}}(this),getSucceededFiles=function(_this){return function(){return _.filter(_this.getFilesQueue(),function(fileToUpload){return"succeeded"===fileToUpload.status})}}(this),getFailedFiles=function(_this){return function(){return _.filter(_this.getFilesQueue(),function(fileToUpload){return"failed"===fileToUpload.status})}}(this),getCancelledFiles=function(_this){return function(){return _.filter(_this.getFilesQueue(),_this.isCancelled)}}(this),this.allFilesCount=function(){return this.getFilesQueue().length},this.succeededFilesCount=function(){return getSucceededFiles().length},this.failedFilesCount=function(){return getFailedFiles().length},this.cancelledFilesCount=function(){return getCancelledFiles().length},this.hasInProgress=function(){return!!_.find(this.getFilesQueue(),function(_this){return function(fileToUpload){return _this.isInProgress(fileToUpload)}}(this))},this.hasFailedFiles=function(){return!!_.find(this.getFilesQueue(),function(fileToUpload){return"failed"===fileToUpload.status})},this.hasAbortable=function(){return!!_.find(this.getFilesQueue(),function(fileToUpload){return fileToUpload.canAbort()})},this.hasRetryable=function(){return!!_.find(this.getFilesQueue(),function(_this){return function(fileToUpload){return fileToUpload.canRetry()&&!_this.isFolder(fileToUpload)}}(this))},this.isInProgress=function(fileToUpload){return _.includes(["waiting","uploading","processing"],fileToUpload.status)},this.isWaiting=function(fileToUpload){return"waiting"===(null!=fileToUpload?fileToUpload.status:void 0)},this.isCancelled=function(fileToUpload){return"failed"===fileToUpload.status&&fileToUpload.error instanceof Promise.CancellationError},this.canCancelUpload=function(fileToUpload){return this.isInProgress(fileToUpload)||this.isWaiting(fileToUpload)},safeApply=_.debounce(function(){if(!$rootScope.$$phase)return $rootScope.$apply()},50),redirectToPrivate=function(){if($state.current.name!=="app."+settings.uploadAdapterName)return $state.go("app."+settings.uploadAdapterName)},isFirstOpen=!0,editorConnection.on("settings",function(){return isFirstOpen=!0}),this.addFiles=function(_this){return function(files,folder){var defaultFolder,uploadFn;return uploadFn=adapter.item.upload,settings.resumableUpload&&_.includes([mediaTypes.VIDEO,mediaTypes.SECURE_VIDEO],settings.mediaType)&&(uploadFn=adapter.item.uploadResumable),redirectToPrivate(),path.setFull(settings.uploadAdapterName),_this.showPopup(),isFirstOpen=!1,defaultFolder={id:null,name:i18n.translate("private_media.all_media")},folder&&folder.can.uploadIn()||(folder=defaultFolder),settings.maxParallelUploads&&(wixmp.Uploader.maxParallelUploads=settings.maxParallelUploads),wixmp.Uploader.upload(_.map(files,function(file){var base,base1,data;return data={uploadFn:uploadFn,source:_.assign(file,{folderId:folder.id,folderName:folder.name,mediaType:settings.mediaType})},"video"!==settings.mediaType&&"secure_video"!==settings.mediaType||""===settings.videoEncodingProfile||((base=data.source).encodingOptions||(base.encodingOptions={}),data.source.encodingOptions.profile_name=settings.videoEncodingProfile),settings.useFastTranscoding&&((base1=data.source).encodingOptions||(base1.encodingOptions={}),data.source.encodingOptions.fast_transcode=!0),data})),safeApply()}}(this),this.confirmAbortAll=function(){var options;return options={queue:this.getFilesQueue(),confirmTitle:i18n.translate("uploader.cancel_all_confirmation.title"),confirmMessage:i18n.translate("uploader.cancel_all_confirmation.message"),confirmYes:i18n.translate("uploader.cancel_all_confirmation.yes"),confirmNo:i18n.translate("uploader.cancel_all_confirmation.no"),confirm:function(){return _.forEach(options.queue,function(fileToUpload){return fileToUpload.abort()})}},confirm(options),!1},this.retryAll=function(){return _.forEach(this.getFilesQueue(),function(fileToUpload){if(fileToUpload.canRetry())return fileToUpload.signUpForRetry()})},this.getReadableFileSize=function(fileSize){return getReadableFileSize(fileSize)},updateProgress=function(_this){return function(){var bytesTotal,bytesTotalUploaded,files,status;return files=_this.getFilesQueue(),bytesTotalUploaded=_.sum(_.map(files,function(fileToUpload){return fileToUpload.bytesLoaded})),bytesTotal=_.sum(_.map(files,function(fileToUpload){return fileToUpload.source.file.size})),_this.totalProgressPercent=Math.round(100*bytesTotalUploaded/bytesTotal),status=100===_this.totalProgressPercent?"processing":"uploading",_.every(files,function(file){return"succeeded"===file.status})&&(status="succeeded"),editorConnection.emit("uploadProcessProgress",{data:{loaded:bytesTotalUploaded,status:status,total:bytesTotal},source:adapter.name}),"succeeded"===status&&editorConnection.emit("uploadProcessComplete",{data:{files:files,loaded:bytesTotalUploaded,status:status,total:bytesTotal},source:adapter.name}),_this.totalProgressPercent}}(this),wixmp.Uploader.on("fileStatusChanged",function(_this){return function(data){return _this.queue.length||(_this.queue=data.queue),updateProgress(),safeApply()}}(this)),wixmp.Uploader.on("queueChanged",function(_this){return function(queue){return _this.queue=queue,updateProgress()}}(this)),this}})}.call(this),function(){"use strict";this.app.factory("HelpCtrlPartial",function($sce,i18n){return function(){return this.popupIsVisible=!1,this.showPopup=function(){return this.popupIsVisible=!0},this.hidePopup=function(){return this.popupIsVisible=!1},this.url=$sce.trustAsResourceUrl(i18n.translate("help_url")),this}})}.call(this),function(){"use strict";this.app.factory("RemoveCtrlPartial",function(Folder,confirm,i18n){return function($scope){return this.selected=function(entities,selectedEntities){var currentSelectedEntities,entitiesCount,isInSiteMedia,options;return!!(entitiesCount=$scope.selectedEntitiesCount())&&(!((isInSiteMedia=_.some(entities.list,function(item){return item.isInSiteMedia}))&&(currentSelectedEntities=selectedEntities.get(),currentSelectedEntities=_.filter(currentSelectedEntities,function(entity){return!entity.readOnly}),!currentSelectedEntities.length))&&(options={confirmYes:i18n.translate("private_media.remove_confirmation.yes"),confirmNo:i18n.translate("private_media.remove_confirmation.no"),confirm:function(){return entities.removeSelected()}},isInSiteMedia?(options.confirmYes=i18n.translate("private_media.site_media.remove"),options.confirmTitle=i18n.translate("private_media.site_media.remove_confirmation.item.title"),options.confirmMessage=entitiesCount>1?i18n.translate("private_media.site_media.remove_confirmation.items.message",[entitiesCount]):i18n.translate("private_media.site_media.remove_confirmation.item.message")):entitiesCount>1?(options.confirmTitle=i18n.translate("private_media.remove_confirmation.items.title"),options.confirmMessage=i18n.translate("private_media.remove_confirmation.items.message",[entitiesCount])):(options.confirmTitle=i18n.translate("private_media.remove_confirmation.item.title"),options.confirmMessage=i18n.translate("private_media.remove_confirmation.item.message")),confirm(options),!1))},this.one=function(entity){var options;return options={confirmYes:i18n.translate("private_media.remove_confirmation.yes"),confirmNo:i18n.translate("private_media.remove_confirmation.no"),confirm:function(){return entity.remove()}},entity.isInSiteMedia?(options.confirmYes=i18n.translate("private_media.site_media.remove"),options.confirmTitle=i18n.translate("private_media.site_media.remove_confirmation.item.title"),options.confirmMessage=i18n.translate("private_media.site_media.remove_confirmation.item.message")):entity instanceof Folder?(options.confirmTitle=i18n.translate("private_media.remove_confirmation.folder.title"),options.confirmMessage=i18n.translate("private_media.remove_confirmation.folder.message")):(options.confirmTitle=i18n.translate("private_media.remove_confirmation.item.title"),options.confirmMessage=i18n.translate("private_media.remove_confirmation.item.message")),confirm(options),!1},this.folder=function(folder){return confirm({confirmTitle:i18n.translate("private_media.remove_confirmation.folder.title"),confirmMessage:i18n.translate("private_media.remove_confirmation.folder.message"),confirmYes:i18n.translate("private_media.remove_confirmation.yes"),confirmNo:i18n.translate("private_media.remove_confirmation.no"),confirm:function(){return folder.remove()}}),!1},this}})}.call(this),function(){"use strict";this.app.config(function(_this){return function($stateProvider){return $stateProvider.state("app",{url:"",templateUrl:"scripts/pages/app.html",controller:"appCtrl",resolve:{settings:function(Settings){return Settings.isLoaded},locales:function(LoadLocales,settings){return LoadLocales(settings).then(function(res){var ref;return null!=(ref=_this.appLoadNotifiers)&&ref.translationsLoaded(),res})}}})}}(this)),this.app.controller("appCtrl",function($document,$q,$scope,$state,SelectedEntities,Notifications,NotificationsCtrlPartial,FilterCtrlPartial,UploadCtrlPartial,HelpCtrlPartial,RemoveCtrlPartial,events,settings,editorConnection,submitItems,tabs,i18n){var lookupScope;return $scope.settings=settings,$scope.tabs=tabs,$scope.selectedEntitiesCount=function(){return SelectedEntities.size},$scope.isActiveTab=function(tab){return $state.includes(tab.state)},$scope.closeWindow=function(){return $document.off("keyup"),editorConnection.emit("close")},settings.closeWindowOnEscape&&$document.on("keyup",function(ev){if(27===ev.keyCode)return $scope.closeWindow()}),$scope.$searchQuery={query:"",currentQuery:""},$scope.$layouts=new FilterCtrlPartial("layout-grid",[{id:"layout-grid",name:"grid",itemWidth:126},{id:"layout-grid-large",name:"large grid",itemWidth:220},{id:"layout-list",name:"list",itemWidth:null}]),$scope.$notifications=new NotificationsCtrlPartial,tabs[settings.uploadAdapterName].canShow()&&($scope.$upload=new UploadCtrlPartial(tabs[settings.uploadAdapterName].getAdapter())),$scope.$help=new HelpCtrlPartial,$scope.$remove=new RemoveCtrlPartial($scope),$scope.canSubmitItems=function(){return!(SelectedEntities.size>1&&"single"===settings.selectionType)&&(!_.any(SelectedEntities.get(),function(item){var base;return!("function"==typeof(base=item.can).submit?base.submit():void 0)})&&SelectedEntities.size>0)},$scope.submitItemsTooltip=function(){return $scope.canSubmitItems()?"":"single"===settings.selectionType?i18n.translate("selected_items.tooltip_error_empty"):i18n.translate("selected_items.tooltip_error_multiple")},$scope.descriptionTranslationKey="private_media.upload_restrictions_header_message",$scope.footerSubmitTranslationKey="footer.submit",lookupScope=function(scope,attrName){if(null!=scope)return scope[attrName]?scope[attrName]:lookupScope(scope.$parent,attrName)},$scope.selectAndSubmitItem=function(item){var base;if(item.can.submit())return SelectedEntities.clear(),SelectedEntities.add(item),"function"==typeof(base=lookupScope(this,"submitItems"))?base():void 0},$scope.submitItems=function(){if($scope.canSubmitItems())return submitItems(_.filter(SelectedEntities.get(),function(item){return item.can.submit()}))},$scope.$on("$stateChangeSuccess",function(){return SelectedEntities.clear()})})}.call(this),function(){"use strict";this.app.config(function($stateProvider){return $stateProvider.state("init",{url:"/init/{settings:.*}",controller:"initCtrl"})}),this.app.controller("initCtrl",function($scope,$stateParams,$state,Settings){var logger;return logger=new Logger("initCtrl"),logger.log("settings received",$stateParams.settings),Settings.reload(JSON.parse(decodeURIComponent(encodeURIComponent($stateParams.settings))))})}.call(this),function(){"use strict";this.app.factory("favoritable",function(SelectedEntities){return function(controller,adapter,getParentFolder){var _events,makeFavoritesCount;return _events=adapter.events,makeFavoritesCount=0,_events.on(_events.ITEM.MAKE_FAVORITES,function(_this){return function(promise){return makeFavoritesCount++,promise.then(function(){if(!--makeFavoritesCount&&"favorites"===("function"==typeof getParentFolder?getParentFolder().type:void 0))return controller.load()})}}()),_events.on(_events.ITEM.UMMAKE_FAVORITES,function(_this){return function(promise){return promise.then(function(res){if("favorites"===("function"==typeof getParentFolder?getParentFolder().type:void 0))return _.remove(controller.list,function(entity){var ref;return entity.id===(null!=(ref=res.data)?ref.id:void 0)}),SelectedEntities.clear()})}}())}})}.call(this),function(){"use strict";this.app.factory("folderCreatable",function(ActionCtrlPartial,Notifications,i18n){return function(controller,adapter,getParentFolder){return controller.$createFolder=new ActionCtrlPartial(function(name){var ref;return 0===$.trim(name).length?Notifications.send(i18n.translate("errors.create_folder_failed.empty_name")):$.trim(name).length>256?Notifications.send(i18n.translate("errors.create_folder_failed.long_name")):adapter.folder.create(name,{parentId:"function"==typeof getParentFolder&&null!=(ref=getParentFolder())?ref.id:void 0})}),controller.$createFolder.show=_.flow(controller.$createFolder.show,function(_this){return function(){return controller.$createFolder.newName=""}}()),adapter.events.on(adapter.events.FOLDER.CREATE,function(_this){return function(promise){return promise.then(function(res){var parentId,ref,ref1,unsorted;if(!_.includes(["unsorted","allMedia","favorites","purchased"],"function"==typeof getParentFolder&&null!=(ref=getParentFolder())?ref.type:void 0))return parentId="function"==typeof getParentFolder&&null!=(ref1=getParentFolder())?ref1.id:void 0,parentId||(unsorted=_.find(controller.list,function(folder){return"unsorted"===folder.type}),parentId=null!=unsorted?unsorted.id:void 0),res.data.parentId!==parentId&&parentId?void 0:controller.list.unshift(res.data)})}}())}})}.call(this),function(){"use strict";this.app.factory("movable",function(SelectedEntities,Folder){return function(controller,adapter,getParentFolder){var _events,affectedFoldersIds,movingCount;return controller.moveSelectedToFolder=function(folder){return SelectedEntities.forEach(function(entity){var base;if("function"==typeof(base=entity.can).move?base.move():void 0)return entity instanceof Folder?folder.moveFolderIn(entity):folder.moveItemIn(entity)}),SelectedEntities.clear()},movingCount=0,affectedFoldersIds=[],_events=adapter.events,_events.on([_events.ITEM.MOVE,_events.FOLDER.MOVE],function(_this){return function(promise,event){return affectedFoldersIds.push(event.arguments[0].parentId||event.arguments[0].folderId),affectedFoldersIds.push(event.arguments[1].parentId||event.arguments[1].folderId),movingCount++,promise.then(function(){var ref,unsorted;if(!--movingCount)return unsorted=_.find(controller.list,function(folder){return"unsorted"===(null!=folder?folder.type:void 0)}),_.includes(affectedFoldersIds,("function"==typeof getParentFolder&&null!=(ref=getParentFolder())?ref.id:void 0)||(null!=unsorted?unsorted.id:void 0))&&controller.reload(),affectedFoldersIds.length=0})}}())}})}.call(this),function(){"use strict";this.app.factory("removable",function(SelectedEntities,Folder,Item){return function(controller,adapter,getParentFolder){var _events,isReadOnly,isSiteOwner;return isReadOnly=function(entity){return entity.readOnly},isSiteOwner=function(entity){return entity.isSiteOwner},controller.removeSelected=function(_this){return function(){var folders,foldersIds,items,itemsIds,ref,ref1;if(items=_.filter(SelectedEntities.get(),function(entity){return entity instanceof Item&&(isSiteOwner(entity)||!isReadOnly(entity))}),folders=_.filter(SelectedEntities.get(),function(entity){return entity instanceof Folder}),itemsIds=_.pluck(items,"id"),foldersIds=_.pluck(folders,"id"),"trash"===("function"==typeof getParentFolder&&null!=(ref=getParentFolder())?ref.type:void 0)){if(items.length&&adapter.items.trash.remove(itemsIds),folders.length)return adapter.folders.trash.remove(foldersIds)}else if("siteMedia"===("function"==typeof getParentFolder&&null!=(ref1=getParentFolder())?ref1.type:void 0)){if(items.length)return adapter.items.siteMedia.remove(itemsIds)}else if(items.length&&adapter.items.remove(itemsIds),folders.length)return adapter.folders.remove(foldersIds)}}(),_events=adapter.events,_events.on([_events.ITEMS.SITE_MEDIA.REMOVE],function(_this){return function(promise){return promise.then(function(res){return _.remove(controller.list,function(entity){return _.some(res.data.itemIds,function(id){return id===entity.id})}),SelectedEntities.clear()})}}()),_events.on([_events.ITEMS.REMOVE,_events.ITEMS.TRASH.REMOVE,_events.ITEMS.TRASH.RESTORE,_events.FOLDERS.REMOVE,_events.FOLDERS.TRASH.REMOVE,_events.FOLDERS.TRASH.RESTORE],function(_this){return function(promises){return _.forEach(promises,function(promise){return promise.then(function(res){var ref;if(_.remove(controller.list,function(entity){return entity.id===res.data.id}),SelectedEntities.clear(),(null!=(ref=controller.selectedFolder)?ref.id:void 0)===res.data.id)return"function"==typeof controller.selectFolder?controller.selectFolder(controller.list[0]):void 0})})}}())}})}.call(this),function(){"use strict";this.app.factory("renamable",function(ActionCtrlPartial,Notifications,Folder,i18n){return function(controller,adapter){return controller.$rename=new ActionCtrlPartial(function(entity,newName){var entityType;return entityType=entity instanceof Folder?"folder":"item",0===$.trim(newName).length?Notifications.send(i18n.translate("errors.rename_"+entityType+"_failed.empty_name")):$.trim(newName).length>256?Notifications.send(i18n.translate("errors.rename_"+entityType+"_failed.long_name")):entity.rename(newName)}),controller.$rename.show=_.flow(controller.$rename.show,function(entity){return controller.$rename.newName=entity.name})}})}.call(this),function(){"use strict";this.app.factory("transcodable",function(){return function(controller,adapter){var _events,transcodeItems,waitForTranscoding;return waitForTranscoding=function(){var ref;return null!=(ref=adapter.blackArrow)?ref.open():void 0},transcodeItems=function(_this){return function(response){var needTranscoding;if(needTranscoding=_.filter(response.data,function(entity){var base;return("function"==typeof(base=entity.can).transcode?base.transcode():void 0)&&!entity.isTranscoded()}),needTranscoding.length>0)return waitForTranscoding()}}(),_events=adapter.events,_events.on([_events.ITEMS.LIST,_events.ITEMS.SEARCH,_events.ITEMS.TRASH.LIST],function(_this){return function(promise){return promise.then(transcodeItems)}}()),wixmp.Uploader.on("uploadQueueStarted",function(_this){return function(){if(adapter.can.item.transcode())return waitForTranscoding()}}())}})}.call(this),function(){"use strict";this.app.factory("updatable",function(){return function(controller,adapter){var _events;return _events=adapter.events,_events.on([_events.ITEM.UPDATE,_events.FOLDER.UPDATE],function(_this){return function(promise){return promise.then(function(res){var dataForUpdate,updatedEntity;if(updatedEntity=_.find(controller.list,function(entity){return entity.id===res.data.id}))return dataForUpdate={},_.each(res.data,function(val,key){if(null!=val&&"id"!==key)return dataForUpdate[key]=val}),_.assign(updatedEntity,dataForUpdate)})}}())}})}.call(this),function(){"use strict";this.app.factory("ActionCtrlPartial",function($q,LoadingHelper,RejectError){return function(runAction){var currentEntity,currentProcessing,loader;return currentProcessing=void 0,currentEntity=void 0,loader=new LoadingHelper(this),this.isProcessing=function(entity){return currentProcessing===entity},this.isVisible=function(entity){return currentEntity===entity},this.hide=function(){return currentEntity=void 0},this.show=function(entity){return currentEntity=entity},this.runOrHide=function(entity,newName){var args;return args=_.filter(_.map(arguments)),newName?this.run.apply(this,args):this.hide.apply(this,args)},this.run=function(){return null==currentEntity?$q.reject(new RejectError(RejectError.noActionSubject,"ActionCtrl")):null!=currentProcessing?$q.reject(new RejectError(RejectError.alreadyLoading,"ActionCtrl")):loader.isDeniedByInterval()?$q.reject(new RejectError(RejectError.tooShortCallInterval,"ActionCtrl")):loader.attach($q.when(runAction.apply(this,arguments)).then(function(){return currentEntity=void 0,currentProcessing=void 0},function(){return currentProcessing=void 0}))},this}})}.call(this),function(){"use strict";this.app.factory("EntitiesCtrlPartial",function($q,SelectedEntities,LoadingHelper,RejectError,Folder,biUiEvents,editorConnection){var itemsPerPage;return itemsPerPage=50,function(adapter,$searchQuery,getParentFolder,loadEntities,searchEntities){var addEntitiesToScope,loadList,loadOrSearch,loadUnlessCount,loader,oldParentFolder,search;return this.list=null,this.selectedFolder=null,this.isLoading=!1,loader=new LoadingHelper(this),oldParentFolder=null,addEntitiesToScope=function(_this){return function(list){if(oldParentFolder===("function"==typeof getParentFolder?getParentFolder():void 0))return _this.list||(_this.list=[]),_.forEach(list.data,function(entity){if(!_.findWhere(_this.list,{id:entity.id}))return _this.list.push(entity)}),list}}(this),loadList=function(isFirstPage){return null==isFirstPage&&(isFirstPage=!0),null==loadEntities?$q.reject(new RejectError(RejectError.noMethod,"EntitiesCtrl.loadEntities")):loadEntities(isFirstPage)},search=function(isFirstPage){return null==isFirstPage&&(isFirstPage=!0),null==searchEntities?$q.reject(new RejectError(RejectError.noMethod,"EntitiesCtrl.searchEntities")):searchEntities($searchQuery.query,isFirstPage).then(function(response){return biUiEvents("search.performed",{found:response.data.length,query:$searchQuery.query}),response})},loadUnlessCount=function(loadData,isFirstPage,response){return loadData(isFirstPage).then(function(currentResponse){var ref;return currentResponse.data=((null!=response?response.data:void 0)||[]).concat(currentResponse.data||[]),currentResponse.data.length>=itemsPerPage||!(null!=(ref=currentResponse.paging)?ref.cursor:void 0)?currentResponse:loadUnlessCount(loadData,!1,currentResponse)},function(error){return response||$q.reject(error)})},loadOrSearch=function(_this){return function(isFirstPage,isReload){var loadData,promise;return null==isFirstPage&&(isFirstPage=!0),null==isReload&&(isReload=!1),_this.isLoading?$q.reject(new RejectError(RejectError.alreadyLoading,"EntitiesCtrl")):loader.isDeniedByInterval()&&oldParentFolder===("function"==typeof getParentFolder?getParentFolder():void 0)?$q.reject(new RejectError(RejectError.tooShortCallInterval,"EntitiesCtrl")):(oldParentFolder="function"==typeof getParentFolder?getParentFolder():void 0,isFirstPage&&(SelectedEntities.clear(),_this.list=null,isReload||(_this.selectedFolder=null)),loadData=$searchQuery.query&&searchEntities?search:loadList,promise=loader.attach(loadUnlessCount(loadData,isFirstPage).then(addEntitiesToScope)),isReload&&promise.then(function(data){return _this.selectedFolder?(_this.selectedFolder=_.find(_this.list,function(entity){return _this.selectedFolder.id===entity.id}),data):data}),promise)}}(this),this.nameById=function(_this){return function(id){var item;return item=_.find(_this.list,function(item){return item.id===id}),null!=item?item.name:void 0}}(this),this.load=function(_this){return function(){return loadOrSearch(!0)}}(),this.more=function(_this){return function(){return loadOrSearch(!1)}}(),this.reload=function(_this){return function(){return loadOrSearch(!0,!0)}}(),this.selectFolder=function(_this){return function(folder){return $searchQuery.currentQuery||($searchQuery.query=""),_this.selectedFolder=folder}}(this),this.isFolder=function(_this){return function(entity){return entity instanceof Folder}}(),editorConnection.on("reloadItems",this.load),this}})}.call(this),function(){this.app.factory("FilterCtrlPartial",function(){return function(defaultId,list){var defaultEntity;return this.selected=null,this.list=list,this.select=function(_this){return function(entity){return _this.selected=entity}}(this),defaultEntity=_.find(this.list,function(entity){return defaultId===entity.id}),this.select(defaultEntity||null),this}})}.call(this),function(){"use strict";this.app.factory("baseCtrl",function($q,EntitiesCtrlPartial,FilterCtrlPartial,Folder,settings,i18n,editorConnection,path,paginatedItemsListLoader,paginatedItemsSearchLoader){return function($scope,adapter){var getDefaultFolder,getDefaultNestedFolder,getSortOptions,initializationPath,isChildFolderSelectedAtPath,isPathWasSet,loadEntities,loadFolders,loadItems,loadNestedFolders,makeFoldersFirst,searchItems,sortNestedFolders,updatePath;return $scope.adapter=adapter,initializationPath=_.clone(path.get()),isPathWasSet=!1,updatePath=function(){var currentPath;return currentPath=[],_.forEach($scope.selectedFoldersPath,function(folder){return!!((null!=folder?folder.id:void 0)||(null!=folder?folder.virtualId:void 0))&&(currentPath.push(folder.id||folder.virtualId),!0)}),path.set(currentPath)},$scope.selectedFoldersPath=[],isChildFolderSelectedAtPath=function(){return!!initializationPath[$scope.selectedFoldersPath.length]},getDefaultFolder=function(){var folderId;if(folderId=initializationPath[0])return _.find($scope.$folders.list,function(folder){return folder.id===folderId||null!=folder.virtualId&&folder.virtualId===folderId})},loadFolders=function(){return adapter.folders.list().catch(function(reason){if(401===reason.code)return editorConnection.emit("notauthorized")})},$scope.$folders=new EntitiesCtrlPartial(adapter,$scope.$searchQuery,null,loadFolders),$scope.$folders.sortOrder=function(folder){return folder.isVirtual?"0"+folder.name:"1"+folder.name},$scope.$folders.load=_.flow($scope.$folders.load,function(promise){return promise.then(function(res){var defaultFolder;return defaultFolder=isPathWasSet?$scope.$folders.list[0]:getDefaultFolder()||$scope.$folders.list[0],$scope.$folders.selectFolder(defaultFolder),res})}),$scope.$folders.selectFolder=_.flow($scope.$folders.selectFolder,function(){return $scope.selectedFoldersPath=[$scope.$folders.selectedFolder],updatePath(),$scope.$nestedEntities.load()}),$scope.selectFolderOrNested=function(folder){var isNested,position;return position=$scope.selectedFoldersPath.indexOf(folder),isNested=position>=1,$scope.selectedFoldersPath.length=position,isNested?$scope.$nestedEntities.selectFolder(folder):$scope.$folders.selectFolder(folder)},$scope.getSelectedFolder=function(){return _.last($scope.selectedFoldersPath)},getDefaultNestedFolder=function(){var folderId;if(folderId=initializationPath[$scope.selectedFoldersPath.length])return _.find($scope.$nestedEntities.list,function(folder){return folder.id===folderId||null!=folder.virtualId&&folder.virtualId===folderId})},sortNestedFolders=function(list){var sortOrder;return sortOrder=$scope.$nestedEntities.sortOrder.selected.data,list.data=_.sortBy(list.data,sortOrder.attrName),"desc"===sortOrder.direction&&list.data.reverse(),list},makeFoldersFirst=function(list){return list.data=_.sortBy(list.data,function(entity){return entity instanceof Folder?0:1}),list},getSortOptions=function(){return{sort:$scope.$nestedEntities.sortOrder.selected.data}},loadItems=paginatedItemsListLoader(adapter,$scope.getSelectedFolder,getSortOptions),searchItems=paginatedItemsSearchLoader(adapter,$scope.getSelectedFolder,getSortOptions),loadNestedFolders=function(){var ref;return null!=(ref=$scope.getSelectedFolder())?ref.foldersList().then(function(list){return!isPathWasSet&&getDefaultNestedFolder()&&$scope.$nestedEntities.selectFolder(getDefaultNestedFolder()),sortNestedFolders(list)}):void 0},loadEntities=function(isFirstPage){var deferred,list,promises,unresolvedCount;return promises=[],settings.hasSubfolders&&isFirstPage&&!_.includes(["unsorted","allMedia","favorites","purchased"],"function"==typeof $scope.getSelectedFolder?$scope.getSelectedFolder().type:void 0)&&promises.push(loadNestedFolders()),isChildFolderSelectedAtPath()||promises.push(loadItems(isFirstPage)),list={data:[]},deferred=$q.defer(),unresolvedCount=0,_.forEach(promises,function(promise){return unresolvedCount++,promise.then(function(currentList){return list.data=list.data.concat(currentList.data),currentList}).then(function(){if(!--unresolvedCount)return deferred.resolve(makeFoldersFirst(list))},function(){if(!--unresolvedCount)return deferred.resolve(makeFoldersFirst(list))})}),deferred.promise},$scope.$nestedEntities=new EntitiesCtrlPartial(adapter,$scope.$searchQuery,$scope.getSelectedFolder,loadEntities,searchItems),$scope.$nestedEntities.selectFolder=_.flow($scope.$nestedEntities.selectFolder,function(folder){return $scope.selectedFoldersPath.push(folder),updatePath(),$scope.$nestedEntities.load()}),$scope.$nestedEntities.sortOrder=new FilterCtrlPartial("date_desc",[{id:"name_asc",name:i18n.translate("sort_order.name_asc"),data:{order:"name",attrName:"name",direction:"asc"}},{id:"name_desc",name:i18n.translate("sort_order.name_desc"),data:{order:"name",attrName:"name",direction:"desc"}},{id:"date_desc",name:i18n.translate("sort_order.date_desc"),data:{order:"date",attrName:"createdAt",direction:"desc"}},{id:"date_asc",name:i18n.translate("sort_order.date_asc"),data:{order:"date",attrName:"createdAt",direction:"asc"}}]),$scope.$nestedEntities.load=_.flow($scope.$nestedEntities.load,function(promise){return promise.catch(function(reason){if(401===reason.code)return editorConnection.emit("notauthorized")})}),$scope.$nestedEntities.sortOrder.select=_.flow($scope.$nestedEntities.sortOrder.select,function(){return $scope.$nestedEntities.load()}),function(){return $scope.$folders.load().then(function(){return isPathWasSet=!0})}}})}.call(this),function(){"use strict";this.app.config(function($stateProvider){return $stateProvider.state("app.empty",{url:"/empty",templateUrl:"scripts/pages/empty/empty.html",controller:"emptyCtrl",resolve:{adapter:function(tabs){return tabs.empty.getAdapter()}}})}),this.app.controller("emptyCtrl",function(_this){return function(){var ref;return null!=(ref=_this.appLoadNotifiers)?ref.emptyStateLoaded():void 0}}(this))}.call(this),function(){"use strict";var eventListeners;eventListeners={},this.app.config(function(_this){return function($stateProvider){return $stateProvider.state("app.private",{url:"/private",templateUrl:"scripts/pages/private/private.html",controller:"privateCtrl",resolve:{notify:function(){var ref;return null!=(ref=_this.appLoadNotifiers)?ref.tabSelected():void 0},adapter:function(tabs){return tabs.private.getAdapter()}}})}}(this)),this.app.controller("privateCtrl",function($scope,$state,$sce,$q,SelectedEntities,Folder,Item,adapter,baseCtrl,i18n,settings,editorConnection,path,updatable,transcodable,renamable,removable,movable,folderCreatable,favoritable,biMeasureImageLoadSpeed,TestWebsocket){var affectedWithUploadFoldersIds,canRefreshAfterUpload,clearSearchQuery,foldersNames,init,isSearch,isSomeFileUploaded,onFileStatusChanged,onUploadQueueFinished,onUploadQueueStarted,siteMediaTooltipLink,url;return init=baseCtrl($scope,adapter),$scope.measureImagesLoadSpeed=biMeasureImageLoadSpeed,$scope.selectedEntities=SelectedEntities,$scope.isSomeRemovable=function(){return _.some(SelectedEntities.get(),function(entity){return entity.can.removeFromFolder()||entity.can.remove()})},
$scope.deleteButtonText=function(){var ref;return"siteMedia"===(null!=(ref=$scope.getSelectedFolder())?ref.type:void 0)?"private_media.site_media.remove":"private_media.remove_items"},$scope.isSelectedSiteMediaFolder=function(){var ref;return"siteMedia"===(null!=(ref=$scope.getSelectedFolder())?ref.type:void 0)},foldersNames={},$scope.getFolderNameById=function(id){return foldersNames[id]},updatable($scope.$folders,adapter),renamable($scope.$folders,adapter),removable($scope.$folders,adapter,null),movable($scope.$folders,adapter,null),folderCreatable($scope.$folders,adapter,null),$scope.$folders.sortOrder=function(folder){return"allMedia"===folder.type?"0":"siteMedia"===folder.type?"1":"trash"===folder.type?"3":folder.isVirtual?"2"+folder.name:"4"+folder.name},$scope.getAllFolder=function(){return _.findWhere($scope.$folders.list,{type:"allMedia"})},$scope.getUnsorted=function(){return _.find($scope.$folders.list,function(folder){return"unsorted"===folder.type})},url=$sce.trustAsResourceUrl(i18n.translate("help_contributors_url")),siteMediaTooltipLink='<a href="'+url+'" target="_blank">'+i18n.translate("private_media.site_media.tooltip.link")+"</a>",$scope.siteMediaTooltip=i18n.translate("private_media.site_media.tooltip.text",[siteMediaTooltipLink]),$scope.isSiteMediaFolder=function(folder){return"siteMedia"===folder.id},updatable($scope.$nestedEntities,adapter),transcodable($scope.$nestedEntities,adapter),renamable($scope.$nestedEntities,adapter),removable($scope.$nestedEntities,adapter,$scope.getSelectedFolder),movable($scope.$nestedEntities,adapter,$scope.getSelectedFolder),folderCreatable($scope.$nestedEntities,adapter,$scope.getSelectedFolder),favoritable($scope.$nestedEntities,adapter,$scope.getSelectedFolder),adapter.events.on(adapter.events.FOLDERS.LIST,function(promise){return promise.then(function(res){return _.forEach(res.data,function(folder){return foldersNames[folder.id]=folder.name})})}),adapter.events.on([adapter.events.FOLDER.UPDATE,adapter.events.FOLDER.CREATE],function(promise){return promise.then(function(res){return foldersNames[res.data.id]=res.data.name})}),isSomeFileUploaded=function(){return _.some($scope.$upload.queue,function(fileToUpload){return"succeeded"===fileToUpload.status})},isSearch=function(){return!!$scope.$searchQuery.query},clearSearchQuery=function(){return $scope.$searchQuery.query="",$scope.$searchQuery.currentQuery=""},affectedWithUploadFoldersIds=[],canRefreshAfterUpload=function(){var ref,ref1,ref2;return _.includes(["allMedia","siteMedia"],null!=(ref=$scope.getSelectedFolder())?ref.type:void 0)||_.includes(affectedWithUploadFoldersIds,null!=(ref1=$scope.getSelectedFolder())?ref1.id:void 0)&&!_.includes(["favorites","purchased","trash"],null!=(ref2=$scope.getSelectedFolder())?ref2.type:void 0)},onUploadQueueStarted=function(){if(_.includes(["video","secure_video"],settings.mediaType))return $scope.$upload.showPopup()},onUploadQueueFinished=function(){if(isSomeFileUploaded()&&canRefreshAfterUpload())return isSearch()&&clearSearchQuery(),$scope.$nestedEntities.load().then(function(){return SelectedEntities.clear(),SelectedEntities.add(_.find($scope.$nestedEntities.list,function(entity){return entity instanceof Item}))})},onFileStatusChanged=function(_this){return function(progress){var item,itemData,ref;if("succeeded"===progress.currentFileProgress.status){if(itemData=progress.currentFileProgress.file.serverResponse.data,itemData.mediaType!==settings.mediaType)return;if(_.includes(affectedWithUploadFoldersIds,itemData.folderId)||affectedWithUploadFoldersIds.push(itemData.folderId),item=new Item(adapter,itemData),isSearch())return clearSearchQuery(),$scope.$nestedEntities.load();if(item.folderId===(null!=(ref=$scope.getSelectedFolder())?ref.id:void 0)||canRefreshAfterUpload())return $scope.$nestedEntities.list.unshift(item)}}}(),_.mapKeys(eventListeners,function(listener,event){return wixmp.Uploader.off(event,listener)}),wixmp.Uploader.on("uploadQueueStarted",onUploadQueueStarted),eventListeners.uploadQueueStarted=onUploadQueueStarted,wixmp.Uploader.on("uploadQueueFinished",onUploadQueueFinished),eventListeners.uploadQueueFinished=onUploadQueueFinished,wixmp.Uploader.on("fileStatusChanged",onFileStatusChanged),eventListeners.fileStatusChanged=onFileStatusChanged,adapter.events.on(adapter.events.FOLDERS.TRASH.RESTORE,function(_this){return function(promises){return $q.all(promises).finally(function(){return $scope.$folders.reload()})}}()),adapter.events.on(adapter.events.FOLDERS.REMOVE,function(_this){return function(promises){return $q.all(promises).finally(function(){if(1===$scope.selectedFoldersPath.length&&"trash"===$scope.selectedFoldersPath[0].type)return $scope.$nestedEntities.load()})}}()),(settings.blackArrowTests||"debug"===settings.mode)&&TestWebsocket(adapter,settings),init()})}.call(this),function(){"use strict";var eventListeners;eventListeners={},this.app.config(function(_this){return function($stateProvider){return $stateProvider.state("app.platform",{url:"/platform",templateUrl:"scripts/pages/platform/platform.html",controller:"platformCtrl",resolve:{notify:function(){var ref;return null!=(ref=_this.appLoadNotifiers)?ref.tabSelected():void 0},adapter:function(tabs){return tabs.platform.getAdapter()}}})}}(this)),this.app.controller("platformCtrl",function($scope,$state,$sce,$q,SelectedEntities,Folder,Item,adapter,baseCtrl,i18n,settings,editorConnection,path,updatable,transcodable,renamable,removable,movable,folderCreatable,favoritable){var affectedWithUploadFoldersIds,canRefreshAfterUpload,clearSearchQuery,foldersNames,init,isSearch,isSomeFileUploaded,onFileStatusChanged,onUploadQueueFinished,onUploadQueueStarted,siteMediaTooltipLink,url;return init=baseCtrl($scope,adapter),$scope.selectedEntities=SelectedEntities,$scope.isSomeRemovable=function(){return _.some(SelectedEntities.get(),function(entity){return entity.can.removeFromFolder()||entity.can.remove()})},$scope.deleteButtonText=function(){var ref;return"siteMedia"===(null!=(ref=$scope.getSelectedFolder())?ref.type:void 0)?"private_media.site_media.remove":"private_media.remove_items"},$scope.showNoEntitiesDescriptionLink=function(){return!1},foldersNames={},$scope.getFolderNameById=function(id){return foldersNames[id]},updatable($scope.$folders,adapter),renamable($scope.$folders,adapter),removable($scope.$folders,adapter,null),movable($scope.$folders,adapter,null),folderCreatable($scope.$folders,adapter,null),$scope.$folders.sortOrder=function(folder){return"allMedia"===folder.type?"0":"siteMedia"===folder.type?"1":"trash"===folder.type?"3":folder.isVirtual?"2"+folder.name:"4"+folder.name},$scope.getAllFolder=function(){return _.findWhere($scope.$folders.list,{type:"allMedia"})},$scope.getUnsorted=function(){return _.find($scope.$folders.list,function(folder){return"unsorted"===folder.type})},url=$sce.trustAsResourceUrl(i18n.translate("help_contributors_url")),siteMediaTooltipLink='<a href="'+url+'" target="_blank">'+i18n.translate("private_media.site_media.tooltip.link")+"</a>",$scope.siteMediaTooltip=i18n.translate("private_media.site_media.tooltip.text",[siteMediaTooltipLink]),$scope.isSiteMediaFolder=function(folder){return"siteMedia"===folder.id},updatable($scope.$nestedEntities,adapter),transcodable($scope.$nestedEntities,adapter),renamable($scope.$nestedEntities,adapter),removable($scope.$nestedEntities,adapter,$scope.getSelectedFolder),movable($scope.$nestedEntities,adapter,$scope.getSelectedFolder),folderCreatable($scope.$nestedEntities,adapter,$scope.getSelectedFolder),favoritable($scope.$nestedEntities,adapter,$scope.getSelectedFolder),adapter.events.on(adapter.events.FOLDERS.LIST,function(promise){return promise.then(function(res){return _.forEach(res.data,function(folder){return foldersNames[folder.id]=folder.name})})}),adapter.events.on([adapter.events.FOLDER.UPDATE,adapter.events.FOLDER.CREATE],function(promise){return promise.then(function(res){return foldersNames[res.data.id]=res.data.name})}),isSomeFileUploaded=function(){return _.some($scope.$upload.queue,function(fileToUpload){return"succeeded"===fileToUpload.status})},isSearch=function(){return!!$scope.$searchQuery.query},clearSearchQuery=function(){return $scope.$searchQuery.query="",$scope.$searchQuery.currentQuery=""},affectedWithUploadFoldersIds=[],canRefreshAfterUpload=function(){var ref,ref1,ref2;return _.includes(["allMedia","siteMedia"],null!=(ref=$scope.getSelectedFolder())?ref.type:void 0)||_.includes(affectedWithUploadFoldersIds,null!=(ref1=$scope.getSelectedFolder())?ref1.id:void 0)&&!_.includes(["favorites","purchased","trash"],null!=(ref2=$scope.getSelectedFolder())?ref2.type:void 0)},onUploadQueueStarted=function(){if(_.includes(["video","secure_video"],settings.mediaType))return $scope.$upload.showPopup()},onUploadQueueFinished=function(){if(isSomeFileUploaded()&&canRefreshAfterUpload())return isSearch()&&clearSearchQuery(),$scope.$nestedEntities.load().then(function(){return SelectedEntities.clear(),SelectedEntities.add(_.find($scope.$nestedEntities.list,function(entity){return entity instanceof Item}))})},onFileStatusChanged=function(_this){return function(progress){var item,itemData,ref;if("succeeded"===progress.currentFileProgress.status){if(itemData=progress.currentFileProgress.file.serverResponse.data,itemData.mediaType!==settings.mediaType)return;if(_.includes(affectedWithUploadFoldersIds,itemData.folderId)||affectedWithUploadFoldersIds.push(itemData.folderId),item=new Item(adapter,itemData),isSearch())return clearSearchQuery(),$scope.$nestedEntities.load();if(item.folderId===(null!=(ref=$scope.getSelectedFolder())?ref.id:void 0)||canRefreshAfterUpload())return $scope.$nestedEntities.list.unshift(item)}}}(),_.mapKeys(eventListeners,function(listener,event){return wixmp.Uploader.off(event,listener)}),wixmp.Uploader.on("uploadQueueStarted",onUploadQueueStarted),eventListeners.uploadQueueStarted=onUploadQueueStarted,wixmp.Uploader.on("uploadQueueFinished",onUploadQueueFinished),eventListeners.uploadQueueFinished=onUploadQueueFinished,wixmp.Uploader.on("fileStatusChanged",onFileStatusChanged),eventListeners.fileStatusChanged=onFileStatusChanged,adapter.events.on(adapter.events.FOLDERS.TRASH.RESTORE,function(_this){return function(promises){return $q.all(promises).finally(function(){return $scope.$folders.reload()})}}()),adapter.events.on(adapter.events.FOLDERS.REMOVE,function(_this){return function(promises){return $q.all(promises).finally(function(){if(1===$scope.selectedFoldersPath.length&&"trash"===$scope.selectedFoldersPath[0].type)return $scope.$nestedEntities.load()})}}()),init()})}.call(this),function(){"use strict";this.app.config(function(_this){return function($stateProvider){return $stateProvider.state("app.public",{url:"/public",templateUrl:"scripts/pages/public/public.html",controller:"publicMediaCtrl",resolve:{notify:function(){var ref;return null!=(ref=_this.appLoadNotifiers)?ref.tabSelected():void 0},adapter:function(tabs){return tabs.public.getAdapter()}}})}}(this)),this.app.controller("publicMediaCtrl",function($scope,adapter,$state,settings,submitItems,SelectedEntities,path,EntitiesCtrlPartial,paginatedItemsListLoader,paginatedItemsSearchLoader,publicAllCategoriesIds){var clearSearchQuery,getDefaultFolder,getDefaultParentFolder,getSelectedFolder,getSelectedParentFolder,initializationPath,isPathWasSet,loadFolders,loadItems,loadParentFolders,searchItems,updatePath;return $scope.adapter=adapter,initializationPath=_.clone(path.get()),isPathWasSet=!1,updatePath=function(){var currentPath,ref,ref1;return currentPath=[],(null!=(ref=$scope.$parentFolders.selectedFolder)?ref.id:void 0)&&(currentPath.push($scope.$parentFolders.selectedFolder.id.split(":")[0]),(null!=(ref1=$scope.$folders.selectedFolder)?ref1.id:void 0)&&currentPath.push($scope.$folders.selectedFolder.id.split(":")[0])),path.set(currentPath)},getDefaultParentFolder=function(){var folderId,res;if(folderId=initializationPath[0])return res=$scope.$parentFolders.list.filter(function(f){return f.id.split(":")[0]===folderId}),res[0]},loadParentFolders=function(){return adapter.folders.list(settings.publicMediaRoot)},$scope.$parentFolders=new EntitiesCtrlPartial(adapter,$scope.$searchQuery,null,loadParentFolders),$scope.$parentFolders.load=_.flow($scope.$parentFolders.load,function(promise){return promise.then(function(){return isPathWasSet?$scope.$parentFolders.selectFolder($scope.$parentFolders.list[0]):$scope.$parentFolders.selectFolder(getDefaultParentFolder()||$scope.$parentFolders.list[0])})}),$scope.$parentFolders.selectFolder=_.flow($scope.$parentFolders.selectFolder,function(){return updatePath(),$scope.$folders.load()}),$scope.$parentFolders.sortOrder=null,getDefaultFolder=function(){var folderId,res;if(folderId=initializationPath[1])return res=$scope.$folders.list.filter(function(f){return f.id.split(":")[0]===folderId}),res[0]},getSelectedParentFolder=function(){return $scope.$parentFolders.selectedFolder},clearSearchQuery=function(){return $scope.$searchQuery.query="",$scope.$searchQuery.currentQuery=""},loadFolders=function(){return $scope.$parentFolders.selectedFolder.foldersList()},$scope.$folders=new EntitiesCtrlPartial(adapter,$scope.$searchQuery,getSelectedParentFolder,loadFolders),$scope.$folders.load=_.flow($scope.$folders.load,function(promise){return promise.then(function(){return isPathWasSet?$scope.$folders.selectFolder($scope.$folders.list[0]):$scope.$folders.selectFolder(getDefaultFolder()||$scope.$folders.list[0])})}),$scope.$folders.selectFolder=_.flow($scope.$folders.selectFolder,function(){return isPathWasSet&&clearSearchQuery(),updatePath(),$scope.$nestedEntities.load()}),$scope.getAllFolder=function(){return _.find($scope.$folders.list,function(folder){return _.includes(publicAllCategoriesIds,""+folder.id.split(":")[0])})},getSelectedFolder=function(){return $scope.$folders.selectedFolder},loadItems=paginatedItemsListLoader(adapter,getSelectedFolder),searchItems=paginatedItemsSearchLoader(adapter,getSelectedFolder),$scope.$nestedEntities=new EntitiesCtrlPartial(adapter,$scope.$searchQuery,getSelectedFolder,loadItems,searchItems),$scope.$nestedEntities.load=_.flow($scope.$nestedEntities.load,function(){return $scope.$searchQuery.query,updatePath()}),$scope.descriptionTranslationKey=void 0,$scope.$parentFolders.load().then(function(){return isPathWasSet=!0}),$scope.submitItems=function(){var idsToGet,promise,readyToSubmit;return readyToSubmit=[],idsToGet=[],_.forEach(SelectedEntities.get(),function(item){return"part"===item.subtype?idsToGet.push(item.id):readyToSubmit.push(item)}),idsToGet.length?(promise=adapter.item.get(idsToGet),promise.then(function(items){return submitItems(readyToSubmit.concat(items.data))})):submitItems(readyToSubmit)}})}.call(this),function(){"use strict";this.app.constant("publicAllCategoriesIds",["c2a37dfc-36cf-4bfd-b940-55bac7bdc9e6","bd176e29-5534-4d9f-87a6-a8177517ea4f","820351a1-729d-4bd1-856d-d578ca44f29e","ea934aee-5729-4c5e-aed1-ac25f5489914","cfad1a19-5cae-4d27-9cb7-fbf39ab6b644","2217cb59-e74f-4eac-b039-c5a61722d69a","9e839ab1-0fe5-4ffe-84c3-1ac80406ae66","8aa61c23-bff9-4426-ae8c-c1fd569764bf","d7b4efe4-a6ea-42df-80ac-1820c14fbe9a","b1dbbe33-cc31-4b23-b865-a81680f70976","8a78186b-a8d2-434a-91e1-8020f6bc9c87","a3269d65-3971-4557-9c4e-918b7a67edc9","d6b6b972-952c-4ab0-b46a-a6c05a0a94a5"])}.call(this),function(){"use strict";var indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};this.app.config(function(_this){return function($stateProvider){return $stateProvider.state("app.external",{url:"/external",templateUrl:"scripts/pages/external/external.html",controller:"externalCtrl",resolve:{notify:function(){var ref;return null!=(ref=_this.appLoadNotifiers)?ref.tabSelected():void 0},adapters:function(tabs){return tabs.external.getAdapters()}}})}}(this)),this.app.controller("externalCtrl",function($scope,adapters,$q,submitItems,importItems,SelectedEntities,i18n,FilterCtrlPartial,EntitiesCtrlPartial,path,Folder,serviceRedirectUrl,paginatedItemsListLoader,supportedExternalServicesWithoutFolders,externalAdaptersWithNestedSupport){var getDefaultNestedFolder,getFirstConnectedService,getServiceFromPath,importedCount,initializationPath,isChildFolderSelectedAtPath,isPathWasSet,itemsPartialControllers,loadNestedFolders,makeFoldersFirst,ref,selectDefaultService,servicesList,setAdapter,skipImport,sortNestedFolders,updatePath,userSettings;return initializationPath=_.clone(path.get()),isPathWasSet=!1,updatePath=function(){var currentPath;return currentPath=[],$scope.$services.selected&&currentPath.push($scope.$services.selected.id),_.forEach($scope.selectedFoldersPath,function(folder){return!!((null!=folder?folder.id:void 0)||(null!=folder?folder.virtualId:void 0))&&(currentPath.push(folder.id||folder.virtualId),!0)}),path.set(currentPath)},$scope.selectedFoldersPath=[],userSettings={redirectUrl:serviceRedirectUrl()},servicesList=_.map(adapters,function(adapter){var connectorId;return connectorId=_.snakeCase(adapter.name).toUpperCase(),{id:adapter.name,translationKey:adapter.translationKey||adapter.name,name:i18n.translate("external_media."+(adapter.translationKey||adapter.name)),connector:wixmp.connectExternalSource(connectorId,userSettings)}}),$scope.$services=new FilterCtrlPartial(null,servicesList),getFirstConnectedService=function(){return _.find($scope.$services.list,$scope.$services.isConnected)},getServiceFromPath=function(){var serviceFromPath,serviceId;return serviceId=initializationPath[0],serviceId&&(serviceFromPath=_.find($scope.$services.list,function(service){return service.id===serviceId})),serviceFromPath},selectDefaultService=function(){return isPathWasSet?$scope.$services.select(getFirstConnectedService()||null):$scope.$services.select(getServiceFromPath()||getFirstConnectedService()||null)},setAdapter=function(service){return $scope.adapter=_.findWhere(adapters,{name:service.id}),$scope.$nestedEntities=itemsPartialControllers[service.id]},$scope.breadcrumbsList=function(){return _.includes(supportedExternalServicesWithoutFolders,$scope.$services.selected.id)?[$scope.$services.selected]:[$scope.$services.selected].concat($scope.selectedFoldersPath)},$scope.$services.connect=function(service){return service.connector.connect().then(function(){return $scope.$services.select(service)})},$scope.$services.disconnect=function(service){if($scope.$services.isConnected(service))return $scope.$services.selected===service&&$scope.$services.select(null),service.connector.disconnect().then(selectDefaultService)},$scope.$services.isConnected=function(service){return null!=service?service.connector.isConnected():void 0},$scope.$services.isAllDisconnected=function(){return _.every($scope.$services.list,function(service){return!$scope.$services.isConnected(service)})},$scope.$services.isAllConnected=function(){return _.every($scope.$services.list,$scope.$services.isConnected)},$scope.$services.disconnectedList=function(){return _.filter($scope.$services.list,function(service){return!$scope.$services.isConnected(service)})},$scope.$services.select=_.flow($scope.$services.select,function(service){if(service&&setAdapter(service),$scope.selectedFoldersPath=[],updatePath(),isPathWasSet=!0,$scope.$services.isConnected(service))return $scope.$nestedEntities.load().then(function(){if(_.includes(supportedExternalServicesWithoutFolders,service.id))return $scope.$nestedEntities.selectFolder(_.find($scope.$nestedEntities.list,function(entity){return entity instanceof Folder}))})}),isChildFolderSelectedAtPath=function(){return!!getDefaultNestedFolder()},$scope.getSelectedFolder=function(){return _.last($scope.selectedFoldersPath)},getDefaultNestedFolder=function(){var folderId;if(folderId=initializationPath[$scope.selectedFoldersPath.length])return _.find($scope.$nestedEntities.list,function(folder){return folder.id===folderId||null!=folder.virtualId&&folder.virtualId===folderId})},sortNestedFolders=function(list){return list.data=_.sortBy(list.data,"name"),list},makeFoldersFirst=function(list){return list.data=_.sortBy(list.data,function(entity){return entity instanceof Folder?0:1}),list},loadNestedFolders=function(){var promise,ref;return promise=(null!=(ref=$scope.getSelectedFolder())?ref.foldersList():void 0)||$scope.adapter.folders.list(),promise.then(function(list){return!isPathWasSet&&getDefaultNestedFolder()&&$scope.$nestedEntities.selectFolder(getDefaultNestedFolder()),sortNestedFolders(list),$scope.$nestedEntities.list=null!=list?list.data:void 0})},$scope.selectFolderOrService=function(folder){var position;return position=$scope.selectedFoldersPath.indexOf(folder),position>=0&&($scope.selectedFoldersPath.length=position),folder instanceof Folder?$scope.$nestedEntities.selectFolder(folder):$scope.$services.select(folder)},itemsPartialControllers={},_.forEach(adapters,function(adapter){var loadAllEntities,loadItems;return loadItems=paginatedItemsListLoader(adapter,$scope.getSelectedFolder),loadAllEntities=function(isFirstPage){var deferred,list,promises,ref,ref1,unresovedCount;return promises=[],isFirstPage&&(!$scope.getSelectedFolder()||(ref=adapter.name,indexOf.call(externalAdaptersWithNestedSupport,ref)>=0))&&promises.push(loadNestedFolders()),($scope.getSelectedFolder()||(ref1=$scope.adapter.name,indexOf.call(externalAdaptersWithNestedSupport,ref1)>=0))&&!isChildFolderSelectedAtPath()&&promises.push(loadItems(isFirstPage)),list={data:[]},deferred=$q.defer(),unresovedCount=0,_.forEach(promises,function(promise){return unresovedCount++,promise.then(function(currentList){return currentList.data&&(list.data=list.data.concat(currentList.data)),currentList}).finally(function(){if(!--unresovedCount)return deferred.resolve(makeFoldersFirst(list))})}),deferred.promise},itemsPartialControllers[adapter.name]=new EntitiesCtrlPartial(adapter,$scope.$searchQuery,$scope.getSelectedFolder,loadAllEntities),itemsPartialControllers[adapter.name].selectFolder=_.flow(itemsPartialControllers[adapter.name].selectFolder,function(folder){return $scope.selectedFoldersPath.push(folder),updatePath(),itemsPartialControllers[adapter.name].load()}),itemsPartialControllers[adapter.name].load=_.flow(itemsPartialControllers[adapter.name].load,function(promise){return promise.catch(function(reason){if(401===reason.code)return editorConnection.emit("notauthorized")})}),itemsPartialControllers[adapter.name].load=_.flow(itemsPartialControllers[adapter.name].load,function(promise){return $scope.isLoading=!0,promise.finally(function(){return $scope.isLoading=!1})})}),$scope.canSubmitItems=_.flow($scope.canSubmitItems,function(canSubmit){return canSubmit&&!$scope.isImporting}),skipImport=function(){return $scope.adapter.can.item.skipImport()},importedCount=0,$scope.getImportingProgress=function(){return importedCount/SelectedEntities.get().length},$scope.importingCount=0,$scope.submitItems=function(){var importedItems,promises;if($scope.canSubmitItems())return skipImport()?submitItems(SelectedEntities.get()):(importedItems=[],$scope.isImporting=!0,importedCount=0,promises=importItems(SelectedEntities.get(),$scope.adapter.name),$scope.importingCount=promises.length,_.forEach(promises,function(promise){return promise.then(function(item){return importedItems.push(item),importedCount++})}),$q.all(promises).then(function(){return $scope.isImporting=!1,submitItems(importedItems),$scope.importingCount=0},function(){return $scope.isImporting=!1,$scope.importingCount=0}))},$scope.getSelectedFolderOrServiceName=function(){var ref,serviceName;return serviceName=i18n.translate("external_media."+$scope.$services.selected.id),_.includes(supportedExternalServicesWithoutFolders,$scope.$services.selected.id)?serviceName:(null!=(ref=$scope.getSelectedFolder())?ref.name:void 0)||serviceName},$scope.descriptionTranslationKey="external_media.upload_restrictions_header_message",_.forEach(adapters,function(adapter){return adapter.events.on([adapter.events.ITEMS.LIST,adapter.events.FOLDERS.LIST],function(promise){if($scope.adapter===adapter)return promise.catch(function(error){if(403===error.code||401===error.code)return $scope.$services.disconnect($scope.$services.selected)})})}),null!=(ref=selectDefaultService())?ref.then(function(){return isPathWasSet=!0}):void 0})}.call(this),function(){"use strict";this.app.config(function(_this){return function($stateProvider){return $stateProvider.state("app.externalSearch",{url:"/externalSearch",templateUrl:"scripts/pages/external-search/external-search.html",controller:"externalSearchCtrl",resolve:{notify:function(){var ref;return null!=(ref=_this.appLoadNotifiers)?ref.tabSelected():void 0},adapters:function(tabs){return tabs.externalSearch.getAdapters()}}})}}(this)),this.app.controller("externalSearchCtrl",function($scope,adapters,submitItems,importItems,SelectedEntities,i18n,FilterCtrlPartial,EntitiesCtrlPartial,path,paginatedItemsSearchLoader,$q){var defaultServiceId,getServiceFromPath,importedCount,initializationPath,itemsPartialControllers,servicesList,setAdapter,skipImport,updatePath;return initializationPath=_.clone(path.get()),updatePath=function(){var currentPath;return currentPath=[],null!=$scope.$services.selected&&currentPath.push($scope.$services.selected.id),path.set(currentPath)},defaultServiceId=path.get()[1]||"googleSearch",servicesList=_.map(adapters,function(adapter){return{id:adapter.name,name:i18n.translate("external_search."+adapter.name)}}),$scope.$services=new FilterCtrlPartial(defaultServiceId,servicesList),setAdapter=function(service){return $scope.adapter=_.findWhere(adapters,{name:service.id}),$scope.$nestedEntities=itemsPartialControllers[service.id]},$scope.$services.select=_.flow($scope.$services.select,function(){return setAdapter($scope.$services.selected),$scope.$nestedEntities.load()}),itemsPartialControllers={},_.forEach(adapters,function(adapter){var searchItems;return searchItems=paginatedItemsSearchLoader(adapter),itemsPartialControllers[adapter.name]=new EntitiesCtrlPartial(adapter,$scope.$searchQuery,null,null,searchItems)}),$scope.canSubmitItems=_.flow($scope.canSubmitItems,function(canSubmit){return canSubmit&&!$scope.isImporting}),skipImport=function(){return $scope.adapter.can.item.skipImport()},importedCount=0,$scope.getImportingProgress=function(){return importedCount/SelectedEntities.get().length},$scope.submitItems=function(){var importedItems,promises;if(SelectedEntities.size)return skipImport()?submitItems(SelectedEntities.get()):(importedItems=[],$scope.isImporting=!0,importedCount=0,promises=importItems(SelectedEntities.get(),$scope.adapter.name),_.forEach(promises,function(promise){return promise.then(function(item){return importedItems.push(item),importedCount++})}),$q.all(promises).then(function(){return $scope.isImporting=!1,submitItems(importedItems)},function(){return $scope.isImporting=!1}))},$scope.descriptionTranslationKey="external_search.upload_restrictions_header_message",getServiceFromPath=function(){var serviceFromPath,serviceId;return serviceId=initializationPath[0],serviceId&&(serviceFromPath=_.find($scope.$services.list,function(service){return service.id===serviceId})),serviceFromPath},$scope.$services.select(getServiceFromPath()||$scope.$services.list[0]),updatePath()})}.call(this),function(){"use strict";this.app.config(function(_this){return function($stateProvider){return $stateProvider.state("app.photoStock",{url:"/photoStock",templateUrl:"scripts/pages/photo-stock/photo-stock.html",controller:"photoStockCtrl",resolve:{notify:function(){var ref;return null!=(ref=_this.appLoadNotifiers)?ref.tabSelected():void 0},adapter:function(tabs){return tabs.photoStock.getAdapter()}}})}}(this)),this.app.controller("photoStockCtrl",function($scope,$state,SelectedEntities,EntitiesCtrlPartial,FilterCtrlPartial,tabs,adapter,settings,stockPayment,submitItems,path,paginatedItemsListLoader,paginatedItemsSearchLoader,i18n){var clearSearchQuery,getDefaultFolder,getFolders,getListOptions,getSelectedFolder,initializationPath,isPathWasSet,loadItems,searchItems,updatePath;return $scope.adapter=adapter,initializationPath=_.clone(path.get()),isPathWasSet=!1,updatePath=function(){var currentPath,ref;return currentPath=[],(null!=(ref=$scope.$folders.selectedFolder)?ref.id:void 0)&&currentPath.push($scope.$folders.selectedFolder.id),path.set(currentPath)},getDefaultFolder=function(){var folderId;if(folderId=initializationPath[0])return _.findWhere($scope.$folders.list,{id:folderId})},clearSearchQuery=function(){return $scope.$searchQuery.query="",$scope.$searchQuery.currentQuery=""},getFolders=function(){return adapter.folders.list()},$scope.$folders=new EntitiesCtrlPartial(adapter,$scope.$searchQuery,null,getFolders),$scope.$folders.load=_.flow($scope.$folders.load,function(promise){return promise.then(function(){return _.forEach($scope.$folders.list,function(folder){var folderId;return folderId=folder.id,null===folder.id&&(folderId="All"),folder.name=i18n.translate("photo_stock.big_stock.folder."+folderId)}),isPathWasSet?$scope.$folders.selectFolder($scope.$folders.list[0]):$scope.$folders.selectFolder(getDefaultFolder()||$scope.$folders.list[0])})}),$scope.$folders.selectFolder=_.flow($scope.$folders.selectFolder,function(){return isPathWasSet&&clearSearchQuery(),updatePath(),$scope.$nestedEntities.load()}),$scope.getAllFolder=function(){return _.find($scope.$folders.list,function(folder){return null===folder.id})},getSelectedFolder=function(){return $scope.$folders.selectedFolder},getListOptions=function(){return{hasIllustrations:!1,hasVectors:!1,isSafeSearch:!0,orientation:$scope.$nestedEntities.$orientation.selected?$scope.$nestedEntities.$orientation.selected.id:void 0}},loadItems=paginatedItemsListLoader(adapter,getSelectedFolder,getListOptions),searchItems=paginatedItemsSearchLoader(adapter,$scope.getAllFolder,getListOptions),$scope.$nestedEntities=new EntitiesCtrlPartial(adapter,$scope.$searchQuery,getSelectedFolder,loadItems,searchItems),$scope.$nestedEntities.load=_.flowRight($scope.$nestedEntities.load,function(){if($scope.$searchQuery.query&&$scope.$folders.selectedFolder!==$scope.getAllFolder())return $scope.$folders.selectedFolder=$scope.getAllFolder(),updatePath()}),$scope.$nestedEntities.$orientation=new FilterCtrlPartial(null,[{name:"vertical",id:"v"},{name:"horizontal",id:"h"}]),$scope.$nestedEntities.$orientation.select=function(orientation){return $scope.$nestedEntities.$orientation.selected=$scope.$nestedEntities.$orientation.selected===orientation?null:orientation,$scope.$nestedEntities.load()},$scope.isBuying=!1,$scope.submitItems=function(){var item,items,payment;if(items=SelectedEntities.get(),items.length)return item=_.first(items),payment=stockPayment(adapter.name),$scope.isBuying=!1,payment.buyImage(item).then(function(){return $scope.isBuying=!0,payment.getBoughtImage(item).then(function(boughtItem){var ref,ref1,ref2;return settings.siteMediaToken&&null!=(ref=tabs.private)&&null!=(ref1=ref.getAdapter())&&null!=(ref2=ref1.items.siteMedia)&&ref2.add([boughtItem.id]),submitItems([boughtItem]),$scope.isBuying=!1},function(){return $scope.isBuying=!1})})},$scope.descriptionTranslationKey="bigstock_images.upload_restrictions_header_message",$scope.footerSubmitTranslationKey="photo_stock_tab.footer.submit",$scope.$folders.load().then(function(){return isPathWasSet=!0})})}.call(this),function(){"use strict";this.app.config(function(_this){return function($stateProvider){return $stateProvider.state("app.shutterStock",{url:"/shutterStock",templateUrl:"scripts/pages/shutter-stock/shutter-stock.html",controller:"shutterStockCtrl",resolve:{notify:function(){var ref;return null!=(ref=_this.appLoadNotifiers)?ref.tabSelected():void 0},adapter:function(tabs){return tabs.shutterStock.getAdapter()}}})}}(this)),this.app.controller("shutterStockCtrl",function($scope,$state,SelectedEntities,EntitiesCtrlPartial,FilterCtrlPartial,tabs,adapter,settings,stockPayment,submitItems,path,paginatedItemsListLoader,paginatedItemsSearchLoader,i18n){
var clearSearchQuery,getDefaultFolder,getFolders,getListOptions,getSelectedFolder,initializationPath,isPathWasSet,loadItems,searchItems,updatePath;return $scope.adapter=adapter,initializationPath=_.clone(path.get()),isPathWasSet=!1,updatePath=function(){var currentPath,ref;return currentPath=[],(null!=(ref=$scope.$folders.selectedFolder)?ref.id:void 0)&&currentPath.push($scope.$folders.selectedFolder.id),path.set(currentPath)},getDefaultFolder=function(){var folderId;if(folderId=initializationPath[0])return _.findWhere($scope.$folders.list,{id:folderId})},clearSearchQuery=function(){return $scope.$searchQuery.query="",$scope.$searchQuery.currentQuery=""},getFolders=function(){return adapter.folders.list()},$scope.$folders=new EntitiesCtrlPartial(adapter,$scope.$searchQuery,null,getFolders),$scope.$folders.load=_.flow($scope.$folders.load,function(promise){return promise.then(function(){return _.forEach($scope.$folders.list,function(folder){var folderId;return folderId=folder.id,null===folder.id&&(folderId="All"),folder.name=i18n.translate("photo_stock.shutterstock.folder."+folderId)}),isPathWasSet?$scope.$folders.selectFolder($scope.$folders.list[0]):$scope.$folders.selectFolder(getDefaultFolder()||$scope.$folders.list[0])})}),$scope.$folders.selectFolder=_.flow($scope.$folders.selectFolder,function(){return isPathWasSet&&clearSearchQuery(),updatePath(),$scope.$nestedEntities.load()}),$scope.getAllFolder=function(){return _.find($scope.$folders.list,function(folder){return null===folder.id})},getSelectedFolder=function(){return $scope.$folders.selectedFolder},getListOptions=function(){return{hasIllustrations:!1,hasVectors:!1,isSafeSearch:!0,orientation:$scope.$nestedEntities.$orientation.selected?$scope.$nestedEntities.$orientation.selected.id:void 0}},loadItems=paginatedItemsListLoader(adapter,getSelectedFolder,getListOptions),searchItems=paginatedItemsSearchLoader(adapter,$scope.getAllFolder,getListOptions),$scope.$nestedEntities=new EntitiesCtrlPartial(adapter,$scope.$searchQuery,getSelectedFolder,loadItems,searchItems),$scope.$nestedEntities.load=_.flowRight($scope.$nestedEntities.load,function(){if($scope.$searchQuery.query&&$scope.$folders.selectedFolder!==$scope.getAllFolder())return $scope.$folders.selectedFolder=$scope.getAllFolder(),updatePath()}),$scope.$nestedEntities.$orientation=new FilterCtrlPartial(null,[{name:"vertical",id:"vertical"},{name:"horizontal",id:"horizontal"}]),$scope.$nestedEntities.$orientation.select=function(orientation){return $scope.$nestedEntities.$orientation.selected=$scope.$nestedEntities.$orientation.selected===orientation?null:orientation,$scope.$nestedEntities.load()},$scope.isBuying=!1,$scope.submitItems=function(){var item,items,payment;if(items=SelectedEntities.get(),items.length)return item=_.first(items),payment=stockPayment(adapter.name),$scope.isBuying=!1,payment.buyImage(item).then(function(){return $scope.isBuying=!0,payment.getBoughtImage(item).then(function(boughtItem){var ref,ref1,ref2;return settings.siteMediaToken&&null!=(ref=tabs.private)&&null!=(ref1=ref.getAdapter())&&null!=(ref2=ref1.items.siteMedia)&&ref2.add([boughtItem.id]),submitItems([boughtItem]),$scope.isBuying=!1},function(){return $scope.isBuying=!1})})},$scope.descriptionTranslationKey="shutterstock_images.upload_restrictions_header_message",$scope.footerSubmitTranslationKey="shutterstock_tab.footer.submit",$scope.$folders.load().then(function(){return isPathWasSet=!0})})}.call(this),function(){"use strict";this.app.config(function(_this){return function($stateProvider){return $stateProvider.state("app.collection",{url:"/collection",templateUrl:"scripts/pages/_base/base.html",controller:"collectionCtrl",resolve:{notify:function(){var ref;return null!=(ref=_this.appLoadNotifiers)?ref.tabSelected():void 0},adapter:function(tabs){return tabs.collection.getAdapter()}}})}}(this)),this.app.controller("collectionCtrl",function($scope,adapter,baseCtrl){return baseCtrl($scope,adapter)()})}.call(this),function(){"use strict";this.app.config(function(_this){return function($stateProvider){return $stateProvider.state("app.settingsPassed",{url:"/settingsPassed",templateUrl:"scripts/pages/_base/base.html",controller:"settingsPassedCtrl",resolve:{notify:function(){var ref;return null!=(ref=_this.appLoadNotifiers)?ref.tabSelected():void 0},adapter:function(tabs){return tabs.settingsPassed.getAdapter()}}})}}(this)),this.app.controller("settingsPassedCtrl",function($scope,adapter,baseCtrl){return baseCtrl($scope,adapter)()})}.call(this),function(){"use strict";this.app.config(function(_this){return function($stateProvider){return $stateProvider.state("app.custom",{url:"/custom",templateUrl:"scripts/pages/custom/custom.html",controller:"customCtrl",resolve:{notify:function(){var ref;return null!=(ref=_this.appLoadNotifiers)?ref.tabSelected():void 0}}})}}(this)),this.app.controller("customCtrl",function($scope,settings,tabs,SelectedEntities,path){var addItemProperties,select,unselect;return addItemProperties=function(item){return item.can={submit:function(){return!0},showImagePreview:function(){return _.includes(["picture","watermark","site_icon","ufont","shape"],settings.mediaType)},showVideoPreview:function(){var ref;return(null!=(ref=item.videoPreviewUrls)?ref.length:void 0)&&_.includes(["video"],settings.mediaType)},showExternalVideoPreview:function(){return!1}},item},select=function(item){return"single"===settings.selectionType&&SelectedEntities.clear(),SelectedEntities.add(item)},unselect=function(item){return SelectedEntities.delete(item)},$scope.sections=settings.customData.sections,$scope.sections.forEach(function(section){return section.action&&path.setFull(section.action.url),section.data=section.data.map(function(item){return addItemProperties(item)})}),$scope.showSection=function(section){return section.data.length>0},$scope.showAction=function(section){return section.action&&section.action.url},$scope.isSelected=function(item){return SelectedEntities.has(item)},$scope.toggle=function(item){return $scope.isSelected(item)?unselect(item):select(item)}})}.call(this),function(){"use strict";this.app.config(function(_this){return function($stateProvider){return $stateProvider.state("app.showbox",{url:"/showbox",templateUrl:"scripts/pages/showbox/showbox.html",controller:"showboxCtrl",resolve:{notify:function(){var ref;return null!=(ref=_this.appLoadNotifiers)?ref.tabSelected():void 0},adapter:function(tabs){return tabs.showbox.getAdapter()}}})}}(this)),this.app.controller("showboxCtrl",function($scope,adapter,$state,settings,path,EntitiesCtrlPartial,paginatedItemsListLoader,paginatedItemsSearchLoader){var clearSearchQuery,getDefaultFolder,getDefaultParentFolder,getSelectedFolder,getSelectedParentFolder,initializationPath,isPathWasSet,loadFolders,loadItems,loadParentFolders,searchItems,updatePath;return $scope.adapter=adapter,initializationPath=_.clone(path.get()),isPathWasSet=!1,updatePath=function(){var currentPath,ref,ref1;return currentPath=[],(null!=(ref=$scope.$parentFolders.selectedFolder)?ref.id:void 0)&&(currentPath.push($scope.$parentFolders.selectedFolder.id),(null!=(ref1=$scope.$folders.selectedFolder)?ref1.id:void 0)&&currentPath.push($scope.$folders.selectedFolder.id)),path.set(currentPath)},getDefaultParentFolder=function(){var folderId;if(folderId=initializationPath[0])return _.findWhere($scope.$parentFolders.list,{id:folderId})},loadParentFolders=function(){return adapter.folders.list(null)},$scope.$parentFolders=new EntitiesCtrlPartial(adapter,$scope.$searchQuery,null,loadParentFolders),$scope.$parentFolders.load=_.flow($scope.$parentFolders.load,function(promise){return promise.then(function(){return isPathWasSet?$scope.$parentFolders.selectFolder($scope.$parentFolders.list[0]):$scope.$parentFolders.selectFolder(getDefaultParentFolder()||$scope.$parentFolders.list[0])})}),$scope.$parentFolders.selectFolder=_.flow($scope.$parentFolders.selectFolder,function(){return updatePath(),$scope.$folders.load()}),$scope.$parentFolders.sortOrder=null,getDefaultFolder=function(){var folderId;if(folderId=initializationPath[1])return _.findWhere($scope.$folders.list,{id:folderId})},getSelectedParentFolder=function(){return $scope.$parentFolders.selectedFolder},clearSearchQuery=function(){return $scope.$searchQuery.query="",$scope.$searchQuery.currentQuery=""},loadFolders=function(){return $scope.$parentFolders.selectedFolder.foldersList()},$scope.$folders=new EntitiesCtrlPartial(adapter,$scope.$searchQuery,getSelectedParentFolder,loadFolders),$scope.$folders.load=_.flow($scope.$folders.load,function(promise){return promise.then(function(){return isPathWasSet?$scope.$folders.selectFolder($scope.$folders.list[0]):$scope.$folders.selectFolder(getDefaultFolder()||$scope.$folders.list[0])})}),$scope.$folders.selectFolder=_.flow($scope.$folders.selectFolder,function(){return isPathWasSet&&clearSearchQuery(),updatePath(),$scope.$nestedEntities.load()}),getSelectedFolder=function(){return $scope.$folders.selectedFolder},loadItems=paginatedItemsListLoader(adapter,getSelectedFolder),searchItems=paginatedItemsSearchLoader(adapter,getSelectedFolder),$scope.$nestedEntities=new EntitiesCtrlPartial(adapter,$scope.$searchQuery,getSelectedFolder,loadItems,searchItems),$scope.$nestedEntities.load=_.flowRight($scope.$nestedEntities.load,updatePath),$scope.descriptionTranslationKey=void 0,$scope.$parentFolders.load().then(function(){return isPathWasSet=!0})})}.call(this),function(){"use strict";this.app.constant("deprecatedSettings",["canShowTabs","canShowSelectButton","showSelectButton"])}.call(this),function(){"use strict";this.app.constant("externalAdaptersWithNestedSupport",["drive","dropbox"])}.call(this),function(){"use strict";this.app.constant("mediaTypes",{ARCHIVE:"archive",DOCUMENT:"document",MUSIC:"music",PICTURE:"picture",SECURE_ARCHIVE:"secure_archive",SECURE_DOCUMENT:"secure_document",SECURE_MUSIC:"secure_music",SECURE_PICTURE:"secure_picture",SECURE_VIDEO:"secure_video",SHAPE:"shape",SITE_ICON:"site_icon",SWF:"swf",UFONT:"ufont",VIDEO:"video",WATERMARK:"watermark"})}.call(this),function(){"use strict";this.app.constant("supportedExternalSearchServices",[{name:"googleSearch",mediaTypes:["picture","secure_picture"]},{name:"flickrSearch",mediaTypes:["picture","secure_picture"]},{name:"vimeoSearch",mediaTypes:["video","secure_video"]},{name:"youtubeSearch",mediaTypes:["video","secure_video"]}])}.call(this),function(){"use strict";this.app.constant("supportedExternalServices",[{name:"facebook",mediaTypes:["picture","secure_picture"]},{name:"picasa",mediaTypes:["picture","secure_picture"]},{name:"instagram",mediaTypes:["picture","secure_picture"]},{name:"flickr",mediaTypes:["picture","secure_picture"]},{name:"drive",mediaTypes:["picture","secure_picture"]},{name:"dropbox",mediaTypes:["picture","secure_picture"]},{name:"youtube",mediaTypes:["video","secure_video"]},{name:"vimeo",mediaTypes:["video","secure_video"]},{name:"facebookVideo",mediaTypes:["video","secure_video"]},{name:"instagramVideo",mediaTypes:["video"]},{name:"deviantart",mediaTypes:["picture","secure_picture"]}])}.call(this),function(){"use strict";this.app.constant("supportedExternalServicesWithoutFolders",["facebookVideo","instagram","instagramVideo","vimeo"])}.call(this),function(){"use strict";this.app.value("supportedArchiveTypes",["zip"])}.call(this),function(){"use strict";this.app.value("supportedDocsTypes",["doc","docx","epub","odp","odt","pdf","ppt","pptx","xls","xlsx","ppsx"])}.call(this),function(){"use strict";this.app.constant("supportedMediaTypes",["picture","watermark","document","ufont","site_icon","swf","music","video","secure_document","secure_picture","secure_music","secure_video"])}.call(this),function(){"use strict";this.app.constant("supportedPublicMediaRoots",["backgrounds","clipart","file_icons","icons","photos","watermarks","shapes","social_icons","video"])}.call(this),function(window){"use strict";var CanvasPrototype=window.HTMLCanvasElement&&window.HTMLCanvasElement.prototype,hasBlobConstructor=window.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),hasArrayBufferViewSupport=hasBlobConstructor&&window.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,dataURLtoBlob=(hasBlobConstructor||BlobBuilder)&&window.atob&&window.ArrayBuffer&&window.Uint8Array&&function(dataURI){var byteString,arrayBuffer,intArray,i,mimeString,bb;for(byteString=dataURI.split(",")[0].indexOf("base64")>=0?atob(dataURI.split(",")[1]):decodeURIComponent(dataURI.split(",")[1]),arrayBuffer=new ArrayBuffer(byteString.length),intArray=new Uint8Array(arrayBuffer),i=0;i<byteString.length;i+=1)intArray[i]=byteString.charCodeAt(i);return mimeString=dataURI.split(",")[0].split(":")[1].split(";")[0],hasBlobConstructor?new Blob([hasArrayBufferViewSupport?intArray:arrayBuffer],{type:mimeString}):(bb=new BlobBuilder,bb.append(arrayBuffer),bb.getBlob(mimeString))};window.HTMLCanvasElement&&!CanvasPrototype.toBlob&&(CanvasPrototype.mozGetAsFile?CanvasPrototype.toBlob=function(callback,type,quality){callback(quality&&CanvasPrototype.toDataURL&&dataURLtoBlob?dataURLtoBlob(this.toDataURL(type,quality)):this.mozGetAsFile("blob",type))}:CanvasPrototype.toDataURL&&dataURLtoBlob&&(CanvasPrototype.toBlob=function(callback,type,quality){callback(dataURLtoBlob(this.toDataURL(type,quality)))})),"function"==typeof define&&define.amd?define(function(){return dataURLtoBlob}):window.dataURLtoBlob=dataURLtoBlob}(this),function(a){"use strict";var b=function(a,c,d){var e,f,g=document.createElement("img");if(g.onerror=c,g.onload=function(){!f||d&&d.noRevoke||b.revokeObjectURL(f),c&&c(b.scale(g,d))},b.isInstanceOf("Blob",a)||b.isInstanceOf("File",a))e=f=b.createObjectURL(a),g._type=a.type;else{if("string"!=typeof a)return!1;e=a,d&&d.crossOrigin&&(g.crossOrigin=d.crossOrigin)}return e?(g.src=e,g):b.readFile(a,function(a){var b=a.target;b&&b.result?g.src=b.result:c&&c(a)})},c=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;b.isInstanceOf=function(a,b){return Object.prototype.toString.call(b)==="[object "+a+"]"},b.transformCoordinates=function(){},b.getTransformedOptions=function(a,b){var c,d,e,f,g=b.aspectRatio;if(!g)return b;c={};for(d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);return c.crop=!0,e=a.naturalWidth||a.width,f=a.naturalHeight||a.height,e/f>g?(c.maxWidth=f*g,c.maxHeight=f):(c.maxWidth=e,c.maxHeight=e/g),c},b.renderImageToCanvas=function(a,b,c,d,e,f,g,h,i,j){return a.getContext("2d").drawImage(b,c,d,e,f,g,h,i,j),a},b.hasCanvasOption=function(a){return a.canvas||a.crop||a.aspectRatio},b.scale=function(a,c){c=c||{};var d,e,f,g,h,i,j,k,l,m=document.createElement("canvas"),n=a.getContext||b.hasCanvasOption(c)&&m.getContext,o=a.naturalWidth||a.width,p=a.naturalHeight||a.height,q=o,r=p,s=function(){var a=Math.max((f||q)/q,(g||r)/r);a>1&&(q*=a,r*=a)},t=function(){var a=Math.min((d||q)/q,(e||r)/r);1>a&&(q*=a,r*=a)};return n&&(c=b.getTransformedOptions(a,c),j=c.left||0,k=c.top||0,c.sourceWidth?(h=c.sourceWidth,void 0!==c.right&&void 0===c.left&&(j=o-h-c.right)):h=o-j-(c.right||0),c.sourceHeight?(i=c.sourceHeight,void 0!==c.bottom&&void 0===c.top&&(k=p-i-c.bottom)):i=p-k-(c.bottom||0),q=h,r=i),d=c.maxWidth,e=c.maxHeight,f=c.minWidth,g=c.minHeight,n&&d&&e&&c.crop?(q=d,r=e,l=h/i-d/e,0>l?(i=e*h/d,void 0===c.top&&void 0===c.bottom&&(k=(p-i)/2)):l>0&&(h=d*i/e,void 0===c.left&&void 0===c.right&&(j=(o-h)/2))):((c.contain||c.cover)&&(f=d=d||f,g=e=e||g),c.cover?(t(),s()):(s(),t())),n?(m.width=q,m.height=r,b.transformCoordinates(m,c),b.renderImageToCanvas(m,a,j,k,h,i,0,0,q,r)):(a.width=q,a.height=r,a)},b.createObjectURL=function(a){return!!c&&c.createObjectURL(a)},b.revokeObjectURL=function(a){return!!c&&c.revokeObjectURL(a)},b.readFile=function(a,b,c){if(window.FileReader){var d=new FileReader;if(d.onload=d.onerror=b,c=c||"readAsDataURL",d[c])return d[c](a),d}return!1},"function"==typeof define&&define.amd?define(function(){return b}):a.loadImage=b}(this),function(a){"use strict";"function"==typeof define&&define.amd?define(["load-image"],a):a(window.loadImage)}(function(a){"use strict";if(window.navigator&&window.navigator.platform&&/iP(hone|od|ad)/.test(window.navigator.platform)){var b=a.renderImageToCanvas;a.detectSubsampling=function(a){var b,c;return a.width*a.height>1048576&&(b=document.createElement("canvas"),b.width=b.height=1,c=b.getContext("2d"),c.drawImage(a,1-a.width,0),0===c.getImageData(0,0,1,1).data[3])},a.detectVerticalSquash=function(a,b){var c,d,e,f,g,h=a.naturalHeight||a.height,i=document.createElement("canvas"),j=i.getContext("2d");for(b&&(h/=2),i.width=1,i.height=h,j.drawImage(a,0,0),c=j.getImageData(0,0,1,h).data,d=0,e=h,f=h;f>d;)g=c[4*(f-1)+3],0===g?e=f:d=f,f=e+d>>1;return f/h||1},a.renderImageToCanvas=function(c,d,e,f,g,h,i,j,k,l){if("image/jpeg"===d._type){var m,n,o,p,q=c.getContext("2d"),r=document.createElement("canvas"),s=1024,t=r.getContext("2d");if(r.width=s,r.height=s,q.save(),m=a.detectSubsampling(d),m&&(e/=2,f/=2,g/=2,h/=2),n=a.detectVerticalSquash(d,m),m||1!==n){for(f*=n,k=Math.ceil(s*k/g),l=Math.ceil(s*l/h/n),j=0,p=0;h>p;){for(i=0,o=0;g>o;)t.clearRect(0,0,s,s),t.drawImage(d,e,f,g,h,-o,-p,g,h),q.drawImage(r,0,0,s,s,i,j,k,l),o+=s,i+=k;p+=s,j+=l}return q.restore(),c}}return b(c,d,e,f,g,h,i,j,k,l)}}}),function(a){"use strict";"function"==typeof define&&define.amd?define(["load-image"],a):a(window.loadImage)}(function(a){"use strict";var b=a.hasCanvasOption,c=a.transformCoordinates,d=a.getTransformedOptions;a.hasCanvasOption=function(c){return b.call(a,c)||c.orientation},a.transformCoordinates=function(b,d){c.call(a,b,d);var e=b.getContext("2d"),f=b.width,g=b.height,h=d.orientation;if(h&&!(h>8))switch(h>4&&(b.width=g,b.height=f),h){case 2:e.translate(f,0),e.scale(-1,1);break;case 3:e.translate(f,g),e.rotate(Math.PI);break;case 4:e.translate(0,g),e.scale(1,-1);break;case 5:e.rotate(.5*Math.PI),e.scale(1,-1);break;case 6:e.rotate(.5*Math.PI),e.translate(0,-g);break;case 7:e.rotate(.5*Math.PI),e.translate(f,-g),e.scale(-1,1);break;case 8:e.rotate(-.5*Math.PI),e.translate(-f,0)}},a.getTransformedOptions=function(b,c){var e,f,g=d.call(a,b,c),h=g.orientation;if(!h||h>8||1===h)return g;e={};for(f in g)g.hasOwnProperty(f)&&(e[f]=g[f]);switch(g.orientation){case 2:e.left=g.right,e.right=g.left;break;case 3:e.left=g.right,e.top=g.bottom,e.right=g.left,e.bottom=g.top;break;case 4:e.top=g.bottom,e.bottom=g.top;break;case 5:e.left=g.top,e.top=g.left,e.right=g.bottom,e.bottom=g.right;break;case 6:e.left=g.top,e.top=g.right,e.right=g.bottom,e.bottom=g.left;break;case 7:e.left=g.bottom,e.top=g.right,e.right=g.top,e.bottom=g.left;break;case 8:e.left=g.bottom,e.top=g.left,e.right=g.top,e.bottom=g.right}return g.orientation>4&&(e.maxWidth=g.maxHeight,e.maxHeight=g.maxWidth,e.minWidth=g.minHeight,e.minHeight=g.minWidth,e.sourceWidth=g.sourceHeight,e.sourceHeight=g.sourceWidth),e}}),function(a){"use strict";"function"==typeof define&&define.amd?define(["load-image"],a):a(window.loadImage)}(function(a){"use strict";var b=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);a.blobSlice=b&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},a.metaDataParsers={jpeg:{65505:[]}},a.parseMetaData=function(b,c,d){d=d||{};var e=this,f=d.maxMetaDataSize||262144,g={};(!(window.DataView&&b&&b.size>=12&&"image/jpeg"===b.type&&a.blobSlice)||!a.readFile(a.blobSlice.call(b,0,f),function(b){if(b.target.error)return console.log(b.target.error),void c(g);var f,h,i,j,k=b.target.result,l=new DataView(k),m=2,n=l.byteLength-4,o=m;if(65496===l.getUint16(0)){for(;n>m&&((f=l.getUint16(m))>=65504&&65519>=f||65534===f);){if(h=l.getUint16(m+2)+2,m+h>l.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(i=a.metaDataParsers.jpeg[f])for(j=0;j<i.length;j+=1)i[j].call(e,l,m,h,g,d);m+=h,o=m}!d.disableImageHead&&o>6&&(g.imageHead=k.slice?k.slice(0,o):new Uint8Array(k).subarray(0,o))}else console.log("Invalid JPEG file: Missing JPEG marker.");c(g)},"readAsArrayBuffer"))&&c(g)}}),function(a){"use strict";"function"==typeof define&&define.amd?define(["load-image","load-image-meta"],a):a(window.loadImage)}(function(a){"use strict";a.ExifMap=function(){return this},a.ExifMap.prototype.map={Orientation:274},a.ExifMap.prototype.get=function(a){return this[a]||this[this.map[a]]},a.getExifThumbnail=function(a,b,c){var d,e,f;if(!c||b+c>a.byteLength)return void console.log("Invalid Exif data: Invalid thumbnail data.");for(d=[],e=0;c>e;e+=1)f=a.getUint8(b+e),d.push((16>f?"0":"")+f.toString(16));return"data:image/jpeg,%"+d.join("%")},a.exifTagTypes={1:{getValue:function(a,b){return a.getUint8(b)},size:1},2:{getValue:function(a,b){return String.fromCharCode(a.getUint8(b))},size:1,ascii:!0},3:{getValue:function(a,b,c){return a.getUint16(b,c)},size:2},4:{getValue:function(a,b,c){return a.getUint32(b,c)},size:4},5:{getValue:function(a,b,c){return a.getUint32(b,c)/a.getUint32(b+4,c)},size:8},9:{getValue:function(a,b,c){return a.getInt32(b,c)},size:4},10:{getValue:function(a,b,c){return a.getInt32(b,c)/a.getInt32(b+4,c)},size:8}},a.exifTagTypes[7]=a.exifTagTypes[1],a.getExifValue=function(b,c,d,e,f,g){var h,i,j,k,l,m,n=a.exifTagTypes[e];if(!n)return void console.log("Invalid Exif data: Invalid tag type.");if(h=n.size*f,(i=h>4?c+b.getUint32(d+8,g):d+8)+h>b.byteLength)return void console.log("Invalid Exif data: Invalid data offset.");if(1===f)return n.getValue(b,i,g);for(j=[],k=0;f>k;k+=1)j[k]=n.getValue(b,i+k*n.size,g);if(n.ascii){for(l="",k=0;k<j.length&&"\0"!==(m=j[k]);k+=1)l+=m;return l}return j},a.parseExifTag=function(b,c,d,e,f){var g=b.getUint16(d,e);f.exif[g]=a.getExifValue(b,c,d,b.getUint16(d+2,e),b.getUint32(d+4,e),e)},a.parseExifTags=function(a,b,c,d,e){var f,g,h;if(c+6>a.byteLength)return void console.log("Invalid Exif data: Invalid directory offset.");if(f=a.getUint16(c,d),(g=c+2+12*f)+4>a.byteLength)return void console.log("Invalid Exif data: Invalid directory size.");for(h=0;f>h;h+=1)this.parseExifTag(a,b,c+2+12*h,d,e);return a.getUint32(g,d)},a.parseExifData=function(b,c,d,e,f){if(!f.disableExif){var g,h,i,j=c+10;if(1165519206===b.getUint32(c+4)){if(j+8>b.byteLength)return void console.log("Invalid Exif data: Invalid segment size.");if(0!==b.getUint16(c+8))return void console.log("Invalid Exif data: Missing byte alignment offset.");switch(b.getUint16(j)){case 18761:g=!0;break;case 19789:g=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==b.getUint16(j+2,g))return void console.log("Invalid Exif data: Missing TIFF marker.");h=b.getUint32(j+4,g),e.exif=new a.ExifMap,h=a.parseExifTags(b,j,j+h,g,e),h&&!f.disableExifThumbnail&&(i={exif:{}},h=a.parseExifTags(b,j,j+h,g,i),i.exif[513]&&(e.exif.Thumbnail=a.getExifThumbnail(b,j+i.exif[513],i.exif[514]))),e.exif[34665]&&!f.disableExifSub&&a.parseExifTags(b,j,j+e.exif[34665],g,e),e.exif[34853]&&!f.disableExifGps&&a.parseExifTags(b,j,j+e.exif[34853],g,e)}}},a.metaDataParsers.jpeg[65505].push(a.parseExifData)}),function(a){"use strict";"function"==typeof define&&define.amd?define(["load-image","load-image-exif"],a):a(window.loadImage)}(function(a){"use strict";a.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},a.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}},a.ExifMap.prototype.getText=function(a){var b=this.get(a);switch(a){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[a][b];case"ExifVersion":case"FlashpixVersion":return String.fromCharCode(b[0],b[1],b[2],b[3]);case"ComponentsConfiguration":return this.stringValues[a][b[0]]+this.stringValues[a][b[1]]+this.stringValues[a][b[2]]+this.stringValues[a][b[3]];case"GPSVersionID":return b[0]+"."+b[1]+"."+b[2]+"."+b[3]}return String(b)},function(a){var b,c=a.tags,d=a.map;for(b in c)c.hasOwnProperty(b)&&(d[c[b]]=b)}(a.ExifMap.prototype),a.ExifMap.prototype.getAll=function(){var a,b,c={};for(a in this)this.hasOwnProperty(a)&&(b=this.tags[a])&&(c[b]=this.getText(b));return c}}),function(){"use strict";this.app.factory("confirm",function($document,$sce,ngDialog,i18n){return function(options){var $body,confirmOnKeyup,dialog;return dialog=ngDialog.open({template:"scripts/pages/_partials/confirmation.html",className:options.className?options.className:void 0,controller:function($scope){return function(){return options.confirmMessage=$sce.trustAsHtml(options.confirmMessage),options.confirmTitle||(options.confirmTitle=i18n.translate("dialog.warn_title")),options.confirmYes||(options.confirmYes=i18n.translate("dialog.yes")),options.confirmNo||(options.confirmNo=i18n.translate("dialog.no")),_.assign($scope,options)}},preCloseCallback:function(){$body.off("keyup",confirmOnKeyup)},closeByEscape:!1,preserveFocus:!1}),$body=$document.find("body"),confirmOnKeyup=function(event){if(27===event.keyCode&&(event.stopPropagation(),$body.off("keyup",confirmOnKeyup),dialog.close()),13===event.keyCode)return $body.off("keyup",confirmOnKeyup),"function"==typeof options.confirm&&options.confirm(),dialog.close()},$body.on("keyup",confirmOnKeyup)}})}.call(this),function(){"use strict";this.app.factory("localizeDate",function($filter,i18n){return function(milliseconds){return $filter("date")(milliseconds,i18n.translate("date_format"))}})}.call(this),function(){"use strict";this.app.factory("path",function($state,tabs){var getSelectedTabId,tabsPaths;return tabsPaths={},getSelectedTabId=function(){var selectedTab;return selectedTab=_.find(tabs,function(tab){return $state.includes(tab.state)}),null!=selectedTab?selectedTab.id:void 0},{set:function(newPath){return tabsPaths[getSelectedTabId()]=newPath},get:function(){return tabsPaths[getSelectedTabId()]||[]},setFull:function(fullPath){var pathArray,tabId;if(pathArray=fullPath.split("/"),null!=(tabId=pathArray[0]))return tabsPaths[tabId]=pathArray.slice(1)},getFull:function(){
var path,tabId;return tabId=getSelectedTabId(),path=""+tabId,tabsPaths[tabId]&&(path+="/"+tabsPaths[tabId].join("/")),path}}})}.call(this),function(){"use strict";this.app.factory("SelectedEntities",function(){var set;return set=new Set,set.get=function(){var array;return array=[],this.forEach(function(el){return array.push(el)}),array},set})}.call(this),function(){"use strict";this.app.factory("futureArrayFromPromise",function($q){return function(promise){var deferred,futureObj;return futureObj=[],deferred=$q.defer(),futureObj.$resolved=!1,futureObj.$promise=deferred.promise,promise.then(function(entities){return _.forEach(entities,function(e){return futureObj.push(e)}),futureObj.$resolved=!0,deferred.resolve(futureObj)},function(r){return futureObj.$resolved=!0,deferred.reject(r)}),futureObj}})}.call(this),function(){"use strict";this.app.constant("htmlEncode",function(html){return $("<div/>").text(html).html()})}.call(this),function(){"use strict";var slice=[].slice;this.app.filter("unsafe",function(i18n,$sce){return function(){var args,input;return input=arguments[0],args=2<=arguments.length?slice.call(arguments,1):[],$sce.trustAsHtml(i18n.translate(input,args))}}),this.app.filter("translate",function(i18n){return function(){var args,input;return input=arguments[0],args=2<=arguments.length?slice.call(arguments,1):[],i18n.translate(input,args)}}),this.app.factory("LoadLocales",function($q,$http,$rootScope,i18n){return function(settings){var loadTranslations;return loadTranslations=function(i18nCode){return $http.get("locales/media_gallery_"+i18nCode+".json",{withCredentials:!1}).then(function(response){return i18n.updateTranslations(response.data),i18n.setPrefix(settings.i18nPrefix),i18n.setLang(i18nCode)},function(reason){var d;return d=$q.defer(),d.reject({code:123,message:"Could not load translations"}),d.promise})},"en"===settings.i18nCode?loadTranslations("en"):loadTranslations(settings.i18nCode).then(null,function(){return loadTranslations("en")})}}),this.app.factory("i18n",function(localeOverride,settings){var areLoaded,getAllOverride,getFullKey,getLang,getLocalesValue,getSettingsValue,getTranslation,lang,prefix,prefixRegExp,setLang,setPrefix,translate,translations,updateTranslations;return prefix="",lang="en",translations={},prefixRegExp=/(.*?)_/,areLoaded=function(){return _.size(translations)},updateTranslations=function(newTranslations){return translations=newTranslations},getAllOverride=function(key){return localeOverride.all[key].replace(/%s/,lang)},getLocalesValue=function(key){var ref,ref1;return(null!=(ref=localeOverride[lang])?ref[key]:void 0)||(null!=(ref1=localeOverride.all)?ref1[key]:void 0)&&getAllOverride(key)||translations[key]},getSettingsValue=function(key){return settings.translations[key]},getTranslation=function(key,args,getValue){var value;return value=getValue(key),value.replace(/%{(\d+?)}/g,function(match,index){return args[index]})},getFullKey=function(key,getValue){var currentPrefix;for(currentPrefix=prefix;!getValue(currentPrefix+":"+key)&&prefixRegExp.test(currentPrefix);)currentPrefix=currentPrefix.replace(prefixRegExp,"");return getValue(currentPrefix+":"+key)?currentPrefix+":"+key:getValue(key)?key:void 0},translate=function(key,args,getValue){var fullKey;return fullKey=getFullKey(key,getValue),null!=fullKey?getTranslation(fullKey,args,getValue):getTranslation("no_translation",[key],getValue)},setPrefix=function(value){return prefix=""+value},setLang=function(code){return lang=code},getLang=function(){return lang},{updateTranslations:updateTranslations,areLoaded:areLoaded,translate:function(key,args){var translation;return getFullKey(key,getSettingsValue)?translate(key,args,getSettingsValue):(translation=translate(key,args,getLocalesValue),settings.helpId&&(null!=key?key.indexOf("help_url"):void 0)>=0&&(translation=translation.replace(/(itemId=)(.+)/,"$1"+settings.helpId)),translation)},isTranslatable:function(key){return!!getFullKey(key,getSettingsValue)||!!getFullKey(key,getLocalesValue)},setPrefix:setPrefix,getLang:getLang,setLang:setLang}})}.call(this),function(){"use strict";this.app.value("localeOverride",{all:{date_format:"MM/dd/yyyy",help_contributors_url:"//%s.wix.com/support/html5/article/about-site-contributors",help_url:"//%s.wix.com/support/html5/widget/0/cb6480f3-768b-4737-ab8f-10fe2e4fa2ab#/main/view?itemId=4987f658-4243-4d84-8581-1a36f09e0f83","shape:help_url":"//www.wix.com/support/html5/widget/0/cb6480f3-768b-4737-ab8f-10fe2e4fa2ab#/main/view?itemId=da3604d7-39d0-4882-b80d-91d3f4c39f6d","document:help_url":"//%s.wix.com/support/html5/widget/0/cb6480f3-768b-4737-ab8f-10fe2e4fa2ab#/main/view?itemId=e637f635-94d3-4a01-854a-d18a666bd643","video:help_url":"//%s.wix.com/support/html5/widget/0/cb6480f3-768b-4737-ab8f-10fe2e4fa2ab#/main/view?itemId=b80afb39-4814-4e05-ae5c-e4e00ff6c949","music:help_url":"//%s.wix.com/support/html5/widget/0/cb6480f3-768b-4737-ab8f-10fe2e4fa2ab#/main/view?itemId=eee746d7-6e5e-4bec-bdce-252d06265195","secure_music:help_url":"//%s.wix.com/support/html5/widget/0/cb6480f3-768b-4737-ab8f-10fe2e4fa2ab#/main/view?itemId=eee746d7-6e5e-4bec-bdce-252d06265195"},cs:{date_format:"dd.MM.yyyy"},da:{date_format:"dd/MM/yyyy"},de:{date_format:"dd.MM.yyyy"},en:{help_contributors_url:"//www.wix.com/support/html5/article/about-site-contributors",help_url:"//www.wix.com/support/html5/widget/0/cb6480f3-768b-4737-ab8f-10fe2e4fa2ab#/main/view?itemId=4987f658-4243-4d84-8581-1a36f09e0f83","shape:help_url":"//www.wix.com/support/html5/widget/0/cb6480f3-768b-4737-ab8f-10fe2e4fa2ab#/main/view?itemId=da3604d7-39d0-4882-b80d-91d3f4c39f6d","document:help_url":"//www.wix.com/support/html5/widget/0/cb6480f3-768b-4737-ab8f-10fe2e4fa2ab#/main/view?itemId=e637f635-94d3-4a01-854a-d18a666bd643","video:help_url":"//www.wix.com/support/html5/widget/0/cb6480f3-768b-4737-ab8f-10fe2e4fa2ab#/main/view?itemId=b80afb39-4814-4e05-ae5c-e4e00ff6c949","music:help_url":"//www.wix.com/support/html5/widget/0/cb6480f3-768b-4737-ab8f-10fe2e4fa2ab#/main/view?itemId=eee746d7-6e5e-4bec-bdce-252d06265195","secure_music:help_url":"//www.wix.com/support/html5/widget/0/cb6480f3-768b-4737-ab8f-10fe2e4fa2ab#/main/view?itemId=eee746d7-6e5e-4bec-bdce-252d06265195"},es:{date_format:"dd/MM/yyyy"},fi:{date_format:"dd.MM.yyyy"},fr:{date_format:"dd/MM/yyyy"},hi:{date_format:"dd/MM/yyyy"},it:{date_format:"dd/MM/yyyy"},ja:{date_format:"yyyy/MM/dd"},ko:{date_format:"yyyy.MM.dd"},nl:{date_format:"dd-MM-yyyy"},no:{date_format:"dd.MM.yyyy"},pl:{date_format:"dd.MM.yyyy"},pt:{date_format:"dd/MM/yyyy"},ru:{date_format:"dd.MM.yyyy"},sv:{date_format:"yyyy-MM-dd"},tr:{date_format:"dd.MM.yyyy"},zh:{date_format:"yyyy-MM-dd",help_contributors_url:"//www.wix.com/support/html5/article/about-site-contributors",help_url:"//www.wix.com/support/html5/widget/0/cb6480f3-768b-4737-ab8f-10fe2e4fa2ab#/main/view?itemId=4987f658-4243-4d84-8581-1a36f09e0f83","shape:help_url":"//www.wix.com/support/html5/widget/0/cb6480f3-768b-4737-ab8f-10fe2e4fa2ab#/main/view?itemId=da3604d7-39d0-4882-b80d-91d3f4c39f6d","document:help_url":"//www.wix.com/support/html5/widget/0/cb6480f3-768b-4737-ab8f-10fe2e4fa2ab#/main/view?itemId=e637f635-94d3-4a01-854a-d18a666bd643","video:help_url":"//www.wix.com/support/html5/widget/0/cb6480f3-768b-4737-ab8f-10fe2e4fa2ab#/main/view?itemId=b80afb39-4814-4e05-ae5c-e4e00ff6c949","music:help_url":"//www.wix.com/support/html5/widget/0/cb6480f3-768b-4737-ab8f-10fe2e4fa2ab#/main/view?itemId=eee746d7-6e5e-4bec-bdce-252d06265195","secure_music:help_url":"//www.wix.com/support/html5/widget/0/cb6480f3-768b-4737-ab8f-10fe2e4fa2ab#/main/view?itemId=eee746d7-6e5e-4bec-bdce-252d06265195"}})}.call(this),function(){"use strict";this.app.factory("editorConnection",function(events){var editorConnection;return editorConnection=new WindowMessenger(window.parent),events.on(events.ITEMS.REMOVE,function(promises,event){return _.forEach(promises,function(promise){return promise.then(function(id){return editorConnection.emit("itemremove",{id:id,source:event.eventTarget.name})})})}),editorConnection})}.call(this),function(){"use strict";this.app.factory("importItems",function($q,tabs,settings){return function(items,adapterName){var adapter,importItem;return adapter=tabs.private.getAdapter(),settings.maxParallelUploads&&(wixmp.Uploader.maxParallelUploads=settings.maxParallelUploads),importItem=function(item,tag){var filesToUpload;return filesToUpload=wixmp.Uploader.upload([{uploadFn:adapter.item.uploadByUrl,source:{url:item.fileUrl,name:item.name||"Untitled",tags:["_social","_imported","_"+adapterName,tag],mediaType:settings.mediaType}}]),filesToUpload[0].deferred.promise.then(function(res){return res.data})},_.map(items,function(item){var tag;return tag="_"+adapterName+"_"+item.id,adapter.items.searchByTag(tag).then(function(result){var ref;return(null!=(ref=result.data)?ref.length:void 0)?result.data[0]:importItem(item,tag)},function(){return importItem(item,tag)})})}})}.call(this),function(){"use strict";this.app.constant("uploadSizesLimits",{default:15728640,document:15728640,picture:26214400,music:52428800,secureMusic:377487360,video:52428800,secureVideo:1610612736}),this.app.constant("uploadSizesLimitsHard",{default:1572864e3,document:1572864e3,picture:262144e4,music:524288e4,secureMusic:37748736e3,video:524288e5,secureVideo:161061273600}),this.app.factory("getFileSizeLimit",function(uploadSizesLimits){return function(mediaType){var customMediaTypes;return customMediaTypes={secure_music:"secureMusic",secure_video:"secureVideo"},uploadSizesLimits[mediaType]||uploadSizesLimits[customMediaTypes[mediaType]]||uploadSizesLimits.default}})}.call(this),function(){"use strict";this.app.factory("Cache",function(Adapter,$q){return function(adapter){var addItems,data,dropFolderCache,getFolderKey,getFolders,getItems,setItems;return data={items:{},folders:{}},dropFolderCache=function(folderKey){return delete data.items[folderKey]},getFolderKey=function(folder){return(null!=folder?folder.id:void 0)||(null!=folder?folder.virtualId:void 0)||null},setItems=function(promise,futureItems,folder){return promise.then(function(items){return data.items[getFolderKey(folder)]=_.clone(items)})},addItems=function(promise,futureItems,folder){return promise.then(function(items){return data.items[getFolderKey(folder)]=_.union(data.items[getFolderKey(folder)],items)})},adapter.on("getFolders",function(promise,futureFolders,folder){return promise.then(function(folders){return data.folders[null!=folder?folder.id:void 0]=folders})}),adapter.on("getItems",setItems),adapter.on("getMoreItems",addItems),adapter.on("removeItem",function(promise,item){return promise.then(function(){return _.forEach(data.items,function(cachedFolderArray){return _.remove(cachedFolderArray,item)})})}),adapter.on("removeFolder",function(promise,folder){var folderKey;return folderKey=getFolderKey(folder),promise.then(function(){return dropFolderCache(folderKey),dropFolderCache("AllMedia")})}),adapter.on("uploadFile",function(promise){return promise.then(function(item){return item.folderId&&dropFolderCache(item.folderId),delete data.items.AllMedia})}),adapter.on("moveItem",function(promise,item,folder){return promise.then(function(){return dropFolderCache(item.folderId),dropFolderCache(getFolderKey(folder))})}),adapter.getItems&&(getItems=adapter.getItems,adapter.getItems=function(folder,options){var items;return null==options&&(options={}),options=_.defaults(options,{cache:!0}),items=data.items[getFolderKey(folder)],options.cache&&null!=items?_.assign(items,{$resolved:!0,$promise:$q.when(items)}):getItems.apply(this,arguments)}),adapter.getFolders&&(getFolders=adapter.getFolders,adapter.getFolders=function(folder){var folders;return(folders=data.folders[null!=folder?folder.id:void 0])?_.assign(folders,{$resolved:!0,$promise:$q.when(folders)}):getFolders.apply(this,arguments)}),adapter}})}.call(this),function(){"use strict";this.app.factory("tabs",function($window,settings,wrapSource,supportedMediaTypes,supportedPublicMediaRoots,supportedExternalServices,uploadSizesLimitsHard,supportedExternalSearchServices,settingsPassedAdapter){var bigStockAdapter,canShowTab,collectionAdapter,externalAdapters,externalSearchAdapters,platformAdapter,prevAdapterSettings,privateAdapter,publicAdapter,settingsPassedAdapterWrapped,showboxAdapter,shutterStockAdapter;return externalAdapters={},externalSearchAdapters={},prevAdapterSettings={},privateAdapter=null,platformAdapter=null,publicAdapter=null,bigStockAdapter=null,shutterStockAdapter=null,collectionAdapter=null,settingsPassedAdapterWrapped=null,showboxAdapter=null,canShowTab=function(tab){return _.includes(settings.tabsList,tab.id)},{private:{id:"private",state:"app.private",translationKey:"private_media_tab",canShow:function(){return canShowTab(this)},getAdapter:function(){var ref,sourceSettings;return sourceSettings={apiUrl:settings.privateMediaRestAPI,filesUrl:settings.privateMediaRestFiles,videoFilesUrl:settings.privateMediaRestVideoFiles,imageOperationsApi:settings.imageOperationsApi,uploadLimits:uploadSizesLimitsHard,refreshTokenUrl:settings.refreshTokenUrl,requestOptions:settings.requestOptions,siteMediaToken:settings.siteMediaToken,vision:settings.vision,blackArrow:settings.blackArrow,asyncFontUpload:settings.asyncFontUpload,asyncUploadByUrl:settings.asyncUploadByUrl,asyncTranscoding:settings.asyncTranscoding},settings.namespace&&_.set(sourceSettings,"requestOptions.params.ns",settings.namespace),_.isEqual(prevAdapterSettings.private,sourceSettings)?(null!=privateAdapter&&null!=(ref=privateAdapter.blackArrow)&&ref.open(),privateAdapter):(prevAdapterSettings.private=_.clone(sourceSettings),privateAdapter=wrapSource(new wixmp.Source(wixmp.sources.PRIVATE,sourceSettings)),privateAdapter.blackArrow.open(),"debug"===settings.mode&&($window.private=privateAdapter),privateAdapter)}},platform:{id:"platform",state:"app.platform",translationKey:"private_media_tab",canShow:function(){return canShowTab(this)},getAdapter:function(){var ref,sourceSettings;return sourceSettings={apiUrl:settings.platformRestAPI,filesUrl:settings.platformRestFiles,videoFilesUrl:settings.platformRestVideoFiles,imageOperationsApi:settings.imageOperationsApi,uploadLimits:uploadSizesLimitsHard,refreshTokenUrl:settings.refreshTokenUrl,requestOptions:settings.requestOptions,blackArrow:settings.blackArrow},_.isEqual(prevAdapterSettings.platform,sourceSettings)?(null!=platformAdapter&&null!=(ref=platformAdapter.blackArrow)&&ref.open(),platformAdapter):(prevAdapterSettings.platform=_.clone(sourceSettings),platformAdapter=wrapSource(new wixmp.Source(wixmp.sources.PLATFORM,sourceSettings)),platformAdapter.blackArrow.open(),"debug"===settings.mode&&($window.private=platformAdapter),platformAdapter)}},public:{id:"public",state:"app.public",translationKey:"public_media_tab",canShow:function(){return canShowTab(this)},getAdapter:function(){var sourceSettings;return sourceSettings={apiUrl:settings.publicMediaRestAPI,filesUrl:settings.publicMediaRestFiles,imageOperationsApi:settings.imageOperationsApi,wixUser:settings.isEmailWithWixDomain},_.isEqual(prevAdapterSettings.public,sourceSettings)?publicAdapter:(prevAdapterSettings.public=_.clone(sourceSettings),publicAdapter=wrapSource(new wixmp.Source(wixmp.sources.PUBLIC,sourceSettings)))}},photoStock:{id:"photoStock",state:"app.photoStock",translationKey:"photo_stock_tab",canShow:function(){return canShowTab(this)},getAdapter:function(){var sourceSettings;return sourceSettings={apiUrl:settings.bigStockSearchAPI},_.isEqual(prevAdapterSettings.photoStock,sourceSettings)?bigStockAdapter:(prevAdapterSettings.photoStock=_.clone(sourceSettings),bigStockAdapter=wrapSource(new wixmp.Source(wixmp.sources.BIGSTOCK,sourceSettings)))}},shutterStock:{id:"shutterStock",state:"app.shutterStock",translationKey:"shutterstock_tab",canShow:function(){return canShowTab(this)},getAdapter:function(){var sourceSettings;return sourceSettings={apiUrl:settings.shutterStockSearchAPI},_.isEqual(prevAdapterSettings.shutterStock,sourceSettings)?shutterStockAdapter:(prevAdapterSettings.shutterStock=_.clone(sourceSettings),shutterStockAdapter=wrapSource(new wixmp.Source(wixmp.sources.SHUTTERSTOCK,sourceSettings)))}},externalSearch:{id:"externalSearch",state:"app.externalSearch",translationKey:"external_free_images_tab",canShow:function(){return canShowTab(this)},getAdapters:function(){return null!=externalSearchAdapters[settings.mediaType]?externalSearchAdapters[settings.mediaType]:externalSearchAdapters[settings.mediaType]=_(supportedExternalSearchServices).filter(function(service){return _.includes(settings.servicesList,service.name)&&_.includes(service.mediaTypes,settings.mediaType)}).map(function(service){var id;return id=_.snakeCase(service.name).toUpperCase(),wrapSource(new wixmp.Source(wixmp.sources[id]))}).value()}},external:{id:"external",state:"app.external",translationKey:"external_media_tab",canShow:function(){return canShowTab(this)},getAdapters:function(){return null!=externalAdapters[settings.mediaType]?externalAdapters[settings.mediaType]:externalAdapters[settings.mediaType]=_(settings.servicesList).filter(function(serviceName){return _.some(supportedExternalServices,function(externalService){return externalService.name===serviceName&&_.includes(externalService.mediaTypes,settings.mediaType)})}).map(function(serviceName){var id;return id=_.snakeCase(serviceName).toUpperCase(),wrapSource(new wixmp.Source(wixmp.sources[id]))}).value()}},collection:{id:"collection",state:"app.collection",translationKey:"collection_tab",canShow:function(){return canShowTab(this)},getAdapter:function(){var sourceSettings;return sourceSettings={apiUrl:settings.collectionsAPI,collectionId:settings.collectionId,filesUrl:settings.privateMediaRestFiles,imageOperationsApi:settings.imageOperationsApi},_.isEqual(prevAdapterSettings.collection,sourceSettings)?collectionAdapter:(prevAdapterSettings.collection=_.clone(sourceSettings),collectionAdapter=wrapSource(new wixmp.Source(wixmp.sources.COLLECTION,sourceSettings)))}},settingsPassed:{id:"settingsPassed",state:"app.settingsPassed",translationKey:"settings_passed_tab",canShow:function(){return canShowTab(this)},getAdapter:function(){return null!=settingsPassedAdapterWrapped?settingsPassedAdapterWrapped:settingsPassedAdapterWrapped=wrapSource(settingsPassedAdapter)}},custom:{id:"custom",state:"app.custom",getTitle:function(){var ref;return(null!=(ref=settings.customData)?ref.title:void 0)||""},canShow:function(){return canShowTab(this)}},showbox:{id:"showbox",state:"app.showbox",translationKey:"showbox_tab",canShow:function(){return canShowTab(this)},getAdapter:function(){var sourceSettings;return sourceSettings={requestOptions:settings.requestOptions},showboxAdapter=wrapSource(new wixmp.Source(wixmp.sources.SHOWBOX,sourceSettings))}},empty:{id:"empty",state:"app.empty",canShow:function(){return!0},getAdapter:function(){var ref;return null!=privateAdapter&&null!=(ref=privateAdapter.blackArrow)?ref.close():void 0}}}})}.call(this),function(){"use strict";this.app.factory("NormalizeUri",function(){return function(url){return new URI(url).normalize()._string}}),this.app.factory("UrlSanitizeInterceptor",function($q,NormalizeUri){return{request:function(config){var deferred;return deferred=$q.defer(),config.url=NormalizeUri(config.url),deferred.resolve(config),deferred.promise}}})}.call(this),function(){"use strict";var slice=[].slice;this.app.factory("Notifications",function($timeout,$rootScope,editorConnection){var expireNotification,notifications,purgeNotifications,safeApply,sendNotification;return safeApply=function(callback){return $rootScope.$$phase?callback():$rootScope.$apply(function(){return callback()})},notifications=[],sendNotification=function(message,timeout,type){var messageId;return null==timeout&&(timeout=5e3),null==type&&(type="error"),messageId=UUID.generate(),message={id:messageId,message:message,type:type},notifications.push(message),timeout&&$timeout(function(){return expireNotification(messageId)},timeout),$rootScope.$emit("UiNotificationReceived",notifications),messageId},expireNotification=function(id){return _.remove(notifications,function(notification){return notification.id===id}),$rootScope.$emit("UiNotificationExpired",notifications)},purgeNotifications=function(){return notifications.length=0,$rootScope.$emit("UiNotificationsPurged",notifications)},window.purge=purgeNotifications,{send:function(){var args;return args=1<=arguments.length?slice.call(arguments,0):[],safeApply(function(){return sendNotification.apply(null,args)})},expire:function(){var args;return args=1<=arguments.length?slice.call(arguments,0):[],safeApply(function(){return expireNotification.apply(null,args)})},get:function(){return safeApply(function(){return notifications})}}})}.call(this),function(){"use strict";var slice=[].slice;this.app.factory("Aviary",function($rootScope,tabs,i18n,settings,biReport){var editor,observers,onAviaryError,onAviarySave;return observers=[],function(){var args,event;return event=arguments[0],args=2<=arguments.length?slice.call(arguments,1):[],_(observers).where({event:event}).each(function(observer){var ref;return(ref=observer.fn).call.apply(ref,[{name:name},observer.event].concat(slice.call(args))),observer})},editor=null,onAviarySave=function(imageId,newUrl){return!1},onAviaryError=function(message){},{on:function(event,fn){return observers.push({event:event,fn:fn})},upload:function(imageName,url,folder){var callback,ext,mime,newName,onAviarySaveButtonClick,parts;return parts=imageName.split("."),ext=parts.slice(-1).pop().toLowerCase(),"jpg"===ext||"jpeg"===ext?(ext="jpg",mime="image/jpeg"):(ext="png",mime="image/png"),newName=parts.slice(0,-1).join(".")+"_edited."+ext,onAviarySaveButtonClick=function(imageId){var canvasElement;return canvasElement=document.getElementById("avpw_canvas_element"),canvasElement.toBlob(function(blob){var file,filesToUpload;return blob.name=newName,blob.size||(blob.size=0),file={uploadFn:tabs.private.getAdapter().item.upload,source:{file:blob,name:blob.name,size:blob.size,folderId:folder.id,folderName:folder.name,mediaType:settings.mediaType,tags:["edited"]}},settings.maxParallelUploads&&(wixmp.Uploader.maxParallelUploads=settings.maxParallelUploads),filesToUpload=wixmp.Uploader.upload([file]),_.last(filesToUpload).deferred.promise.then(function(res){return editor.close(),res}),$rootScope.$apply()},mime),biReport("uploadStarted",{files:1,media_type:settings.mediaType,mode:"aviary"})},callback=function(){var image;return image=new Image,image.src=url,editor.launch({url:url,image:image,onSaveButtonClicked:onAviarySaveButtonClick})},editor?callback():editor=new window.Aviary.Feather({apiKey:"9dce9779bdcd467287c648d258e79772",tools:"crop,orientation,enhance,effects,frames,brightness,contrast,saturation,warmth,focus,sharpness,draw,redeye,whiten,blemish,stickers,text",theme:"minimum",maxSize:1500,displayImageSize:!0,onSave:onAviarySave,onError:onAviaryError,language:i18n.getLang(),launchDelay:0,onLoad:callback})}}})}.call(this),function(){"use strict";this.app.factory("stockPayment",function($q,$rootScope,tabs,settings){return function(stockName){var getBoughtImage;return getBoughtImage=function(id,maxTryCount,tryCount){return null==maxTryCount&&(maxTryCount=5),null==tryCount&&(tryCount=0),tryCount++,tryCount>maxTryCount?$q.reject():tabs.private.getAdapter().items.searchByTag("_"+stockName+"_"+id).then(function(result){var items;return items=result.data,items.length?items[0]:getBoughtImage(id,maxTryCount,tryCount)},function(){return getBoughtImage(id,maxTryCount,tryCount)})},{buyImage:function(item){var deferred,popup,url;return deferred=$q.defer(),"bigstock"===stockName?url=settings.bigStockPaymentAPI+"/services/bigstock/start_purchase?image_id="+item.id+"&size_code=l&altsku="+settings.bigStockAltSku:"shutterstock"===stockName&&(url=settings.bigStockPaymentAPI+"/services/shutterstock/start_purchase?image_id="+item.id+"&altsku="+settings.bigStockAltSku),popup=window.open(url,"purchase","width=1000,height=550,scrollbars=1"),popup.blur(),window.focus(),getBoughtImage(item.id,1).then(function(){return popup.close(),deferred.resolve({success:!0})},function(){var isCompleted;return popup.focus(),isCompleted=!1,window.processPayment=function(data){if(null==data&&(data={}),!isCompleted)return $rootScope.$apply(function(){return isCompleted=!0,"string"==typeof data&&(data=JSON.parse(data)),data.success?deferred.resolve(data):deferred.reject(data)})},window.addEventListener("message",function(event){if(window.debug&&console.log(event),/premium\./i.test(event.origin))return window.processPayment(event.data)},!1)}),deferred.promise},getBoughtImage:function(itemOrId){return getBoughtImage((null!=itemOrId?itemOrId.id:void 0)||itemOrId)}}}})}.call(this),function(){"use strict";this.app.factory("submitItems",function(settings,editorConnection,path,mediaTypes){var filterDomain,filterFileUrl;return filterDomain=function(string){var regexp;return regexp=/(http:\/\/[^\/]+\/)/i,string.replace(regexp,"")},filterFileUrl=function(fileUrl){return fileUrl.replace(/.*\//,"")},function(items){var result;return result={path:path.getFull(),items:_.map(items,function(item){var fileUrl,mapped,preview,ref;return fileUrl=item.fileUrl||"",mapped={id:item.id,mediaType:item.mediaType,fileName:filterFileUrl(fileUrl),uri:filterFileUrl(fileUrl),fileUrl:fileUrl,title:item.name},_.includes([mediaTypes.PICTURE,mediaTypes.SECURE_PICTURE,mediaTypes.SWF],mapped.mediaType)&&(mapped.width=item.width,mapped.height=item.height),"secure_music"===item.mediaType&&(mapped.sampleUrl=item.sampleUrl),item.fileInput&&(mapped.fileInput=item.fileInput),item.fileOutput&&(mapped.fileOutput=item.fileOutput),"secure_music"===item.mediaType&&(preview=_.find(null!=(ref=item.fileOutput)?ref.audio:void 0,function(audio){return"preview"===audio.tag}),mapped.previewFileName=null!=preview?preview.url.replace(/.*\//,""):void 0),"video"===item.mediaType&&(mapped.fileBaseUrl=fileUrl.split("/").slice(0,2).join("/"),item.embedHtml&&(mapped.embedHtml=item.embedHtml),item.externalSources&&(mapped.externalSources=item.externalSources)),_.forEach(settings.additionalItemAttributes,function(attrName){if(null==mapped[attrName])return mapped[attrName]=/Url/i.test(attrName)?filterDomain(item[attrName]):item[attrName]}),mapped})},editorConnection.emit("items",result)}})}.call(this),function(){"use strict";this.app.factory("RejectError",function(){var RejectError;return RejectError=function(){function RejectError(data,caller){this.caller=caller,"string"==typeof data&&(data={message:data}),_.assign(this,data)}return RejectError.prototype.toString=function(){return null!=this.caller?this.caller+": "+this.message:this.message},RejectError}(),_.assign(RejectError,{alreadyLoading:{code:-400,message:"Already loading"},tooShortCallInterval:{code:-401,message:"Too short call interval"},cantLoadMore:{code:-402,message:"No entities for load more"},noMethod:{code:-403,message:"Method is undefined or misspelled"},invalidFileSize:{code:-404,message:"Invalid file size"},noActionSubject:{code:-405,message:"No action subject"}})})}.call(this),function(){"use strict";var bind=function(fn,me){return function(){return fn.apply(me,arguments)}};this.app.factory("LoadingHelper",function(){return function(){function LoadingHelper(obj,options){this.obj=obj,this.attach=bind(this.attach,this),this.loadTimeout=null,_.assign(this.options,options),this.obj[this.options.attributeName]}return LoadingHelper.prototype.options={minLoadInterval:1e3,attributeName:"isLoading"},LoadingHelper.prototype.isDeniedByInterval=function(){return null!=this.loadTimeout},LoadingHelper.prototype.attach=function(promise){return this.loadTimeout=setTimeout(function(_this){return function(){return _this.loadTimeout=null}}(this),this.options.minLoadInterval),this.obj[this.options.attributeName]=!0,promise.then(function(_this){return function(){return _this.obj[_this.options.attributeName]=!1}}(this),function(_this){return function(){return _this.obj[_this.options.attributeName]=!1}}(this))},LoadingHelper}()})}.call(this),function(){"use strict";this.app.factory("serviceRedirectUrl",function($location){return function(){return $location.absUrl().replace($location.url(),"").replace(/\/[^\/]+?$/,"/service_connected.html")}})}.call(this),function(){"use strict";this.app.constant("getThumbnailsSizes",function(){return window.devicePixelRatio>1.5?{thumbnail:{width:440,height:440,mode:"fill"},preview:{width:750,height:750,mode:"fit"}}:{thumbnail:{width:220,height:220,mode:"fill"},preview:{width:375,height:375,mode:"fit"}}})}.call(this),function(){"use strict";this.app.value("nestedMethod",{get:function(obj,namespace){var method;return method=obj,_.forEach(namespace.split("."),function(ns){if(null==(method=method[ns]))return!1}),method},set:function(obj,namespace,method){var nsList,originalMethod;return originalMethod=obj,nsList=namespace.split("."),_.forEach(nsList,function(ns,index){return originalMethod[ns]||(originalMethod[ns]={}),index===nsList.length-1?originalMethod[ns]=method:originalMethod=originalMethod[ns]}),obj}})}.call(this),function(){"use strict";this.app.factory("paginatedItemsListLoader",function($q,RejectError,getThumbnailsSizes){return function(adapter,getParentFolder,getSortOptions){var getOptions,paging;return paging=null,getOptions=function(){return _.assign({thumbnails:getThumbnailsSizes(),paging:paging},"function"==typeof getSortOptions?getSortOptions():void 0)},function(isFirstPage){var parentFolder,promise;return isFirstPage||(null!=paging?paging.cursor:void 0)?(isFirstPage&&(paging=null),parentFolder="function"==typeof getParentFolder?getParentFolder():void 0,promise=parentFolder?getParentFolder().itemsList(getOptions()):adapter.items.list(null,getOptions()),promise.then(function(list){return paging=list.paging,list})):$q.reject(new RejectError(RejectError.cantLoadMore,"EntitiesCtrl"))}}})}.call(this),function(){"use strict";this.app.factory("paginatedItemsSearchLoader",function(getThumbnailsSizes,$q,RejectError){return function(adapter,getParentFolder,getSortOptions){var getOptions,paging;return paging=null,getOptions=function(){return _.assign({thumbnails:getThumbnailsSizes(),paging:paging},"function"==typeof getSortOptions?getSortOptions():void 0)},function(query,isFirstPage){var parentFolder,promise;return isFirstPage||(null!=paging?paging.cursor:void 0)?(isFirstPage&&(paging=null),parentFolder="function"==typeof getParentFolder?getParentFolder():void 0,promise=parentFolder?getParentFolder().itemsSearch(query,getOptions()):adapter.items.search(null,query,getOptions()),promise.then(function(list){return paging=list.paging,list})):$q.reject(new RejectError(RejectError.cantLoadMore,"EntitiesCtrl"))}}})}.call(this),function(){"use strict";this.app.factory("getReadableFileSize",function(i18n){var fileSizes;return fileSizes=["bytes","kilobytes","megabytes","gigabytes","terabytes"],function(fileSize){var i,il;for(i=0,il=fileSizes.length;i<il&&(fileSize/=1024,i++,!(fileSize/1024<1)););return{size:fileSize,sizeType:i18n.translate("uploader."+fileSizes[i])}}})}.call(this),function(){"use strict";this.app.constant("productionSettings",{baseHost:"wix.com",uploadAdapterName:"private",windowStyle:"fullscreen",showTabs:!0,submitItems:!0,disableUpload:!1,selectionType:"multiple",mediaType:"picture",publicMediaRoot:"photos",i18nCode:"en",i18nPrefix:"",namespace:"",translations:{},cssUrl:"",hasPurchased:!1,hasFavorites:!1,hasSubfolders:!1,hasTrash:!1,canSubmitUntranscoded:!1,mp4PreviewsOnly:!0,useFastTranscoding:!1,biImageLoadSpeed:!1,bi:!0,experiments:!0,closeWindowOnEscape:!0,mode:"production",tabsList:["private","external","public","photoStock"],servicesList:["facebook","instagram","drive","flickr","picasa","deviantart","flickrSearch","googleSearch"],additionalItemAttributes:["sourceName","tags","tagsEn","labels","vendor","creator","reference"],maxParallelUploads:4,path:"",collectionId:"",recommendedPublicCategoryId:"630c9ae8-c079-409e-92a0-bb50fb9ab037",helpId:"",imageOperationsApi:"vanbrandt",
privateMediaRestFiles:"//static.wixstatic.com",settingsPassedFiles:"//static.wixstatic.com",privateMediaRestVideoFiles:"//video.wixstatic.com",publicMediaRestFiles:"//static.wixstatic.com",publicMediaRestVideoFiles:"//video.wixstatic.com",privateMediaRestAPI:"https://files.wix.com",publicMediaRestAPI:"https://publicmedia.wix.com/public",bigStockPaymentAPI:"https://pix.wix.com",bigStockSearchAPI:"https://pix.wix.com/services/bigstock",shutterStockSearchAPI:"https://pix.wix.com/services/shutterstock",bigStockPriceUrl:"/_api/wix/digitalGoodsPriceQuote?digitalGoodsSkuGuid=31396262-3737-3438-2d31-3131312d3434",bigStockAltSku:"0",collectionsAPI:"//collections.wixstatic.com/collections",videoEncodingProfile:"mp4-only",resumableUpload:!1,blackArrow:{enabled:!0},blackArrowTests:!1,asyncFontUpload:!1,asyncUploadByUrl:!1,asyncTranscoding:!0,isEmailWithWixDomain:!1,stockShutterOn:"0"})}.call(this),function(){"use strict";this.app.constant("testSettings",{baseHost:"ten.wixpress.com",uploadAdapterName:"private",windowStyle:"fullscreen",showTabs:!0,submitItems:!0,disableUpload:!1,selectionType:"multiple",mediaType:"picture",publicMediaRoot:"photos",i18nCode:"en",i18nPrefix:"",namespace:"",translations:{},cssUrl:"",hasPurchased:!1,hasFavorites:!1,hasSubfolders:!1,hasTrash:!1,canSubmitUntranscoded:!1,mp4PreviewsOnly:!0,useFastTranscoding:!1,biImageLoadSpeed:!1,bi:!0,experiments:!0,closeWindowOnEscape:!0,mode:"test",tabsList:["private","external","public","photoStock","externalSearch","collection"],servicesList:["facebook","instagram","dropbox","drive","flickr","picasa","deviantart","flickrSearch","googleSearch"],additionalItemAttributes:["sourceName","tags","tagsEn","labels","vendor","creator","reference"],maxParallelUploads:4,path:"",collectionId:"",recommendedPublicCategoryId:"630c9ae8-c079-409e-92a0-bb50fb9ab037",helpId:"",imageOperationsApi:"vangogh",privateMediaRestFiles:"//static.{baseHost}",settingsPassedFiles:"//static.{baseHost}",privateMediaRestVideoFiles:"//video.{baseHost}",publicMediaRestFiles:"//static.{baseHost}",publicMediaRestVideoFiles:"//video-dev.{baseHost}",privateMediaRestAPI:"https://files.{baseHost}",publicMediaRestAPI:"https://publicmedia.{baseHost}/public",bigStockPaymentAPI:"https://pix.wix.com",bigStockSearchAPI:"https://pix.wix.com/services/bigstock",collectionsAPI:"//collections.wixstatic.com/collections",videoEncodingProfile:"mp4-only",resumableUpload:!1,blackArrow:{enabled:!1},blackArrowTests:!1})}.call(this),function(){"use strict";this.app.constant("openSettings",{baseHost:"open.wixmp.com",uploadAdapterName:"platform",windowStyle:"fullscreen",showTabs:!0,submitItems:!0,disableUpload:!1,selectionType:"multiple",mediaType:"picture",publicMediaRoot:"photos",i18nCode:"en",i18nPrefix:"",namespace:"",translations:{},cssUrl:"",hasPurchased:!1,hasFavorites:!1,hasSubfolders:!1,hasTrash:!1,canSubmitUntranscoded:!1,mp4PreviewsOnly:!0,useFastTranscoding:!1,biImageLoadSpeed:!1,bi:!1,experiments:!1,closeWindowOnEscape:!0,mode:"production",tabsList:["platform"],servicesList:[],additionalItemAttributes:["sourceName","tags","labels","meta"],path:"",collectionId:"",recommendedPublicCategoryId:"630c9ae8-c079-409e-92a0-bb50fb9ab037",helpId:"",platformRestAPI:"//wixmp-8cbe8e680e95a22c77c8d3d0.appspot.com/mmgr/",platformRestFiles:"//images-wixmp-8cbe8e680e95a22c77c8d3d0.wixmp.com",platformRestVideoFiles:"",imageOperationsApi:"vanbrandt",privateMediaRestFiles:"//static.wixstatic.com",settingsPassedFiles:"//static.wixstatic.com",privateMediaRestVideoFiles:"//video.wixstatic.com",publicMediaRestFiles:"//static.wixstatic.com",publicMediaRestVideoFiles:"//video.wixstatic.com",privateMediaRestAPI:"https://files.wix.com",publicMediaRestAPI:"https://publicmedia.wix.com/public",bigStockPaymentAPI:"https://pix.wix.com",bigStockSearchAPI:"https://pix.wix.com/services/bigstock",bigStockPriceUrl:"",collectionsAPI:"//collections.wixstatic.com/collections",videoEncodingProfile:"mp4-only",resumableUpload:!1,blackArrow:{enabled:!0},blackArrowTests:!1})}.call(this),function(){"use strict";this.app.factory("getDefaultSettings",function(productionSettings,testSettings,openSettings){var baseHostRule;return baseHostRule=/\{baseHost\}/i,function(baseHost,mediaType){var defaultSettings;return null==baseHost&&(baseHost=""),null==mediaType&&(mediaType=""),defaultSettings=/\.wixpress\.com/i.test(baseHost)?testSettings:/open\.wixmp\.com/i.test(baseHost)?openSettings:productionSettings,defaultSettings=_.cloneDeep(defaultSettings),_.forEach(defaultSettings,function(value,key){return"string"==typeof value&&baseHostRule.test(value)&&(defaultSettings[key]=value.replace(baseHostRule,baseHost)),!0}),"secure_picture"===mediaType&&(defaultSettings.privateMediaRestFiles=defaultSettings.privateMediaRestAPI+"/secure-image"),defaultSettings}})}.call(this),function(){"use strict";this.app.service("getExperimentsSettings",function($q,$http){var TIMEOUT,currentSettings,experimentsSettings;return experimentsSettings={blackArrowTestsExp:{blackArrowTests:!0},resumableUpload:{resumableUpload:!0},publicMediaCDN:{publicMediaRestAPI:"https://publicmedia.wixmp.com/public"},stockBigPrice:{bigStockPriceUrl:"/_api/wix/digitalGoodsPriceQuote?digitalGoodsSkuGuid=32366262-3737-3438-2D38-3537332D3333",bigStockAltSku:"1"},stockShutter:{stockShutterOn:"1",hasPurchased:!0}},currentSettings=null,TIMEOUT=300,function(settings){var url;return!settings.experiments||currentSettings?$q.when(currentSettings):_.isEmpty(_(settings.laboratory).values().filter().value())?(url="/_api/wix-laboratory-server/laboratory/conductAllInScope?scope=media-manager",$http.get(url,{timeout:TIMEOUT}).then(function(res){var jsonSettings;return jsonSettings=res.data,_.forEach(jsonSettings,function(experimentValue,experimentName){if(null!=experimentsSettings[experimentName]&&("true"===experimentValue||"new"===experimentValue))return currentSettings=_.merge({},currentSettings,experimentsSettings[experimentName])}),currentSettings},function(){return $q.reject(currentSettings)})):(_.forEach(settings.laboratory,function(experimentValue,experimentName){if(null!=experimentsSettings[experimentName]&&experimentValue)return currentSettings=_.merge({},currentSettings,experimentsSettings[experimentName])}),$q.when(currentSettings))}})}.call(this),function(){"use strict";this.app.value("settings",{}),this.app.factory("Settings",function(_this){return function($rootScope,$q,$window,$state,$stateParams,biReport,getDefaultSettings,editorConnection,settings,tabs,path,getExperimentsSettings){var deferred,fedopsLogger,logger,prepare,redirectToPathOrFirstTab,ref,ref1,reload,sendOpenSettingsBiReport,setSettings;return logger=new Logger("Settings"),biReport("dialogOpened",{version:$window.VERSION},null,!0),(null!=(ref=window.fedops)&&null!=(ref1=ref.logger)?ref1.create:void 0)&&(fedopsLogger=window.fedops.logger.create("media-manager-g5"),fedopsLogger.appLoaded()),redirectToPathOrFirstTab=function(currentPath){var splittedPath,tabToShow;return splittedPath=currentPath.split("/"),tabToShow=tabs[splittedPath[0]],(null!=tabToShow?tabToShow.canShow():void 0)||(tabToShow=_.find(tabs,function(tab){return tab.canShow()})),tabToShow?($state.transitionTo(tabToShow.state,$stateParams,{reload:!0,inherit:!1,notify:!0,location:"replace"}),path.setFull(currentPath)):(console.error("Can not find any tab to show."),console.warn(settings))},prepare=function(newSettings){var defaultSettings,set;return defaultSettings=getDefaultSettings(newSettings.baseHost,newSettings.mediaType),set=_.merge(defaultSettings,newSettings,function(defaultOption,currentOption){return _.isArray(defaultOption)?currentOption:_.isObject(defaultOption)&&_.isObject(currentOption)?_.merge(defaultOption,currentOption):_.isUndefined(currentOption)||_.isNull(currentOption)||""===currentOption?defaultOption:currentOption}),_.isString(set.tabsList)&&(set.tabsList=set.tabsList.split(",")),_.isString(set.servicesList)&&(set.servicesList=set.servicesList.split(",")),null!=newSettings.publicMediaFile&&(set.publicMediaRoot=newSettings.publicMediaFile),"default"===set.publicMediaRoot&&(set.publicMediaRoot=defaultSettings.publicMediaRoot),null!=newSettings.canShowTabs&&(set.showTabs=newSettings.canShowTabs),null!=newSettings.canShowSelectButton&&(set.submitItems=newSettings.canShowSelectButton),null!=newSettings.showSelectButton&&(set.submitItems=newSettings.showSelectButton),_.isString(newSettings.translations)&&newSettings.translations&&(set.translations=JSON.parse(newSettings.translations)),_.forEach(set,function(val,key){if("true"===val&&(set[key]=!0),"false"===val)return set[key]=!1}),set},deferred=$q.defer(),setSettings=function(set,settings,experimentsSettings){return settings=_(settings).extend(set).merge(experimentsSettings).value(),deferred.resolve(settings),logger.log("Settings was set",settings)},sendOpenSettingsBiReport=function(experimentsLoaded){return biReport("MMOpenSettings",{media_type:settings.mediaType,source:experimentsLoaded},"media-mr")},reload=function(set){var ref2;return logger.log("New settings received",set),null!=(ref2=_this.appLoadNotifiers)&&ref2.settingsReceivedFromProtocol(),set=prepare(set),getExperimentsSettings(set).then(function(experimentsSettings){return setSettings(set,settings,experimentsSettings),sendOpenSettingsBiReport(!0),"1"===settings.stockShutterOn&&settings.tabsList.indexOf("photoStock")>=0&&(_.remove(settings.tabsList,function(tabName){return"shutterStock"===tabName}),settings.tabsList.splice(settings.tabsList.indexOf("photoStock"),1,"shutterStock")),redirectToPathOrFirstTab(settings.path)}).catch(function(experimentsSettings){return setSettings(set,settings,experimentsSettings),sendOpenSettingsBiReport(!1),redirectToPathOrFirstTab(settings.path)}).then(function(){return setTimeout(function(){return editorConnection.emit("settingsReady",!0)},500)})},editorConnection.on("settings",reload),editorConnection.on("empty",function(){return $state.go("app.empty")}),{reload:reload,isLoaded:deferred.promise}}}(this))}.call(this),function(){"use strict";this.app.constant("BIEventsIds",{dialogOpen:100,dialogOpened:101,uploadStarted:103,uiEvent:134,imageLoadSpeed:143,webSockets:145,MMOpenSettings:500})}.call(this),function(){"use strict";this.app.service("biUiEvents",function(biReport,settings,path){return function(eventName,options){return options.eventName=eventName,options.mediaType=settings.mediaType,options.i18nCode=settings.i18nCode,options.publicMediaRoot=settings.publicMediaRoot,options.path||(options.path=path.getFull()),biReport("uiEvent",options)}})}.call(this),function(){"use strict";this.app.service("biReport",function(_this){return function(BIEventsIds,settings){return function(eventName,data,projectSrc,force){var image;if(null==projectSrc&&(projectSrc="mg"),null==force&&(force=!1),settings.bi||force)return data=_.assign({evid:BIEventsIds[eventName]},data),image=new Image,image.src=_this.BIURL+"/"+projectSrc+"?src=26&"+$.param(data)+"&_="+(new Date).getTime()}}}(this))}.call(this),function(){"use strict";this.app.service("biSubscribeUpload",function(biReport){var filesToUpload,getCurrentTime,send,uploadSessionId,uploadStartTime;return filesToUpload=[],uploadStartTime=0,uploadSessionId=null,getCurrentTime=function(){return(new Date).getTime()},send=function(eventName,options){var data;return data={usi:uploadSessionId,did:window.siteID||window.sessionID,src:26},biReport(eventName,_.assign(data,options))},function(){return wixmp.Uploader.on("uploadQueueStarted",function(queue){return uploadSessionId=UUID.generate(),uploadStartTime=getCurrentTime(),filesToUpload=_.filter(queue,function(file){return"waiting"===file.status}),send("uploadQueueStarted",{files:filesToUpload.length,mode:"html5"})}),wixmp.Uploader.on("uploadQueueFinished",function(){var eventName,failsCount,speed,successBytes,uploadingTimeSec;if(!((uploadingTimeSec=(getCurrentTime()-uploadStartTime)/1e3)<1||(successBytes=_.sum(filesToUpload,function(fileToUpload){return"failed"!==fileToUpload.status?fileToUpload.source.file.size:0}))<10240))return failsCount=_.sum(filesToUpload,function(fileToUpload){return"failed"===fileToUpload.status?1:0}),eventName=failsCount>0?"uploadQueueFail":"uploadQueueSuccess",speed=Math.floor(successBytes/uploadingTimeSec),speed<=0&&(speed=-1),send(eventName,{files:filesToUpload.length,errors:failsCount,speedBytesPerSecond:speed})})}})}.call(this),function(){this.app.factory("biMeasureImageLoadSpeed",function($http,biReport,settings){return function(){if(settings.biImageLoadSpeed&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))return $http.get("//collections.wixstatic.com/collections/931f1bd1-2757-447f-a581-34517630a80c.json",{withCredentials:!1}).then(function(res){var canMeasure,minResponseTimeMs,promise,ref,ref1,ref2,ref3,runTestPercent,start;if(runTestPercent=(null!=(ref=res.data.collection)&&null!=(ref1=ref.public_properties)?ref1.run_test_percent:void 0)||10,canMeasure="debug"===settings.mode||/local(\.|host)/i.test(document.location.host)||100*Math.random()<runTestPercent,minResponseTimeMs=(null!=(ref2=res.data.collection)&&null!=(ref3=ref2.public_properties)?ref3.min_response_time_ms:void 0)||10,canMeasure)return start=null,promise=new Promise(function(resolve){return start=resolve}),_.forEach(_.shuffle(res.data.collection.items),function(item){var cdnid,headers,iframeUrl,itemid,sever,url;if(itemid=item.id+"",url=item.public_properties.url)return headers=item.public_properties.headers,sever=/^((https?:)?\/\/[^\/]+)/i.exec(url)[1],iframeUrl=item.public_properties.iframe_url||sever+"/image_load_speed_v4.html",cdnid=item.public_properties.cdnid,promise=promise.then(function(){var $iframe,connection;return $iframe=$("<iframe>"),$iframe.css({display:"none"}),$iframe.prop({src:iframeUrl}),$iframe.appendTo("body"),connection=new WindowMessenger($iframe[0].contentWindow),connection.on("loadSpeed.readyForRequest",function(){return connection.emit("loadSpeed.measure",{url:url,headers:headers,itemid:itemid,cdnid:cdnid})}),connection.on("loadSpeed.result",function(data){var biData,getHeaderValue,hasHeader,ref4,response_size,response_speed,response_time_ms;if(data.options.itemid===itemid&&!(data.responseTimeMS<minResponseTimeMs)&&data.isSuccess&&200===data.responseCode&&(headers=data.responseHeaders.toLowerCase(),response_size=(null!=(ref4=headers.match(/content-length: ([0-9]+)/))?ref4[1]:void 0)||0,response_time_ms=data.responseTimeMS||0,response_speed=response_time_ms&&1e3*response_size/response_time_ms||0,!(response_size<1)))return biData={file_name:url,origin:"",cdn:"none",is_cache_hit:"false",response_size:response_size,response_time_ms:Math.round(response_time_ms),response_speed:Math.round(response_speed),description:JSON.stringify(headers)},getHeaderValue=function(headerName){var ref5;return null!=(ref5=new RegExp(headerName+": ?([^\n\r]+)").exec(headers))?ref5[1]:void 0},hasHeader=function(header){return headers.indexOf(header)>=0},hasHeader("x-goog-")?biData.origin="google":(hasHeader("x-amz-")||hasHeader("x-amz-"))&&(biData.origin="amazon"),/google/.test(getHeaderValue("via"))?(biData.cdn="google",biData.is_cache_hit=+getHeaderValue("age")>0?"true":"false"):hasHeader("x-akamai-request-id")?(biData.cdn="akamai",biData.is_cache_hit=/hit/.test(getHeaderValue("x-cache"))||/hit/.test(getHeaderValue("x-cache-remote"))?"true":"false"):/varnish/.test(getHeaderValue("via"))?(biData.cdn="fastly",biData.is_cache_hit=/hit/.test(getHeaderValue("x-cache"))?"true":"false"):/cloudfront/i.test(getHeaderValue("via"))&&(biData.cdn="cloudfront",biData.is_cache_hit=/hit/.test(getHeaderValue("x-cache"))?"true":"false"),biData.cdn+=":"+data.options.cdnid,biReport("imageLoadSpeed",biData)})})}),start(),promise})}})}.call(this),function(){"use strict";this.app.factory("TestWebsocket",function($q,biReport,openSettings){return function(adapter,settings){var TIMEOUT_TO_ERROR,TIME_START,blackArrow,convertTime,errorTimeoutId,getCurrentTime,messageToSend,onMessage,sendBi,sendErrorAfterTimeLimit;if(!_.isEqual(settings.baseHost,openSettings.baseHost)&&adapter.blackArrow&&_.get(settings,"blackArrow.enabled"))return TIME_START=0,TIMEOUT_TO_ERROR=3e4,errorTimeoutId=null,blackArrow=adapter.blackArrow,messageToSend={uniqueId:""+_.random(1,Number.MAX_SAFE_INTEGER)},getCurrentTime=function(){return(new Date).getTime()},convertTime=function(time){if(time)return time<=1e3?1:time<=5e3?5:time<=1e4?10:time<=3e4?30:time>3e4?100:void 0},sendBi=function(eventStatus,time){var data,timeConverted;return data={eventName:"ws_test",eventStatus:eventStatus+"_"+blackArrow.getStatus()},timeConverted=convertTime(time),timeConverted&&(data.time=timeConverted),biReport("webSockets",data)},onMessage=function(message){if(_.isEqual(message,messageToSend))return sendBi("message_received",getCurrentTime()-TIME_START),clearTimeout(errorTimeoutId),blackArrow.off("message",onMessage)},sendErrorAfterTimeLimit=function(){return errorTimeoutId=setTimeout(function(){if(blackArrow.getOpenStarted())return sendBi("message_error",getCurrentTime()-TIME_START),blackArrow.off("message",onMessage)},TIMEOUT_TO_ERROR)},setTimeout(function(){if(blackArrow.getOpenStarted())return blackArrow.send(messageToSend,null,"post"),TIME_START=getCurrentTime(),sendBi("message_sent"),sendErrorAfterTimeLimit()},2e4),blackArrow.on("message",onMessage)}})}.call(this),function(){"use strict";this.app.factory("bigstockPrice",function($q,$http,settings){return function(){var price,priceUrl;return(price=void 0)?$q.when(price):(priceUrl=settings.bigStockPriceUrl,$http.get(priceUrl+"&locale="+settings.i18nCode,{withCredentials:!1}).then(function(response){return price=response.data}))}})}.call(this),function(){this.app.factory("settingsPassedAdapter",function(editorConnection,settings){var addThumbnailsToItem,getLoader,itemsLoader;return getLoader=function(name){return function(){var args,requestId;return requestId=_.uniqueId(),args=Array.prototype.slice.call(arguments),new Promise(function(resolve,reject){var onReject,onResolve,unsubscribe;return unsubscribe=function(){return editorConnection.off("adapter."+name+".resolve",onResolve),editorConnection.off("adapter."+name+".reject",onReject)},onResolve=function(data){if(data.requestId===requestId)return unsubscribe(),resolve(data)},onReject=function(data){if(data.requestId===requestId)return unsubscribe(),reject(data)},editorConnection.on("adapter."+name+".resolve",onResolve),editorConnection.on("adapter."+name+".reject",onReject),editorConnection.emit("adapter."+name,{requestId:requestId,arguments:args})})}},addThumbnailsToItem=function(options,item){return _.extend(wixmp.thumbnailGenerator.getWixThumbnailsUrls(item,options.thumbnails,{filesUrl:settings.settingsPassedFiles,imageOperationsApi:settings.imageOperationsApi}),item)},itemsLoader=getLoader("itemsList"),{name:"settingsPassed",folders:{list:getLoader("foldersList")},items:{list:function(folderId,options){return itemsLoader.apply(this,arguments).then(function(res){return res.data=_.map(res.data,_.partial(addThumbnailsToItem,options)),res})}}}})}.call(this),function(){"use strict";this.app.factory("wrapSource",function(settings,events,digest,defaultOptions,virtualActions,nestedFoldersList,allMediaFolder,siteMediaFolder,favoritesFolder,trashFolder,unsortedFolder,purchasedFolder,canDoAction,wrapItems,wrapFolders){return function(source){var adapter;return adapter=_.cloneDeep(source),_.merge(adapter,events.integrateSource(source)),_.merge(adapter,defaultOptions(adapter)),_.merge(adapter,virtualActions(adapter)),_.merge(adapter,digest(adapter)),_.merge(adapter,canDoAction(adapter)),_.merge(adapter,unsortedFolder(adapter)),settings.hasSubfolders&&_.merge(adapter,nestedFoldersList(adapter)),settings.siteMediaToken&&_.merge(adapter,siteMediaFolder(adapter)),_.merge(adapter,allMediaFolder(adapter)),settings.hasPurchased&&_.merge(adapter,purchasedFolder(adapter)),settings.hasFavorites&&_.merge(adapter,favoritesFolder(adapter)),settings.hasTrash&&_.merge(adapter,trashFolder(adapter)),_.merge(adapter,wrapItems(adapter)),_.merge(adapter,wrapFolders(adapter))}})}.call(this),function(){"use strict";this.app.factory("appLoad",function(_this){return function(events){return{integrate:function(){return events.on(events.FOLDERS.LIST,function(){var ref;return null!=(ref=_this.appLoadNotifiers)?ref.foldersLoaded():void 0}),events.on(events.FOLDERS.TRASH.LIST,function(){var ref;return null!=(ref=_this.appLoadNotifiers)?ref.foldersLoaded():void 0}),events.on(events.ITEMS.LIST,function(){var ref;return null!=(ref=_this.appLoadNotifiers)?ref.itemsLoaded():void 0}),events.on(events.ITEMS.SEARCH,function(){var ref;return null!=(ref=_this.appLoadNotifiers)?ref.itemsLoaded():void 0})}}}}(this))}.call(this),function(){"use strict";this.app.factory("canDoAction",function(settings){return function(adapter){return{can:{items:{list:function(){var ref;return null!=(ref=adapter.items)?ref.hasOwnProperty("list"):void 0},search:function(){var ref;return null!=(ref=adapter.items)?ref.hasOwnProperty("search"):void 0},remove:function(){var ref;return null!=(ref=adapter.items)?ref.hasOwnProperty("remove"):void 0},restore:function(){var ref,ref1;return settings.hasTrash&&(null!=(ref=adapter.items)&&null!=(ref1=ref.trash)?ref1.hasOwnProperty("restore"):void 0)},removeFromTrash:function(){var ref,ref1;return settings.hasTrash&&(null!=(ref=adapter.items)&&null!=(ref1=ref.trash)?ref1.hasOwnProperty("remove"):void 0)}},folders:{remove:function(){var ref;return null!=(ref=adapter.folders)?ref.hasOwnProperty("remove"):void 0},removeFromTrash:function(){var ref,ref1;return settings.hasTrash&&(null!=(ref=adapter.folders)&&null!=(ref1=ref.trash)?ref1.hasOwnProperty("remove"):void 0)},restore:function(){var ref,ref1;return settings.hasTrash&&(null!=(ref=adapter.folders)&&null!=(ref1=ref.trash)?ref1.hasOwnProperty("restore"):void 0)}},folder:{create:function(){var ref;return null!=(ref=adapter.folder)?ref.hasOwnProperty("create"):void 0},rename:function(){var ref;return null!=(ref=adapter.folder)?ref.hasOwnProperty("update"):void 0},move:function(){var ref;return settings.hasSubfolders&&(null!=(ref=adapter.folder)?ref.hasOwnProperty("update"):void 0)}},item:{upload:function(){var ref;return null!=(ref=adapter.item)?ref.hasOwnProperty("upload"):void 0},uploadByUrl:function(){var ref;return null!=(ref=adapter.item)?ref.hasOwnProperty("uploadByUrl"):void 0},rename:function(){var ref;return null!=(ref=adapter.item)?ref.hasOwnProperty("update"):void 0},move:function(){var ref;return null!=(ref=adapter.item)?ref.hasOwnProperty("update"):void 0},makeFavorites:function(){var ref;return settings.hasFavorites&&(null!=(ref=adapter.item)?ref.hasOwnProperty("makeFavorites"):void 0)},transcode:function(){return _.includes(["secure_music","video","secure_video"],settings.mediaType)&&adapter.hasOwnProperty("blackArrow")},getDownloadLink:function(){return"private"===adapter.name},skipImport:function(){return _.includes(["video","secure_video"],settings.mediaType)}}}}}})}.call(this),function(){"use strict";this.app.factory("digest",function($q,nestedMethod){return function(adapter){var addDigest,eventNames,getEventNames,methodsWithDigest;return getEventNames=function(obj,eventsNames){return null==eventsNames&&(eventsNames=[]),_.forEach(obj,function(eventName){return"string"==typeof eventName?eventsNames.push(eventName):getEventNames(eventName,eventsNames)}),eventsNames},addDigest=function(promise){return _.isArray(promise)?_.forEach(promise,function(promise){return $q.when(promise)}):$q.when(promise),promise},methodsWithDigest={},eventNames=getEventNames(adapter.events),_.forEach(eventNames,function(eventName){var method;if(adapter.events.on(eventName,addDigest),"function"==typeof(method=nestedMethod.get(adapter,eventName)))return nestedMethod.set(methodsWithDigest,eventName,function(){var promise;return promise=method.apply(this,arguments),addDigest(promise)})}),methodsWithDigest}})}.call(this),function(){"use strict";this.app.factory("events",function(_this){return function($window,$q){var addListener,callListeners,eventsList,globalListeners,integrateSource,logEvent,logger;return"function"==typeof wixmp.bi&&wixmp.bi(!0,{siteId:siteId,version:$window.VERSION}),logger=new _this.Logger("EVENTS"),logEvent=function(promises,event){var promisesList;return logger.log(event.eventTarget.name+"."+event.eventName+" emited",event.arguments),promisesList=_.isArray(promises)?promises:[promises],_.forEach(promisesList,function(promise){return promise.then(function(res){return logger.log(event.eventTarget.name+"."+event.eventName+" succeed",res),res},function(res){return logger.log(event.eventTarget.name+"."+event.eventName+" failed",res),res})}),promises},globalListeners=[],eventsList=_.cloneDeep(wixmp.events),eventsList.FOLDER.RENAME="folder.rename",eventsList.FOLDER.MOVE="folder.move",eventsList.ITEM.RENAME="item.rename",eventsList.ITEM.MOVE="item.move",eventsList.ITEM.MAKE_FAVORITES="item.makeFavorites",eventsList.ITEM.UMMAKE_FAVORITES="item.unmakeFavorites",callListeners=function(listeners,promise,event,wrap){return null==wrap&&(wrap=!0),_.forEach(listeners,function(listener){return wrap?_.isArray(promise)?listener(_.map(promise,$q.when),_.clone(event)):listener($q.when(promise),_.clone(event)):listener(promise,event)})},addListener=function(listeners,eventsNames,fn){return _.isString(eventsNames)&&(eventsNames=[eventsNames]),_.forEach(eventsNames,function(eventName){return listeners[eventName]||(listeners[eventName]=[]),listeners[eventName].push(fn)})},integrateSource=function(source){var emit,emitOnAddTag,emitOnAttrChanged,emitOnRemoveTag,getEventNames,onCurrentSource,sourceInterceptors,sourceListeners;return sourceListeners=[],sourceInterceptors=[],onCurrentSource=function(eventName,fn){return wixmp.events.on(eventName,function(promise,event){if(event.eventTarget===source)return fn.apply(this,arguments)})},emit=function(promise,event){return logEvent(promise,event),callListeners(sourceInterceptors[event.eventName],promise,event,!1),callListeners(sourceListeners[event.eventName],promise,event),callListeners(globalListeners[event.eventName],promise,event)},emitOnAttrChanged=function(attrName,newEventName,promise,event){var changes,newEvent,original;if(original=event.arguments[0],changes=event.arguments[1],null!=changes[attrName]&&original[attrName]!==changes[attrName])return newEvent=_.assign({},event,{eventName:newEventName}),emit.call(this,promise,newEvent)},emitOnAddTag=function(tagName,newEventName,promise,event){var changes,newEvent,originalData;if(originalData=event.arguments[0],changes=event.arguments[1],!_.includes(originalData.tags||[],tagName)&&_.includes(changes.tags||[],tagName))return newEvent=_.assign({},event,{eventName:newEventName}),emit.call(this,promise,newEvent)},emitOnRemoveTag=function(tagName,newEventName,promise,event){var changes,newEvent,originalData;if(originalData=event.arguments[0],changes=event.arguments[1],_.includes(originalData.tags||[],tagName)&&!_.includes(changes.tags||[],tagName))return newEvent=_.assign({},event,{eventName:newEventName}),emit.call(this,promise,newEvent)},getEventNames=function(obj,eventsNames){return null==eventsNames&&(eventsNames=[]),_.forEach(obj,function(eventName){return"string"==typeof eventName?eventsNames.push(eventName):getEventNames(eventName,eventsNames)}),eventsNames},_.forEach(getEventNames(wixmp.events),function(eventName){return onCurrentSource(eventName,emit)}),onCurrentSource(wixmp.events.FOLDER.UPDATE,_.partial(emitOnAttrChanged,"name",eventsList.FOLDER.RENAME)),onCurrentSource(wixmp.events.FOLDER.UPDATE,_.partial(emitOnAttrChanged,"parentId",eventsList.FOLDER.MOVE)),onCurrentSource(wixmp.events.ITEM.UPDATE,_.partial(emitOnAttrChanged,"name",eventsList.ITEM.RENAME)),onCurrentSource(wixmp.events.ITEM.UPDATE,_.partial(emitOnAttrChanged,"folderId",eventsList.ITEM.MOVE)),onCurrentSource(wixmp.events.ITEM.UPDATE,_.partial(emitOnAddTag,"_favorites",eventsList.ITEM.MAKE_FAVORITES)),onCurrentSource(wixmp.events.ITEM.UPDATE,_.partial(emitOnRemoveTag,"_favorites",eventsList.ITEM.UMMAKE_FAVORITES)),{events:_.assign({},eventsList,{on:_.partial(addListener,sourceListeners),intercept:_.partial(addListener,sourceInterceptors)})}},_.assign({},eventsList,{integrateSource:integrateSource,on:_.partial(addListener,globalListeners)})}}(this))}.call(this),function(){"use strict";this.app.factory("Folder",function(modelsMethodsWrappers,settings){var $$;return $$=modelsMethodsWrappers,function(){function Folder(adapter,data){var foldersList,foldersListAtTrash,itemsList,itemsListAtTrash,ref,ref1,remove,removeFromTrash;Object.defineProperty(this,"_isProcessing",{writable:!0,value:!1}),this.can={rename:function(_this){return function(){return!_this.isInTrash&&adapter.can.folder.rename()}}(this),moveItemIn:function(_this){return function(){return!_this.isInTrash&&adapter.can.item.move()}}(this),moveFolderIn:function(_this){return function(){return!_this.isInTrash&&adapter.can.folder.move()}}(this),uploadIn:function(_this){return function(){return!_this.isInTrash&&adapter.can.item.upload()}}(this),select:function(_this){return function(){return adapter.can.folder.move()}}(),submit:function(_this){return function(){return!1}}(),move:function(_this){return function(){return!_this.isInTrash&&adapter.can.folder.move()}}(this),restore:function(_this){return function(){return adapter.can.folders.restore()&&_this.isInTrash}}(this),remove:function(_this){return function(){return _this.isInTrash?adapter.can.folders.removeFromTrash():adapter.can.folders.remove()}}(this)},_.merge(this,data),this.mediaType||(this.mediaType=settings.mediaType),null!=this.thumbnailUrl&&0!==this.filesCount||(this.thumbnailUrl="images/thumbnails/subfolder.svg"),this.rename||(this.rename=$$.partialIfExists(adapter,"folder.rename",this.id)),this.restore||(this.restore=$$.partialIfExists(adapter,"folders.trash.restore",[this.id])),remove=$$.partialIfExists(adapter,"folders.remove",[this.id]),removeFromTrash=$$.partialIfExists(adapter,"folders.trash.remove",[this.id]),this.remove||(this.remove=function(_this){return function(){return _this.isInTrash?removeFromTrash.apply(_this,arguments):remove.apply(_this,arguments)}}(this)),null!=(null!=(ref=adapter.item)?ref.move:void 0)&&(this.moveItemIn||(this.moveItemIn=function(_this){return function(item){return adapter.item.move(item,_this.id)}}(this))),null!=(null!=(ref1=adapter.folder)?ref1.move:void 0)&&(this.moveFolderIn||(this.moveFolderIn=function(_this){return function(folder){return adapter.folder.move(folder,_this.id)}}(this))),foldersList=$$.partialIfExists(adapter,"folders.list",this.id),foldersListAtTrash=$$.partialIfExists(adapter,"folders.trash.list",this.id),this.foldersList||(this.foldersList=function(_this){return function(){return _this.isInTrash?foldersListAtTrash.apply(_this,arguments):foldersList.apply(_this,arguments)}}(this)),itemsList=$$.partialIfExists(adapter,"items.list",this.id),itemsListAtTrash=$$.partialIfExists(adapter,"items.trash.list",this.id),this.itemsList||(this.itemsList=function(_this){return function(){return _this.isInTrash?itemsListAtTrash.apply(_this,arguments):itemsList.apply(_this,arguments)}}(this)),this.itemsSearch||(this.itemsSearch=$$.partialIfExists(adapter,"items.search",this.id)),_.forEach(["rename","remove"],function(_this){return function(actionName){return _this.can[actionName]=$$.disableAtProcessing(_this,_this.can[actionName])}}(this))}return Folder}()}),this.app.factory("wrapFolders",function(Folder,nestedMethod){return function(adapter){var folderCreate,foldersList,mapFolder,mapFoldersList,methods,ref,ref1,ref2,ref3,trashList;return mapFolder=function(res){return res.data=new Folder(adapter,res.data),res},mapFoldersList=function(list){return list.data=_.map(list.data,function(folderData){return new Folder(adapter,folderData)}),list},folderCreate=null!=(ref=adapter.folder)?ref.create:void 0,foldersList=null!=(ref1=adapter.folders)?ref1.list:void 0,trashList=null!=(ref2=adapter.folders)&&null!=(ref3=ref2.trash)?ref3.list:void 0,
adapter.events.intercept([adapter.events.FOLDER.CREATE],function(promise){return promise.then(mapFolder)}),methods={},null!=folderCreate&&nestedMethod.set(methods,"folder.create",function(){return folderCreate.apply(this,arguments).then(mapFolder)}),null!=foldersList&&nestedMethod.set(methods,"folders.list",function(){return foldersList.apply(this,arguments).then(mapFoldersList)}),null!=trashList&&nestedMethod.set(methods,"folders.trash.list",function(){return trashList.apply(this,arguments).then(mapFoldersList)}),methods}})}.call(this),function(){"use strict";this.app.factory("Item",function(settings,modelsMethodsWrappers,NormalizeUri,itemThumbnailExtender){var $$;return $$=modelsMethodsWrappers,function(){function Item(adapter,data){var canBuy,canEdit,canGetDownloadLink,canShowExternalVideoPreview,canShowImagePreview,canShowVideoPreview,canTranscode,isDownloadSupportedByApi,remove,removeFromSiteMedia,removeFromTrash,untranscoded;this.sourceName=adapter.name,Object.defineProperty(this,"_isProcessing",{writable:!0,value:!1}),isDownloadSupportedByApi=function(){return"rembrandt"!==settings.imageOperationsApi},canEdit=function(_this){return function(){return!_this.isInTrash&&!untranscoded()&&isDownloadSupportedByApi()&&"private"===adapter.name&&_.includes(["picture","watermark","site_icon"],_this.mediaType)}}(this),canShowImagePreview=function(_this){return function(){return!untranscoded()&&_.includes(["picture","secure_picture","watermark","site_icon","ufont","shape"],_this.mediaType)}}(this),canShowVideoPreview=function(_this){return function(){var ref;return(null!=(ref=data.videoPreviewUrls)?ref.length:void 0)&&!untranscoded()&&_.includes(["video","secure_video"],_this.mediaType)}}(this),canShowExternalVideoPreview=function(_this){return function(){return data.iframeSrc&&_.includes(["video","secure_video"],_this.mediaType)}}(this),canGetDownloadLink=function(_this){return function(){return!_this.isInTrash&&!untranscoded()&&isDownloadSupportedByApi()&&adapter.can.item.getDownloadLink()&&!_.includes(["secure_music","secure_video","video","secure_picture","secure_document"],_this.mediaType)}}(this),canBuy=function(_this){return function(){return!untranscoded()&&_.includes(["bigstock","shutterstock"],adapter.name)}}(),untranscoded=function(_this){return function(){return _this.can.transcode()&&!_this.isTranscoded()}}(this),canTranscode=function(_this){return function(){return!_this.isInTrash&&adapter.can.item.transcode()&&null!=_this.transcodingStatus}}(this),this.can={rename:function(_this){return function(){return!_this.isInTrash&&!untranscoded()&&adapter.can.item.rename()&&!_this.isInSiteMedia}}(this),move:function(_this){return function(){return!_this.isInTrash&&!untranscoded()&&adapter.can.item.move()}}(this),makeFavorites:function(_this){return function(){return!_this.isInTrash&&!untranscoded()&&settings.hasFavorites&&adapter.can.item.makeFavorites()}}(this),unmakeFavorites:function(_this){return function(){return!_this.isInTrash&&!untranscoded()&&settings.hasFavorites&&adapter.can.item.makeFavorites()&&_this.isFavorites()}}(this),transcode:function(_this){return function(){return canTranscode()}}(),submit:function(_this){return function(){return settings.submitItems&&!_this.isInTrash&&(!canTranscode()||(settings.canSubmitUntranscoded||"READY"===_this.transcodingStatus))&&!_this._isProcessing}}(this),select:function(_this){return function(){return!0}}(),restore:function(_this){return function(){return adapter.can.items.restore()&&!untranscoded()&&_this.isInTrash}}(this),remove:function(_this){return function(){return _this.isInTrash?adapter.can.items.removeFromTrash():!_this.isInSiteMedia&&adapter.can.items.remove()}}(this),removeFromFolder:function(_this){return function(){return _this.isInSiteMedia&&(_this.isSiteOwner||!_this.isReadOnly(data))}}(this),edit:canEdit,showImagePreview:canShowImagePreview,showVideoPreview:canShowVideoPreview,showExternalVideoPreview:canShowExternalVideoPreview,getDownloadLink:canGetDownloadLink,buy:canBuy},_.merge(this,data),this.mediaType||(this.mediaType=settings.mediaType),_.assign(this,itemThumbnailExtender(this));try{this.name=decodeURIComponent(this.name)}catch(undefined){}this.rename||(this.rename=$$.partialIfExists(adapter,"item.rename",this.id)),remove=$$.partialIfExists(adapter,"items.remove",[this.id]),removeFromTrash=$$.partialIfExists(adapter,"items.trash.remove",[this.id]),removeFromSiteMedia=$$.partialIfExists(adapter,"items.siteMedia.remove",[this.id]),this.remove||(this.remove=function(_this){return function(){return _this.isInTrash?removeFromTrash.apply(_this,arguments):_this.isInSiteMedia?removeFromSiteMedia.apply(_this,arguments):remove.apply(_this,arguments)}}(this)),this.restore||(this.restore=$$.partialIfExists(adapter,"items.trash.restore",[this.id])),this.makeFavorites||(this.makeFavorites=$$.partialIfExists(adapter,"item.makeFavorites",this)),this.unmakeFavorites||(this.unmakeFavorites=$$.partialIfExists(adapter,"item.unmakeFavorites",this)),this.addToSiteMedia||(this.addToSiteMedia=$$.partialIfExists(adapter,"items.siteMedia.add",[this.id])),this.getDownloadLink||(this.getDownloadLink=function(){var currentExtension,downloadName,getExtension,originalExtension;return getExtension=function(fileName){return/[^.]*$/.exec(fileName)[0]},originalExtension=getExtension(this.originalUrl),currentExtension=getExtension(this.name),downloadName=currentExtension===originalExtension?this.name:this.name+"."+originalExtension,NormalizeUri(settings.privateMediaRestFiles+"/"+this.fileUrl+"?dn="+downloadName)}),_.forEach(["rename","remove","move","edit","getDownloadLink"],function(_this){return function(actionName){return _this.can[actionName]=$$.disableAtProcessing(_this,_this.can[actionName])}}(this))}return Item.prototype.isFavorites=function(){return _.includes(this.tags,"_favorites")},Item.prototype.isTranscoded=function(){return"READY"===this.transcodingStatus},Item.prototype.isReadOnly=function(entity){return entity.readOnly},Item}()}),this.app.factory("wrapItems",function(Item,editorConnection,nestedMethod,itemThumbnailExtender){return function(adapter){var itemsList,itemsSearch,itemsSearchByTag,itemsSiteMediaList,itemsTrashList,mapItem,mapItemsList,methods,ref,ref1,ref2,ref3,ref4,ref5,ref6,ref7,ref8,upload,uploadByUrl;return mapItem=function(res){return res.data=new Item(adapter,res.data),res},mapItemsList=function(res){return res.data=_.map(res.data,function(itemData){return new Item(adapter,itemData)}),res},adapter.events.intercept([adapter.events.ITEMS.UPLOAD,adapter.events.ITEMS.UPLOAD_BY_URL],function(promises){return _.map(promises,function(promise){return promise.then(mapItem)})}),adapter.events.intercept(adapter.events.ITEM.UPDATE,function(promise){return promise.then(function(res){return _.extend(res.data,itemThumbnailExtender(res.data)),res})}),upload=null!=(ref=adapter.item)?ref.upload:void 0,uploadByUrl=null!=(ref1=adapter.item)?ref1.uploadByUrl:void 0,itemsList=null!=(ref2=adapter.items)?ref2.list:void 0,itemsTrashList=null!=(ref3=adapter.items)&&null!=(ref4=ref3.trash)?ref4.list:void 0,itemsSiteMediaList=null!=(ref5=adapter.items)&&null!=(ref6=ref5.siteMedia)?ref6.list:void 0,itemsSearch=null!=(ref7=adapter.items)?ref7.search:void 0,itemsSearchByTag=null!=(ref8=adapter.items)?ref8.searchByTag:void 0,methods={},null!=upload&&nestedMethod.set(methods,"item.upload",function(){var promise,wrapped;return promise=upload.apply(this,arguments),wrapped=promise.then(function(data){return editorConnection.emit("uploadSingleFile",{data:_.assign({},data),source:adapter.name}),data}).then(mapItem),promise.progress(function(data){return wrapped.notify(data)}),wrapped}),null!=uploadByUrl&&nestedMethod.set(methods,"item.uploadByUrl",function(){return uploadByUrl.apply(this,arguments).then(mapItem)}),null!=itemsList&&nestedMethod.set(methods,"items.list",function(){return itemsList.apply(this,arguments).then(mapItemsList)}),null!=itemsTrashList&&nestedMethod.set(methods,"items.trash.list",function(){return itemsTrashList.apply(this,arguments).then(mapItemsList)}),null!=itemsSiteMediaList&&nestedMethod.set(methods,"items.siteMedia.list",function(){return itemsSiteMediaList.apply(this,arguments).then(mapItemsList)}),null!=itemsSearch&&nestedMethod.set(methods,"items.search",function(){return itemsSearch.apply(this,arguments).then(mapItemsList)}),null!=itemsSearchByTag&&nestedMethod.set(methods,"items.searchByTag",function(){return itemsSearchByTag.apply(this,arguments).then(mapItemsList)}),methods}})}.call(this),function(){"use strict";var slice=[].slice;this.app.factory("itemThumbnailExtender",function(settings,mediaTypes,supportedArchiveTypes,supportedDocsTypes){var extras,getComplexThumbnails,getDocumentExtension,getPictureThumbnails,getSecureMusicThumbnails,getSecurePictureThumbnails,getThumbnails,getVideoThumbnails,obj;return getDocumentExtension=function(fileUrl){return fileUrl.split(".")<3?"":fileUrl.split(".").pop()},getThumbnails=function(item){return{thumbnailUrl:"images/thumbnails/"+item.mediaType+".svg",thumbnail2xUrl:"images/thumbnails/"+item.mediaType+".svg"}},getSecureMusicThumbnails=function(){return{thumbnailUrl:"images/thumbnails/music.svg",thumbnail2xUrl:"images/thumbnails/music.svg"}},getPictureThumbnails=function(item){if(_.isNull(item.thumbnailUrl))return{thumbnailUrl:"images/thumbnails/Images.svg"}},getVideoThumbnails=function(item){return{fileOutput:item.fileOutput}},getSecurePictureThumbnails=function(item){if(settings.namespace)return{thumbnailUrl:item.thumbnailUrl+"?ns="+settings.namespace,previewUrl:item.previewUrl+"?ns="+settings.namespace}},getComplexThumbnails=function(item){var extension;if(extension=getDocumentExtension(item.fileUrl),_.includes(slice.call(supportedArchiveTypes).concat(slice.call(supportedDocsTypes)),extension))return{thumbnailUrl:"images/thumbnails/"+item.mediaType+"-"+extension+".svg",thumbnail2xUrl:"images/thumbnails/"+item.mediaType+"-"+extension+".svg"}},obj={},obj[""+mediaTypes.ARCHIVE]=getComplexThumbnails,obj[""+mediaTypes.DOCUMENT]=getComplexThumbnails,obj[""+mediaTypes.MUSIC]=getThumbnails,obj[""+mediaTypes.PICTURE]=getPictureThumbnails,obj[""+mediaTypes.SECURE_MUSIC]=getSecureMusicThumbnails,obj[""+mediaTypes.SECURE_PICTURE]=getSecurePictureThumbnails,obj[""+mediaTypes.SWF]=getThumbnails,obj[""+mediaTypes.VIDEO]=getVideoThumbnails,extras=obj,function(item){return extras[item.mediaType]?extras[item.mediaType](item):{}}})}.call(this),function(){"use strict";var slice=[].slice;this.app.factory("modelsMethodsWrappers",function(nestedMethod){return{setProcessing:function(model,method){return function(){var promise;return model._isProcessing=!0,promise=method.apply(this,arguments),promise.finally(function(){return model._isProcessing=!1})}},withModelUpdate:function(model,method){return function(){return method.apply(this,arguments).then(function(res){return _.assign(model,res.data)})}},disableAtProcessing:function(model,canAction){return function(){return!model._isProcessing&&canAction()}},partialIfExists:function(){var adapter,args,method,namespace;if(adapter=arguments[0],namespace=arguments[1],args=3<=arguments.length?slice.call(arguments,2):[],null!=(method=nestedMethod.get(adapter,namespace)))return _.partial.apply(_,[method].concat(slice.call(args)))}}})}.call(this),function(){"use strict";this.app.factory("virtualActions",function(){return function(adapter){var folderUpdate,itemUpdate,methods,ref,ref1;return folderUpdate=null!=(ref=adapter.folder)?ref.update:void 0,itemUpdate=null!=(ref1=adapter.item)?ref1.update:void 0,methods={},null!=folderUpdate&&(methods.folder={rename:function(folderId,newName){return folderUpdate({id:folderId},{name:newName})},move:function(folder,moveToFolderId){return folderUpdate({id:folder.id,parentId:folder.parentId},{parentId:moveToFolderId})}}),null!=itemUpdate&&(methods.item={rename:function(itemId,newName){return itemUpdate({id:itemId},{name:newName})},move:function(item,moveToFolderId){return itemUpdate({id:item.id,folderId:item.folderId},{folderId:moveToFolderId})},makeFavorites:function(item){var tagsArr;return tagsArr=Array.prototype.slice(item.tags||[]),tagsArr.push("_favorites"),tagsArr=_.uniq(tagsArr),itemUpdate({id:item.id,tags:item.tags},{tags:tagsArr})},unmakeFavorites:function(item){var tagsArr;return tagsArr=Array.prototype.slice(item.tags||[]),tagsArr=_.without(tagsArr,"_favorites"),itemUpdate({id:item.id,tags:item.tags},{tags:tagsArr})}}),methods}})}.call(this),function(){"use strict";this.app.factory("defaultOptions",function(settings,nestedMethod){return function(adapter){var extendArgument,language,languageMediaType,mediaType,methods;return methods={},extendArgument=function(namespace,argumentIndex,geArg){var originalMethod;if(originalMethod=nestedMethod.get(adapter,namespace))return nestedMethod.set(methods,namespace,function(){var args;return args=Array.prototype.slice.call(arguments),_.isArray(args[argumentIndex])?args[argumentIndex]=_.map(args[argumentIndex],function(entity){return _.assign(geArg(),entity)}):args[argumentIndex]=_.assign(geArg(),args[argumentIndex]),originalMethod.apply(this,args)})},mediaType=function(){return{mediaType:settings.mediaType}},language=function(){return{language:settings.i18nCode}},languageMediaType=function(){return{language:settings.i18nCode,mediaType:settings.mediaType}},extendArgument("folders.list",1,mediaType),extendArgument("folders.trash.list",1,mediaType),extendArgument("folder.create",1,mediaType),extendArgument("items.list",1,mediaType),extendArgument("items.trash.list",1,mediaType),extendArgument("items.siteMedia.list",1,mediaType),extendArgument("items.searchByTag",1,mediaType),extendArgument("items.search",2,mediaType),extendArgument("items.upload",0,mediaType),extendArgument("items.uploadByUrl",0,mediaType),"public"===adapter.name&&(extendArgument("folders.list",1,language),extendArgument("item.get",1,language),extendArgument("items.list",1,languageMediaType),extendArgument("items.search",2,languageMediaType)),methods}})}.call(this),function(){"use strict";var slice=[].slice,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};this.app.factory("nestedFoldersList",function(nestedMethod,externalAdaptersWithNestedSupport){var filterResByParentId;return filterResByParentId=function(parentId,promise){return promise.then(function(res){var foldersIds,unsorted;return parentId||(unsorted=_.find(res.data,function(folder){return null===folder.parentId}),parentId=null!=unsorted?unsorted.id:void 0),parentId?res.data=_.filter(res.data,function(folder){return folder.parentId===parentId||folder===unsorted}):(foldersIds=_.pluck(res.data,"id"),_.remove(res.data,function(folder){return _.includes(foldersIds,folder.parentId)})),res})},function(adapter){var adaptersWithNestedSupport,foldersList,foldersTrashList,methods,ref,ref1,ref2,ref3;return adaptersWithNestedSupport=["private"].concat(slice.call(externalAdaptersWithNestedSupport)),ref=adapter.name,indexOf.call(adaptersWithNestedSupport,ref)<0?{}:(adapter.events.intercept([adapter.events.FOLDERS.LIST],function(promise,event){var parentId;return parentId=event.arguments[0],filterResByParentId(parentId,promise)}),foldersList=null!=(ref1=adapter.folders)?ref1.list:void 0,foldersTrashList=null!=(ref2=adapter.folders)&&null!=(ref3=ref2.trash)?ref3.list:void 0,methods={},null!=foldersList&&nestedMethod.set(methods,"folders.list",function(parentId){var promise;return promise=foldersList.apply(this,arguments),filterResByParentId(parentId,promise)}),null!=foldersTrashList&&nestedMethod.set(methods,"folders.trash.list",function(parentId){var promise;return/^trash/i.test(parentId)&&(parentId=null),promise=foldersTrashList.apply(this,arguments),filterResByParentId(parentId,promise)}),methods)}})}.call(this),function(){"use strict";this.app.factory("allMediaFolder",function($q,Folder,settings,i18n,nestedMethod){var createAllMediaFolder;return createAllMediaFolder=function(adapter){return new Folder(adapter,{id:null,virtualId:"allMedia_"+settings.mediaType,mediaType:settings.mediaType,parentId:null,name:i18n.translate("private_media.all_media"),filesCount:0,createdAt:0,isVirtual:!0,type:"allMedia",can:{rename:function(){return!1},remove:function(){return!1},moveItemIn:function(){return!1}},foldersList:function(){return $q.when([])}})},function(adapter){var foldersList,methods,ref;return _.includes(["private","platform"],adapter.name)?(foldersList=null!=(ref=adapter.folders)?ref.list:void 0,methods={},nestedMethod.set(methods,"folders.list",function(parentId){return foldersList.apply(this,arguments).then(function(list){return parentId?list:(list.data.unshift(createAllMediaFolder(adapter)),list)})}),methods):{}}})}.call(this),function(){"use strict";this.app.factory("siteMediaFolder",function($q,Folder,settings,i18n,nestedMethod){var createSiteMediaFolder;return createSiteMediaFolder=function(adapter){return new Folder(adapter,{id:"siteMedia",virtualId:"siteMedia_"+settings.mediaType,mediaType:settings.mediaType,parentId:null,name:i18n.translate("private_media.site_media"),filesCount:0,createdAt:0,isVirtual:!0,type:"siteMedia",can:{rename:function(){return!1},remove:function(){return!1},moveItemIn:function(){return!0}},foldersList:function(){return $q.when([])},itemsList:function(options){return adapter.items.siteMedia.list(null,options)},moveItemIn:function(item){return item.addToSiteMedia()}})},function(adapter){var foldersList,methods,ref;return"private"!==adapter.name?{}:(foldersList=null!=(ref=adapter.folders)?ref.list:void 0,methods={},nestedMethod.set(methods,"folders.list",function(parentId){return foldersList.apply(this,arguments).then(function(list){return parentId?list:(list.data.unshift(createSiteMediaFolder(adapter)),list)})}),methods)}})}.call(this),function(){"use strict";this.app.factory("unsortedFolder",function($q,Folder,i18n,nestedMethod,settings){var createUnsorted,makeUnsorted;return makeUnsorted=function(rootFolder,adapter){return rootFolder.name=i18n.translate(("private"===adapter.name?"private_media":adapter.name)+".unsorted"),rootFolder.isVirtual=!0,rootFolder.type="unsorted",rootFolder.can={rename:function(){return!1},remove:function(){return!1},move:function(){return!1}},rootFolder.foldersList=function(){return $q.when([])},rootFolder},createUnsorted=function(adapter){var folder;return folder=new Folder(adapter,{id:null,virtualId:"unsorted_"+settings.mediaType,mediaType:settings.mediaType,parentId:null,createdAt:0}),makeUnsorted(folder,adapter)},function(adapter){var foldersList,methods,ref;return _.includes(["private","collection","settingsPassed"],adapter.name)?(foldersList=null!=(ref=adapter.folders)?ref.list:void 0,methods={},nestedMethod.set(methods,"folders.list",function(parentId){return foldersList.apply(this,arguments).then(function(list){var rootFolder;return parentId?list:(rootFolder=_.find(list.data,function(folder){return null===folder.parentId}),rootFolder&&"private"===adapter.name?(_.remove(list.data,rootFolder),list.data.unshift(makeUnsorted(rootFolder,adapter))):list.data.unshift(createUnsorted(adapter)),list)})}),methods):{}}})}.call(this),function(){"use strict";this.app.factory("purchasedFolder",function($q,i18n,settings,nestedMethod){return function(adapter){var foldersList,methods,ref;return"private"!==adapter.name?{}:(foldersList=null!=(ref=adapter.folders)?ref.list:void 0,methods={},nestedMethod.set(methods,"folders.list",function(parentId){return foldersList.apply(this,arguments).then(function(list){return parentId?list:(list.data.push({id:"purchased"+settings.mediaType,name:i18n.translate("private_media.purchased"),type:"purchased",isVirtual:!0,mediaType:settings.mediaType,can:{rename:function(){return!1},remove:function(){return!1},moveItemIn:function(){return!1},moveFolderIn:function(){return!1},move:function(){return!1},uploadIn:function(){return!1}},foldersList:function(){return $q.when([])},itemsList:function(id,options){return null==options&&(options={}),adapter.items.searchByTag("_paid",options)}}),list)})}),methods)}})}.call(this),function(){"use strict";this.app.factory("favoritesFolder",function(i18n,settings,$q,nestedMethod){return function(adapter){var foldersList,methods,ref;return"private"!==adapter.name?{}:(foldersList=null!=(ref=adapter.folders)?ref.list:void 0,methods={},nestedMethod.set(methods,"folders.list",function(parentId){return foldersList.apply(this,arguments).then(function(list){return parentId?list:(list.data.push({id:"favorites"+settings.mediaType,name:i18n.translate("private_media.favorites"),type:"favorites",isVirtual:!0,mediaType:settings.mediaType,can:{rename:function(){return!1},remove:function(){return!1},moveItemIn:function(){return!0},moveFolderIn:function(){return!1},move:function(){return!1},uploadIn:function(){return!1}},foldersList:function(){return $q.when([])},itemsList:function(options){return null==options&&(options={}),adapter.items.searchByTag("_favorites",options)},moveItemIn:function(item){return adapter.item.makeFavorites(item)}}),list)})}),methods)}})}.call(this),function(){"use strict";this.app.factory("trashFolder",function(i18n,settings,nestedMethod,confirm){return function(adapter){var foldersList,methods,ref,ref1;return"private"!==adapter.name||null==(null!=(ref=adapter.items)?ref.trash:void 0)?{}:(foldersList=null!=(ref1=adapter.folders)?ref1.list:void 0,methods={},nestedMethod.set(methods,"folders.list",function(parentId){return foldersList.apply(this,arguments).then(function(list){return parentId?list:(list.data.push({id:"trash"+settings.mediaType,name:i18n.translate("private_media.trash"),type:"trash",isVirtual:!0,mediaType:settings.mediaType,can:{rename:function(){return!1},remove:function(){return!1},moveItemIn:function(){return!0},move:function(){return!1},uploadIn:function(){return!1},restore:function(){return!0},deleteAll:function(){return!0}},itemsList:function(options){return adapter.items.trash.list(null,options)},foldersList:function(options){return adapter.folders.trash.list(null,options)},moveItemIn:function(item){return item.remove()},moveFolderIn:function(folder){return folder.remove()},restore:function(){return confirm({confirmTitle:i18n.translate("private_media.restore_confirmation.title"),confirmMessage:i18n.translate("private_media.restore_confirmation.message"),confirmYes:i18n.translate("private_media.restore_confirmation.yes"),confirmNo:i18n.translate("private_media.restore_confirmation.no"),confirm:function(){return adapter.trash.restore({mediaType:settings.mediaType})},className:"blue"}),!1},deleteAll:function(){return confirm({confirmTitle:i18n.translate("private_media.empty_trash_confirmation.title"),confirmMessage:i18n.translate("private_media.empty_trash_confirmation.message"),confirmYes:i18n.translate("private_media.empty_trash_confirmation.yes"),confirmNo:i18n.translate("private_media.empty_trash_confirmation.no"),confirm:function(){return adapter.trash.remove({mediaType:settings.mediaType})}}),!1}}),list)})}),methods)}})}.call(this),function(){"use strict";var ref,ref1;null!=(ref=this.appLoadNotifiers)&&ref.appIsInitialized(),this.app.config(function(_this){return function($httpProvider,RestangularProvider){return $httpProvider.defaults.withCredentials=!0,$httpProvider.defaults.responseType="json",$httpProvider.interceptors.push("UrlSanitizeInterceptor"),RestangularProvider.setDefaultHeaders({"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}),RestangularProvider.setDefaultRequestParams("jsonp",{callback:"JSON_CALLBACK"}),RestangularProvider.setDefaultHttpFields({withCredentials:!0})}}()),null!=(ref1=this.appLoadNotifiers)&&ref1.componentsAreConfigured(),this.app.run(["editorConnection","appLoad","biSubscribeUpload",function(_this){return function(editorConnection,appLoad){var ref2,ref3;return null!=(ref2=_this.appLoadNotifiers)&&ref2.appIsRunning(),appLoad.integrate(),editorConnection.emit("ready"),null!=(ref3=_this.appLoadNotifiers)?ref3.sentReadyToProtocol():void 0}}(this)])}.call(this);