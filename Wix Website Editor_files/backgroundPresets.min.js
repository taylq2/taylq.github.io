define("backgroundPresets/components/backgroundPresetSection.rt",["react","lodash","baseUI","util","constants"],function(e,t,i,a,r){"use strict";return function(){return e.createElement("div",{className:"bg-preset-list-section section-wrapper"},e.createElement("div",{className:"section-header"},e.createElement("div",{className:"title-line"},e.createElement("div",{className:"title"},this.props.title),e.createElement(i.infoIcon,{key:"infoIcon",className:"info-icon",text:this.props.infoTooltip}))),e.createElement.apply(this,["ul",{className:"preset-list-section-list columns-"+(this.props.columns||1)},t.map(this.getPresetData(),function(t,s){return e.createElement("li",{className:"preset-list-item",key:"preset"+s,onClick:function(e,t){this.selectPreset(e,"presetBackgrounds",t)}.bind(this,t,s)},e.createElement(i.tooltip,{value:this.getMediaPreviewComp(t),alignment:"right",styleType:r.UI.TOOLTIP.STYLE_TYPE.CONTENT_ONLY,delay:"300",width:"294px",noArrow:!0},e.createElement("div",{className:"preset-list-preset",style:this.getThumbBackdropStyle(t)},e.createElement("div",{className:"preset-list-preset-content",style:this.getThumbStyle(t)}),this.getMediaType(t)===this.mediaTypes.VIDEO?e.createElement("div",{style:this.getOverlayStyle(t),className:"preset-list-preset-overlay",key:"preset-list-preset-overlay"}):null,this.getMediaType(t)===this.mediaTypes.VIDEO?e.createElement("div",{className:"preset-list-preset-video-controls",key:"bgVideoIndicator"},e.createElement(i.symbol,{name:"bgVideoIndicator"})):null,t.thumbnail&&t.thumbnail.title?e.createElement("div",{key:"preset-title",className:"preset-title"},a.translate(t.thumbnail.title)):null)))}.bind(this))]))}}),define("backgroundPresets/components/mediaPreview.rt",["react","lodash","util"],function(e,t,i){"use strict";return function(){function a(e,i){var a=t.assign({},e,i);return e.hasOwnProperty("style")&&(a.style=t.defaults(a.style,e.style)),e.hasOwnProperty("className")&&i.hasOwnProperty("className")&&(a.className=i.className+" "+e.className),a}return function(){var r=this.getMediaType(),s=i.backgroundPanelUtils;return e.createElement("div",{className:"media-preview-panel"},e.createElement("div",{className:t({"media-preview-wrapper":!0,hide:r===this.mediaTypes.VIDEO&&!this.state.isPreviewReady,show:r===this.mediaTypes.VIDEO&&this.state.isPreviewReady}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},e.createElement("div",a({className:"media-preview-color"},{style:this.getBackgroundColor()})),r===this.mediaTypes.IMAGE?e.createElement("div",a({className:"media-preview-image",key:"media-preview-image"},{style:this.getBackgroundStyle(r)})):null,r===this.mediaTypes.VIDEO?e.createElement("div",a({className:"media-preview-video-wrapper",key:"media-preview-video-wrapper"},{style:this.getVideoStyle()}),e.createElement("video",{autoPlay:!0,loop:!0,muted:!0,preload:"none",ref:"videoInstance",className:"media-preview-video"},e.createElement("source",{src:this.getVideoSource("mp4"),type:"video/mp4"}),e.createElement("source",{src:this.getVideoSource("webm"),type:"video/webm"}))):null,e.createElement("div",{className:"media-preview-overlay",style:s.getOverlayStyle(this.props.data,this.getEditorAPI())})),e.createElement("div",{className:"media-preview-caption"},e.createElement("span",{className:"media-title"},this.getMediaCaption()),r===this.mediaTypes.VIDEO?e.createElement("span",{className:"video-duration",key:"video-duration"},this.getSecInMin()):null))}.apply(this,[])}}),define("backgroundPresets/components/mediaPreview",["reactDOM","react","lodash","util","core","backgroundPresets/components/mediaPreview.rt"],function(e,t,i,a,r,s){"use strict";var n="480p",o=a.imageTransform,l=a.backgroundPanelUtils;return t.createClass({displayName:"mediaPreview",mediaTypes:l.getMediaTypes(),mixins:[r.mixins.editorAPIMixin],getInitialState:function(){return{isPreviewReady:!1}},componentWillUnmount:function(){this.getMediaType()===this.mediaTypes.VIDEO&&(this.getInstance().removeEventListener("timeupdate",this.onPlaying),this.removeVideoSecurely())},componentDidMount:function(){this.getMediaType()===this.mediaTypes.VIDEO&&this.getInstance().addEventListener("timeupdate",this.onPlaying)},onPlaying:function(){this.state.isPreviewReady||this.setState({isPreviewReady:!0})},getInstance:function(){return e.findDOMNode(this.refs.videoInstance)},removeVideoSecurely:function(){var e=this.getInstance();e.pause(),i.forEach(e.children,function(e){"source"===e.nodeName.toLowerCase()&&e.setAttribute("src","")}),e.load()},getMediaType:function(){return l.getMediaType(this.props.data)},getBackgroundColor:function(){return{backgroundColor:l.getColorValue(this.getEditorAPI(),this.props.data.color)}},getBackgroundStyle:function(e){var t=this.props.data,i=e===this.mediaTypes.VIDEO?t.mediaRef.posterImageRef:t.mediaRef,r=void 0;if(t.fittingType===o.fittingTypes.LEGACY_BG_FIT_AND_TILE||t.fittingType===o.fittingTypes.TILE){r=l.isSmallerFromContainer(i.width,i.height,270,152)?o.fittingTypes.TILE:o.fittingTypes.FIT_AND_TILE}else r=o.fittingTypes.SCALE_TO_FILL;var s=l.getImageDisplayData(r,t.alignType,i.uri,i.width,i.height,270,152,85),n=s.css.container;return n.backgroundImage="url("+a.url.joinURL(l.MEDIA_URL_PREFIX,s.uri)+")",n.opacity=i.opacity,n},getVideoSource:function(e){var t=this.props.data.mediaRef,r=t.videoId,s=function(e){return i.find(e,{quality:n})}(t.qualities)||t.qualities[0];return a.url.joinURL(l.VIDEO_URL_PREFIX,r,s.quality,e,"file."+e)},getVideoStyle:function(){return{width:270,height:152,opacity:this.props.data.mediaRef.opacity}},getSecInMin:function(){var e=this.props.data.mediaRef.duration,t=e%60;return parseInt(e/60,10)+":"+(t<10?"0"+t:t)},getMediaCaption:function(){return this.props.data.mediaRef.title||""},render:s})}),define("backgroundPresets/components/backgroundPresetSection",["react","lodash","core","util","color","backgroundPresets/components/backgroundPresetSection.rt","backgroundPresets/components/mediaPreview"],function(e,t,i,a,r,s,n){"use strict";var o=a.imageTransform.fittingTypes,l=a.imageTransform.alignTypes,c=a.backgroundPanelUtils,d=[{thumbWidth:238,thumbHeight:58},{thumbWidth:110,thumbHeight:58},{thumbWidth:68,thumbHeight:50},{thumbWidth:88,thumbHeight:59}];return e.createClass({displayName:"backgroundPresetSection",mixins:[i.mixins.editorAPIMixin],propTypes:{title:e.PropTypes.string,infoTooltip:e.PropTypes.string,onSelectPreset:e.PropTypes.func,columns:e.PropTypes.number,desktopPresets:e.PropTypes.array.isRequired,mobilePresets:e.PropTypes.array},mediaTypes:c.getMediaTypes(),getInitialState:function(){var e=this.props.columns-1||0;return{thumbWidth:d[e].thumbWidth,thumbHeight:d[e].thumbHeight}},componentWillReceiveProps:function(e){var t=e.columns-1||0;this.setState({thumbWidth:d[t].thumbWidth,thumbHeight:d[t].thumbHeight})},getMediaType:function(e){return c.getMediaType(e.ref)},getPresetData:function(){return this.getEditorAPI().isMobileEditor()?this.props.mobilePresets||{}:this.props.desktopPresets},getMediaPreviewComp:function(t){return this.getMediaType(t)!==this.mediaTypes.COLOR?e.createElement(n,{data:t.ref}):null},getThumbStyle:function(e){var i={},s=void 0,n=o.SCALE_TO_FILL,d=l.CENTER,u=this.getMediaType(e);if(e.thumbnail&&e.thumbnail.uri&&e.thumbnail.width&&e.thumbnail.height)s=t.omit(e.thumbnail,"title");else if(u!==this.mediaTypes.COLOR){if(s=e.ref.mediaRef.posterImageRef||e.ref.mediaRef,e.ref.fittingType===o.LEGACY_BG_FIT_AND_TILE||e.ref.fittingType===o.TILE){n=c.isSmallerFromContainer(s.width,s.height,this.state.thumbWidth,this.state.thumbHeight)?o.TILE:o.FIT_AND_TILE}else n=o.SCALE_TO_FILL;d=e.ref.alignType}if(s){var m=c.getImageDisplayData(n,d,s.uri,s.width,s.height,this.state.thumbWidth,this.state.thumbHeight,90);(i=m.css.container).backgroundImage="url("+a.url.joinURL(c.MEDIA_URL_PREFIX,m.uri)+")"}var h=c.getColorValue(this.getEditorAPI(),e.ref.color||"#ffffff");return h&&(i.backgroundColor=new r(h).alpha(e.ref.colorOpacity||1).rgbaString()),i.width=this.state.thumbWidth+"px",i.height=this.state.thumbHeight+"px",i},getThumbBackdropStyle:function(e){var t={},i=o.TILE,r=l.CENTER;if(e.thumbnailBackground&&e.thumbnailBackground.uri&&e.thumbnailBackground.width&&e.thumbnailBackground.height){var s=c.getImageDisplayData(i,r,e.thumbnailBackground.uri,e.thumbnailBackground.width,e.thumbnailBackground.height,this.state.thumbWidth,this.state.thumbHeight,90);t=s.css.container;var n=a.url.isExternalUrl(s.uri)?s.uri:a.url.joinURL(c.MEDIA_URL_PREFIX,s.uri);t.backgroundImage="url("+n+")"}return t.width=this.state.thumbWidth+"px",t.height=this.state.thumbHeight+"px",t},getOverlayStyle:function(e){var t=e.ref,i={},a=c.getColorValue(this.getEditorAPI(),t.colorOverlay);return a&&(i.backgroundColor=new r(a).alpha(t.colorOverlayOpacity||0).rgbaString()),i},selectPreset:function(e,i,a){this.props.onSelectPreset(t.cloneDeep(e),i,a)},render:function(){return s.apply(this)}})}),define("backgroundPresets",["backgroundPresets/components/backgroundPresetSection"],function(e){"use strict";return e});
//# sourceMappingURL=backgroundPresets.min.js.map